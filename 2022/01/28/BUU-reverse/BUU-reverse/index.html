<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>BUU_reverse | ke1os' blog</title><meta name="keywords" content="BUU-reverse练习"><meta name="author" content="ke1os"><meta name="copyright" content="ke1os"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="[RCTF2019]DontEatMe用findcrypt插件查看一下加密算法，Blowfish算法   [羊城杯 2020]Bytecode (py字节码)题目中给出了挺长的字节码，在解这道题的时候，需要多参考查看官方dis反汇编器的文档。 可以使用以下命令，时不时反汇编一下逆向出的代码，进行对比。 1python3 -m dis fileName.py  题目给出的字节码： 1234567">
<meta property="og:type" content="article">
<meta property="og:title" content="BUU_reverse">
<meta property="og:url" content="http://ke1os.top/2022/01/28/BUU-reverse/BUU-reverse/index.html">
<meta property="og:site_name" content="ke1os&#39; blog">
<meta property="og:description" content="[RCTF2019]DontEatMe用findcrypt插件查看一下加密算法，Blowfish算法   [羊城杯 2020]Bytecode (py字节码)题目中给出了挺长的字节码，在解这道题的时候，需要多参考查看官方dis反汇编器的文档。 可以使用以下命令，时不时反汇编一下逆向出的代码，进行对比。 1python3 -m dis fileName.py  题目给出的字节码： 1234567">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2022-01-28T12:18:36.000Z">
<meta property="article:modified_time" content="2022-05-08T01:44:52.098Z">
<meta property="article:author" content="ke1os">
<meta property="article:tag" content="BUU-reverse练习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/img/ke1os.jpg"><link rel="canonical" href="http://ke1os.top/2022/01/28/BUU-reverse/BUU-reverse/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BUU_reverse',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-08 09:44:52'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/ke1os.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">27</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">14</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">ke1os' blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUU_reverse</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-01-28T12:18:36.000Z" title="Created 2022-01-28 20:18:36">2022-01-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-05-08T01:44:52.098Z" title="Updated 2022-05-08 09:44:52">2022-05-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BUU_reverse"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><span id="more"></span>

<h1 id="RCTF2019-DontEatMe"><a href="#RCTF2019-DontEatMe" class="headerlink" title="[RCTF2019]DontEatMe"></a>[RCTF2019]DontEatMe</h1><p>用findcrypt插件查看一下加密算法，Blowfish算法</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220427221442380.png" class="" title="image-20220427221442380">

<h1 id="羊城杯-2020-Bytecode-py字节码"><a href="#羊城杯-2020-Bytecode-py字节码" class="headerlink" title="[羊城杯 2020]Bytecode (py字节码)"></a>[羊城杯 2020]Bytecode (py字节码)</h1><p>题目中给出了挺长的字节码，在解这道题的时候，需要多参考查看<a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/dis.html">官方dis反汇编器的文档</a>。</p>
<p>可以使用以下命令，时不时反汇编一下逆向出的代码，进行对比。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m dis fileName.py</span><br></pre></td></tr></table></figure>

<p>题目给出的字节码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">4</span>           <span class="number">0</span> LOAD_CONST               <span class="number">0</span> (<span class="number">3</span>) <span class="comment"># LOAD_CONST 压栈操作</span></span><br><span class="line">             <span class="number">3</span> LOAD_CONST               <span class="number">1</span> (<span class="number">37</span>)</span><br><span class="line">             <span class="number">6</span> LOAD_CONST               <span class="number">2</span> (<span class="number">72</span>)</span><br><span class="line">             <span class="number">9</span> LOAD_CONST               <span class="number">3</span> (<span class="number">9</span>)</span><br><span class="line">            <span class="number">12</span> LOAD_CONST               <span class="number">4</span> (<span class="number">6</span>)</span><br><span class="line">            <span class="number">15</span> LOAD_CONST               <span class="number">5</span> (<span class="number">132</span>)</span><br><span class="line">            <span class="number">18</span> BUILD_LIST               <span class="number">6</span>		    <span class="comment"># 创建列表 </span></span><br><span class="line">            <span class="number">21</span> STORE_NAME               <span class="number">0</span> (en)   <span class="comment"># en = [3,37,72,9,6,132]</span></span><br><span class="line"></span><br><span class="line"> <span class="number">5</span>          <span class="number">24</span> LOAD_CONST               <span class="number">6</span> (<span class="number">101</span>)</span><br><span class="line">            <span class="number">27</span> LOAD_CONST               <span class="number">7</span> (<span class="number">96</span>)</span><br><span class="line">            <span class="number">30</span> LOAD_CONST               <span class="number">8</span> (<span class="number">23</span>)</span><br><span class="line">            <span class="number">33</span> LOAD_CONST               <span class="number">9</span> (<span class="number">68</span>)</span><br><span class="line">            <span class="number">36</span> LOAD_CONST              <span class="number">10</span> (<span class="number">112</span>)</span><br><span class="line">            <span class="number">39</span> LOAD_CONST              <span class="number">11</span> (<span class="number">42</span>)</span><br><span class="line">            <span class="number">42</span> LOAD_CONST              <span class="number">12</span> (<span class="number">107</span>)</span><br><span class="line">            <span class="number">45</span> LOAD_CONST              <span class="number">13</span> (<span class="number">62</span>)</span><br><span class="line">            <span class="number">48</span> LOAD_CONST               <span class="number">7</span> (<span class="number">96</span>)</span><br><span class="line">            <span class="number">51</span> LOAD_CONST              <span class="number">14</span> (<span class="number">53</span>)</span><br><span class="line">            <span class="number">54</span> LOAD_CONST              <span class="number">15</span> (<span class="number">176</span>)</span><br><span class="line">            <span class="number">57</span> LOAD_CONST              <span class="number">16</span> (<span class="number">179</span>)</span><br><span class="line">            <span class="number">60</span> LOAD_CONST              <span class="number">17</span> (<span class="number">98</span>)</span><br><span class="line">            <span class="number">63</span> LOAD_CONST              <span class="number">14</span> (<span class="number">53</span>)</span><br><span class="line">            <span class="number">66</span> LOAD_CONST              <span class="number">18</span> (<span class="number">67</span>)</span><br><span class="line">            <span class="number">69</span> LOAD_CONST              <span class="number">19</span> (<span class="number">29</span>)</span><br><span class="line">            <span class="number">72</span> LOAD_CONST              <span class="number">20</span> (<span class="number">41</span>)</span><br><span class="line">            <span class="number">75</span> LOAD_CONST              <span class="number">21</span> (<span class="number">120</span>)</span><br><span class="line">            <span class="number">78</span> LOAD_CONST              <span class="number">22</span> (<span class="number">60</span>)</span><br><span class="line">            <span class="number">81</span> LOAD_CONST              <span class="number">23</span> (<span class="number">106</span>)</span><br><span class="line">            <span class="number">84</span> LOAD_CONST              <span class="number">24</span> (<span class="number">51</span>)</span><br><span class="line">            <span class="number">87</span> LOAD_CONST               <span class="number">6</span> (<span class="number">101</span>)</span><br><span class="line">            <span class="number">90</span> LOAD_CONST              <span class="number">25</span> (<span class="number">178</span>)</span><br><span class="line">            <span class="number">93</span> LOAD_CONST              <span class="number">26</span> (<span class="number">189</span>)</span><br><span class="line">            <span class="number">96</span> LOAD_CONST               <span class="number">6</span> (<span class="number">101</span>)</span><br><span class="line">            <span class="number">99</span> LOAD_CONST              <span class="number">27</span> (<span class="number">48</span>)</span><br><span class="line">           <span class="number">102</span> BUILD_LIST              <span class="number">26</span>			<span class="comment"># 创建列表 </span></span><br><span class="line">           <span class="number">105</span> STORE_NAME               <span class="number">1</span> (output) <span class="comment"># output = [101,96,23,68,112,42,107,62,96,53,176,179,98,53,67,29,41,120,60,106,51,101,178,189,101,48]</span></span><br><span class="line"></span><br><span class="line"> <span class="number">7</span>         <span class="number">108</span> LOAD_CONST              <span class="number">28</span> (<span class="string">&#x27;welcome to GWHT2020&#x27;</span>)</span><br><span class="line">           <span class="number">111</span> PRINT_ITEM          </span><br><span class="line">           <span class="number">112</span> PRINT_NEWLINE       </span><br><span class="line"></span><br><span class="line"> <span class="number">9</span>         <span class="number">113</span> LOAD_NAME                <span class="number">2</span> (raw_input)</span><br><span class="line">           <span class="number">116</span> LOAD_CONST              <span class="number">29</span> (<span class="string">&#x27;please input your flag:&#x27;</span>)</span><br><span class="line">           <span class="number">119</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">122</span> STORE_NAME               <span class="number">3</span> (flag)</span><br><span class="line"></span><br><span class="line"><span class="number">10</span>         <span class="number">125</span> LOAD_NAME                <span class="number">3</span> (flag)</span><br><span class="line">           <span class="number">128</span> STORE_NAME               <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">12</span>         <span class="number">131</span> LOAD_NAME                <span class="number">5</span> (<span class="built_in">len</span>)</span><br><span class="line">           <span class="number">134</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">137</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">140</span> STORE_NAME               <span class="number">6</span> (a)</span><br><span class="line"></span><br><span class="line"><span class="number">13</span>         <span class="number">143</span> LOAD_NAME                <span class="number">6</span> (a)</span><br><span class="line">           <span class="number">146</span> LOAD_CONST              <span class="number">30</span> (<span class="number">38</span>)   </span><br><span class="line">           <span class="number">149</span> COMPARE_OP               <span class="number">0</span> (&lt;)  </span><br><span class="line">           <span class="number">152</span> POP_JUMP_IF_FALSE      <span class="number">173</span></span><br><span class="line"></span><br><span class="line"><span class="number">14</span>         <span class="number">155</span> LOAD_CONST              <span class="number">31</span> (<span class="string">&#x27;lenth wrong!&#x27;</span>)</span><br><span class="line">           <span class="number">158</span> PRINT_ITEM          </span><br><span class="line">           <span class="number">159</span> PRINT_NEWLINE       </span><br><span class="line"></span><br><span class="line"><span class="number">15</span>         <span class="number">160</span> LOAD_NAME                <span class="number">7</span> (exit)                 <span class="comment"># if len(str) &lt; 38:</span></span><br><span class="line">           <span class="number">163</span> LOAD_CONST              <span class="number">32</span> (<span class="number">0</span>)                       <span class="comment"># sys.exit(0)</span></span><br><span class="line">           <span class="number">166</span> CALL_FUNCTION            <span class="number">1</span>                        <span class="comment"># else:</span></span><br><span class="line">           <span class="number">169</span> POP_TOP                                                </span><br><span class="line">           <span class="number">170</span> JUMP_FORWARD             <span class="number">0</span> (to <span class="number">173</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">17</span>     &gt;&gt;  <span class="number">173</span> LOAD_NAME                <span class="number">8</span> (<span class="built_in">ord</span>)</span><br><span class="line">           <span class="number">176</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">179</span> LOAD_CONST              <span class="number">32</span> (<span class="number">0</span>)                  </span><br><span class="line">           <span class="number">182</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">183</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line"></span><br><span class="line">           <span class="number">186</span> LOAD_CONST              <span class="number">33</span> (<span class="number">2020</span>)</span><br><span class="line"></span><br><span class="line">           <span class="number">189</span> BINARY_MULTIPLY                           <span class="comment"># ord(str[0])*2020</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">           <span class="number">190</span> LOAD_NAME                <span class="number">8</span> (<span class="built_in">ord</span>)</span><br><span class="line">           <span class="number">193</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)          <span class="comment"># ord(str[1])</span></span><br><span class="line">           <span class="number">196</span> LOAD_CONST              <span class="number">34</span> (<span class="number">1</span>)</span><br><span class="line">           <span class="number">199</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">200</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line"></span><br><span class="line">           <span class="number">203</span> BINARY_ADD                                <span class="comment"># ord(str[0])*2020 + ord(str[1])</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">           <span class="number">204</span> LOAD_CONST              <span class="number">33</span> (<span class="number">2020</span>)         <span class="comment"># (ord(str[0])*2020 + ord(str[1]))*2020</span></span><br><span class="line">           <span class="number">207</span> BINARY_MULTIPLY     </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">           <span class="number">208</span> LOAD_NAME                <span class="number">8</span> (<span class="built_in">ord</span>)</span><br><span class="line">           <span class="number">211</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">214</span> LOAD_CONST              <span class="number">35</span> (<span class="number">2</span>)</span><br><span class="line">           <span class="number">217</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">218</span> CALL_FUNCTION            <span class="number">1</span>                </span><br><span class="line"></span><br><span class="line">           <span class="number">221</span> BINARY_ADD                                <span class="comment"># (ord(str[0])*2020 + ord(str[1]))*2020 + ord(str[2])</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">           <span class="number">222</span> LOAD_CONST              <span class="number">33</span> (<span class="number">2020</span>)         </span><br><span class="line">           <span class="number">225</span> BINARY_MULTIPLY                           <span class="comment"># ((ord(str[0])*2020 + ord(str[1]))*2020 + ord(str[2]))*2020</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">           <span class="number">226</span> LOAD_NAME                <span class="number">8</span> (<span class="built_in">ord</span>)           <span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">3</span>])</span><br><span class="line">           <span class="number">229</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">232</span> LOAD_CONST               <span class="number">0</span> (<span class="number">3</span>)</span><br><span class="line">           <span class="number">235</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">236</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">239</span> BINARY_ADD                                <span class="comment"># ((ord(str[0])*2020 + ord(str[1]))*2020 + ord(str[2]))*2020 + ord(str[3])</span></span><br><span class="line"></span><br><span class="line">           <span class="number">240</span> LOAD_CONST              <span class="number">33</span> (<span class="number">2020</span>)</span><br><span class="line">           <span class="number">243</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">244</span> LOAD_NAME                <span class="number">8</span> (<span class="built_in">ord</span>)</span><br><span class="line">           <span class="number">247</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">250</span> LOAD_CONST              <span class="number">36</span> (<span class="number">4</span>)</span><br><span class="line">           <span class="number">253</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">254</span> CALL_FUNCTION            <span class="number">1</span>                <span class="comment"># ord(str[4])</span></span><br><span class="line"></span><br><span class="line">           <span class="number">257</span> BINARY_ADD                                <span class="comment"># (((ord(str[0])*2020 + ord(str[1]))*2020 + ord(str[2])*2020) + ord(str[3]))*2020 + ord(str[4])</span></span><br><span class="line"></span><br><span class="line">           <span class="number">258</span> LOAD_CONST              <span class="number">37</span> (<span class="number">1182843538814603</span>)</span><br><span class="line">           <span class="number">261</span> COMPARE_OP               <span class="number">2</span> (==)           <span class="comment"># (((ord(str[0])*2020 + ord(str[1]))*2020 + ord(str[2])*2020) + ord(str[3]))*2020 + ord(str[4]) == 1182843538814603</span></span><br><span class="line">           <span class="number">264</span> POP_JUMP_IF_FALSE      <span class="number">275</span>                </span><br><span class="line"></span><br><span class="line"><span class="number">18</span>         <span class="number">267</span> LOAD_CONST              <span class="number">38</span> (<span class="string">&#x27;good!continue\xe2\x80\xa6\xe2\x80\xa6&#x27;</span>)</span><br><span class="line">           <span class="number">270</span> PRINT_ITEM          </span><br><span class="line">           <span class="number">271</span> PRINT_NEWLINE       </span><br><span class="line">           <span class="number">272</span> JUMP_FORWARD            <span class="number">15</span> (to <span class="number">290</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">20</span>     &gt;&gt;  <span class="number">275</span> LOAD_CONST              <span class="number">39</span> (<span class="string">&#x27;bye~&#x27;</span>)</span><br><span class="line">           <span class="number">278</span> PRINT_ITEM          </span><br><span class="line">           <span class="number">279</span> PRINT_NEWLINE       </span><br><span class="line"></span><br><span class="line"><span class="number">21</span>         <span class="number">280</span> LOAD_NAME                <span class="number">7</span> (exit)</span><br><span class="line">           <span class="number">283</span> LOAD_CONST              <span class="number">32</span> (<span class="number">0</span>)</span><br><span class="line">           <span class="number">286</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">289</span> POP_TOP             </span><br><span class="line"></span><br><span class="line"><span class="number">23</span>     &gt;&gt;  <span class="number">290</span> BUILD_LIST               <span class="number">0</span></span><br><span class="line">           <span class="number">293</span> STORE_NAME               <span class="number">9</span> (x)				<span class="comment"># x = []</span></span><br><span class="line"></span><br><span class="line"><span class="number">24</span>         <span class="number">296</span> LOAD_CONST              <span class="number">40</span> (<span class="number">5</span>)</span><br><span class="line">           <span class="number">299</span> STORE_NAME              <span class="number">10</span> (k)				<span class="comment"># k = 5</span></span><br><span class="line"></span><br><span class="line"><span class="number">25</span>         <span class="number">302</span> SETUP_LOOP             <span class="number">128</span> (to <span class="number">433</span>)             <span class="comment"># for i in range(13):</span></span><br><span class="line">           <span class="number">305</span> LOAD_NAME               <span class="number">11</span> (<span class="built_in">range</span>)</span><br><span class="line">           <span class="number">308</span> LOAD_CONST              <span class="number">41</span> (<span class="number">13</span>)</span><br><span class="line">           <span class="number">311</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">314</span> GET_ITER            </span><br><span class="line">       &gt;&gt;  <span class="number">315</span> FOR_ITER               <span class="number">114</span> (to <span class="number">432</span>)</span><br><span class="line">           <span class="number">318</span> STORE_NAME              <span class="number">12</span> (i)</span><br><span class="line"></span><br><span class="line"><span class="number">26</span>         <span class="number">321</span> LOAD_NAME                <span class="number">8</span> (<span class="built_in">ord</span>)</span><br><span class="line">           <span class="number">324</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">327</span> LOAD_NAME               <span class="number">10</span> (k)                    <span class="comment"># b = ord(str[k])</span></span><br><span class="line">           <span class="number">330</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">331</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">334</span> STORE_NAME              <span class="number">13</span> (b)</span><br><span class="line"></span><br><span class="line"><span class="number">27</span>         <span class="number">337</span> LOAD_NAME                <span class="number">8</span> (<span class="built_in">ord</span>)</span><br><span class="line">           <span class="number">340</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">343</span> LOAD_NAME               <span class="number">10</span> (k)</span><br><span class="line">           <span class="number">346</span> LOAD_CONST              <span class="number">34</span> (<span class="number">1</span>)</span><br><span class="line">           <span class="number">349</span> BINARY_ADD          </span><br><span class="line">           <span class="number">350</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">351</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">354</span> STORE_NAME              <span class="number">14</span> (c)                   <span class="comment"># c = ord(str[k+1])</span></span><br><span class="line"></span><br><span class="line"><span class="number">28</span>         <span class="number">357</span> LOAD_NAME               <span class="number">14</span> (c)</span><br><span class="line">           <span class="number">360</span> LOAD_NAME                <span class="number">0</span> (en)</span><br><span class="line">           <span class="number">363</span> LOAD_NAME               <span class="number">12</span> (i)</span><br><span class="line">           <span class="number">366</span> LOAD_CONST               <span class="number">4</span> (<span class="number">6</span>)</span><br><span class="line">           <span class="number">369</span> BINARY_MODULO       <span class="comment"># % </span></span><br><span class="line">           <span class="number">370</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">371</span> BINARY_XOR          </span><br><span class="line">           <span class="number">372</span> STORE_NAME              <span class="number">15</span> (a11)                   <span class="comment"># a11 = c ^ en[(i % 6)]</span></span><br><span class="line"></span><br><span class="line"><span class="number">29</span>         <span class="number">375</span> LOAD_NAME               <span class="number">13</span> (b)</span><br><span class="line">           <span class="number">378</span> LOAD_NAME                <span class="number">0</span> (en)</span><br><span class="line">           <span class="number">381</span> LOAD_NAME               <span class="number">12</span> (i)</span><br><span class="line">           <span class="number">384</span> LOAD_CONST               <span class="number">4</span> (<span class="number">6</span>)</span><br><span class="line">           <span class="number">387</span> BINARY_MODULO       </span><br><span class="line">           <span class="number">388</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">389</span> BINARY_XOR          </span><br><span class="line">           <span class="number">390</span> STORE_NAME              <span class="number">16</span> (a22)                  <span class="comment"># a22 = b ^ en[(i % 6)]</span></span><br><span class="line"></span><br><span class="line"><span class="number">30</span>         <span class="number">393</span> LOAD_NAME                <span class="number">9</span> (x)</span><br><span class="line">           <span class="number">396</span> LOAD_ATTR               <span class="number">17</span> (append)</span><br><span class="line">           <span class="number">399</span> LOAD_NAME               <span class="number">15</span> (a11)</span><br><span class="line">           <span class="number">402</span> CALL_FUNCTION            <span class="number">1</span>                       <span class="comment"># x.append(a11)</span></span><br><span class="line">           <span class="number">405</span> POP_TOP             </span><br><span class="line"></span><br><span class="line"><span class="number">31</span>         <span class="number">406</span> LOAD_NAME                <span class="number">9</span> (x)</span><br><span class="line">           <span class="number">409</span> LOAD_ATTR               <span class="number">17</span> (append)</span><br><span class="line">           <span class="number">412</span> LOAD_NAME               <span class="number">16</span> (a22)                 <span class="comment"># x.append(a22)</span></span><br><span class="line">           <span class="number">415</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">418</span> POP_TOP             </span><br><span class="line"></span><br><span class="line"><span class="number">32</span>         <span class="number">419</span> LOAD_NAME               <span class="number">10</span> (k)                  <span class="comment"># k = k + 2</span></span><br><span class="line">           <span class="number">422</span> LOAD_CONST              <span class="number">35</span> (<span class="number">2</span>)                    </span><br><span class="line">           <span class="number">425</span> INPLACE_ADD         </span><br><span class="line">           <span class="number">426</span> STORE_NAME              <span class="number">10</span> (k)</span><br><span class="line">           <span class="number">429</span> JUMP_ABSOLUTE          <span class="number">315</span></span><br><span class="line">       &gt;&gt;  <span class="number">432</span> POP_BLOCK           </span><br><span class="line"></span><br><span class="line"><span class="number">33</span>     &gt;&gt;  <span class="number">433</span> LOAD_NAME                <span class="number">9</span> (x)</span><br><span class="line">           <span class="number">436</span> LOAD_NAME                <span class="number">1</span> (output)            <span class="comment"># if x != output:</span></span><br><span class="line">           <span class="number">439</span> COMPARE_OP               <span class="number">2</span> (==)</span><br><span class="line">           <span class="number">442</span> POP_JUMP_IF_FALSE      <span class="number">453</span></span><br><span class="line"></span><br><span class="line"><span class="number">34</span>         <span class="number">445</span> LOAD_CONST              <span class="number">38</span> (<span class="string">&#x27;good!continue\xe2\x80\xa6\xe2\x80\xa6&#x27;</span>)</span><br><span class="line">           <span class="number">448</span> PRINT_ITEM          </span><br><span class="line">           <span class="number">449</span> PRINT_NEWLINE       </span><br><span class="line">           <span class="number">450</span> JUMP_FORWARD            <span class="number">15</span> (to <span class="number">468</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">36</span>     &gt;&gt;  <span class="number">453</span> LOAD_CONST              <span class="number">42</span> (<span class="string">&#x27;oh,you are wrong!&#x27;</span>)</span><br><span class="line">           <span class="number">456</span> PRINT_ITEM          </span><br><span class="line">           <span class="number">457</span> PRINT_NEWLINE       </span><br><span class="line"></span><br><span class="line"><span class="number">37</span>         <span class="number">458</span> LOAD_NAME                <span class="number">7</span> (exit)</span><br><span class="line">           <span class="number">461</span> LOAD_CONST              <span class="number">32</span> (<span class="number">0</span>)</span><br><span class="line">           <span class="number">464</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">467</span> POP_TOP             </span><br><span class="line"></span><br><span class="line"><span class="number">39</span>     &gt;&gt;  <span class="number">468</span> LOAD_NAME                <span class="number">5</span> (<span class="built_in">len</span>)</span><br><span class="line">           <span class="number">471</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">474</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">477</span> STORE_NAME              <span class="number">18</span> (l) <span class="comment"># l = len(str)</span></span><br><span class="line"></span><br><span class="line"><span class="number">40</span>         <span class="number">480</span> LOAD_NAME                <span class="number">8</span> (<span class="built_in">ord</span>)</span><br><span class="line">           <span class="number">483</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">486</span> LOAD_NAME               <span class="number">18</span> (l)</span><br><span class="line">           <span class="number">489</span> LOAD_CONST              <span class="number">43</span> (<span class="number">7</span>)</span><br><span class="line">           <span class="number">492</span> BINARY_SUBTRACT     </span><br><span class="line">           <span class="number">493</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">494</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">497</span> STORE_NAME              <span class="number">19</span> (a1) <span class="comment"># a1 = ord(str[l-7])</span></span><br><span class="line"></span><br><span class="line"><span class="number">41</span>         <span class="number">500</span> LOAD_NAME                <span class="number">8</span> (<span class="built_in">ord</span>)</span><br><span class="line">           <span class="number">503</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">506</span> LOAD_NAME               <span class="number">18</span> (l)</span><br><span class="line">           <span class="number">509</span> LOAD_CONST               <span class="number">4</span> (<span class="number">6</span>)</span><br><span class="line">           <span class="number">512</span> BINARY_SUBTRACT     </span><br><span class="line">           <span class="number">513</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">514</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">517</span> STORE_NAME              <span class="number">20</span> (a2) <span class="comment"># a2 = ord(str[l-6])</span></span><br><span class="line"></span><br><span class="line"><span class="number">42</span>         <span class="number">520</span> LOAD_NAME                <span class="number">8</span> (<span class="built_in">ord</span>)</span><br><span class="line">           <span class="number">523</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">526</span> LOAD_NAME               <span class="number">18</span> (l)</span><br><span class="line">           <span class="number">529</span> LOAD_CONST              <span class="number">40</span> (<span class="number">5</span>)</span><br><span class="line">           <span class="number">532</span> BINARY_SUBTRACT     </span><br><span class="line">           <span class="number">533</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">534</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">537</span> STORE_NAME              <span class="number">21</span> (a3) <span class="comment"># a3 = ord(str[l-5])</span></span><br><span class="line"></span><br><span class="line"><span class="number">43</span>         <span class="number">540</span> LOAD_NAME                <span class="number">8</span> (<span class="built_in">ord</span>)</span><br><span class="line">           <span class="number">543</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">546</span> LOAD_NAME               <span class="number">18</span> (l)</span><br><span class="line">           <span class="number">549</span> LOAD_CONST              <span class="number">36</span> (<span class="number">4</span>)</span><br><span class="line">           <span class="number">552</span> BINARY_SUBTRACT     </span><br><span class="line">           <span class="number">553</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">554</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">557</span> STORE_NAME              <span class="number">22</span> (a4) <span class="comment"># a4 = ord(str[l-4])</span></span><br><span class="line"></span><br><span class="line"><span class="number">44</span>         <span class="number">560</span> LOAD_NAME                <span class="number">8</span> (<span class="built_in">ord</span>)</span><br><span class="line">           <span class="number">563</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">566</span> LOAD_NAME               <span class="number">18</span> (l)</span><br><span class="line">           <span class="number">569</span> LOAD_CONST               <span class="number">0</span> (<span class="number">3</span>)</span><br><span class="line">           <span class="number">572</span> BINARY_SUBTRACT     </span><br><span class="line">           <span class="number">573</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">574</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">577</span> STORE_NAME              <span class="number">23</span> (a5) <span class="comment"># a5 = ord(str[l-3])</span></span><br><span class="line"></span><br><span class="line"><span class="number">45</span>         <span class="number">580</span> LOAD_NAME                <span class="number">8</span> (<span class="built_in">ord</span>)</span><br><span class="line">           <span class="number">583</span> LOAD_NAME                <span class="number">4</span> (<span class="built_in">str</span>)</span><br><span class="line">           <span class="number">586</span> LOAD_NAME               <span class="number">18</span> (l)</span><br><span class="line">           <span class="number">589</span> LOAD_CONST              <span class="number">35</span> (<span class="number">2</span>)</span><br><span class="line">           <span class="number">592</span> BINARY_SUBTRACT     </span><br><span class="line">           <span class="number">593</span> BINARY_SUBSCR       </span><br><span class="line">           <span class="number">594</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">           <span class="number">597</span> STORE_NAME              <span class="number">24</span> (a6)  <span class="comment"># a6 = ord(str[l-2])</span></span><br><span class="line"></span><br><span class="line"><span class="number">46</span>         <span class="number">600</span> LOAD_NAME               <span class="number">19</span> (a1)</span><br><span class="line">           <span class="number">603</span> LOAD_CONST               <span class="number">0</span> (<span class="number">3</span>)</span><br><span class="line">           <span class="number">606</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">607</span> LOAD_NAME               <span class="number">20</span> (a2)</span><br><span class="line">           <span class="number">610</span> LOAD_CONST              <span class="number">35</span> (<span class="number">2</span>)</span><br><span class="line">           <span class="number">613</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">614</span> BINARY_ADD          </span><br><span class="line">           <span class="number">615</span> LOAD_NAME               <span class="number">21</span> (a3)</span><br><span class="line">           <span class="number">618</span> LOAD_CONST              <span class="number">40</span> (<span class="number">5</span>)</span><br><span class="line">           <span class="number">621</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">622</span> BINARY_ADD          </span><br><span class="line">           <span class="number">623</span> LOAD_CONST              <span class="number">44</span> (<span class="number">1003</span>)</span><br><span class="line">           <span class="number">626</span> COMPARE_OP               <span class="number">2</span> (==)</span><br><span class="line">           <span class="number">629</span> POP_JUMP_IF_FALSE      <span class="number">807</span>			<span class="comment"># if a1*3+a2*2+a3*5 == 1003:</span></span><br><span class="line"></span><br><span class="line"><span class="number">47</span>         <span class="number">632</span> LOAD_NAME               <span class="number">19</span> (a1)</span><br><span class="line">           <span class="number">635</span> LOAD_CONST              <span class="number">36</span> (<span class="number">4</span>)</span><br><span class="line">           <span class="number">638</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">639</span> LOAD_NAME               <span class="number">20</span> (a2)</span><br><span class="line">           <span class="number">642</span> LOAD_CONST              <span class="number">43</span> (<span class="number">7</span>)</span><br><span class="line">           <span class="number">645</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">646</span> BINARY_ADD          </span><br><span class="line">           <span class="number">647</span> LOAD_NAME               <span class="number">21</span> (a3)</span><br><span class="line">           <span class="number">650</span> LOAD_CONST               <span class="number">3</span> (<span class="number">9</span>)</span><br><span class="line">           <span class="number">653</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">654</span> BINARY_ADD          </span><br><span class="line">           <span class="number">655</span> LOAD_CONST              <span class="number">45</span> (<span class="number">2013</span>)</span><br><span class="line">           <span class="number">658</span> COMPARE_OP               <span class="number">2</span> (==)</span><br><span class="line">           <span class="number">661</span> POP_JUMP_IF_FALSE      <span class="number">807</span>			<span class="comment"># if a1*4 + a2*7 + a3*9 == 2013:</span></span><br><span class="line"></span><br><span class="line"><span class="number">48</span>         <span class="number">664</span> LOAD_NAME               <span class="number">19</span> (a1)</span><br><span class="line">           <span class="number">667</span> LOAD_NAME               <span class="number">20</span> (a2)</span><br><span class="line">           <span class="number">670</span> LOAD_CONST              <span class="number">46</span> (<span class="number">8</span>)</span><br><span class="line">           <span class="number">673</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">674</span> BINARY_ADD          </span><br><span class="line">           <span class="number">675</span> LOAD_NAME               <span class="number">21</span> (a3)</span><br><span class="line">           <span class="number">678</span> LOAD_CONST              <span class="number">35</span> (<span class="number">2</span>)</span><br><span class="line">           <span class="number">681</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">682</span> BINARY_ADD          </span><br><span class="line">           <span class="number">683</span> LOAD_CONST              <span class="number">47</span> (<span class="number">1109</span>)</span><br><span class="line">           <span class="number">686</span> COMPARE_OP               <span class="number">2</span> (==)</span><br><span class="line">           <span class="number">689</span> POP_JUMP_IF_FALSE      <span class="number">804</span>		 <span class="comment"># if a1 + a2*8 +a3*2 == 1109</span></span><br><span class="line"></span><br><span class="line"><span class="number">49</span>         <span class="number">692</span> LOAD_NAME               <span class="number">22</span> (a4)</span><br><span class="line">           <span class="number">695</span> LOAD_CONST               <span class="number">0</span> (<span class="number">3</span>)</span><br><span class="line">           <span class="number">698</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">699</span> LOAD_NAME               <span class="number">23</span> (a5)</span><br><span class="line">           <span class="number">702</span> LOAD_CONST              <span class="number">35</span> (<span class="number">2</span>)</span><br><span class="line">           <span class="number">705</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">706</span> BINARY_ADD          </span><br><span class="line">           <span class="number">707</span> LOAD_NAME               <span class="number">24</span> (a6)</span><br><span class="line">           <span class="number">710</span> LOAD_CONST              <span class="number">40</span> (<span class="number">5</span>)</span><br><span class="line">           <span class="number">713</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">714</span> BINARY_ADD          </span><br><span class="line">           <span class="number">715</span> LOAD_CONST              <span class="number">48</span> (<span class="number">671</span>)</span><br><span class="line">           <span class="number">718</span> COMPARE_OP               <span class="number">2</span> (==)</span><br><span class="line">           <span class="number">721</span> POP_JUMP_IF_FALSE      <span class="number">801</span>		<span class="comment"># if a4*3+a5*2+a6*5 == 671:</span></span><br><span class="line"></span><br><span class="line"><span class="number">50</span>         <span class="number">724</span> LOAD_NAME               <span class="number">22</span> (a4)</span><br><span class="line">           <span class="number">727</span> LOAD_CONST              <span class="number">36</span> (<span class="number">4</span>)</span><br><span class="line">           <span class="number">730</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">731</span> LOAD_NAME               <span class="number">23</span> (a5)</span><br><span class="line">           <span class="number">734</span> LOAD_CONST              <span class="number">43</span> (<span class="number">7</span>)</span><br><span class="line">           <span class="number">737</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">738</span> BINARY_ADD          </span><br><span class="line">           <span class="number">739</span> LOAD_NAME               <span class="number">24</span> (a6)</span><br><span class="line">           <span class="number">742</span> LOAD_CONST               <span class="number">3</span> (<span class="number">9</span>)</span><br><span class="line">           <span class="number">745</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">746</span> BINARY_ADD          </span><br><span class="line">           <span class="number">747</span> LOAD_CONST              <span class="number">49</span> (<span class="number">1252</span>)</span><br><span class="line">           <span class="number">750</span> COMPARE_OP               <span class="number">2</span> (==)</span><br><span class="line">           <span class="number">753</span> POP_JUMP_IF_FALSE      <span class="number">798</span>		<span class="comment"># if a4*4+a5*7+a6*9 == 1252</span></span><br><span class="line"></span><br><span class="line"><span class="number">51</span>         <span class="number">756</span> LOAD_NAME               <span class="number">22</span> (a4)</span><br><span class="line">           <span class="number">759</span> LOAD_NAME               <span class="number">23</span> (a5)</span><br><span class="line">           <span class="number">762</span> LOAD_CONST              <span class="number">46</span> (<span class="number">8</span>)</span><br><span class="line">           <span class="number">765</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">766</span> BINARY_ADD          </span><br><span class="line">           <span class="number">767</span> LOAD_NAME               <span class="number">24</span> (a6)</span><br><span class="line">           <span class="number">770</span> LOAD_CONST              <span class="number">35</span> (<span class="number">2</span>)</span><br><span class="line">           <span class="number">773</span> BINARY_MULTIPLY     </span><br><span class="line">           <span class="number">774</span> BINARY_ADD          </span><br><span class="line">           <span class="number">775</span> LOAD_CONST              <span class="number">50</span> (<span class="number">644</span>) </span><br><span class="line">           <span class="number">778</span> COMPARE_OP               <span class="number">2</span> (==)</span><br><span class="line">           <span class="number">781</span> POP_JUMP_IF_FALSE      <span class="number">795</span>		<span class="comment"># if a4 + a5*8 + a6*2 == 644</span></span><br><span class="line"></span><br><span class="line"><span class="number">52</span>         <span class="number">784</span> LOAD_CONST              <span class="number">51</span> (<span class="string">&#x27;congraduation!you get the right flag!&#x27;</span>)</span><br><span class="line">           <span class="number">787</span> PRINT_ITEM          </span><br><span class="line">           <span class="number">788</span> PRINT_NEWLINE       </span><br><span class="line">           <span class="number">789</span> JUMP_ABSOLUTE          <span class="number">795</span></span><br><span class="line">           <span class="number">792</span> JUMP_ABSOLUTE          <span class="number">798</span></span><br><span class="line">       &gt;&gt;  <span class="number">795</span> JUMP_ABSOLUTE          <span class="number">801</span></span><br><span class="line">       &gt;&gt;  <span class="number">798</span> JUMP_ABSOLUTE          <span class="number">804</span></span><br><span class="line">       &gt;&gt;  <span class="number">801</span> JUMP_ABSOLUTE          <span class="number">807</span></span><br><span class="line">       &gt;&gt;  <span class="number">804</span> JUMP_FORWARD             <span class="number">0</span> (to <span class="number">807</span>)</span><br><span class="line">       &gt;&gt;  <span class="number">807</span> LOAD_CONST              <span class="number">52</span> (<span class="literal">None</span>)</span><br><span class="line">           <span class="number">810</span> RETURN_VALUE </span><br></pre></td></tr></table></figure>



<p>本人逆向出来的，或许有些许出入，但逻辑基本正确……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">en = [<span class="number">3</span>,<span class="number">37</span>,<span class="number">72</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">132</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;welcome to GWHT2020&#x27;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">&#x27;please input your flag:&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">str</span> = flag</span><br><span class="line"></span><br><span class="line">a = <span class="built_in">len</span>(<span class="built_in">str</span>(a))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> a &lt; <span class="number">38</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;lenth wrong!&#x27;</span>)</span><br><span class="line">	sys.exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (((<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">0</span>])*<span class="number">2020</span> + <span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">1</span>]))*<span class="number">2020</span> + <span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">2</span>])*<span class="number">2020</span>) + <span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">3</span>]))*<span class="number">2020</span> + <span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">4</span>]) == <span class="number">1182843538814603</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;good!continue\xe2\x80\xa6\xe2\x80\xa6&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	sys.exit()</span><br><span class="line">output = [<span class="number">101</span>,<span class="number">96</span>,<span class="number">23</span>,<span class="number">68</span>,<span class="number">112</span>,<span class="number">42</span>,<span class="number">107</span>,<span class="number">62</span>,<span class="number">96</span>,<span class="number">53</span>,<span class="number">176</span>,<span class="number">179</span>,<span class="number">98</span>,<span class="number">53</span>,<span class="number">67</span>,<span class="number">29</span>,<span class="number">41</span>,<span class="number">120</span>,<span class="number">60</span>,<span class="number">106</span>,<span class="number">51</span>,<span class="number">101</span>,<span class="number">178</span>,<span class="number">189</span>,<span class="number">101</span>,<span class="number">48</span>]</span><br><span class="line">x = []</span><br><span class="line">k  = <span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>):</span><br><span class="line"></span><br><span class="line">	a11 = <span class="built_in">ord</span>(<span class="built_in">str</span>[k]) ^ en[(i % <span class="number">6</span>)]</span><br><span class="line">	a22 = <span class="built_in">ord</span>(<span class="built_in">str</span>[k+<span class="number">1</span>])^ en[(i % <span class="number">6</span>)]</span><br><span class="line">	x.append(a11)</span><br><span class="line">	x.append(a22)</span><br><span class="line">	k = k + <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> x == output:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;good!continue\xe2\x80\xa6\xe2\x80\xa6&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	sys.exit()</span><br><span class="line"></span><br><span class="line">l = <span class="built_in">len</span>(<span class="built_in">str</span>)</span><br><span class="line">a1 = <span class="built_in">ord</span>(<span class="built_in">str</span>[l-<span class="number">7</span>])</span><br><span class="line">a2 = <span class="built_in">ord</span>(<span class="built_in">str</span>[l-<span class="number">6</span>])</span><br><span class="line">a3 = <span class="built_in">ord</span>(<span class="built_in">str</span>[l-<span class="number">5</span>])</span><br><span class="line">a4 = <span class="built_in">ord</span>(<span class="built_in">str</span>[l-<span class="number">4</span>])</span><br><span class="line">a5 = <span class="built_in">ord</span>(<span class="built_in">str</span>[l-<span class="number">3</span>])</span><br><span class="line">a6 = <span class="built_in">ord</span>(<span class="built_in">str</span>[l-<span class="number">2</span>])</span><br><span class="line"><span class="keyword">if</span> a1*<span class="number">3</span>+a2*<span class="number">2</span>+a3*<span class="number">5</span> == <span class="number">1003</span>:</span><br><span class="line">	<span class="keyword">if</span> a1*<span class="number">4</span> + a2*<span class="number">7</span> + a3*<span class="number">9</span> == <span class="number">2013</span>:</span><br><span class="line">		<span class="keyword">if</span> a1 + a2*<span class="number">8</span> +a3*<span class="number">2</span> == <span class="number">1109</span>:</span><br><span class="line">			<span class="keyword">if</span> a4*<span class="number">3</span>+a5*<span class="number">2</span>+a6*<span class="number">5</span> == <span class="number">671</span>:</span><br><span class="line">				<span class="keyword">if</span> a4*<span class="number">4</span>+a5*<span class="number">7</span>+a6*<span class="number">9</span> == <span class="number">1252</span>:	</span><br><span class="line">					<span class="keyword">if</span> a4 + a5*<span class="number">8</span> + a6*<span class="number">2</span> == <span class="number">644</span>:</span><br><span class="line">						<span class="built_in">print</span>(<span class="string">&#x27;congraduation!you get the right flag!&#x27;</span>)</span><br></pre></td></tr></table></figure>



<p>首先是开头的五个字符的爆破代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line">arr = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> string.printable:</span><br><span class="line">	arr.append(<span class="built_in">ord</span>(i))</span><br><span class="line"><span class="keyword">for</span> str_0 <span class="keyword">in</span> arr:</span><br><span class="line">	<span class="keyword">for</span> str_1 <span class="keyword">in</span> arr:</span><br><span class="line">		<span class="keyword">for</span> str_2 <span class="keyword">in</span> arr:</span><br><span class="line">			<span class="keyword">for</span> str_3 <span class="keyword">in</span> arr:</span><br><span class="line">				<span class="keyword">if</span> ((((str_0*<span class="number">2020</span> + str_1)*<span class="number">2020</span> + str_2)*<span class="number">2020</span>) + str_3)*<span class="number">2020</span> + <span class="built_in">ord</span>(<span class="string">&quot;&#123;&quot;</span>) == <span class="number">1182843538814603</span>:</span><br><span class="line">					<span class="built_in">print</span>(<span class="built_in">chr</span>(str_0),<span class="built_in">chr</span>(str_1),<span class="built_in">chr</span>(str_2),<span class="built_in">chr</span>(str_3),<span class="string">&quot;&#123;&quot;</span>)</span><br><span class="line">					<span class="comment"># G W H T &#123;</span></span><br></pre></td></tr></table></figure>



<p>然后是中间的异或运算，我还是使用的爆破：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">output = [<span class="number">101</span>,<span class="number">96</span>,<span class="number">23</span>,<span class="number">68</span>,<span class="number">112</span>,<span class="number">42</span>,<span class="number">107</span>,<span class="number">62</span>,<span class="number">96</span>,<span class="number">53</span>,<span class="number">176</span>,<span class="number">179</span>,<span class="number">98</span>,<span class="number">53</span>,<span class="number">67</span>,<span class="number">29</span>,<span class="number">41</span>,<span class="number">120</span>,<span class="number">60</span>,<span class="number">106</span>,<span class="number">51</span>,<span class="number">101</span>,<span class="number">178</span>,<span class="number">189</span>,<span class="number">101</span>,<span class="number">48</span>]</span><br><span class="line">en = [<span class="number">3</span>,<span class="number">37</span>,<span class="number">72</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">132</span>]</span><br><span class="line">flag1 = []</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>):</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> string.printable:</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">ord</span>(j) ^ en[(i%<span class="number">6</span>)] == output[k]:</span><br><span class="line">			flag1.append(j)</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> string.printable:</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">ord</span>(j) ^ en[(i%<span class="number">6</span>)] == output[k+<span class="number">1</span>]:</span><br><span class="line">			flag1.append(j)</span><br><span class="line">	k += <span class="number">2</span></span><br><span class="line">flag1 = <span class="string">&quot;&quot;</span>.join(flag1)</span><br><span class="line"><span class="built_in">print</span>(flag1)</span><br><span class="line"><span class="comment"># fc2a8bb7f347a6f8a05c5c69f3</span></span><br></pre></td></tr></table></figure>



<p>最后只需要解z3就可以了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">s = Solver()</span><br><span class="line">a1,a2,a3,a4,a5,a6 = Ints(<span class="string">&quot;a1 a2 a3 a4 a5 a6&quot;</span>)</span><br><span class="line">s.add(a1*<span class="number">3</span>+a2*<span class="number">2</span>+a3*<span class="number">5</span> == <span class="number">1003</span>)</span><br><span class="line">s.add(a1*<span class="number">4</span> + a2*<span class="number">7</span> + a3*<span class="number">9</span> == <span class="number">2013</span>)</span><br><span class="line">s.add(a1 + a2*<span class="number">8</span> +a3*<span class="number">2</span> == <span class="number">1109</span>)</span><br><span class="line">s.add(a4*<span class="number">3</span>+a5*<span class="number">2</span>+a6*<span class="number">5</span> == <span class="number">671</span>)</span><br><span class="line">s.add(a4*<span class="number">4</span>+a5*<span class="number">7</span>+a6*<span class="number">9</span> == <span class="number">1252</span>)</span><br><span class="line">s.add(a4 + a5*<span class="number">8</span> + a6*<span class="number">2</span> == <span class="number">644</span>)</span><br><span class="line">s.check()</span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br><span class="line"></span><br><span class="line">flag2 = <span class="string">&quot;&quot;</span></span><br><span class="line">result = [<span class="number">97</span>,<span class="number">101</span>,<span class="number">102</span>,<span class="number">102</span>,<span class="number">55</span>,<span class="number">51</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> result:</span><br><span class="line">	flag2 += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="comment"># aeff73</span></span><br></pre></td></tr></table></figure>

<p>最后把flag拼一下：</p>
<p>GWHT{fc2a8bb7f347a6f8a05c5c69f3aeff73}</p>
<h1 id="ACTF新生赛2020-fungame-溢出"><a href="#ACTF新生赛2020-fungame-溢出" class="headerlink" title="[ACTF新生赛2020]fungame (溢出)"></a>[ACTF新生赛2020]fungame (溢出)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407194850207.png" class="" title="image-20220407194850207">

<p>ida32打开看看</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> *v4; <span class="comment">// [esp+1Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  v4 = <span class="built_in">malloc</span>(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(v4, <span class="number">0</span>, <span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(x, <span class="number">0</span>, <span class="number">0x18</span>u);</span><br><span class="line">  sub_401340(v4);</span><br><span class="line">  sub_4013BA(v4);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_401340函数，动调y1的值即可（后来发现y1的数组直接告诉我们了,shift+e提取即可）</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407195034909.png" class="" title="image-20220407195034909">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407200340921.png" class="" title="image-20220407200340921">



<p>shift+e提取数据</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407200404959.png" class="" title="image-20220407200404959">



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">y1 = [<span class="number">0x23</span>, <span class="number">0x61</span>, <span class="number">0x3e</span>, <span class="number">0x69</span>, <span class="number">0x54</span>, <span class="number">0x41</span>, <span class="number">0x18</span>, <span class="number">0x4d</span>, <span class="number">0x6e</span>, <span class="number">0x3b</span>, <span class="number">0x65</span>, <span class="number">0x53</span>, <span class="number">0x30</span>, <span class="number">0x79</span>, <span class="number">0x45</span>, <span class="number">0x5b</span>]</span><br><span class="line">y2 = [<span class="number">0x71</span>, <span class="number">0x04</span>, <span class="number">0x61</span>, <span class="number">0x58</span>, <span class="number">0x27</span>, <span class="number">0x1E</span>, <span class="number">0x4B</span>, <span class="number">0x22</span>, <span class="number">0x5E</span>, <span class="number">0x64</span>, <span class="number">0x03</span>, <span class="number">0x26</span>, <span class="number">0x5E</span>, <span class="number">0x17</span>, <span class="number">0x3C</span>, <span class="number">0x7A</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(y1))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(y2))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(y1)):</span><br><span class="line">	flag += <span class="built_in">chr</span>(y1[i]^y2[i])  </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#Re_1s_So0_funny!</span></span><br></pre></td></tr></table></figure>

<p>–更新–</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46296905/article/details/116431938">参考</a></p>
<p>以为到这边就结束了，发现输入的flag不对，于是查看下面一个函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_4013BA</span><span class="params">(<span class="type">char</span> *Source)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> Destination[<span class="number">12</span>]; <span class="comment">// [esp+1Ch] [ebp-Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(Destination, Source);</span><br><span class="line">  <span class="built_in">strcpy</span>(x, Source);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Destination的大小只有12，但是我们传过来的参数大小为16位，所以肯定会溢出，超出的4个字符，作为地址，调用隐藏函数sub_40233D，交叉引用参数x，可以找到函数sub_40233D</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407231855921.png" class="" title="image-20220407231855921">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407232916653.png" class="" title="image-20220407232916653">

<p>base64解码，注意，函数sub_40233D还输出了x，即函数的地址，所以我们需要在flag中添加上</p>
<p>且，ida中使用的是<strong>小端序</strong>，添加地址需要注意。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">y1 = [<span class="number">0x23</span>, <span class="number">0x61</span>, <span class="number">0x3e</span>, <span class="number">0x69</span>, <span class="number">0x54</span>, <span class="number">0x41</span>, <span class="number">0x18</span>, <span class="number">0x4d</span>, <span class="number">0x6e</span>, <span class="number">0x3b</span>, <span class="number">0x65</span>, <span class="number">0x53</span>, <span class="number">0x30</span>, <span class="number">0x79</span>, <span class="number">0x45</span>, <span class="number">0x5b</span>]</span><br><span class="line">y2 = [<span class="number">0x71</span>, <span class="number">0x04</span>, <span class="number">0x61</span>, <span class="number">0x58</span>, <span class="number">0x27</span>, <span class="number">0x1E</span>, <span class="number">0x4B</span>, <span class="number">0x22</span>, <span class="number">0x5E</span>, <span class="number">0x64</span>, <span class="number">0x03</span>, <span class="number">0x26</span>, <span class="number">0x5E</span>, <span class="number">0x17</span>, <span class="number">0x3C</span>, <span class="number">0x7A</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(y2)):</span><br><span class="line">	flag += (<span class="built_in">chr</span>(y1[i]^y2[i]))</span><br><span class="line"></span><br><span class="line">string = <span class="string">b&quot;YTFzMF9wV24=&quot;</span></span><br><span class="line">decode = base64.b64decode(string)</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + flag +<span class="built_in">chr</span>(<span class="number">0x3d</span>)+<span class="built_in">chr</span>(<span class="number">0x23</span>)+<span class="built_in">chr</span>(<span class="number">0x40</span>)+ decode.decode(<span class="string">&#x27;utf-8&#x27;</span>)+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;Re_1s_So0_funny!=#@a1s0_pWn&#125;</span></span><br></pre></td></tr></table></figure>

<p>给我整蒙了……</p>
<h1 id="未完FlareOn2-very-success"><a href="#未完FlareOn2-very-success" class="headerlink" title="[未完FlareOn2]very_success"></a>[未完FlareOn2]very_success</h1><p>放在linux中，file一下</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407152416339.png" class="" title="image-20220407152416339">

<p>die查一下：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407152513542.png" class="" title="image-20220407152513542">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407152453053.png" class="" title="image-20220407152453053">



<p>用ida32打开</p>
<p>查看sub_401000函数，调整一下堆栈平衡，alt+k,调整最前面的堆栈平衡。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407191739612.png" class="" title="image-20220407191739612">

<p>反汇编成功的伪代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">BOOL __usercall sub_401000@&lt;eax&gt;(<span class="type">int</span> a1@&lt;ebp&gt;)</span><br><span class="line">&#123;</span><br><span class="line">  HANDLE StdHandle; <span class="comment">// [esp-14h] [ebp-14h]</span></span><br><span class="line">  HANDLE v3; <span class="comment">// [esp-10h] [ebp-10h]</span></span><br><span class="line">  <span class="type">int</span> v4[<span class="number">3</span>]; <span class="comment">// [esp-Ch] [ebp-Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> retaddr; <span class="comment">// [esp+0h] [ebp+0h]</span></span><br><span class="line"></span><br><span class="line">  v4[<span class="number">1</span>] = a1;</span><br><span class="line">  StdHandle = GetStdHandle(<span class="number">0xFFFFFFF6</span>);</span><br><span class="line">  v3 = GetStdHandle(<span class="number">0xFFFFFFF5</span>);</span><br><span class="line">  WriteFile(v3, aYouCrushedThat, <span class="number">0x43</span>u, v4, <span class="number">0</span>);</span><br><span class="line">  ReadFile(StdHandle, Buffer, <span class="number">0x32</span>u, v4, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( sub_401084(v4, retaddr, Buffer, v4[<span class="number">0</span>]) )</span><br><span class="line">    <span class="keyword">return</span> WriteFile(v3, aYouAreSuccess, <span class="number">17u</span>, v4, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> WriteFile(v3, aYouAreFailure, <span class="number">17u</span>, v4, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这题的逻辑看的我头晕</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407194308313.png" class="" title="image-20220407194308313">

<p>境界还不够，先放一放</p>
<h1 id="SCTF2019-Strange-apk-apk动态释放文件"><a href="#SCTF2019-Strange-apk-apk动态释放文件" class="headerlink" title="[SCTF2019]Strange apk (apk动态释放文件)"></a>[SCTF2019]Strange apk (apk动态释放文件)</h1><p>用jeb进行返汇编。</p>
<p>上次做apk逆向，告诉我assets目录下面存放着很重要的东西，在这边只看到了一个data文件，很奇怪。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407102518186.png" class="" title="image-20220407102518186">

<p>发现了几个奇怪的函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407102329333.png" class="" title="image-20220407102329333">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407102304781.png" class="" title="image-20220407102304781">

<p>按x查看“_”函数的调用</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407102453933.png" class="" title="image-20220407102453933">

<p>函数的意思就是把这个asset目录下的data文件和字符串”syclover” 进行异或，我们用脚本来还原。</p>
<p>这个脚本网上很多都是<a target="_blank" rel="noopener" href="https://www.notion.so/SCTF2019-Strange-apk-0bbe7b7ffc524484925e80eb14f5a11c">还原成2000KB+的文件</a>，和源文件对应不上，反汇编不起来。我重新找了个<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_52369224/article/details/122565323?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_default&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_default&utm_relevant_index=1">脚本</a>，但是需要很长时间跑出来。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;syclover&quot;</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">        data = f.read(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data: <span class="keyword">break</span></span><br><span class="line">        data2 = <span class="built_in">ord</span>(data) ^ <span class="built_in">ord</span>(s[count % <span class="built_in">len</span>(s)])</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;dates&#x27;</span>, <span class="string">&#x27;ab&#x27;</span>) <span class="keyword">as</span> g:</span><br><span class="line">            c = data2.to_bytes(<span class="number">1</span>, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">            g.write(c)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">f.close</span><br></pre></td></tr></table></figure>

<p>查看datas头文件可以发现，跑出来datas文件是apk格式的文件，后缀改成apk，然后再用jeb打开。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407140437917.png" class="" title="image-20220407140437917">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407143729159.png" class="" title="image-20220407143729159">

<p>首先查看s文件</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407141250338.png" class="" title="image-20220407141250338">

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> = <span class="string">&quot;c2N0ZntXM2xjMG1l&quot;</span></span><br></pre></td></tr></table></figure>

<p>base64解码一下</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407141553948.png" class="" title="image-20220407141553948">

<p>再去分析t文件</p>
<p>syclover在进行md5加密之后，作为key与data进行了encode</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407141741578.png" class="" title="image-20220407141741578">

<p>将这串字符中的“8”去掉</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;~8t808_8A8n848r808i8d8-8w808r8l8d8&#125;8&quot;</span>.replace(<span class="string">&quot;8&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(string)</span><br><span class="line"><span class="comment"># ~t0_An4r0id-w0rld&#125;</span></span><br></pre></td></tr></table></figure>

<p>sctf{W3lc0me~t0_An4r0id-w0rld}</p>
<p>还是先用<a target="_blank" rel="noopener" href="https://icode.best/i/42984939490879">正常一点的方法</a>来看这道题：</p>
<p>首先是寻找app的入口点，打开Manifest文件，入口点是myappllicatin.t，但是我们只能看到sctf.hello这个包。所以可能是app动态释放文件</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407143112812.png" class="" title="image-20220407143112812">

<p>当我们运行上面的脚本之后，再次查看Mainfest文件，可以看到入口点和包对应上了。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407143524606.png" class="" title="image-20220407143524606">

<p>较好解决方案应该是用<a target="_blank" rel="noopener" href="https://blog.csdn.net/liuxiaohuai_/article/details/115704067">映射大师</a>，“frida dex dump(python)将app运行时候的dex给dump下来再进行分析。”–引用大佬的话</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220407140808306.png" class="" title="image-20220407140808306">

<p>尝试了许久，发现不太支持，先放一放……</p>
<h1 id="RoarCTF2019-polyre-OLLVM控制流程平坦化-CRC"><a href="#RoarCTF2019-polyre-OLLVM控制流程平坦化-CRC" class="headerlink" title="[RoarCTF2019]polyre (OLLVM控制流程平坦化+CRC)"></a>[RoarCTF2019]polyre (OLLVM控制流程平坦化+CRC)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406113727672.png" class="" title="image-20220406113727672">

<p>ida64拖进去看看</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406113938782.png" class="" title="image-20220406113938782">

<p>定位一下：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406113911670.png" class="" title="image-20220406113911670">

<p>对于这个程序，我没有一点话要说……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406114619923.png" class="" title="image-20220406114619923">

<p>–更新–</p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://security.tencent.com/index.php/blog/msg/112">https://security.tencent.com/index.php/blog/msg/112</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/liuxiaohuai_/article/details/114369681">https://blog.csdn.net/liuxiaohuai_/article/details/114369681</a></p>
<p>查阅博客后，得知该程序添加了控制流平坦化，目的是为了模糊基本块之间的前后关系，以及增大分析的难度，我们需要使用deflat.py执行控制流平坦化脚本命令，且使用其脚本需要安装angr库</p>
<p>输入命令：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 deflat.py attachment <span class="number">0x400620</span></span><br></pre></td></tr></table></figure>

<p>关于<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406144706868.png" class="" title="image-20220406144706868">这行命令，最重要的就是后面的地址的选取，其实是函数的起始地址</p>
<p>还是感谢大佬的好心提示，脚本运行需要修改一些东西，关于这边存放的是am_graph模块的存放地址</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406143930725.png" class="" title="image-20220406143930725">

<p>复原成功之后，下面是ida反汇编伪代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">signed</span> __int64 v4; <span class="comment">// [rsp+1E0h] [rbp-110h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1E8h] [rbp-108h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+1ECh] [rbp-104h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+1ECh] [rbp-104h]</span></span><br><span class="line">  <span class="type">char</span> s1[<span class="number">48</span>]; <span class="comment">// [rsp+1F0h] [rbp-100h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">60</span>]; <span class="comment">// [rsp+220h] [rbp-D0h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v10; <span class="comment">// [rsp+25Ch] [rbp-94h]</span></span><br><span class="line">  <span class="type">char</span> *v11; <span class="comment">// [rsp+260h] [rbp-90h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+26Ch] [rbp-84h]</span></span><br><span class="line">  <span class="type">bool</span> v13; <span class="comment">// [rsp+272h] [rbp-7Eh]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v14; <span class="comment">// [rsp+273h] [rbp-7Dh]</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// [rsp+274h] [rbp-7Ch]</span></span><br><span class="line">  <span class="type">char</span> *v16; <span class="comment">// [rsp+278h] [rbp-78h]</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// [rsp+284h] [rbp-6Ch]</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// [rsp+288h] [rbp-68h]</span></span><br><span class="line">  <span class="type">bool</span> v19; <span class="comment">// [rsp+28Fh] [rbp-61h]</span></span><br><span class="line">  <span class="type">char</span> *v20; <span class="comment">// [rsp+290h] [rbp-60h]</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// [rsp+298h] [rbp-58h]</span></span><br><span class="line">  <span class="type">bool</span> v22; <span class="comment">// [rsp+29Fh] [rbp-51h]</span></span><br><span class="line">  __int64 v23; <span class="comment">// [rsp+2A0h] [rbp-50h]</span></span><br><span class="line">  <span class="type">bool</span> v24; <span class="comment">// [rsp+2AFh] [rbp-41h]</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+2B0h] [rbp-40h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+2B8h] [rbp-38h]</span></span><br><span class="line">  __int64 v27; <span class="comment">// [rsp+2C0h] [rbp-30h]</span></span><br><span class="line">  __int64 v28; <span class="comment">// [rsp+2C8h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> v29; <span class="comment">// [rsp+2D0h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> v30; <span class="comment">// [rsp+2D4h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">char</span> *v31; <span class="comment">// [rsp+2D8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v32; <span class="comment">// [rsp+2E0h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v33; <span class="comment">// [rsp+2E4h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">bool</span> v34; <span class="comment">// [rsp+2EBh] [rbp-5h]</span></span><br><span class="line"></span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x30</span>uLL);</span><br><span class="line">  <span class="built_in">memset</span>(s1, <span class="number">0</span>, <span class="keyword">sizeof</span>(s1));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Input:&quot;</span>);</span><br><span class="line">  v11 = s;</span><br><span class="line">  <span class="keyword">if</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_43;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, v11);</span><br><span class="line">    v6 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( dword_603058 &lt; <span class="number">10</span> || (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">LABEL_43:</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, v11);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      v12 = v6;</span><br><span class="line">    <span class="keyword">while</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> );</span><br><span class="line">    v13 = v12 &lt; <span class="number">64</span>;</span><br><span class="line">    <span class="keyword">while</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      ;</span><br><span class="line">    <span class="keyword">if</span> ( !v13 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v14 = s[v6];</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      v15 = v14;</span><br><span class="line">    <span class="keyword">while</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> );</span><br><span class="line">    <span class="keyword">if</span> ( v15 == <span class="number">10</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v16 = &amp;s[v6];</span><br><span class="line">      *v16 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v17 = v6 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      v6 = v17;</span><br><span class="line">    <span class="keyword">while</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      v18 = i;</span><br><span class="line">    <span class="keyword">while</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> );</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      v19 = v18 &lt; <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">while</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> );</span><br><span class="line">    <span class="keyword">if</span> ( !v19 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      v20 = s;</span><br><span class="line">    <span class="keyword">while</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> );</span><br><span class="line">    v4 = *&amp;v20[<span class="number">8</span> * i];</span><br><span class="line">    v7 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v21 = v7;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">        v22 = v21 &lt; <span class="number">64</span>;</span><br><span class="line">      <span class="keyword">while</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> );</span><br><span class="line">      <span class="keyword">if</span> ( !v22 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v23 = v4;</span><br><span class="line">      v24 = v4 &lt; <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v4 &gt;= <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v27 = v4;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">          v28 = <span class="number">2</span> * v27;</span><br><span class="line">        <span class="keyword">while</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> );</span><br><span class="line">        v4 = v28;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v25 = <span class="number">2</span> * v4;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">          v26 = v25;</span><br><span class="line">        <span class="keyword">while</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> );</span><br><span class="line">        v4 = v26 ^ <span class="number">0xB0004B7679FA26B3</span>LL;</span><br><span class="line">      &#125;</span><br><span class="line">      v29 = v7;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">        v7 = v29 + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">while</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    v30 = <span class="number">8</span> * i;</span><br><span class="line">    v31 = &amp;s1[<span class="number">8</span> * i];</span><br><span class="line">    <span class="keyword">if</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">LABEL_55:</span><br><span class="line">      *v31 = v4;</span><br><span class="line">    *v31 = v4;</span><br><span class="line">    <span class="keyword">if</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_55;</span><br><span class="line">    v32 = i + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    v33 = <span class="built_in">memcmp</span>(s1, &amp;unk_402170, <span class="number">0x30</span>uLL);</span><br><span class="line">  <span class="keyword">while</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> );</span><br><span class="line">  v34 = v33 != <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( dword_603058 &gt;= <span class="number">10</span> &amp;&amp; (((dword_603054 - <span class="number">1</span>) * dword_603054) &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">if</span> ( v34 )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> v10;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从大佬那边荡过来的<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46296905/article/details/115774374?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_antiscanv2&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_antiscanv2&utm_relevant_index=1">简化代码</a>：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">_int64 __fastcall <span class="title function_">main</span><span class="params">(__int64 a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">signed</span> __int64 v4; </span><br><span class="line">	<span class="type">signed</span> <span class="type">int</span> j,i,k; </span><br><span class="line">	<span class="type">char</span> s1[<span class="number">48</span>],s[<span class="number">60</span>]; </span><br><span class="line">	<span class="type">unsigned</span> __int8 v14; </span><br><span class="line">	<span class="type">char</span> *v16; </span><br><span class="line">	<span class="type">int</span> v33; </span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x30</span>uLL);</span><br><span class="line">	<span class="built_in">memset</span>(s1, <span class="number">0</span>, <span class="number">0x30</span>uLL);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Input:&quot;</span>, <span class="number">0LL</span>);</span><br><span class="line">	scanf_s(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; ; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (i &gt;= <span class="number">64</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		v14 = s[i];</span><br><span class="line">		<span class="keyword">if</span> (v14 == <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			v16 = &amp;s[i];</span><br><span class="line">			*v16 = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">break</span>;                            <span class="comment">//换行符换成 &#x27;/0 &#x27;</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">6</span>; ++j)</span><br><span class="line">	&#123;</span><br><span class="line">		v4 = *&amp;s[<span class="number">8</span> * j];                       <span class="comment">// 输入的每8个字节一组，组成1个64位的v4，小端序</span></span><br><span class="line">		<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">64</span> ; ++k)              <span class="comment">// 循环64次</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (v4 &gt;= <span class="number">0</span>)                      <span class="comment">// 如果v4非负，v4*=2，相当于左移一位，结果必为偶数，如果左移一位后最高位为1，则v4变成了负数</span></span><br><span class="line">				v4 *= <span class="number">2LL</span>;</span><br><span class="line">			<span class="keyword">else</span>                              <span class="comment">// 如果v4为负，v4乘2后再异或0xB0004B7679FA26B3，相当于先左移一位再异或，结果必为奇数，注意这时最高位的1被移出了</span></span><br><span class="line">				v4 = <span class="number">2</span> * v4 ^ <span class="number">0xB0004B7679FA26B3</span>LL;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	v33 = <span class="built_in">memcmp</span>(s, &amp;unk_402170, <span class="number">0x30</span>uLL);     <span class="comment">/*（冗余码）unk_402170=[</span></span><br><span class="line"><span class="comment">	                                             0x96, 0x62, 0x53, 0x43, 0x6D, 0xF2, 0x8F, 0xBC, </span></span><br><span class="line"><span class="comment">	                                             0x16, 0xEE, 0x30, 0x05, 0x78, 0x00, 0x01, 0x52, </span></span><br><span class="line"><span class="comment">	                                             0xEC, 0x08, 0x5F, 0x93, 0xEA, 0xB5, 0xC0, 0x4D, </span></span><br><span class="line"><span class="comment">	                                             0x50, 0xF4, 0x53, 0xD8, 0xAF, 0x90, 0x2B, 0x34, </span></span><br><span class="line"><span class="comment">	                                             0x81, 0x36, 0x2C, 0xAA, 0xBC, 0x0E, 0x25, 0x8B,</span></span><br><span class="line"><span class="comment">	                                             0xE4, 0x8A, 0xC6, 0xA2, 0x81, 0x9F, 0x75, 0x55]  */</span></span><br><span class="line">	<span class="keyword">if</span> (v33 != <span class="number">0</span>)</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>具体的逻辑：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">v12 = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span>(v12&lt;<span class="number">0x40</span>):</span><br><span class="line">    v4 = v28</span><br><span class="line">    <span class="keyword">if</span>(v4 &gt;= <span class="number">0</span>):</span><br><span class="line">        v28 = v28 * <span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        v28 = v28 * <span class="number">2</span></span><br><span class="line">        v28 = v28 ^ <span class="number">0xB0004B7679FA26B3</span></span><br><span class="line">    v12 += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>从别处得知是CRC32加密</p>
<p>大致流程：输入 48位，分成 6 组，将每组 8 字节转化为 long 类型的值，对每组进行加密，先判断正负，然后将值乘 2，随后根据正负异或 0xB0004B7679FA26B3，循环 64 次，最后与unk_402170进行比较。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406190137458.png" class="" title="image-20220406190137458">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406190830005.png" class="" title="image-20220406190830005">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406190651025.png" class="" title="image-20220406190651025">



<p>需要注意的是ida的小端序，<a target="_blank" rel="noopener" href="https://www.wuj1n9.cn/2020/04/30/OLLVM-%E4%B8%8E%E5%8E%BB%E5%B9%B3%E5%9D%A6%E5%8C%96/">代码来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">origin = [<span class="number">0xbc8ff26d43536296</span>,</span><br><span class="line">          <span class="number">0x520100780530ee16</span>,</span><br><span class="line">          <span class="number">0x4dc0b5ea935f08ec</span>,</span><br><span class="line">          <span class="number">0x342b90afd853f450</span>,</span><br><span class="line">          <span class="number">0x8b250ebcaa2c3681</span>,</span><br><span class="line">          <span class="number">0x55759f81a2c68ae4</span>]</span><br><span class="line">key = <span class="number">0xB0004B7679FA26B3</span></span><br><span class="line">data = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> value <span class="keyword">in</span> origin:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">64</span>):</span><br><span class="line">     	  <span class="comment"># 判断奇偶</span></span><br><span class="line">        parity = value &amp; <span class="number">1</span> </span><br><span class="line">        <span class="keyword">if</span> parity == <span class="number">1</span>:</span><br><span class="line">            value = (value ^ key) &gt;&gt; <span class="number">1</span></span><br><span class="line">            value = value | <span class="number">0x8000000000000000</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            value = value &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(value))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> (j &lt; <span class="number">8</span>):</span><br><span class="line">        <span class="comment"># 因为是小端序，需要从最后一个字节开始取</span></span><br><span class="line">        data += <span class="built_in">chr</span>(value &amp; <span class="number">0xFF</span>)</span><br><span class="line">        <span class="comment"># 右移 8 位，倒着取字节</span></span><br><span class="line">        value = value &gt;&gt; <span class="number">8</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>



<p>可以对照看一下CRC64加密算法的C实现</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/l1028386804/article/details/50748724">https://blog.csdn.net/l1028386804/article/details/50748724</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Improved calculation of CRC-64 values for protein sequences</span></span><br><span class="line"><span class="comment"> * By Adam Lu 刘亚壮  - 2016-02-26</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* If you want to try the old CRC-64 function, currently employed in</span></span><br><span class="line"><span class="comment">   SWISSPROT/TrEMBL then uncomment the next line */</span></span><br><span class="line"><span class="comment">/* #define OLDCRC */</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> OLDCRC</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> POLY64REV	0xd800000000000000ULL</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> INITIALCRC	0x0000000000000000ULL</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> POLY64REV     0x95AC9329AC4BC9B5ULL</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> INITIALCRC    0xFFFFFFFFFFFFFFFFULL</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">crc64</span><span class="params">(<span class="type">char</span> *seq, <span class="type">char</span> *res)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i, j, low, high;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> crc = INITIALCRC, part;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> init = <span class="number">0</span>;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> CRCTable[<span class="number">256</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!init)</span><br><span class="line">    &#123;</span><br><span class="line">	init = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">	    part = i;</span><br><span class="line">	    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">	    &#123;</span><br><span class="line">		<span class="keyword">if</span> (part &amp; <span class="number">1</span>) </span><br><span class="line">		    part = (part &gt;&gt; <span class="number">1</span>) ^ POLY64REV;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		    part &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">	    &#125;</span><br><span class="line">	    CRCTable[i] = part;</span><br><span class="line">	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (*seq)</span><br><span class="line">	crc = CRCTable[(crc ^ *seq++) &amp; <span class="number">0xff</span>] ^ (crc &gt;&gt; <span class="number">8</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     The output is done in two parts to avoid problems with </span></span><br><span class="line"><span class="comment">     architecture-dependent word order</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    low = crc &amp; <span class="number">0xffffffff</span>;</span><br><span class="line">    high = (crc &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xffffffff</span>;</span><br><span class="line">    <span class="built_in">sprintf</span> (res, <span class="string">&quot;%08X%08X&quot;</span>, high, low);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span> <span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *testseq1 = <span class="string">&quot;MNIIQGNLVGTGLKIGIVVGRFNDFITSKLLSGAEDALLRHGVDTNDIDVAWVPGAFEIPFAAKKMAETKKYDAIITLGTVIRGATTSYDYVCNEAAKGIAQAANTTGVPVIFGIVTTENIEQAIERAGTKAGNKGVDCAVSAIEMANLNRSFE&quot;</span>;</span><br><span class="line">    <span class="type">char</span> *testseq2 = <span class="string">&quot;MNIIQGNLVGTGLKIGIVVGRFNDFITSKLLSGAEDALLRHGVDTNDIDVAWVPGAFEIPFAAKKMAETKKYDAIITLGDVIRGATTHYDYVCNEAAKGIAQAANTTGVPVIFGIVTTENIEQAIERAGTKAGNKGVDCAVSAIEMANLNRSFE&quot;</span>; <span class="comment">/* Differs from 1st seq in two places */</span></span><br><span class="line">    <span class="type">char</span> result[<span class="number">20</span>];</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    crc64(testseq1, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The CRC-64 for sequence %s is %s\n&quot;</span>, testseq1, result);</span><br><span class="line"> </span><br><span class="line">    crc64(testseq2, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The CRC-64 for sequence %s is %s\n&quot;</span>, testseq2, result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="GKCTF-2021-QQQQT-base58"><a href="#GKCTF-2021-QQQQT-base58" class="headerlink" title="[GKCTF 2021]QQQQT (base58)"></a>[GKCTF 2021]QQQQT (base58)</h1><p>用die扫一下：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406094814859.png" class="" title="image-20220406094814859">

<p>用网上下载了一个<a target="_blank" rel="noopener" href="https://mega.nz/file/c9wizByT#51UhYoMUL5PpkCQd_EFYVO8OH4FkQMZrSgh3m9P3-CU">EnigmaVBUnpacker</a> </p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406095412721.png" class="" title="image-20220406095412721">



<p>解包之后再次扫描已经没有壳了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406095521434.png" class="" title="image-20220406095521434">



<p>但是程序也打不开了……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406113212043.png" class="" title="image-20220406113212043">



<p>放到xdbg32中，发现可以字符串</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406113145817.png" class="" title="image-20220406113145817">



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;56fkoP8KhwCf3v7CEz&quot;</span></span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406113558409.png" class="" title="image-20220406113558409">

<p>flag{12t4tww3r5e77}</p>
<h1 id="NPUCTF2020-你好sao啊-base64换表解密"><a href="#NPUCTF2020-你好sao啊-base64换表解密" class="headerlink" title="[NPUCTF2020]你好sao啊(base64换表解密)"></a>[NPUCTF2020]你好sao啊(base64换表解密)</h1><p>可以看出，中间的RxEncode是一个base64换表解密</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406093213286.png" class="" title="image-20220406093213286">

<p>将只需要将v15,v16,v17,v18从后往前拼成字节</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220406094048594.png" class="" title="image-20220406094048594">

<p>可以看到这个表中，数字5和6换成了{和}，只需要把最后base64加密中的5和6替换即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">string = <span class="string">b&quot;\x9E\x9b\x9C\xB5\xFE\x70\xD3\x0F\xb2\xd1\x4f\x9c\x02\x7f\xab\xde\x59\x65\x63\xe7\x40\x9d\xcd\xfa\x04&quot;</span></span><br><span class="line">flag = base64.b64encode(string)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#&#x27;npuctf&#123;w0w+y0U+cAn+r3lllY+dAnc3&#125;BA==&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="UTCTF2020-babymips-mips-异或运算"><a href="#UTCTF2020-babymips-mips-异或运算" class="headerlink" title="[UTCTF2020]babymips (mips+异或运算)"></a>[UTCTF2020]babymips (mips+异或运算)</h1><p>用ida打开，函数很清晰：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220405150901027.png" class="" title="image-20220405150901027">



<p>shift+e提取数据unk_4015F4,并将前84个赋值给v7</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220405151247253.png" class="" title="image-20220405151247253">



<p>跟进sub_401164函数：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220405150944461.png" class="" title="image-20220405150944461">

<p>a2，是上面数据提取的v7，这样的话，这题静态分析也可以做，动调也可以做。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">arr =[<span class="number">98</span>, <span class="number">108</span>, <span class="number">127</span>, <span class="number">118</span>, <span class="number">122</span>, <span class="number">123</span>, <span class="number">102</span>, <span class="number">115</span>, <span class="number">118</span>, <span class="number">80</span>, <span class="number">82</span>, <span class="number">125</span>, <span class="number">64</span>, <span class="number">84</span>, <span class="number">85</span>, <span class="number">121</span>, <span class="number">64</span>, <span class="number">73</span>, <span class="number">71</span>, <span class="number">77</span>, <span class="number">116</span>, <span class="number">25</span>, <span class="number">123</span>, <span class="number">106</span>, <span class="number">66</span>, <span class="number">10</span>, <span class="number">79</span>, <span class="number">82</span>, <span class="number">125</span>, <span class="number">105</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">12</span>, <span class="number">100</span>, <span class="number">16</span>, <span class="number">15</span>, <span class="number">30</span>, <span class="number">74</span>, <span class="number">103</span>, <span class="number">3</span>, <span class="number">124</span>, <span class="number">103</span>, <span class="number">2</span>, <span class="number">106</span>, <span class="number">49</span>, <span class="number">103</span>, <span class="number">97</span>, <span class="number">55</span>, <span class="number">122</span>, <span class="number">98</span>, <span class="number">44</span>, <span class="number">44</span>, <span class="number">15</span>, <span class="number">110</span>, <span class="number">23</span>, <span class="number">0</span>, <span class="number">22</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">10</span>, <span class="number">109</span>, <span class="number">98</span>, <span class="number">115</span>, <span class="number">37</span>, <span class="number">57</span>, <span class="number">118</span>, <span class="number">46</span>, <span class="number">28</span>, <span class="number">99</span>, <span class="number">120</span>, <span class="number">43</span>, <span class="number">116</span>, <span class="number">50</span>, <span class="number">22</span>, <span class="number">32</span>, <span class="number">34</span>, <span class="number">68</span>, <span class="number">25</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">78</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(arr))</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(arr)):</span><br><span class="line">  flag += <span class="built_in">chr</span>(arr[i]^(i+<span class="number">23</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#utflag&#123;mips_cpp_gang_5VDm:~`N]ze;\)5%vZ=C&#x27;C(r#$q=*efD&quot;ZNY_GX&gt;6&amp;sn.wF8$v*mvA@&#x27;&#125;efghi$</span></span><br></pre></td></tr></table></figure>



<h1 id="WUSTCTF2020-funnyre-花指令-异或运算"><a href="#WUSTCTF2020-funnyre-花指令-异或运算" class="headerlink" title="[WUSTCTF2020]funnyre (花指令+异或运算)"></a>[WUSTCTF2020]funnyre (花指令+异或运算)</h1><p>ida64打开，一整块的汇编都在报红，需要手动恢复main函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220405125650139.png" class="" title="image-20220405125650139">

<p>mian函数调好之后发现有错误，跟进查看返汇编</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220405130159350.png" class="" title="image-20220405130159350">

<p>经典花指令，会出现好几次，需要一个一个手修。</p>
<p>nop掉jz和jnz，然后对比其他汇编的硬编码就能知道错误在哪里了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220405130240494.png" class="" title="image-20220405130240494">



<p>修复成功之后，分析一下main函数，输入字符串为38位，除去头5位与最后一位，其他字符串，经过很多次运算之后，与unk_4025C0数组的32位进行对比</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220405133024211.png" class="" title="image-20220405133024211">



<p>对unk_4025C0数组进行数据提取：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220405133139843.png" class="" title="image-20220405133139843">



<p>注意，中间还存在了一个取反运算</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220405140358092.png" class="" title="image-20220405140358092">



<p>三百多个数据，一个一个输入，累死了&#x3D;^&#x3D;，幸好解出来了:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">arr = [ <span class="number">0xD9</span>, <span class="number">0x2C</span>, <span class="number">0x27</span>, <span class="number">0xD6</span>, <span class="number">0xD8</span>, <span class="number">0x2A</span>, <span class="number">0xDA</span>, <span class="number">0x2D</span>, <span class="number">0xD7</span>, <span class="number">0x2C</span>, <span class="number">0xDC</span>, <span class="number">0xE1</span>, <span class="number">0xDB</span>, <span class="number">0x2C</span>, <span class="number">0xD9</span>, <span class="number">0xDD</span>, <span class="number">0x27</span>, <span class="number">0x2D</span>, <span class="number">0x2A</span>, <span class="number">0xDC</span>, <span class="number">0xDB</span>, <span class="number">0x2C</span>, <span class="number">0xE1</span>, <span class="number">0x29</span>, <span class="number">0xDA</span>, <span class="number">0xDA</span>, <span class="number">0x2C</span>, <span class="number">0xDA</span>, <span class="number">0x2A</span>, <span class="number">0xD9</span>, <span class="number">0x29</span>, <span class="number">0x2A</span>]</span><br><span class="line">add = [<span class="number">8</span>,<span class="number">21</span>,<span class="number">60</span>,<span class="number">24</span>,<span class="number">7</span>,<span class="number">16</span>,<span class="number">20</span>,<span class="number">31</span>,<span class="number">28</span>,<span class="number">54</span>,<span class="number">26</span>,<span class="number">78</span>,<span class="number">34</span>,<span class="number">45</span>,<span class="number">13</span>,<span class="number">81</span>,<span class="number">98</span>,<span class="number">22</span>,<span class="number">76</span>,<span class="number">93</span>,<span class="number">36</span>,<span class="number">48</span>,<span class="number">72</span>,<span class="number">3</span>,<span class="number">95</span>,<span class="number">92</span>,<span class="number">18</span>,<span class="number">51</span>,<span class="number">25</span>,<span class="number">35</span>,<span class="number">39</span>,<span class="number">63</span>,<span class="number">88</span>,<span class="number">19</span>,<span class="number">46</span>,<span class="number">82</span>,<span class="number">66</span>,<span class="number">27</span>,<span class="number">47</span>,<span class="number">49</span>,<span class="number">29</span>,<span class="number">62</span>,<span class="number">23</span>,<span class="number">2</span>,<span class="number">77</span>,<span class="number">15</span>,<span class="number">37</span>,<span class="number">40</span>,<span class="number">4</span>,<span class="number">75</span>,<span class="number">14</span>,<span class="number">69</span>,<span class="number">61</span>,<span class="number">42</span>,<span class="number">52</span>,<span class="number">73</span>,<span class="number">6</span>,<span class="number">56</span>,<span class="number">96</span>,<span class="number">71</span>,<span class="number">67</span>,<span class="number">50</span>,<span class="number">68</span>,<span class="number">97</span>,<span class="number">32</span>,<span class="number">55</span>,<span class="number">86</span>,<span class="number">94</span>,<span class="number">11</span>,<span class="number">33</span>,<span class="number">43</span>,<span class="number">38</span>,<span class="number">17</span>,<span class="number">74</span>,<span class="number">10</span>,<span class="number">84</span>,<span class="number">12</span>,<span class="number">70</span>,<span class="number">44</span>,<span class="number">89</span>,<span class="number">85</span>,<span class="number">41</span>,<span class="number">53</span>,<span class="number">65</span>,<span class="number">57</span>,<span class="number">90</span>,<span class="number">1</span>,<span class="number">58</span>,<span class="number">59</span>,<span class="number">83</span>,<span class="number">87</span>,<span class="number">99</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">91</span>,<span class="number">30</span>,<span class="number">79</span>,<span class="number">64</span>,<span class="number">80</span>]</span><br><span class="line">huo1 = [<span class="number">0x67</span>,<span class="number">0x68</span>,<span class="number">0xc3</span>,<span class="number">0x23</span>,<span class="number">0xe9</span>,<span class="number">0x8</span>,<span class="number">0x3b</span>,<span class="number">0x50</span>,<span class="number">0xfa</span>,<span class="number">0x64</span>,<span class="number">0xc8</span>,<span class="number">0x5</span>,<span class="number">0xf5</span>,<span class="number">0x76</span>,<span class="number">0x86</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0xf0</span>,<span class="number">0x37</span>,<span class="number">0x49</span>,<span class="number">0x4c</span>,<span class="number">0x18</span>,<span class="number">0x39</span>,<span class="number">0x5d</span>,<span class="number">0x2c</span>,<span class="number">0x75</span>,<span class="number">0x4d</span>,<span class="number">0x95</span>,<span class="number">0xed</span>,<span class="number">0x84</span>,<span class="number">0x10</span>,<span class="number">0x32</span>,<span class="number">0x2</span>,<span class="number">0x12</span>,<span class="number">0x9c</span>,<span class="number">0x65</span>,<span class="number">0x73</span>,<span class="number">0x2f</span>,<span class="number">0x13</span>,<span class="number">0xc</span>,<span class="number">0xbd</span>,<span class="number">0x96</span>,<span class="number">0xa8</span>,<span class="number">0x33</span>,<span class="number">0xd2</span>,<span class="number">0xe2</span>,<span class="number">0xc7</span>,<span class="number">0xd3</span>,<span class="number">0x4e</span>,<span class="number">0xa9</span>,<span class="number">0xf9</span>]</span><br><span class="line"><span class="comment"># not</span></span><br><span class="line">huo2 = [<span class="number">0xef</span>,<span class="number">0x62</span>,<span class="number">0x66</span>,<span class="number">0xce</span>,<span class="number">0x14</span>,<span class="number">0xb</span>,<span class="number">0xb6</span>,<span class="number">0x7</span>,<span class="number">0xa3</span>,<span class="number">0x97</span>,<span class="number">0xdc</span>,<span class="number">0xb8</span>,<span class="number">0xe7</span>,<span class="number">0xd5</span>,<span class="number">0x7f</span>,<span class="number">0x82</span>,<span class="number">0x34</span>,<span class="number">0xe1</span>,<span class="number">0x98</span>,<span class="number">0xe3</span>,<span class="number">0xf6</span>,<span class="number">0xeb</span>,<span class="number">0xd8</span>,<span class="number">0xda</span>,<span class="number">0x1d</span>,<span class="number">0x9d</span>,<span class="number">0x7d</span>,<span class="number">0x80</span>,<span class="number">0xc9</span>,<span class="number">0x27</span>,<span class="number">0xa0</span>,<span class="number">0x8e</span>,<span class="number">0xf7</span>,<span class="number">0x6f</span>,<span class="number">0xfb</span>,<span class="number">0x9a</span>,<span class="number">0x9b</span>,<span class="number">0xcb</span>,<span class="number">0xd4</span>,<span class="number">0x30</span>,<span class="number">0xac</span>,<span class="number">0x60</span>,<span class="number">0x92</span>,<span class="number">0xaf</span>,<span class="number">0x2d</span>,<span class="number">0xab</span>,<span class="number">0x51</span>,<span class="number">0xb7</span>,<span class="number">0x35</span>,<span class="number">0xd0</span>,<span class="number">0xa4</span>,<span class="number">0xad</span>,<span class="number">0xc0</span>,<span class="number">0xec</span>,<span class="number">0xbe</span>,<span class="number">0xfc</span>,<span class="number">0xbb</span>,<span class="number">0x54</span>,<span class="number">0xc5</span>,<span class="number">0xc1</span>,<span class="number">0xc6</span>,<span class="number">0x3</span>,<span class="number">0xde</span>,<span class="number">0x5e</span>,<span class="number">0x3a</span>,<span class="number">0xfd</span>,<span class="number">0x29</span>,<span class="number">0x31</span>,<span class="number">0x85</span>,<span class="number">0x2b</span>,<span class="number">0xb9</span>,<span class="number">0x55</span>,<span class="number">0xdf</span>,<span class="number">0xcf</span>,<span class="number">0x4b</span>,<span class="number">0xcc</span>,<span class="number">0x1f</span>,<span class="number">0xd6</span>,<span class="number">0x93</span>,<span class="number">0xf</span>,<span class="number">0xe0</span>,<span class="number">0xd1</span>,<span class="number">0xb0</span>,<span class="number">0xf1</span>,<span class="number">0x56</span>,<span class="number">0xf4</span>,<span class="number">0x45</span>,<span class="number">0x63</span>,<span class="number">0x7c</span>,<span class="number">0x2e</span>,<span class="number">0x11</span>,<span class="number">0x81</span>,<span class="number">0x1c</span>,<span class="number">0x77</span>,<span class="number">0xfe</span>,<span class="number">0x3f</span>,<span class="number">0x36</span>,<span class="number">0x87</span>,<span class="number">0xbf</span>,<span class="number">0xba</span>,<span class="number">0x8b</span>,<span class="number">0xa7</span>,<span class="number">0x26</span>,<span class="number">0x5f</span>,<span class="number">0x72</span>,<span class="number">0xdb</span>,<span class="number">0x47</span>,<span class="number">0x4a</span>,<span class="number">0x15</span>,<span class="number">0x19</span>,<span class="number">0xb4</span>,<span class="number">0x7b</span>,<span class="number">0x8a</span>,<span class="number">0x9</span>,<span class="number">0xe8</span>,<span class="number">0x71</span>,<span class="number">0x20</span>,<span class="number">0x88</span>,<span class="number">0xe6</span>,<span class="number">0x46</span>,<span class="number">0x25</span>,<span class="number">0xee</span>,<span class="number">0xa5</span>,<span class="number">0x8f</span>,<span class="number">0x43</span>,<span class="number">0x1a</span>,<span class="number">0x5b</span>,<span class="number">0xd9</span>,<span class="number">0x61</span>,<span class="number">0x79</span>,<span class="number">0xa6</span>,<span class="number">0xb3</span>,<span class="number">0x8c</span>,<span class="number">0x90</span>,<span class="number">0x44</span>,<span class="number">0x3d</span>,<span class="number">0xc2</span>,<span class="number">0x22</span>,<span class="number">0x6b</span>,<span class="number">0xa2</span>,<span class="number">0x1e</span>,<span class="number">0x6d</span>,<span class="number">0x57</span>,<span class="number">0x74</span>,<span class="number">0x1</span>,<span class="number">0xbc</span>,<span class="number">0x94</span>,<span class="number">0x2a</span>,<span class="number">0x7e</span>,<span class="number">0xe5</span>,<span class="number">0x21</span>,<span class="number">0x5c</span>,<span class="number">0x69</span>,<span class="number">0xb1</span>,<span class="number">0x5a</span>,<span class="number">0x17</span>,<span class="number">0xd</span>,<span class="number">0xb5</span>,<span class="number">0xd7</span>,<span class="number">0x16</span>,<span class="number">0x89</span>,<span class="number">0x40</span>,<span class="number">0x6e</span>,<span class="number">0xe4</span>,<span class="number">0x48</span>,<span class="number">0xea</span>,<span class="number">0x28</span>,<span class="number">0x70</span>,<span class="number">0x78</span>,<span class="number">0x6</span>,<span class="number">0xa1</span>,<span class="number">0x3c</span>,<span class="number">0x9f</span>,<span class="number">0xf2</span>,<span class="number">0x58</span>,<span class="number">0xf8</span>,<span class="number">0xae</span>,<span class="number">0xaa</span>,<span class="number">0x1b</span>,<span class="number">0x52</span>,<span class="number">0xdd</span>,<span class="number">0x7a</span>,<span class="number">0x38</span>,<span class="number">0x8d</span>,<span class="number">0xe</span>,<span class="number">0x42</span>,<span class="number">0x9e</span>,<span class="number">0x4</span>,<span class="number">0x53</span>,<span class="number">0xc4</span>,<span class="number">0x83</span>,<span class="number">0x24</span>,<span class="number">0x4f</span>,<span class="number">0x6c</span>,<span class="number">0x3e</span>,<span class="number">0xca</span>,<span class="number">0xf3</span>,<span class="number">0xa</span>,<span class="number">0x59</span>,<span class="number">0x6a</span>,<span class="number">0xcd</span>,<span class="number">0x91</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(add)):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    arr[j] -= add[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(huo1)):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    arr[j] ^= huo1[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">  arr[i] = ~arr[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(huo2)):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    arr[j] ^= huo2[i]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> arr:</span><br><span class="line">  flag += <span class="built_in">chr</span>(i%<span class="number">128</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;&quot;</span>+flag+<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="comment">#flag&#123;1dc20f6e3d497d15cef47d9a66d6f1af&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="QCTF2018-Xman-babymips-mips-位移运算"><a href="#QCTF2018-Xman-babymips-mips-位移运算" class="headerlink" title="[QCTF2018]Xman-babymips (mips+位移运算)"></a>[QCTF2018]Xman-babymips (mips+位移运算)</h1><p>用ida32打开，虽然是mips架构的程序，但是生成的伪代码还是很清晰的：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [sp+18h] [+18h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">36</span>]; <span class="comment">// [sp+1Ch] [+1Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  setbuf((FILE *)<span class="built_in">stdout</span>, <span class="number">0</span>);</span><br><span class="line">  setbuf((FILE *)<span class="built_in">stdin</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Give me your flag:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%32s&quot;</span>, v5);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">    v5[i] ^= <span class="number">32</span> - (_BYTE)i;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(v5, fdata, <span class="number">5u</span>) )</span><br><span class="line">    <span class="keyword">return</span> sub_4007F0(v5);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Wrong&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>跟进sub_4007F0函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">sub_4007F0</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v1; <span class="comment">// $v1</span></span><br><span class="line">  <span class="type">size_t</span> i; <span class="comment">// [sp+18h] [+18h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">5</span>; i &lt; <span class="built_in">strlen</span>(a1); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (i &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      v1 = (a1[i] &gt;&gt; <span class="number">2</span>) | (a1[i] &lt;&lt; <span class="number">6</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v1 = (<span class="number">4</span> * a1[i]) | (a1[i] &gt;&gt; <span class="number">6</span>);</span><br><span class="line">    a1[i] = v1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(a1 + <span class="number">5</span>, (<span class="type">const</span> <span class="type">char</span> *)off_410D04, <span class="number">0x1B</span>u) )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Right!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>先进行一个异或，然后五位后面的进行一个移位或运算</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220405124952904.png" class="" title="image-20220405124952904">

<p>最后对比，shift+e提取数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">string1 = [<span class="number">81</span>,<span class="number">124</span>,<span class="number">106</span>,<span class="number">123</span>,<span class="number">103</span>]</span><br><span class="line">string2 =[ <span class="number">0x52</span>, <span class="number">0xFD</span>, <span class="number">0x16</span>, <span class="number">0xA4</span>, <span class="number">0x89</span>, <span class="number">0xBD</span>, <span class="number">0x92</span>, <span class="number">0x80</span>, <span class="number">0x13</span>, <span class="number">0x41</span>, <span class="number">0x54</span>, <span class="number">0xA0</span>, <span class="number">0x8D</span>, <span class="number">0x45</span>, <span class="number">0x18</span>, <span class="number">0x81</span>, <span class="number">0xDE</span>, <span class="number">0xFC</span>, <span class="number">0x95</span>, <span class="number">0xF0</span>, <span class="number">0x16</span>, <span class="number">0x79</span>, <span class="number">0x1A</span>, <span class="number">0x15</span>, <span class="number">0x5B</span>, <span class="number">0x75</span>, <span class="number">0x1F</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(string2)):</span><br><span class="line">	<span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">		string2[i] = ((string2[i] &lt;&lt; <span class="number">2</span>) % <span class="number">0x100</span> | string2[i] &gt;&gt; <span class="number">6</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		string2[i] = ( string2[i] &gt;&gt; <span class="number">2</span> | (string2[i] &lt;&lt; <span class="number">6</span>) % <span class="number">0x100</span>)</span><br><span class="line">	string1.append(string2[i])</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(string1)):</span><br><span class="line">	flag += <span class="built_in">chr</span>((<span class="number">32</span>-i) ^ string1[i])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>其中，因为要考虑到溢出情况，所以%0x100，当然ascii码的范围在128以内，所以求余0x80也可以。</p>
<h1 id="羊城杯-2020-login-pyinstaller解包-pyc返汇编-z3"><a href="#羊城杯-2020-login-pyinstaller解包-pyc返汇编-z3" class="headerlink" title="[羊城杯 2020]login (pyinstaller解包+pyc返汇编+z3)"></a>[羊城杯 2020]login (pyinstaller解包+pyc返汇编+z3)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220404150335113.png" class="" title="image-20220404150335113">

<p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-270024.htm">Pyinstaller如何解包</a></p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220404153014787.png" class="" title="image-20220404153014787">



<p>现在就是需要根据struct.pyc文件头来修复login.pyc的文件头</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220404153459347.png" class="" title="image-20220404153459347">

<p>大佬使用010editor，那我也使用010editor</p>
<p>struct.pyc:</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220404154251177.png" class="" title="image-20220404154251177">

<p>login.pyc：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220404154310371.png" class="" title="image-20220404154310371">

<p>对比一下，我们复制struct.pyc的E3之前的数据复制到login就可以成功修复文件了</p>
<p>uncompyle6不支持反汇编python 3.9版本的pyc文件</p>
<p>我使用的是pycdc，使用方法<a target="_blank" rel="noopener" href="http://www.syjblog.com/?p=470">在这里</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./pycdc /home/ks/桌面/pyinstaller/login.pyc</span><br></pre></td></tr></table></figure>

<p>就能看到py代码了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220404155850717.png" class="" title="image-20220404155850717">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12,a13,a14=Ints(<span class="string">&quot;a1 a2 a3 a4 a5 a6 a7 a8 a9 a10 a11 a12 a13 a14&quot;</span>)</span><br><span class="line"></span><br><span class="line">s=Solver()</span><br><span class="line"></span><br><span class="line">s.add(a1 * <span class="number">88</span> + a2 * <span class="number">67</span> + a3 * <span class="number">65</span> - a4 * <span class="number">5</span> + a5 * <span class="number">43</span> + a6 * <span class="number">89</span> + a7 * <span class="number">25</span> + a8 * <span class="number">13</span> - a9 * <span class="number">36</span> + a10 * <span class="number">15</span> + a11 * <span class="number">11</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> + a14 * <span class="number">29</span> == <span class="number">22748</span>)</span><br><span class="line">s.add(a1 * <span class="number">89</span> + a2 * <span class="number">7</span> + a3 * <span class="number">12</span> - a4 * <span class="number">25</span> + a5 * <span class="number">41</span> + a6 * <span class="number">23</span> + a7 * <span class="number">20</span> - a8 * <span class="number">66</span> + a9 * <span class="number">31</span> + a10 * <span class="number">8</span> + a11 * <span class="number">2</span> - a12 * <span class="number">41</span> - a13 * <span class="number">39</span> + a14 * <span class="number">17</span> == <span class="number">7258</span>) </span><br><span class="line">s.add(a1 * <span class="number">28</span> + a2 * <span class="number">35</span> + a3 * <span class="number">16</span> - a4 * <span class="number">65</span> + a5 * <span class="number">53</span> + a6 * <span class="number">39</span> + a7 * <span class="number">27</span> + a8 * <span class="number">15</span> - a9 * <span class="number">33</span> + a10 * <span class="number">13</span> + a11 * <span class="number">101</span> + a12 * <span class="number">90</span> - a13 * <span class="number">34</span> + a14 * <span class="number">23</span> == <span class="number">26190</span>)</span><br><span class="line">s.add(a1 * <span class="number">23</span> + a2 * <span class="number">34</span> + a3 * <span class="number">35</span> - a4 * <span class="number">59</span> + a5 * <span class="number">49</span> + a6 * <span class="number">81</span> + a7 * <span class="number">25</span> + a8 * <span class="number">128</span> - a9 * <span class="number">32</span> + a10 * <span class="number">75</span> + a11 * <span class="number">81</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> + a14 * <span class="number">29</span> == <span class="number">37136</span>) </span><br><span class="line">s.add(a1 * <span class="number">38</span> + a2 * <span class="number">97</span> + a3 * <span class="number">35</span> - a4 * <span class="number">52</span> + a5 * <span class="number">42</span> + a6 * <span class="number">79</span> + a7 * <span class="number">90</span> + a8 * <span class="number">23</span> - a9 * <span class="number">36</span> + a10 * <span class="number">57</span> + a11 * <span class="number">81</span> + a12 * <span class="number">42</span> - a13 * <span class="number">62</span> - a14 * <span class="number">11</span> == <span class="number">27915</span>) </span><br><span class="line">s.add(a1 * <span class="number">22</span> + a2 * <span class="number">27</span> + a3 * <span class="number">35</span> - a4 * <span class="number">45</span> + a5 * <span class="number">47</span> + a6 * <span class="number">49</span> + a7 * <span class="number">29</span> + a8 * <span class="number">18</span> - a9 * <span class="number">26</span> + a10 * <span class="number">35</span> + a11 * <span class="number">41</span> + a12 * <span class="number">40</span> - a13 * <span class="number">61</span> + a14 * <span class="number">28</span> == <span class="number">17298</span>) </span><br><span class="line">s.add(a1 * <span class="number">12</span> + a2 * <span class="number">45</span> + a3 * <span class="number">35</span> - a4 * <span class="number">9</span> - a5 * <span class="number">42</span> + a6 * <span class="number">86</span> + a7 * <span class="number">23</span> + a8 * <span class="number">85</span> - a9 * <span class="number">47</span> + a10 * <span class="number">34</span> + a11 * <span class="number">76</span> + a12 * <span class="number">43</span> - a13 * <span class="number">44</span> + a14 * <span class="number">65</span> == <span class="number">19875</span>) </span><br><span class="line">s.add(a1 * <span class="number">79</span> + a2 * <span class="number">62</span> + a3 * <span class="number">35</span> - a4 * <span class="number">85</span> + a5 * <span class="number">33</span> + a6 * <span class="number">79</span> + a7 * <span class="number">86</span> + a8 * <span class="number">14</span> - a9 * <span class="number">30</span> + a10 * <span class="number">25</span> + a11 * <span class="number">11</span> + a12 * <span class="number">57</span> - a13 * <span class="number">50</span> - a14 * <span class="number">9</span> == <span class="number">22784</span>) </span><br><span class="line">s.add(a1 * <span class="number">8</span> + a2 * <span class="number">6</span> + a3 * <span class="number">64</span> - a4 * <span class="number">85</span> + a5 * <span class="number">73</span> + a6 * <span class="number">29</span> + a7 * <span class="number">2</span> + a8 * <span class="number">23</span> - a9 * <span class="number">36</span> + a10 * <span class="number">5</span> + a11 * <span class="number">2</span> + a12 * <span class="number">47</span> - a13 * <span class="number">64</span> + a14 * <span class="number">27</span> == <span class="number">9710</span>) </span><br><span class="line">s.add(a1 * <span class="number">67</span> - a2 * <span class="number">68</span> + a3 * <span class="number">68</span> - a4 * <span class="number">51</span> - a5 * <span class="number">43</span> + a6 * <span class="number">81</span> + a7 * <span class="number">22</span> - a8 * <span class="number">12</span> - a9 * <span class="number">38</span> + a10 * <span class="number">75</span> + a11 * <span class="number">41</span> + a12 * <span class="number">27</span> - a13 * <span class="number">52</span> + a14 * <span class="number">31</span> == <span class="number">13376</span>) </span><br><span class="line">s.add(a1 * <span class="number">85</span> + a2 * <span class="number">63</span> + a3 * <span class="number">5</span> - a4 * <span class="number">51</span> + a5 * <span class="number">44</span> + a6 * <span class="number">36</span> + a7 * <span class="number">28</span> + a8 * <span class="number">15</span> - a9 * <span class="number">6</span> + a10 * <span class="number">45</span> + a11 * <span class="number">31</span> + a12 * <span class="number">7</span> - a13 * <span class="number">67</span> + a14 * <span class="number">78</span> == <span class="number">24065</span>) </span><br><span class="line">s.add(a1 * <span class="number">47</span> + a2 * <span class="number">64</span> + a3 * <span class="number">66</span> - a4 * <span class="number">5</span> + a5 * <span class="number">43</span> + a6 * <span class="number">112</span> + a7 * <span class="number">25</span> + a8 * <span class="number">13</span> - a9 * <span class="number">35</span> + a10 * <span class="number">95</span> + a11 * <span class="number">21</span> + a12 * <span class="number">43</span> - a13 * <span class="number">61</span> + a14 * <span class="number">20</span> == <span class="number">27687</span>) </span><br><span class="line">s.add(a1 * <span class="number">89</span> + a2 * <span class="number">67</span> + a3 * <span class="number">85</span> - a4 * <span class="number">25</span> + a5 * <span class="number">49</span> + a6 * <span class="number">89</span> + a7 * <span class="number">23</span> + a8 * <span class="number">56</span> - a9 * <span class="number">92</span> + a10 * <span class="number">14</span> + a11 * <span class="number">89</span> + a12 * <span class="number">47</span> - a13 * <span class="number">61</span> - a14 * <span class="number">29</span> == <span class="number">29250</span>) </span><br><span class="line">s.add(a1 * <span class="number">95</span> + a2 * <span class="number">34</span> + a3 * <span class="number">62</span> - a4 * <span class="number">9</span> - a5 * <span class="number">43</span> + a6 * <span class="number">83</span> + a7 * <span class="number">25</span> + a8 * <span class="number">12</span> - a9 * <span class="number">36</span> + a10 * <span class="number">16</span> + a11 * <span class="number">51</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> - a14 * <span class="number">24</span> == <span class="number">15317</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sat</span><br><span class="line">[a13 = <span class="number">88</span>,</span><br><span class="line"> a3 = <span class="number">10</span>,</span><br><span class="line"> a4 = <span class="number">7</span>,</span><br><span class="line"> a10 = <span class="number">108</span>,</span><br><span class="line"> a12 = <span class="number">74</span>,</span><br><span class="line"> a1 = <span class="number">119</span>,</span><br><span class="line"> a7 = <span class="number">28</span>,</span><br><span class="line"> a6 = <span class="number">43</span>,</span><br><span class="line"> a9 = <span class="number">52</span>,</span><br><span class="line"> a14 = <span class="number">33</span>,</span><br><span class="line"> a5 = <span class="number">104</span>,</span><br><span class="line"> a8 = <span class="number">91</span>,</span><br><span class="line"> a2 = <span class="number">24</span>,</span><br><span class="line"> a11 = <span class="number">88</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">arr = [ <span class="number">10</span>,<span class="number">24</span>,<span class="number">119</span>,<span class="number">7</span>,<span class="number">104</span>,<span class="number">43</span>,<span class="number">28</span>,<span class="number">91</span>,<span class="number">108</span>,<span class="number">52</span>,<span class="number">88</span>,<span class="number">74</span>,<span class="number">88</span>,<span class="number">33</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    arr[i] = arr[i]^arr[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> arr:</span><br><span class="line">    flag += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#U_G07_th3_k3y!</span></span><br><span class="line"><span class="comment">#flag&#123;58964088b637e50d3a22b9510c1d1ef8&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="MRCTF2020-PixelShooter（apk逆向-x2F-C-逆向）"><a href="#MRCTF2020-PixelShooter（apk逆向-x2F-C-逆向）" class="headerlink" title="[MRCTF2020]PixelShooter（apk逆向&#x2F;C#逆向）"></a>[MRCTF2020]PixelShooter（apk逆向&#x2F;C#逆向）</h1><p>这次又换了一个安卓逆向工具：jeb</p>
<p>听大佬说安卓Unity游戏核心逻辑一般位于assets\bin\Data\Managed\Assembly-CSharp.dll中</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220404110438343.png" class="" title="image-20220404110438343">

<p>进入之后，搜索字符串就出来了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220404111943058.png" class="" title="image-20220404111943058">

<p>如果说是unity逆向，那么dnspy可以逆向出来啊，大佬能逆出来，为啥我逆不出来？？</p>
<p><a target="_blank" rel="noopener" href="https://ctf.ieki.xyz/contest/mrctf-2020.html">参考链接：</a></p>
<h1 id="FlareOn5-Ultimate-Minesweeper-NET逆向"><a href="#FlareOn5-Ultimate-Minesweeper-NET逆向" class="headerlink" title="[FlareOn5]Ultimate Minesweeper (.NET逆向)"></a>[FlareOn5]Ultimate Minesweeper (.NET逆向)</h1><p>dotnet题，用dnSpy64打开</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220403194941601.png" class="" title="image-20220403194941601">

<p>动调了许久，找不出门路，于是借鉴了大佬Hk_Mayfly的文章</p>
<p>首先是找到判断的主要函数处</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220403222432373.png" class="" title="image-20220403222432373">

<p>跟进SquareRevealedCallback函数，可以发现前面的if语句中输出了结束信息以及程序结束的函数，那么后面的getkey函数就是输出我们flag的函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220403222519255.png" class="" title="image-20220403222519255">

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Token: 0x0600000D RID: 13 RVA: 0x000023E4 File Offset: 0x000005E4</span></span><br><span class="line">		private <span class="built_in">string</span> <span class="title function_">GetKey</span><span class="params">(List&lt;uint&gt; revealedCells)</span></span><br><span class="line">		&#123;</span><br><span class="line">			revealedCells.Sort();</span><br><span class="line">			Random random = new Random(Convert.ToInt32((revealedCells[<span class="number">0</span>] &lt;&lt; <span class="number">20</span>) | (revealedCells[<span class="number">1</span>] &lt;&lt; <span class="number">10</span>) | revealedCells[<span class="number">2</span>]));</span><br><span class="line">			byte[] <span class="built_in">array</span> = new byte[<span class="number">32</span>];</span><br><span class="line">			byte[] array2 = new byte[]</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="number">245</span>, <span class="number">75</span>, <span class="number">65</span>, <span class="number">142</span>, <span class="number">68</span>, <span class="number">71</span>, <span class="number">100</span>, <span class="number">185</span>, <span class="number">74</span>, <span class="number">127</span>,</span><br><span class="line">				<span class="number">62</span>, <span class="number">130</span>, <span class="number">231</span>, <span class="number">129</span>, <span class="number">254</span>, <span class="number">243</span>, <span class="number">28</span>, <span class="number">58</span>, <span class="number">103</span>, <span class="number">179</span>,</span><br><span class="line">				<span class="number">60</span>, <span class="number">91</span>, <span class="number">195</span>, <span class="number">215</span>, <span class="number">102</span>, <span class="number">145</span>, <span class="number">154</span>, <span class="number">27</span>, <span class="number">57</span>, <span class="number">231</span>,</span><br><span class="line">				<span class="number">241</span>, <span class="number">86</span></span><br><span class="line">			&#125;;</span><br><span class="line">			random.NextBytes(<span class="built_in">array</span>);</span><br><span class="line">			uint num = <span class="number">0U</span>;</span><br><span class="line">			<span class="keyword">while</span> ((ulong)num &lt; (ulong)((<span class="type">long</span>)array2.Length))</span><br><span class="line">			&#123;</span><br><span class="line">				byte[] array3 = array2;</span><br><span class="line">				uint num2 = num;</span><br><span class="line">				array3[(<span class="type">int</span>)num2] = array3[(<span class="type">int</span>)num2] ^ <span class="built_in">array</span>[(<span class="type">int</span>)num];</span><br><span class="line">				num += <span class="number">1U</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> Encoding.ASCII.GetString(array2);</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>我们将SquareRevealedCallback函数中的if语句注释掉，就不会弹出失败信息了，右键，编辑方法。</p>
<p>接着是将文件保存，ctrl+shift+s，选择一个目录保存</p>
<p>然后打开文件，找到关键点</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220403222156134.png" class="" title="image-20220403222156134">

<p>后面一次点击这3个点，就可以成功输出flag</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220403222117643.png" class="" title="image-20220403222117643">

<p>flag{<a href="mailto:&#67;&#x68;&#51;&#x61;&#116;&#x65;&#114;&#115;&#x5f;&#65;&#108;&#119;&#52;&#x79;&#115;&#95;&#x57;&#49;&#110;&#64;&#102;&#108;&#97;&#114;&#x65;&#x2d;&#111;&#x6e;&#46;&#99;&#111;&#109;">&#67;&#x68;&#51;&#x61;&#116;&#x65;&#114;&#115;&#x5f;&#65;&#108;&#119;&#52;&#x79;&#115;&#95;&#x57;&#49;&#110;&#64;&#102;&#108;&#97;&#114;&#x65;&#x2d;&#111;&#x6e;&#46;&#99;&#111;&#109;</a>}</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mayfly-nymph/p/13185584.html">参考</a></p>
<h1 id="网鼎杯-2020-青龙组-jocker-混淆-动调"><a href="#网鼎杯-2020-青龙组-jocker-混淆-动调" class="headerlink" title="[网鼎杯 2020 青龙组]jocker [混淆+动调]"></a>[网鼎杯 2020 青龙组]jocker [混淆+动调]</h1><p>又遇到了混淆题……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220403194409093.png" class="" title="image-20220403194409093">

<p>一眼就看出来前面的是假把戏，只有最后的encrypt才是真正的加密函数，还进行了混淆。</p>
<p>上idc代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;idc.idc&gt;</span></span></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> addr = <span class="number">0x401500</span>;</span><br><span class="line">    <span class="keyword">auto</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt;= <span class="number">186</span>;i++)&#123;</span><br><span class="line">        PatchByte((addr+i),(addr+i)^<span class="number">0x41</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在运行idc代码之后，修改一下函数，再跳过for循环，应用补丁，删除ida数据库，重新加载后，呈现出来的mian函数就是这样：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> Str[<span class="number">50</span>]; <span class="comment">// [esp+12h] [ebp-96h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Destination[<span class="number">80</span>]; <span class="comment">// [esp+44h] [ebp-64h] BYREF</span></span><br><span class="line">  DWORD flOldProtect; <span class="comment">// [esp+94h] [ebp-14h] BYREF</span></span><br><span class="line">  <span class="type">size_t</span> v7; <span class="comment">// [esp+98h] [ebp-10h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [esp+9Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input you flag:&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !VirtualProtect(encrypt, <span class="number">0xC8</span>u, <span class="number">4u</span>, &amp;flOldProtect) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%40s&quot;</span>, Str);</span><br><span class="line">  v7 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">  <span class="keyword">if</span> ( v7 != <span class="number">24</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">strcpy</span>(Destination, Str);</span><br><span class="line">  wrong(Str);</span><br><span class="line">  omg(Str);</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( encrypt(Destination) )</span><br><span class="line">    finally(Destination);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再稍微修改一下encrypt函数，以及函数的范围</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">encrypt</span><span class="params">(<span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v2[<span class="number">19</span>]; <span class="comment">// [esp+1Ch] [ebp-6Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [esp+68h] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+6Ch] [ebp-1Ch]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">1</span>;</span><br><span class="line">  qmemcpy(v2, &amp;unk_403040, <span class="keyword">sizeof</span>(v2));</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">18</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">char</span>)(a1[i] ^ aHahahahaDoYouF[i]) != v2[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;wrong ~&quot;</span>);</span><br><span class="line">      v3 = <span class="number">0</span>;</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;come here&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>还有finally函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">finally</span><span class="params">(<span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v3[<span class="number">9</span>]; <span class="comment">// [esp+13h] [ebp-15h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(v3, <span class="string">&quot;%tp&amp;:&quot;</span>);</span><br><span class="line">  v1 = time(<span class="number">0</span>);</span><br><span class="line">  srand(v1);</span><br><span class="line">  v4 = rand() % <span class="number">100</span>;</span><br><span class="line">  v3[<span class="number">6</span>] = <span class="number">0</span>;</span><br><span class="line">  *(_WORD *)&amp;v3[<span class="number">7</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (v3[(<span class="type">unsigned</span> __int8)v3[<span class="number">5</span>]] != a1[(<span class="type">unsigned</span> __int8)v3[<span class="number">5</span>]]) == v4 )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Really??? Did you find it?OMG!!!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;I hide the last part, you will not succeed!!!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析一下encrypt函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220403190503471.png" class="" title="image-20220403190503471">

<p>input与ahh异或之后需要等于v2，动调一下v2</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220403190907891.png" class="" title="image-20220403190907891">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">v2 = [<span class="number">0xe</span>,<span class="number">0xd</span>,<span class="number">0x9</span>,<span class="number">0x6</span>,<span class="number">0x13</span>,<span class="number">0x5</span>,<span class="number">0x58</span>, <span class="number">0x56</span>, <span class="number">0x3e</span>, <span class="number">0x06</span>,<span class="number">0xc</span>, <span class="number">0x3c</span>, <span class="number">0x1f</span>, <span class="number">0x57</span>, <span class="number">0x14</span>, <span class="number">0x6b</span>, <span class="number">0x57</span>, <span class="number">0x59</span>, <span class="number">0xd</span>]</span><br><span class="line">ahh = <span class="string">&quot;hahahaha_do_you_find_me?&quot;</span></span><br><span class="line">arr = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v2)):</span><br><span class="line">	arr.append(<span class="built_in">ord</span>(ahh[i])^v2[i])</span><br><span class="line"><span class="comment"># flag&#123;d07abccf8a410c</span></span><br></pre></td></tr></table></figure>

<p>encrypt函数只能求出前19位，还有最后5位是在finally函数中</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220403191747755.png" class="" title="image-20220403191747755">

<p>v3字符串是”%tp&amp;:”，我们唯一可以确定的是最后一位是”}”，可以算出同一加密的key是多少</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">v2 = [<span class="number">0xe</span>,<span class="number">0xd</span>,<span class="number">0x9</span>,<span class="number">0x6</span>,<span class="number">0x13</span>,<span class="number">0x5</span>,<span class="number">0x58</span>, <span class="number">0x56</span>, <span class="number">0x3e</span>, <span class="number">0x06</span>,<span class="number">0xc</span>, <span class="number">0x3c</span>, <span class="number">0x1f</span>, <span class="number">0x57</span>, <span class="number">0x14</span>, <span class="number">0x6b</span>, <span class="number">0x57</span>, <span class="number">0x59</span>, <span class="number">0xd</span>]</span><br><span class="line">ahh = <span class="string">&quot;hahahaha_do_you_find_me?&quot;</span></span><br><span class="line">arr = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v2)):</span><br><span class="line">	arr.append(<span class="built_in">ord</span>(ahh[i])^v2[i])</span><br><span class="line"><span class="comment"># flag&#123;d07abccf8a410c</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;%tp&amp;:&quot;</span></span><br><span class="line">key = <span class="built_in">ord</span>(<span class="string">&quot;:&quot;</span>)^<span class="built_in">ord</span>(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="comment">#71</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">	arr.append(<span class="built_in">ord</span>(i)^<span class="number">71</span>)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> arr])</span><br><span class="line"><span class="comment">#flag&#123;d07abccf8a410cb37a&#125;</span></span><br></pre></td></tr></table></figure>





<h1 id="GWCTF-2019-re3-混淆-动调-AES"><a href="#GWCTF-2019-re3-混淆-动调-AES" class="headerlink" title="[GWCTF 2019]re3 (混淆+动调+AES)"></a>[GWCTF 2019]re3 (混淆+动调+AES)</h1><p>findcrypt查看加密</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220402205040382.png" class="" title="image-20220402205040382">



<p>再查看字符串，跟进成功的字符串</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220402205146023.png" class="" title="image-20220402205146023">

<p>发现已被混淆</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220402205219483.png" class="" title="image-20220402205219483">

<p>跟进此处，发现这是个函数，下面还调用了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220402205304814.png" class="" title="image-20220402205304814">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220402205320258.png" class="" title="image-20220402205320258">

<p>查看反汇编窗口：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220402205424401.png" class="" title="image-20220402205424401">

<p>这些数据其实是代码，经过异或之后，变成代码执行</p>
<p>shift+F2 调用idc</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;idc.idc&gt;</span></span></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="keyword">auto</span> addr = <span class="number">0x402219</span>;</span><br><span class="line"><span class="keyword">auto</span> i;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>;i&lt;<span class="number">223</span>;i++)&#123;</span><br><span class="line">    PatchByte(addr+i,Byte(addr+i)^<span class="number">0x99</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>选中修改后的数据，按c，force,转换成代码，</p>
<p>xuanzsub_402219函数，修改函数的范围</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220402211840643.png" class="" title="image-20220402211840643">



<p>tab键查看反汇编</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220402211908935.png" class="" title="image-20220402211908935">



<p>我们再修改一下main函数的值</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220402212103578.png" class="" title="image-20220402212103578">



<p>注意,修改完成之后，需要patch一下源程序，然后把ida数据库文件删除后，再用ida重新打开。而且在调试的时候，需要跳过中间的混淆函数</p>
<p>反汇编函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+8h] [rbp-48h]</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">40</span>]; <span class="comment">// [rsp+20h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%39s&quot;</span>, s);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">strlen</span>(s) != <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  mprotect(&amp;dword_400000, <span class="number">0xF000</span>uLL, <span class="number">7</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">223</span>; ++i )</span><br><span class="line">    *((_BYTE *)sub_402219 + i) ^= <span class="number">0x99</span>u;</span><br><span class="line">  sub_40207B(&amp;unk_603170);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)sub_402219(s) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mayfly-nymph/p/12829168.html">参考链接：</a></p>
<p>从后往前分析：</p>
<p>跟进最后的sub_402219函数，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_402219</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v2; <span class="comment">// [rsp+18h] [rbp-D8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-D4h]</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">200</span>]; <span class="comment">// [rsp+20h] [rbp-D0h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+E8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  sub_400A71(v4, &amp;unk_603170);</span><br><span class="line">  sub_40196E(v4, a1);</span><br><span class="line">  sub_40196E(v4, a1 + <span class="number">16</span>);</span><br><span class="line">  v2 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)(i + a1) != byte_6030A0[i] )</span><br><span class="line">      v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> sub_40196E是AES加密，sub_400A71是生成轮密钥，最后对比的byte_6030A0的值可以动调出来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">byte_6030A0 = <span class="number">0xBC0AADC0147C5ECCE0B140BC9C51D52B46B2B9434DE5324BAD7FB4B39CDB4B5B</span></span><br></pre></td></tr></table></figure>

<p>现在我们需要知道作为轮密钥的unk_603170的值</p>
<p>分析sub_402219上面的sub_40207B函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220402214440608.png" class="" title="image-20220402214440608">

<p>sub_401CF9函数，将base64的表传入，赋值给v2</p>
<p>最下面的一个函数sub_401CF9，传入参数unk_603170和v2</p>
<p>动调unk_603170的值。sub_402219中，unk_603170作为二参传入sub_400A71函数中</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220402231059344.png" class="" title="image-20220402231059344">

<p>分析其反汇编，因为参数传递是从右往左传递，通过ida动调，就能得知unk_603170</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220402230718613.png" class="" title="image-20220402230718613">

<p>shift+e数据提取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unk_603170 = <span class="number">0xcb8d493521b47a4cc1ae7e62229266ce</span></span><br></pre></td></tr></table></figure>



<ol>
<li>Base64表经过sub_40207B函数两次加密，传入unk_603170</li>
<li>使用unk_603170作为轮回密钥，进行AES加密</li>
<li>结果与byte_6030A0比较</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Palmer9/article/details/105034093">代码参考：</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">key = long_to_bytes(<span class="number">0xcb8d493521b47a4cc1ae7e62229266ce</span>)</span><br><span class="line">crypto = long_to_bytes(<span class="number">0xbc0aadc0147c5ecce0b140bc9c51d52b46b2b9434de5324bad7fb4b39cdb4b5b</span>)</span><br><span class="line">lun = AES.new(key, mode=AES.MODE_ECB)</span><br><span class="line">flag = lun.decrypt(crypto)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="RCTF2019-DontEatMe-1"><a href="#RCTF2019-DontEatMe-1" class="headerlink" title="[RCTF2019]DontEatMe"></a>[RCTF2019]DontEatMe</h1><p>迷宫题：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220329225719004.png" class="" title="image-20220329225719004">

<h1 id="红帽杯2019-xx"><a href="#红帽杯2019-xx" class="headerlink" title="[红帽杯2019] xx"></a>[红帽杯2019] xx</h1><p>上来先用findcrypt插件识别一下加密算法</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220325123615814.png" class="" title="image-20220325123615814">

<p>先是判断输入字符串长度是否等于19</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220325130821306.png" class="" title="image-20220325130821306">



<p>动调后可以看出，xxtea加密上面的代码，就是把输入字符串第四个后面的所有元素赋值为0，并把这四个字符作为二参，作为密钥，进入到xxtea加密算法中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">四参:<span class="string">&quot;qwertyuiopasdfghjklzxcvbnm1234567890&quot;</span>字符串地址</span><br><span class="line">三参:<span class="number">0x13</span></span><br><span class="line">二参:<span class="number">0x00000001000FF998</span> 地址</span><br><span class="line">一参:<span class="number">0x00000001000FF9B0</span></span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220325130556605.png" class="" title="image-20220325130556605">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220325130146968.png" class="" title="image-20220325130146968">



<p>然后是对xxtea加密后的算法进行混淆</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220325130522997.png" class="" title="image-20220325130522997">



<p>然后是进行异或操作：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220325130706622.png" class="" title="image-20220325130706622">



<p>最后是进行对比</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220325130716653.png" class="" title="image-20220325130716653">

<p>正向：</p>
<p>—-&gt;输入字符串（19位）</p>
<p>—-&gt;取前面输入的前4位作为xxtea算法密钥</p>
<p>—-&gt;xxtea算法加密</p>
<p>—-&gt;加密字符串后进行打乱置换</p>
<p>—-&gt;对打乱之后的数组进行异或</p>
<p>—-&gt;对比16进制数组</p>
<p>逆向：</p>
<p>—-&gt;得到最后对比的16进制数组</p>
<p>—-&gt;异或</p>
<p>—-&gt;恢复置换</p>
<p>—-&gt;xxtea解密</p>
<p>—-&gt;得到输入字符串</p>
<p>因为是小端序，最后对比的16进制数组应该是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data =[<span class="number">0xCE</span>,<span class="number">0xBC</span>,<span class="number">0x40</span>,<span class="number">0x6B</span>,<span class="number">0x7C</span>,<span class="number">0x3A</span>,<span class="number">0x95</span>,<span class="number">0xC0</span>,<span class="number">0xEF</span>,<span class="number">0x9B</span>,<span class="number">0x20</span>,<span class="number">0x20</span>,<span class="number">0x91</span>,<span class="number">0xF7</span>,<span class="number">0x02</span>,<span class="number">0x35</span>,<span class="number">0x23</span>,<span class="number">0x18</span>,<span class="number">0x02</span>,<span class="number">0xC8</span>,<span class="number">0xE7</span>,<span class="number">0x56</span>,<span class="number">0x56</span>,<span class="number">0xFA</span>] </span><br></pre></td></tr></table></figure>

<p>动调了一下异或，发现第一次和第二次都没有异或，第三次才异或，而且越往后，内层异或次数越多。i在外层递增遍历数组v20，i&#x2F;3的值越大，内层v20[j]与v20[i]的异或次数i&#x2F;3越多。下面是c的正向伪代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">1</span>; i &lt; <span class="number">24</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( i / <span class="number">3</span> &gt; <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v20[i] ^= v20[j++];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( j &lt; i / <span class="number">3</span> );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>下面是逆向的python代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i//<span class="number">3</span>):</span><br><span class="line">        data[i] ^= data[j]</span><br></pre></td></tr></table></figure>

<p>数组置换代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">table = &#123;<span class="number">0</span>:<span class="number">2</span>,<span class="number">1</span>:<span class="number">0</span>,<span class="number">2</span>:<span class="number">3</span>,<span class="number">3</span>:<span class="number">1</span>,<span class="number">4</span>:<span class="number">6</span>,<span class="number">5</span>:<span class="number">4</span>,<span class="number">6</span>:<span class="number">7</span>,<span class="number">7</span>:<span class="number">5</span>,<span class="number">8</span>:<span class="number">10</span>,<span class="number">9</span>:<span class="number">8</span>,<span class="number">10</span>:<span class="number">11</span>,<span class="number">11</span>:<span class="number">9</span>,<span class="number">12</span>:<span class="number">14</span>,<span class="number">13</span>:<span class="number">12</span>,<span class="number">14</span>:<span class="number">15</span>,<span class="number">15</span>:<span class="number">13</span>,<span class="number">16</span>:<span class="number">18</span>,<span class="number">17</span>:<span class="number">16</span>,<span class="number">18</span>:<span class="number">19</span>,<span class="number">19</span>:<span class="number">17</span>,<span class="number">20</span>:<span class="number">22</span>,<span class="number">21</span>:<span class="number">20</span>,<span class="number">22</span>:<span class="number">23</span>,<span class="number">23</span>:<span class="number">21</span>&#125;</span><br><span class="line"></span><br><span class="line">data1 = [<span class="number">0</span>]*<span class="built_in">len</span>(table)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">  data1[table[i]] = data[i]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data1 = [<span class="number">0xbc</span>, <span class="number">0xa5</span>, <span class="number">0xce</span>, <span class="number">0x40</span>, <span class="number">0xf4</span>, <span class="number">0xb2</span>, <span class="number">0xb2</span>, <span class="number">0xe7</span>, <span class="number">0xa9</span>, <span class="number">0x12</span>, <span class="number">0x9d</span>, <span class="number">0x12</span>, <span class="number">0xae</span>, <span class="number">0x10</span>, <span class="number">0xc8</span>, <span class="number">0x5b</span>, <span class="number">0x3d</span>, <span class="number">0xd7</span>, <span class="number">0x6</span>, <span class="number">0x1d</span>, <span class="number">0xdc</span>, <span class="number">0x70</span>, <span class="number">0xf8</span>, <span class="number">0xdc</span>]</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Moomin/p/15802972.html">xxtea 加密 python2代码</a>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct  </span><br><span class="line">  </span><br><span class="line">_DELTA = <span class="number">0x9E3779B9</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_long2str</span>(<span class="params">v, w</span>):  </span><br><span class="line">    n = (<span class="built_in">len</span>(v) - <span class="number">1</span>) &lt;&lt; <span class="number">2</span>  </span><br><span class="line">    <span class="keyword">if</span> w:  </span><br><span class="line">        m = v[-<span class="number">1</span>]  </span><br><span class="line">        <span class="keyword">if</span> (m &lt; n - <span class="number">3</span>) <span class="keyword">or</span> (m &gt; n): <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>  </span><br><span class="line">        n = m  </span><br><span class="line">    s = struct.pack(<span class="string">&#x27;&lt;%iL&#x27;</span> % <span class="built_in">len</span>(v), *v)  </span><br><span class="line">    <span class="keyword">return</span> s[<span class="number">0</span>:n] <span class="keyword">if</span> w <span class="keyword">else</span> s  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_str2long</span>(<span class="params">s, w</span>):  </span><br><span class="line">    n = <span class="built_in">len</span>(s)  </span><br><span class="line">    m = (<span class="number">4</span> - (n &amp; <span class="number">3</span>) &amp; <span class="number">3</span>) + n  </span><br><span class="line">    s = s.ljust(m, <span class="string">&quot;\0&quot;</span>)  </span><br><span class="line">    v = <span class="built_in">list</span>(struct.unpack(<span class="string">&#x27;&lt;%iL&#x27;</span> % (m &gt;&gt; <span class="number">2</span>), s))  </span><br><span class="line">    <span class="keyword">if</span> w: v.append(n)  </span><br><span class="line">    <span class="keyword">return</span> v  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params"><span class="built_in">str</span>, key</span>):  </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">str</span> == <span class="string">&#x27;&#x27;</span>: <span class="keyword">return</span> <span class="built_in">str</span>  </span><br><span class="line">    v = _str2long(<span class="built_in">str</span>, <span class="literal">True</span>)  </span><br><span class="line">    k = _str2long(key.ljust(<span class="number">16</span>, <span class="string">&quot;\0&quot;</span>), <span class="literal">False</span>)  </span><br><span class="line">    n = <span class="built_in">len</span>(v) - <span class="number">1</span>  </span><br><span class="line">    z = v[n]  </span><br><span class="line">    y = v[<span class="number">0</span>]  </span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span>  </span><br><span class="line">    q = <span class="number">6</span> + <span class="number">52</span> // (n + <span class="number">1</span>)  </span><br><span class="line">    <span class="keyword">while</span> q &gt; <span class="number">0</span>:  </span><br><span class="line">        <span class="built_in">sum</span> = (<span class="built_in">sum</span> + _DELTA) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">        e = <span class="built_in">sum</span> &gt;&gt; <span class="number">2</span> &amp; <span class="number">3</span>  </span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> xrange(n):  </span><br><span class="line">            y = v[p + <span class="number">1</span>]  </span><br><span class="line">            v[p] = (v[p] + ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (<span class="built_in">sum</span> ^ y) + (k[p &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">            z = v[p]  </span><br><span class="line">        y = v[<span class="number">0</span>]  </span><br><span class="line">        v[n] = (v[n] + ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (<span class="built_in">sum</span> ^ y) + (k[n &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">        z = v[n]  </span><br><span class="line">        q -= <span class="number">1</span>  </span><br><span class="line">    <span class="keyword">return</span> _long2str(v, <span class="literal">False</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params"><span class="built_in">str</span>, key</span>):  </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">str</span> == <span class="string">&#x27;&#x27;</span>: <span class="keyword">return</span> <span class="built_in">str</span>  </span><br><span class="line">    v = _str2long(<span class="built_in">str</span>, <span class="literal">False</span>)  </span><br><span class="line">    k = _str2long(key.ljust(<span class="number">16</span>, <span class="string">&quot;\0&quot;</span>), <span class="literal">False</span>)  </span><br><span class="line">    n = <span class="built_in">len</span>(v) - <span class="number">1</span>  </span><br><span class="line">    z = v[n]  </span><br><span class="line">    y = v[<span class="number">0</span>]  </span><br><span class="line">    q = <span class="number">6</span> + <span class="number">52</span> // (n + <span class="number">1</span>)  </span><br><span class="line">    <span class="built_in">sum</span> = (q * _DELTA) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">sum</span> != <span class="number">0</span>):  </span><br><span class="line">        e = <span class="built_in">sum</span> &gt;&gt; <span class="number">2</span> &amp; <span class="number">3</span>  </span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> xrange(n, <span class="number">0</span>, -<span class="number">1</span>):  </span><br><span class="line">            z = v[p - <span class="number">1</span>]  </span><br><span class="line">            v[p] = (v[p] - ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (<span class="built_in">sum</span> ^ y) + (k[p &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">            y = v[p]  </span><br><span class="line">        z = v[n]  </span><br><span class="line">        v[<span class="number">0</span>] = (v[<span class="number">0</span>] - ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (<span class="built_in">sum</span> ^ y) + (k[<span class="number">0</span> &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">        y = v[<span class="number">0</span>]  </span><br><span class="line">        <span class="built_in">sum</span> = (<span class="built_in">sum</span> - _DELTA) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">    <span class="keyword">return</span> _long2str(v, <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:  </span><br><span class="line">    key = <span class="string">&quot;flag&quot;</span></span><br><span class="line">    data1 = [<span class="number">0xbc</span>,<span class="number">0xa5</span>,<span class="number">0xce</span>,<span class="number">0x40</span>,<span class="number">0xf4</span>,<span class="number">0xb2</span>,<span class="number">0xb2</span>,<span class="number">0xe7</span>,<span class="number">0xa9</span>,<span class="number">0x12</span>,<span class="number">0x9d</span>,<span class="number">0x12</span>,<span class="number">0xae</span>,<span class="number">0x10</span>,<span class="number">0xc8</span>,<span class="number">0x5b</span>,<span class="number">0x3d</span>,<span class="number">0xd7</span>,<span class="number">0x6</span>,<span class="number">0x1d</span>,<span class="number">0xdc</span>,<span class="number">0x70</span>,<span class="number">0xf8</span>,<span class="number">0xdc</span>]</span><br><span class="line">    s = <span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, data1))</span><br><span class="line">    s = decrypt(s, key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">repr</span>(s))</span><br><span class="line">    <span class="comment"># flag = b&#x27;flag&#123;CXX_and_++tea&#125;&#x27;</span></span><br><span class="line">    <span class="comment"># flag = encrypt(flag,key)</span></span><br><span class="line">    <span class="comment"># print(flag)</span></span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220325145402120.png" class="" title="image-20220325145402120">

<h1 id="虎符2022-未完-fpbe"><a href="#虎符2022-未完-fpbe" class="headerlink" title="[虎符2022 未完] fpbe"></a>[虎符2022 未完] fpbe</h1><p>查看官方wp，发现使用的是另一款基于java的反汇编器：Ghidra</p>
<p>插件也下载好了，就是不会安装……没有在file下面找到extension</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220325113334811.png" class="" title="image-20220325113334811">

<h1 id="GUET-CTF2019-encrypt-RC4-x2F-elf动调-x2F-base64分块"><a href="#GUET-CTF2019-encrypt-RC4-x2F-elf动调-x2F-base64分块" class="headerlink" title="[GUET CTF2019] encrypt RC4&#x2F;elf动调&#x2F;base64分块"></a>[GUET CTF2019] encrypt RC4&#x2F;elf动调&#x2F;base64分块</h1><p>写在前面：关于elf的动调</p>
<p>把ida目录下dbgsrv的两个linux_server拖到linux需要调试的文件的文件夹中</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220321230908644.png" class="" title="image-20220321230908644">

<p>运行相关格式的linux_server</p>
<p>返回ida中，选择remote linux debugger，F9，选择相应配置</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220321202138576.png" class="" title="image-20220321202138576">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220321202532487.png" class="" title="image-20220321202532487">

<p>在程序开始的地方打上断点，按F9，就可以动调了（操作与其他动调工具一致）</p>
<p>这道题是关于<a target="_blank" rel="noopener" href="https://www.cnblogs.com/block2016/p/5601925.html">RC4的加密算法</a></p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220321235326116.png" class="" title="image-20220321235326116">

<p>算法共有三个步骤</p>
<ol>
<li>S列表和T向量的初始值，同时建立一个临时变量T，将密钥的值循环赋值到T数组中</li>
<li>S的初始置换</li>
</ol>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220322000627910.png" class="" title="image-20220321235326116">

<ol start="3">
<li>生成密码流</li>
</ol>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220322001205213.png" class="" title="image-20220321235326116">



<p>查看main函数</p>
<p>题目中给出了密钥v10数组，并作为二参进入了函数sub_4006B6</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220322005234327.png" class="" title="image-20220322005234327">



<p>跟进sub_4006B6函数，其融合了RC4加密算法的第一二步骤</p>
<p>将v9（以下统称S）数组中元素的值按升序置为0-255，题目中没有明显的赋值T向量，但效果一致</p>
<p>接下来就是swap()，打乱S数组了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220322005352665.png" class="" title="image-20220322005352665">



<p>展示一下打乱前和打乱后的S数组（大可不必）</p>
<p>打乱前：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/QQ%E5%9B%BE%E7%89%8720220321203240.png" class="" title="QQ图片20220321203127">



<p>打乱后：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/QQ%E5%9B%BE%E7%89%8720220321203127.png" class="" title="QQ图片20220321203127">



<p>跟进sub_4007DB函数，与RC4有所出入的是生成的 k（v9[(v7 + v8)]）直接与明文（s）异或了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220322001205213.png" class="" title="image-20220321235326116">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220322003023063.png" class="" title="image-20220322003023063">



<p>正向：s  –&gt;  k</p>
<p>​          k ^ 明文 &#x3D;&#x3D;&gt; 密文</p>
<p>逆向：密文 ^ k &#x3D;&#x3D;&gt; 明文</p>
<p>所以我们只需要求等式右边的k值，与密文异或，就能求出明文了（很多wp上来就是求数组S，说实话没啥用，因为k就是通过S生成的，S则是通过递增数组和密钥T数组生成的，当然也是可以求出来的）</p>
<p>动调elf文件，跟进sub_4007D8函数，光标放在22行，查看反汇编界面，rdx是异或之前的数，在其处下断点，一直F9，将k数组统计出来</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220321212045797.png" class="" title="image-20220321212045797">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">k = [<span class="number">0x10</span>,<span class="number">0x59</span>,<span class="number">0x9C</span>,<span class="number">0x92</span>,<span class="number">0x06</span>,<span class="number">0x22</span>,<span class="number">0xCF</span>,<span class="number">0xA5</span>,<span class="number">0x72</span>,<span class="number">0x1E</span>,<span class="number">0x45</span>,<span class="number">0x6A</span>,<span class="number">0x06</span>,<span class="number">0xCB</span>,<span class="number">0x08</span>,<span class="number">0xC3</span>,<span class="number">0xE4</span>,<span class="number">0x49</span>,<span class="number">0x5A</span>,<span class="number">0x63</span>,<span class="number">0x0C</span>,<span class="number">0xDF</span>,<span class="number">0xF6</span>,<span class="number">0x5F</span>,<span class="number">0x08</span>,<span class="number">0x28</span>,<span class="number">0xBD</span>,<span class="number">0xE2</span>,<span class="number">0x10</span>,<span class="number">0x15</span>,<span class="number">0x1F</span>,<span class="number">0x6E</span>,<span class="number">0xAA</span>,<span class="number">0x5A</span>,<span class="number">0xCA</span>,<span class="number">0xEC</span>,<span class="number">0x80</span>,<span class="number">0xAF</span>,<span class="number">0x9B</span>,<span class="number">0x16</span>,<span class="number">0xBB</span>,<span class="number">0x3D</span>,<span class="number">0x13</span>,<span class="number">0x2F</span>,<span class="number">0x6A</span>,<span class="number">0xA4</span>,<span class="number">0xC7</span>,<span class="number">0x2E</span>,<span class="number">0xBC</span>,<span class="number">0x4B</span>,<span class="number">0x60</span>,<span class="number">0x9A</span>,<span class="number">0xAF</span>,<span class="number">0xE9</span>,<span class="number">0xCE</span>,<span class="number">0xDA</span>,<span class="number">0x67</span>,<span class="number">0x39</span>,<span class="number">0xBA</span>,<span class="number">0x3B</span>,<span class="number">0x85</span>,<span class="number">0xEB</span>,<span class="number">0xD2</span>,<span class="number">0x6B</span>,<span class="number">0xAB</span>,<span class="number">0x06</span>,<span class="number">0x6B</span>,<span class="number">0x10</span>,<span class="number">0x57</span>,<span class="number">0x2C</span>,<span class="number">0x88</span>,<span class="number">0x70</span>,<span class="number">0xF7</span>,<span class="number">0x4F</span>,<span class="number">0xAA</span>,<span class="number">0x7F</span>,<span class="number">0x12</span>,<span class="number">0x47</span>,<span class="number">0xD6</span>,<span class="number">0xDE</span>,<span class="number">0x74</span>,<span class="number">0xB2</span>,<span class="number">0x1D</span>,<span class="number">0xA4</span>,<span class="number">0xD7</span>,<span class="number">0x76</span>,<span class="number">0x9A</span>,<span class="number">0xE0</span>]</span><br></pre></td></tr></table></figure>

<p>现在我们需要求的是密文，我们跟进下面的函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220321215126544.png" class="" title="image-20220321215126544">

<p>这边很眼熟，在base64加密中看见过，将3位字符，转换成4位字符</p>
<p>正向：rc4加密后的字符每4位转换成3位</p>
<p>逆向：最后对比的byte_602080字符，每3位转换成4位</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220321212541166.png" class="" title="image-20220321212541166">



<p>shift+e数据提取（漏了一位，记得手动添上）</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220321213410313.png" class="" title="image-20220321213410313">



<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46296905/article/details/115793801">脚本参考</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="number">0x5a</span>, <span class="number">0x60</span>, <span class="number">0x54</span>, <span class="number">0x7A</span>, <span class="number">0x7A</span>, <span class="number">0x54</span>, <span class="number">0x72</span>, <span class="number">0x44</span>,<span class="number">0x7C</span>, <span class="number">0x66</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x5B</span>, <span class="number">0x5F</span>, <span class="number">0x56</span>, <span class="number">0x56</span>,<span class="number">0x4C</span>, <span class="number">0x7C</span>, <span class="number">0x79</span>, <span class="number">0x6E</span>, <span class="number">0x65</span>, <span class="number">0x55</span>, <span class="number">0x52</span>, <span class="number">0x79</span>,<span class="number">0x55</span>, <span class="number">0x6D</span>, <span class="number">0x46</span>, <span class="number">0x6B</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0x4A</span>, <span class="number">0x67</span>,<span class="number">0x4C</span>, <span class="number">0x61</span>, <span class="number">0x73</span>, <span class="number">0x4A</span>, <span class="number">0x72</span>, <span class="number">0x6F</span>, <span class="number">0x5A</span>, <span class="number">0x70</span>,<span class="number">0x48</span>, <span class="number">0x52</span>, <span class="number">0x78</span>, <span class="number">0x49</span>, <span class="number">0x55</span>, <span class="number">0x6C</span>, <span class="number">0x48</span>, <span class="number">0x5C</span>,<span class="number">0x76</span>, <span class="number">0x5A</span>, <span class="number">0x45</span>, <span class="number">0x3D</span>]</span><br><span class="line">string = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(data),<span class="number">4</span>):</span><br><span class="line">    string += <span class="built_in">chr</span>((((data[i]-<span class="number">0x3D</span>)&amp;<span class="number">0x3F</span>)&lt;&lt;<span class="number">2</span>)|(((data[i+<span class="number">1</span>]-<span class="number">0x3D</span>)&amp;<span class="number">0x30</span>)&gt;&gt;<span class="number">4</span>))</span><br><span class="line">    string += <span class="built_in">chr</span>((((data[i+<span class="number">1</span>]-<span class="number">0x3D</span>)&amp;<span class="number">0x0F</span>)&lt;&lt;<span class="number">4</span>)|(((data[i+<span class="number">2</span>]-<span class="number">0x3D</span>)&amp;<span class="number">0x3C</span>)&gt;&gt;<span class="number">2</span>))</span><br><span class="line">    string += <span class="built_in">chr</span>(((data[i+<span class="number">3</span>]-<span class="number">0x3D</span>)&amp;<span class="number">0x3F</span>)|((data[i+<span class="number">2</span>]-<span class="number">0x3D</span>)&amp;<span class="number">0x03</span>)&lt;&lt;<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">k = [<span class="number">0x10</span>,<span class="number">0x59</span>,<span class="number">0x9C</span>,<span class="number">0x92</span>,<span class="number">0x06</span>,<span class="number">0x22</span>,<span class="number">0xCF</span>,<span class="number">0xA5</span>,<span class="number">0x72</span>,<span class="number">0x1E</span>,<span class="number">0x45</span>,<span class="number">0x6A</span>,<span class="number">0x06</span>,<span class="number">0xCB</span>,<span class="number">0x08</span>,<span class="number">0xC3</span>,<span class="number">0xE4</span>,<span class="number">0x49</span>,<span class="number">0x5A</span>,<span class="number">0x63</span>,<span class="number">0x0C</span>,<span class="number">0xDF</span>,<span class="number">0xF6</span>,<span class="number">0x5F</span>,<span class="number">0x08</span>,<span class="number">0x28</span>,<span class="number">0xBD</span>,<span class="number">0xE2</span>,<span class="number">0x10</span>,<span class="number">0x15</span>,<span class="number">0x1F</span>,<span class="number">0x6E</span>,<span class="number">0xAA</span>,<span class="number">0x5A</span>,<span class="number">0xCA</span>,<span class="number">0xEC</span>,<span class="number">0x80</span>,<span class="number">0xAF</span>,<span class="number">0x9B</span>,<span class="number">0x16</span>,<span class="number">0xBB</span>,<span class="number">0x3D</span>,<span class="number">0x13</span>,<span class="number">0x2F</span>,<span class="number">0x6A</span>,<span class="number">0xA4</span>,<span class="number">0xC7</span>,<span class="number">0x2E</span>,<span class="number">0xBC</span>,<span class="number">0x4B</span>,<span class="number">0x60</span>,<span class="number">0x9A</span>,<span class="number">0xAF</span>,<span class="number">0xE9</span>,<span class="number">0xCE</span>,<span class="number">0xDA</span>,<span class="number">0x67</span>,<span class="number">0x39</span>,<span class="number">0xBA</span>,<span class="number">0x3B</span>,<span class="number">0x85</span>,<span class="number">0xEB</span>,<span class="number">0xD2</span>,<span class="number">0x6B</span>,<span class="number">0xAB</span>,<span class="number">0x06</span>,<span class="number">0x6B</span>,<span class="number">0x10</span>,<span class="number">0x57</span>,<span class="number">0x2C</span>,<span class="number">0x88</span>,<span class="number">0x70</span>,<span class="number">0xF7</span>,<span class="number">0x4F</span>,<span class="number">0xAA</span>,<span class="number">0x7F</span>,<span class="number">0x12</span>,<span class="number">0x47</span>,<span class="number">0xD6</span>,<span class="number">0xDE</span>,<span class="number">0x74</span>,<span class="number">0xB2</span>,<span class="number">0x1D</span>,<span class="number">0xA4</span>,<span class="number">0xD7</span>,<span class="number">0x76</span>,<span class="number">0x9A</span>,<span class="number">0xE0</span>]</span><br><span class="line">arr = <span class="built_in">list</span>(string)</span><br><span class="line"></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(arr)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(arr[i])^k[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>太强了……改天得研究一下这个脚本是怎么写的</p>
<h1 id="HDCTF-MFC-Win消息发送-DES加密"><a href="#HDCTF-MFC-Win消息发送-DES加密" class="headerlink" title="[HDCTF] MFC (Win消息发送+DES加密)"></a>[HDCTF] MFC (Win消息发送+DES加密)</h1><p>刚开始用的火绒剑，感觉没啥用</p>
<p>去下了个spy类工具，用来查看windows的窗口，消息和进程等等</p>
<p>这边用的是大佬推荐的CometAssistant，彗星小助手</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317102714748.png" class="" title="image-20220317102714748">



<p>还去下载了一个spy++ (但是看着有点膈应人)</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317103503594.png" class="" title="image-20220317103503594">



<p>关于xspy的使用很简单，只需要把这个放大镜拖动放到需要嗅探的窗口中就可以了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317104050952.png" class="" title="image-20220317104050952">



<p>突破口在这边，当然也涉及我的知识盲区了：向窗口发送信息</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317104234342.png" class="" title="image-20220317104234342">



<p>这边直接把<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39268483/article/details/90611852">大佬博客</a>里的代码贴过来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;Windows.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	HWND h = ::FindWindowA(NULL, <span class="string">&quot;Flag就在控件里&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (h)</span><br><span class="line">	&#123;</span><br><span class="line">		SendMessage(h, <span class="number">0x464</span>, NULL, NULL);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		printf(<span class="string">&quot;false&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析一下：</p>
<p>首先Win32 API的使用需要导入Windows.h的库</p>
<p>FindWindowA:检索其类名和窗口名与指定字符串匹配的顶级窗口的句柄。此函数不搜索子窗口。此函数不执行区分大小写的搜索。返回值是一个窗口句柄。一参是窗口的类名，可为空。二参是窗口的标题名称。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317105237993.png" class="" title="image-20220317105237993">



<p>SendMessage:将指定的消息发送到一个或多个窗口。SendMessage函数调用指定窗口的窗口过程，直到窗口过程处理完消息后才返回。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317105528018.png" class="" title="image-20220317105528018">

<p>贴上<a target="_blank" rel="noopener" href="https://blog.csdn.net/u011392772/article/details/52245584">详细解释</a>，长话短说就是一参是接受窗口的句柄，二参是指定被发送的消息，三四参数是附加消息指定信息。</p>
<p>这个窗口的窗口名称为“Flag就在控件中”，我们就去寻找这个窗口的句柄，并赋值为h。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317105831541.png" class="" title="image-20220317105831541">



<p>找到句柄之后我们向其发送一个数字：0x464（至于为什么要发送0x464，还得让我琢磨琢磨……）</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317110051029.png" class="" title="image-20220317110051029">



<p>当发送完数字之后，窗口变了<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317110258054.png" class="" title="image-20220317110258054"></p>
<p>DES是一个常见的分组加密形式，需要一个密钥+明文&#x3D;&#x3D;&gt;明文</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317110613169.png" class="" title="image-20220317110613169">



<p>貌似这个名字就是明文了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317110759883.png" class="" title="image-20220317110759883">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">crypto: 944c8d100f82f0c18b682f63e4dbaa207a2f1e72581c2f1b</span><br><span class="line">key: &#123;I am a Des key&#125;</span><br></pre></td></tr></table></figure>





<p>flag{thIs_Is_real_kEy_hahaaa}</p>
<h1 id="CISCN2018-2ex-base64换表"><a href="#CISCN2018-2ex-base64换表" class="headerlink" title="[CISCN2018]2ex (base64换表)"></a>[CISCN2018]2ex (base64换表)</h1><p>啊这……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317002745323.png" class="" title="image-20220317002745323">

<p>放到ida中，这个字符很起疑心：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317002850142.png" class="" title="image-20220317002850142">

<p>长度竟然为64？base64换表走起：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">string =  <span class="string">&quot;|_r-+_Cl5;vgq_pdme7#7eC0=&quot;</span></span><br><span class="line"></span><br><span class="line">new_base = <span class="string">&quot;@,.1fgvw#`/2ehux$~\&quot;3dity%_;4cjsz^+&#123;5bkrA&amp;=&#125;6alqB*-[70mpC()]89noD&quot;</span></span><br><span class="line"></span><br><span class="line">base = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(string.translate(<span class="built_in">str</span>.maketrans(new_base,base)))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;change53233&#125;)&#x27;</span></span><br></pre></td></tr></table></figure>

<p>CTFtools也成，得把表中的转义字符\给去掉才行</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220317003203120.png" class="" title="image-20220317003203120">

<p>（太棒了，水了一题）</p>
<h1 id="安洵杯-2019-crackMe-SM4-base64魔改-hook"><a href="#安洵杯-2019-crackMe-SM4-base64魔改-hook" class="headerlink" title="[安洵杯 2019]crackMe (SM4+base64魔改+hook)"></a>[安洵杯 2019]crackMe (SM4+base64魔改+hook)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220315193727317.png" class="" title="image-20220315193727317">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220315193808566.png" class="" title="image-20220315193808566">

<p>搞不懂为什么我运行不起来，修复了半天，去装了个win7</p>
<p>运行之后，应该是这样的界面：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220315202648640.png" class="" title="image-20220315202648640">

<p>猜测这道题的考点是hook</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220315205054404.png" class="" title="image-20220315205054404">



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220315202709625.png" class="" title="image-20220315202709625">



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220315083636158.png" class="" title="image-20220315083636158">



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220315083753490.png" class="" title="image-20220315083753490">



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220315083904788.png" class="" title="image-20220315083904788">

<p>正向：</p>
<p>——–&gt;base64表大小写转换</p>
<p>——–&gt;SM4加密（key &#x3D; “where_are_you_now?”）</p>
<p>——–&gt;SM4加密后，密码相邻位互换</p>
<p>——–&gt;base64表，先进行大小写转换，再进行（a1+24）%64转换[相当于把字母表向左移动了24位]</p>
<p>——–&gt;base64解密</p>
<p>逆向</p>
<p>——–&gt;base64表转换（大小写与移位）</p>
<p>——–&gt;加密字符转换（相邻位置互换）</p>
<p>——–&gt;base64换表解密</p>
<p>——–&gt;SM4解密（需要pysm4的包）</p>
<p>这道base64是用”!”，来替换’&#x3D;’ ，先来转换base64的表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">base = <span class="built_in">list</span>(<span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    base[i] = base[i].swapcase()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(base))</span><br><span class="line"></span><br><span class="line">new_base = [base[(i+<span class="number">24</span>)%<span class="number">64</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(base))]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(new_base))</span><br><span class="line"><span class="comment"># new_base = yzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/abcdefghijklmnopqrstuvwx</span></span><br></pre></td></tr></table></figure>



<p>再把需要转换的字符两两转换，换表base64解码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">base = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">new_base = <span class="string">&quot;yzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/abcdefghijklmnopqrstuvwx&quot;</span></span><br><span class="line"></span><br><span class="line">raw_string = <span class="built_in">list</span>(<span class="string">&quot;1UTAOIkpyOSWGv/mOYFY4R!!&quot;</span>.replace(<span class="string">&quot;!&quot;</span>,<span class="string">&quot;=&quot;</span>))</span><br><span class="line"><span class="comment"># 1UTAOIkpyOSWGv/mOYFY4R==</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(raw_string),<span class="number">2</span>):</span><br><span class="line">	raw_string[i],raw_string[i+<span class="number">1</span>] = raw_string[i+<span class="number">1</span>],raw_string[i]</span><br><span class="line"><span class="comment"># U1ATIOpkOyWSvGm/YOYFR4==</span></span><br><span class="line"></span><br><span class="line">string = <span class="string">&quot;&quot;</span>.join(raw_string)</span><br><span class="line">s = base64.b64decode(string.translate(<span class="built_in">str</span>.maketrans(new_base,base)))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(s))</span><br><span class="line"><span class="comment"># [89, 208, 149, 41, 13, 242, 64, 6, 20, 244, 141, 39, 105, 6, 135, 78]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串转换成16进制</span></span><br><span class="line">hex_s = binascii.b2a_hex(s)</span><br><span class="line"><span class="built_in">print</span>(hex_s)</span><br><span class="line"><span class="comment"># b&#x27;59d095290df2400614f48d276906874e&#x27;</span></span><br></pre></td></tr></table></figure>



<p>然后把生成的两个16进制数:需要解密的数hex_key以及轮回秘钥hex_s，放到SM4解密函数decode()中解密，将生成的Int类型数字，转换成16进制，再转换成bytes类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> pysm4 <span class="keyword">import</span> encrypt,decrypt</span><br><span class="line">key = <span class="string">&quot;where_are_u_now?&quot;</span></span><br><span class="line">hex_key = <span class="built_in">hex</span>(binascii.b2a_hex(key.encode(<span class="string">&#x27;utf-8&#x27;</span>)))</span><br><span class="line"><span class="comment"># b&#x27;77686572655f6172655f755f6e6f773f&#x27;</span></span><br><span class="line"></span><br><span class="line">hex_s = <span class="number">0x59d095290df2400614f48d276906874e</span></span><br><span class="line">hex_key = <span class="number">0x77686572655f6172655f755f6e6f773f</span></span><br><span class="line"></span><br><span class="line">clear_num = decrypt(cipher_num, mk)</span><br><span class="line"><span class="comment"># clear_num = 110726793309279461591673877471154814753</span></span><br><span class="line"><span class="comment"># 将生成的int型结果转换成16进制字符串</span></span><br><span class="line"><span class="comment"># 再将16进制字符串去除头两位，转换成bytes类型</span></span><br><span class="line"><span class="comment"># 最后再将bytes类型编码</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span>+<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(clear_num)[<span class="number">2</span>:]).decode()+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;SM4foRExcepioN?!&#125;</span></span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220315222418372.png" class="" title="image-20220315222418372">

<p>参考链接：<a target="_blank" rel="noopener" href="http://81.69.232.121/%E5%AE%89%E6%B4%B5%E6%9D%AF-2019crackme-%E6%88%91%E4%BA%BA%E5%82%BB%E4%BA%86/">http://81.69.232.121/%E5%AE%89%E6%B4%B5%E6%9D%AF-2019crackme-%E6%88%91%E4%BA%BA%E5%82%BB%E4%BA%86/</a></p>
<h1 id="WUSTCTF2020-level4-idc-or-算法"><a href="#WUSTCTF2020-level4-idc-or-算法" class="headerlink" title="[WUSTCTF2020]level4 (idc or 算法)"></a>[WUSTCTF2020]level4 (idc or 算法)</h1><p>没想到这题竟然有三种解法，之前写这篇的时候，没有深入的研究：</p>
<p>ida打开:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  puts(&quot;Practice my Data Structure code.....&quot;);</span><br><span class="line">  puts(&quot;Typing....Struct.....char....*left....*right............emmmmm...OK!&quot;);</span><br><span class="line">  init(&quot;Typing....Struct.....char....*left....*right............emmmmm...OK!&quot;, argv);</span><br><span class="line">  puts(&quot;Traversal!&quot;);</span><br><span class="line">  printf(&quot;Traversal type 1:&quot;);</span><br><span class="line">  type1(&amp;unk_601290);</span><br><span class="line">  printf(&quot;\nTraversal type 2:&quot;);</span><br><span class="line">  type2(&amp;unk_601290);</span><br><span class="line">  printf(&quot;\nTraversal type 3:&quot;);</span><br><span class="line">  puts(&quot;    //type3(&amp;x[22]);   No way!&quot;);</span><br><span class="line">  puts(&amp;byte_400A37);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>跟进type1：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall type1(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; // rax</span><br><span class="line"></span><br><span class="line">  if ( a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    type1(*((_QWORD *)a1 + 1));</span><br><span class="line">    putchar(*a1);</span><br><span class="line">    return type1(*((_QWORD *)a1 + 2));</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br></pre></td></tr></table></figure>

<p>跟进type2:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">int __fastcall type2(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  int result; // eax</span><br><span class="line"></span><br><span class="line">  if ( a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    type2(*((_QWORD *)a1 + 1));</span><br><span class="line">    type2(*((_QWORD *)a1 + 2));</span><br><span class="line">    return putchar(*a1);</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br></pre></td></tr></table></figure>

<p>两个递归调用，可以确定type1是中序遍历二叉树，type2是后序遍历二叉树，我们需要做的就是通过type1,type2，我们可以尝试还原出二叉树的构造。</p>
<h2 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h2><p>手算，如果二叉树太大，耗时耗力。</p>
<h2 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h2><p>可以猜测出flag应为前序遍历，使用idc脚本编写</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220314232801510.png" class="" title="image-20220314232801510">

<p>跟进type2，查看反汇编代码，发现只需要调整代码块的位置，就使type2函数变成前序遍历</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">static main()</span><br><span class="line">&#123;</span><br><span class="line">    auto address1=<span class="number">0x4007CA</span>;</span><br><span class="line">    auto address2=<span class="number">0x4007EA</span>;</span><br><span class="line">    auto address3=<span class="number">0x4007FB</span>;</span><br><span class="line">    auto code1=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    auto i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(i=address1;i&lt;address2;i++)</span><br><span class="line">    &#123;</span><br><span class="line">    	code1=code1+Byte(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    j=address1;</span><br><span class="line">    <span class="keyword">for</span>(i=address2;i&lt;address3;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        PatchByte(j++,Byte(i));</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;strlen(code1);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        PatchByte(j++,<span class="built_in">ord</span>(code1[i]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220314232836202.png" class="" title="image-20220314232836202">

<p>在计算机中，汇编指令和数据其实都是一码事，都是二进制代码，为了方便使用的是16进制数，一个字节8位，使用的是两个十六进制数。Byte是根据给出的虚拟地址，取一个字节，PatchByte则是用二参的字节去patch一参的地址。</p>
<p>idc代码就是把address1-address2处的字节与address2-address3的字节交换</p>
<p>可以在这边输入6，可以看到指令的字节</p>








<p>选中代码，右键分析，强制执行之后：</p>




<p>改变前：</p>




<p>改变后：</p>




<p>别的大佬的博客用的都是keypatch插件，我是直接把对应地址的call指令重新patch了</p>




<p>最后，把patch完的程序，apply patches to应用</p>




<p>出来了：</p>




<h2 id="方法三："><a href="#方法三：" class="headerlink" title="方法三："></a>方法三：</h2><p>上手C++代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;iostream&gt;</span></span><br><span class="line">using namespace std;</span><br><span class="line">char post[] = <span class="string">&quot;20f0Th&#123;2tsIS_icArE&#125;e7__w&quot;</span>; // 后序遍历结果</span><br><span class="line">char mid[] = <span class="string">&quot;2f0t02T&#123;hcsiI_SwA__r7Ee&#125;&quot;</span>; // 中序遍历结果</span><br><span class="line">void pre(<span class="built_in">int</span> root, <span class="built_in">int</span> start, <span class="built_in">int</span> end)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (start &gt; end)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">int</span> i = start;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; end &amp;&amp; mid[i] != post[root]) i++;  //定位根在中序的位置</span><br><span class="line">    cout &lt;&lt; mid[i];  //访问当前处理的树的根</span><br><span class="line">    pre(root - <span class="number">1</span> - (end - i), start, i - <span class="number">1</span>);  //递归处理左子树</span><br><span class="line">    pre(root - <span class="number">1</span>, i + <span class="number">1</span>, end);  //递归处理右子树  </span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    pre(<span class="number">24</span>, <span class="number">0</span>, <span class="number">24</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;This_IS_A_7reE&#125;</span></span><br></pre></td></tr></table></figure>

<p>感谢师傅送我的代码！！</p>
<h1 id="CFI-CTF-2018-IntroToPE-NET逆向"><a href="#CFI-CTF-2018-IntroToPE-NET逆向" class="headerlink" title="[CFI-CTF 2018]IntroToPE (.NET逆向)"></a>[CFI-CTF 2018]IntroToPE (.NET逆向)</h1><p>打开看一下：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220311200540624.png" class="" title="image-20220311200540624">



<p>查个壳，这让我有点害怕，第一次遇到带红的</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220311200622000.png" class="" title="image-20220311200622000">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Big sec. <span class="number">1</span> .text ,  Explore <span class="keyword">and</span> analyze .NET assemblies <span class="keyword">with</span> .NET Reflector v10 - www.red-gate.com</span><br><span class="line"> - IF file <span class="keyword">is</span> packed <span class="keyword">try</span> .NET <span class="type">Generic</span> unpacker : www.quequero.org/Pack_Unpack</span><br></pre></td></tr></table></figure>

<p>还去下载了.net Reflector 和 .NET Generic unpacker</p>
<p>我们直接用dnSpy打开，</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220311205050885.png" class="" title="image-20220311205050885">

<p>找到对应的函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220311205132690.png" class="" title="image-20220311205132690">



<p>热泪盈眶</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220311205230857.png" class="" title="image-20220311205230857">

<h1 id="GXYCTF2019-simple-CPP-z3-反调试-动调"><a href="#GXYCTF2019-simple-CPP-z3-反调试-动调" class="headerlink" title="[GXYCTF2019]simple CPP (z3+反调试+动调)"></a>[GXYCTF2019]simple CPP (z3+反调试+动调)</h1><p>这题折磨的我没有脾气……</p>
<p>先查个壳，C++逆向，据我所知，c++的题目，一般都得调试……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309224035369.png" class="" title="image-20220309224035369">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309224130514.png" class="" title="image-20220309224130514">

<p>瞧瞧这是人看的题目么</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309233753899.png" class="" title="image-20220309233753899">



<p>main函数中，还出现了反调试函数，调试会崩，需要打补丁。我用ida调试了很久，太菜，无果……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309225103884.png" class="" title="image-20220309225103884">



<p>题目的意思是将输入的字符转换成16进制字符串，假设输入abc，则字符串为616263</p>
<p>我们需要求出v20数组</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220310211404233.png" class="" title="image-20220310211404233">





<p>用x,y,z,w分别代表v20[0]~v20[3]，还是耐住性子写了一遍本题的位运算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">v20[<span class="number">3</span>] = w</span><br><span class="line"></span><br><span class="line">v20[<span class="number">2</span>] = z</span><br><span class="line"></span><br><span class="line">v20[<span class="number">1</span>] = y</span><br><span class="line"></span><br><span class="line">v20[<span class="number">0</span>] = x</span><br><span class="line"></span><br><span class="line">v41 = v20[<span class="number">2</span>] = z</span><br><span class="line"></span><br><span class="line">v21 = v20[<span class="number">1</span>] = y</span><br><span class="line"></span><br><span class="line">v22 = v20[<span class="number">0</span>] = x</span><br><span class="line"></span><br><span class="line">v24 = v21 &amp; v22 = x &amp; y</span><br><span class="line"></span><br><span class="line">v25 = z &amp; ~x = <span class="number">0x11204161012</span></span><br><span class="line"></span><br><span class="line">v26 = ~v21 = ~y</span><br><span class="line"></span><br><span class="line">v27 = v41 &amp; v26 = z &amp; ~y</span><br><span class="line"></span><br><span class="line">v28 = x &amp; ~y</span><br><span class="line"></span><br><span class="line">v23[<span class="number">0</span>] = v21 &amp; v22 = x &amp; y</span><br><span class="line"></span><br><span class="line">v23[<span class="number">1</span>] = v25 = z &amp; ~x = </span><br><span class="line"></span><br><span class="line">v23[<span class="number">2</span>] = v41 &amp; v26 = z &amp; ~y</span><br><span class="line"></span><br><span class="line">v23[<span class="number">3</span>] = v28 = x &amp; ~y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">v29 = v25 | v24 | v27 | v28</span><br><span class="line">    = (z &amp; ~x)|(x &amp; y)|(z &amp; ~y)|(x &amp; ~y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">v30 = y</span><br><span class="line"></span><br><span class="line">v31 = z</span><br><span class="line"></span><br><span class="line">v32 = v27 &amp; *v20 | v31 &amp; (v24 | v30 &amp; ~*v20 | ~(v30 | *v20))</span><br><span class="line">    ==&gt; (z &amp; ~y) &amp; x | z &amp; (x &amp; y | y &amp; ~(x)) | ~(y | x)</span><br><span class="line">    ==&gt; <span class="number">0x8020717153E3013</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">v33 = v29 ==&gt; (z &amp; ~x)|(x &amp; y)|(z &amp; ~y)|(x &amp; ~y)</span><br><span class="line">	  ==&gt;  <span class="number">0x3E3A4717373E7F1F</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(v29 ^ v20[<span class="number">3</span>]) == <span class="number">0x3E3A4717050F791F</span></span><br><span class="line">==&gt; ((z &amp; ~x)|(x &amp; y)|(z &amp; ~y)|(x &amp; ~y)）^ w </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">v3 = v33</span><br><span class="line"></span><br><span class="line"> (v25 | v24 | v30 &amp; v31) == (~v20[<span class="number">0</span>] &amp; v31 | 0xC00020130082C0Ci64) &amp;&amp; v33</span><br><span class="line"></span><br><span class="line">==&gt; <span class="number">0x11204161012</span> | (x &amp; y) | (y &amp; z) == ((~x &amp; z) | <span class="number">0xC00020130082C0C</span>) &amp;&amp; <span class="number">0x3E3A4717373E7F1F</span></span><br></pre></td></tr></table></figure>

<p>在Z3中，只有BitVecs可以进行位运算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x,y,z,w=BitVecs(<span class="string">&#x27;x y z w&#x27;</span>,<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">s=Solver()</span><br><span class="line"></span><br><span class="line">s.add(z &amp; ~x == <span class="number">0x11204161012</span>)</span><br><span class="line"></span><br><span class="line">s.add(((z &amp; ~y) &amp; x | z &amp; (x &amp; y | y &amp; ~(x)) | ~(y | x)) == <span class="number">0x8020717153E3013</span>)</span><br><span class="line"></span><br><span class="line">s.add(((z &amp; ~x)|(x &amp; y)|(z &amp; ~y)|(x &amp; ~y)) == <span class="number">0x3E3A4717373E7F1F</span>)</span><br><span class="line"></span><br><span class="line">s.add(<span class="number">0x11204161012</span> | (x &amp; y) | (y &amp; z) == ((~x &amp; z) | <span class="number">0xC00020130082C0C</span>))</span><br><span class="line"></span><br><span class="line">s.add((((z &amp; ~x)|(x &amp; y)|(z &amp; ~y)|(x &amp; ~y))^ w ) == <span class="number">0x3E3A4717050F791F</span>)</span><br><span class="line"></span><br><span class="line">s.check()</span><br><span class="line"></span><br><span class="line">m = s.model()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%s = 0x%x&quot;</span>%(i,m[i].as_long()))</span><br><span class="line">y = <span class="number">0xcdc5bae9f8c9acec</span></span><br><span class="line">x = <span class="number">0x3e3a460533286f0d</span></span><br><span class="line">w = <span class="number">0x32310600</span></span><br><span class="line">z = <span class="number">0x8020717153e3013</span></span><br></pre></td></tr></table></figure>

<p>然而我的代码和大佬的代码运行结果只有一个变量不一致……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">y = <span class="number">0xc00020130082c0c</span></span><br><span class="line">x = <span class="number">0x3e3a460533286f0d</span></span><br><span class="line">w = <span class="number">0x32310600</span></span><br><span class="line">z = <span class="number">0x8020717153e3013</span></span><br></pre></td></tr></table></figure>

<p>在动调中发现了这些字符</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220310171305532.png" class="" title="image-20220310171305532">

<p>下面的代码是大佬的代码，我实在没有搞懂lis中0x8c之后的十六进制数是哪里来的……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">lis = [<span class="number">0x3E</span>,<span class="number">0x3A</span>,<span class="number">0x46</span>,<span class="number">0x05</span>,<span class="number">0x33</span>,<span class="number">0x28</span>,<span class="number">0x6F</span>,<span class="number">0x0D</span>,<span class="number">0x8C</span>,<span class="number">0x00</span>,<span class="number">0x8A</span>,<span class="number">0x09</span>,<span class="number">0x78</span>,<span class="number">0x49</span>,<span class="number">0x2C</span>,<span class="number">0xAC</span>,<span class="number">0x08</span>,<span class="number">0x02</span>,<span class="number">0x07</span>,<span class="number">0x17</span>,<span class="number">0x15</span>,<span class="number">0x3E</span>,<span class="number">0x30</span>,<span class="number">0x13</span>,<span class="number">0x32</span>,<span class="number">0x31</span>,<span class="number">0x06</span>]</span><br><span class="line">string = <span class="string">&#x27;i_will_check_is_debug_or_noi_wil&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lis)):</span><br><span class="line">	flag += <span class="built_in">chr</span>(lis[i] ^ <span class="built_in">ord</span>(string[i]))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>We1l_D0näeéb’ _ólgebra_am_i</p>
<p>第二部分的解，比赛的时候已经给出e!P0or_a</p>
<p>所以flag{We1l_D0ne!P0or_algebra_am_i}</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/mcmuyanga/article/details/113628506">https://blog.csdn.net/mcmuyanga/article/details/113628506</a></p>
<h1 id="FlareOn1-Bob-Doge-（-net逆向-dnspy逆向）"><a href="#FlareOn1-Bob-Doge-（-net逆向-dnspy逆向）" class="headerlink" title="[FlareOn1]Bob Doge （.net逆向+dnspy逆向）"></a>[FlareOn1]Bob Doge （.net逆向+dnspy逆向）</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309201356570.png" class="" title="image-20220309201356570">

<p>先查个壳，发现没有壳，c++编写</p>
<p>运行一下，发现是个安装的程序</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309201529216.png" class="" title="image-20220309201529216">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309212331545.png" class="" title="image-20220309212331545">

<p>安装成功之后，会在安装目录下，生成一个.exe文件，我们再扫个壳，这边就能看出来是C#编写的.net程序了</p>
<p>（麻了，我还以为要逆向安装程序，给我ida给我看呆了）</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309212516519.png" class="" title="image-20220309212516519">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309212439319.png" class="" title="image-20220309212439319">

<p>点击decode之后变成了doge，哈哈哈</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309212444410.png" class="" title="image-20220309212444410">

<p>我们放到dnSpy中进行反编译</p>
<p>找到加密函数之后，text3就是flag</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309213108050.png" class="" title="image-20220309213108050">

<p>断点打在加密函数最后的text3处，F5运行到这边，flag就出来了</p>
<p>（我跟个憨憨一样用逆向算法算了半天还没算出来……）</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309223124013.png" class="" title="image-20220309223124013">



<h1 id="SWPU2019-ReverseMe-（od动调plus）"><a href="#SWPU2019-ReverseMe-（od动调plus）" class="headerlink" title="[SWPU2019]ReverseMe （od动调plus）"></a>[SWPU2019]ReverseMe （od动调plus）</h1><p>首先是查壳：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309003950599.png" class="" title="image-20220309003950599">

<p>因为是c++编写的，ida静态分析难度较大，所以选择od动调分析：</p>
<p>快过来熟悉一下od的操作！！！</p>
<p>首先通过中文搜索引擎跳转到提示性语句：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309004258611.png" class="" title="image-20220309004258611">



<p>可以确定的是call语句的下一条cmp指令，与0x20，也就是32，决定是否跳转，也就是0x20是长度<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309004423566.png" class="" title="image-20220309004423566"></p>
<p>我们输入一个符合条件的数值，继续向下调试。我这边输入了32个1</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309004836629.png" class="" title="image-20220309004836629">



<p>可以看到，在执行lea语句后，esi被赋值成”SWPU_2019_CTF”</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309005103352.png" class="" title="image-20220309005103352">



<p>这边是与输入字符进行异或，ord(1) ^ ord(S) &#x3D; ord(‘b’)</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309005343600.png" class="" title="image-20220309005343600">



<p>可以在循环之外下断点，然后F9快速跳到断点出，再往下看，下面则是把数据依次压入栈：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309005758986.png" class="" title="image-20220309005758986">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309011040706.png" class="" title="image-20220309011040706">

<p>再往下看，遇到一个函数，我们进入一个函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309011104034.png" class="" title="image-20220309011104034">

<p>F7跟进，我们遇到了xor，从0xae58b8地址读取数据赋给ecx，进行异或</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309011239475.png" class="" title="image-20220309011239475">

<p>选中下面的框框，我们选择在数据窗口中跟随地址</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309011450441.png" class="" title="image-20220309011450441">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309011556186.png" class="" title="image-20220309011556186">

<p>就能看到是什么数据进行对比了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string2 = [<span class="number">0x86</span>,<span class="number">0x0C</span>,<span class="number">0x3E</span>,<span class="number">0xCA</span>,<span class="number">0x98</span>,<span class="number">0xD7</span>,<span class="number">0xAE</span>,<span class="number">0x19</span>,<span class="number">0xE2</span>,<span class="number">0x77</span>,<span class="number">0x6B</span>,<span class="number">0xA6</span>,<span class="number">0x6A</span>,<span class="number">0xA1</span>,<span class="number">0x77</span>,<span class="number">0xB0</span>,<span class="number">0x69</span>,<span class="number">0x91</span>,<span class="number">0x37</span>,<span class="number">0x05</span>,<span class="number">0x7A</span>,<span class="number">0xF9</span>,<span class="number">0x7B</span>,<span class="number">0x30</span>,<span class="number">0x43</span>,<span class="number">0x5A</span>,<span class="number">0x4B</span>,<span class="number">0x10</span>,<span class="number">0x86</span>,<span class="number">0x7D</span>,<span class="number">0xD4</span>,<span class="number">0x28</span>]</span><br></pre></td></tr></table></figure>



<p>跳出这个函数之后，接着往下看：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309012131724.png" class="" title="image-20220309012131724">



<p>开始了第三次异或，和第二次一样，我们只需要找这个地址的数据就行了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309012506507.png" class="" title="image-20220309012506507">

<p>继续跟随数据窗口，跳转如下，我们找到了需要最终对比的数据了：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220309012617489.png" class="" title="image-20220309012617489">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">final = [<span class="number">0xB3</span>,<span class="number">0x37</span>,<span class="number">0x0F</span>,<span class="number">0xF8</span>,<span class="number">0xBC</span>,<span class="number">0xBC</span>,<span class="number">0xAE</span>,<span class="number">0x5D</span>,<span class="number">0xBA</span>,<span class="number">0x5A</span>,<span class="number">0x4D</span>,<span class="number">0x86</span>,<span class="number">0x44</span>,<span class="number">0x97</span>,<span class="number">0x62</span>,<span class="number">0xD3</span>,<span class="number">0x4F</span>,<span class="number">0xBA</span>,<span class="number">0x24</span>,<span class="number">0x16</span>,<span class="number">0x0B</span>,<span class="number">0x9F</span>,<span class="number">0x72</span>,<span class="number">0x1A</span>,<span class="number">0x65</span>,<span class="number">0x68</span>,<span class="number">0x6D</span>,<span class="number">0x26</span>,<span class="number">0xBA</span>,<span class="number">0x6B</span>,<span class="number">0xC8</span>,<span class="number">0x67</span>]</span><br></pre></td></tr></table></figure>

<p>最终脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 正  final[i] = input[i]^string1[i%13]^string2[i]</span></span><br><span class="line"><span class="comment"># 逆  input[i] = final[i]^string1[i%13]^string2[i]</span></span><br><span class="line"></span><br><span class="line">string1 = <span class="string">&quot;SWPU_2019_CTF&quot;</span></span><br><span class="line">string2 = [<span class="number">0x86</span>,<span class="number">0x0C</span>,<span class="number">0x3E</span>,<span class="number">0xCA</span>,<span class="number">0x98</span>,<span class="number">0xD7</span>,<span class="number">0xAE</span>,<span class="number">0x19</span>,<span class="number">0xE2</span>,<span class="number">0x77</span>,<span class="number">0x6B</span>,<span class="number">0xA6</span>,<span class="number">0x6A</span>,<span class="number">0xA1</span>,<span class="number">0x77</span>,<span class="number">0xB0</span>,<span class="number">0x69</span>,<span class="number">0x91</span>,<span class="number">0x37</span>,<span class="number">0x05</span>,<span class="number">0x7A</span>,<span class="number">0xF9</span>,<span class="number">0x7B</span>,<span class="number">0x30</span>,<span class="number">0x43</span>,<span class="number">0x5A</span>,<span class="number">0x4B</span>,<span class="number">0x10</span>,<span class="number">0x86</span>,<span class="number">0x7D</span>,<span class="number">0xD4</span>,<span class="number">0x28</span>]</span><br><span class="line">final = [<span class="number">0xB3</span>,<span class="number">0x37</span>,<span class="number">0x0F</span>,<span class="number">0xF8</span>,<span class="number">0xBC</span>,<span class="number">0xBC</span>,<span class="number">0xAE</span>,<span class="number">0x5D</span>,<span class="number">0xBA</span>,<span class="number">0x5A</span>,<span class="number">0x4D</span>,<span class="number">0x86</span>,<span class="number">0x44</span>,<span class="number">0x97</span>,<span class="number">0x62</span>,<span class="number">0xD3</span>,<span class="number">0x4F</span>,<span class="number">0xBA</span>,<span class="number">0x24</span>,<span class="number">0x16</span>,<span class="number">0x0B</span>,<span class="number">0x9F</span>,<span class="number">0x72</span>,<span class="number">0x1A</span>,<span class="number">0x65</span>,<span class="number">0x68</span>,<span class="number">0x6D</span>,<span class="number">0x26</span>,<span class="number">0xBA</span>,<span class="number">0x6B</span>,<span class="number">0xC8</span>,<span class="number">0x67</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(final[i] ^ <span class="built_in">ord</span>(string1[i%<span class="number">13</span>]) ^ string2[i])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{Y0uaretheB3st!#@_VirtualCC}</p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://blog.nowcoder.net/n/aa8086cbf8c54e3b8dd49c52e2fcefe0?from=nowcoder_improve">https://blog.nowcoder.net/n/aa8086cbf8c54e3b8dd49c52e2fcefe0?from=nowcoder_improve</a></p>
<h1 id="SCTF2019-babyre-花指令-三维迷宫-暗藏base64-？？？"><a href="#SCTF2019-babyre-花指令-三维迷宫-暗藏base64-？？？" class="headerlink" title="[SCTF2019]babyre (花指令+三维迷宫+暗藏base64+？？？)"></a>[SCTF2019]babyre (花指令+三维迷宫+暗藏base64+？？？)</h1><p>ida打开后一瞅，我就知道事情不简单</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306104701878.png" class="" title="image-20220306104701878">

<p>发现了海量的花指令</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306105500667.png" class="" title="image-20220306105500667">



<p>第一处：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306131847033.png" class="" title="image-20220306131847033">

<p>修改之后</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306132014745.png" class="" title="image-20220306132014745">



<p>第二处，下面的jrcxz也需要nop掉(细节上出问题后面就得重修……)</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306132055354.png" class="" title="image-20220306132055354">



<p>第三处：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306132342638.png" class="" title="image-20220306132342638">



<p>第四处：</p>
<p>E13处，in指令第二个字节C7是mov指令，就需要去把第一个字节给nop掉了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306132452508.png" class="" title="image-20220306132452508">



<p>第五处：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306132551211.png" class="" title="image-20220306132551211">



<p>所以说，一共 是五处花指令？</p>
<p>下面是转换main函数，快捷键P</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306132839185.png" class="" title="image-20220306132839185">



<p>这边的话，先d键，转换为数据，再c键，force转换为代码</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306133037006.png" class="" title="image-20220306133037006">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306133108826.png" class="" title="image-20220306133108826">



<p>（注意，需要把所有的花指令修完之后，再去转换main函数和C22函数，重复了n次，每次都再C22处JUMPOUT）</p>
<p>选中798到C21，按P键转换成函数，还原main函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306114858341.png" class="" title="image-20220306114858341">



<p>这边也类似，选中到c22，按住P键，就可以把刚刚的loc_C22声明成函数，之后就可以F5反汇编了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306115041398.png" class="" title="image-20220306115041398">

<p>以下就是成功反汇编出的主函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall main(<span class="built_in">int</span> a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  char v4; // [rsp+Fh] [rbp-151h]</span><br><span class="line">  <span class="built_in">int</span> v5; // [rsp+10h] [rbp-150h]</span><br><span class="line">  <span class="built_in">int</span> v6; // [rsp+14h] [rbp-14Ch]</span><br><span class="line">  char *v7; // [rsp+18h] [rbp-148h]</span><br><span class="line">  char v8[<span class="number">10</span>]; // [rsp+26h] [rbp-13Ah] BYREF</span><br><span class="line">  _QWORD input3[<span class="number">2</span>]; // [rsp+30h] [rbp-130h] BYREF</span><br><span class="line">  <span class="built_in">int</span> v10; // [rsp+40h] [rbp-120h]</span><br><span class="line">  __int64 input2[<span class="number">3</span>]; // [rsp+50h] [rbp-<span class="number">1</span>10h] BYREF</span><br><span class="line">  char v12; // [rsp+68h] [rbp-F8h]</span><br><span class="line">  __int64 v13[<span class="number">3</span>]; // [rsp+70h] [rbp-F0h] BYREF</span><br><span class="line">  char v14; // [rsp+88h] [rbp-D8h]</span><br><span class="line">  __int64 input1[<span class="number">6</span>]; // [rsp+90h] [rbp-D0h] BYREF</span><br><span class="line">  __int16 v16; // [rsp+C0h] [rbp-A0h]</span><br><span class="line">  char v17[<span class="number">136</span>]; // [rsp+D0h] [rbp-90h] BYREF</span><br><span class="line">  unsigned __int64 v18; // [rsp+158h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v18 = __readfsqword(0x28u);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  memset(input2, <span class="number">0</span>, sizeof(input2));</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  memset(v13, <span class="number">0</span>, sizeof(v13));</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  memset(input1, <span class="number">0</span>, sizeof(input1));</span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">  strcpy(</span><br><span class="line">    v17,</span><br><span class="line">    <span class="string">&quot;**************.****.**s..*..******.****.***********..***..**..#*..***..***.********************.**..*******..**...*..*.*.**.*&quot;</span>);</span><br><span class="line">  input3[<span class="number">0</span>] = 0LL;</span><br><span class="line">  input3[<span class="number">1</span>] = 0LL;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v7 = &amp;v17[<span class="number">22</span>];</span><br><span class="line">  strcpy(v8, <span class="string">&quot;sctf_9102&quot;</span>);</span><br><span class="line">  puts((const char *)(unsigned <span class="built_in">int</span>)<span class="string">&quot;plz tell me the shortest password1:&quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%s&quot;</span>, input1);</span><br><span class="line">  v6 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = *((_BYTE *)input1 + v5);</span><br><span class="line">    switch ( v4 )</span><br><span class="line">    &#123;</span><br><span class="line">      case <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">        v7 -= <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      case <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">        v7 += <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      case <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">        ++v7;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      case <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">        --v7;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      case <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">        v7 += <span class="number">25</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      case <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">        v7 -= <span class="number">25</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      default:</span><br><span class="line">        v6 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v5;</span><br><span class="line">    <span class="keyword">if</span> ( *v7 != <span class="number">46</span> &amp;&amp; *v7 != <span class="number">35</span> )</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( *v7 == <span class="number">35</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      puts(<span class="string">&quot;good!you find the right way!\nBut there is another challenge!&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    puts((const char *)(unsigned <span class="built_in">int</span>)<span class="string">&quot;plz tell me the password2:&quot;</span>);</span><br><span class="line">    scanf(<span class="string">&quot;%s&quot;</span>, input2);</span><br><span class="line">    sub_C22(input2, v13);</span><br><span class="line">    <span class="keyword">if</span> ( (unsigned <span class="built_in">int</span>)sub_F67(v13, v8) == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      puts(<span class="string">&quot;Congratulation!&quot;</span>);</span><br><span class="line">      puts((const char *)(unsigned <span class="built_in">int</span>)<span class="string">&quot;Now,this is the last!&quot;</span>);</span><br><span class="line">      puts(<span class="string">&quot;plz tell me the password3:&quot;</span>);</span><br><span class="line">      scanf(<span class="string">&quot;%s&quot;</span>, input3);</span><br><span class="line">      <span class="keyword">if</span> ( (unsigned <span class="built_in">int</span>)sub_FFA(input3) == <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        puts(<span class="string">&quot;Congratulation!Here is your flag!:&quot;</span>);</span><br><span class="line">        printf(<span class="string">&quot;sctf&#123;%s-%s(%s)&#125;&quot;</span>, (const char *)input1, (const char *)input2, (const char *)input3);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        printf(<span class="string">&quot;something srong...&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> 0LL;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      printf(<span class="string">&quot;sorry,somthing wrong...&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> 0LL;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;sorry,is&#x27;t not a right way...&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> 0LL;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看出这是个迷宫题，而且看起来方向键很多，是三维迷宫，长度为125 &#x3D; 5 * 5 * 5</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">maze = <span class="string">&#x27;**************.****.**s..*..******.****.***********..***..**..#*..***..***.********************.**..*******..**...*..*.*.**.*&#x27;</span></span><br><span class="line"></span><br><span class="line">maze_3d = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    maze_3d.append(maze[<span class="number">5</span>*i:<span class="number">5</span>*(i+<span class="number">1</span>)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(maze_3d)+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> maze_3d[i]:</span><br><span class="line">        <span class="built_in">print</span>(j,end = <span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306120424011.png" class="" title="image-20220306120424011">

<p>得出：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input1 = <span class="string">&#x27;ddwwxssxaxwwaasasyywwdd&#x27;</span></span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306122319333.png" class="" title="image-20220306122319333">



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306165135146.png" class="" title="image-20220306165135146">

<p>第二个挑战，就是每输入四个字符，就将其转换成3个字符：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306165152571.png" class="" title="image-20220306165152571">

<p>下面附上<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46296905/article/details/115731435?ops_request_misc=%7B%22request_id%22:%22164655410816781683929544%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=164655410816781683929544&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-8-115731435.pc_search_result_cache&utm_term=%5BSCTTF2019%5Dbabyre&spm=1018.2226.3001.4187">大佬的爆破代码</a>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">unsigned <span class="built_in">int</span> data[<span class="number">128</span>] = &#123;</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x3E</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x3F</span>,</span><br><span class="line">    <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x3A</span>, <span class="number">0x3B</span>,</span><br><span class="line">    <span class="number">0x3C</span>, <span class="number">0x3D</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x40</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>,</span><br><span class="line">    <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>,</span><br><span class="line">    <span class="number">0x0F</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>,</span><br><span class="line">    <span class="number">0x17</span>, <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x1C</span>, <span class="number">0x1D</span>, <span class="number">0x1E</span>, <span class="number">0x1F</span>, <span class="number">0x20</span>,</span><br><span class="line">    <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x23</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x27</span>, <span class="number">0x28</span>,</span><br><span class="line">    <span class="number">0x29</span>, <span class="number">0x2A</span>, <span class="number">0x2B</span>, <span class="number">0x2C</span>, <span class="number">0x2D</span>, <span class="number">0x2E</span>, <span class="number">0x2F</span>, <span class="number">0x30</span>,</span><br><span class="line">    <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> shuju[<span class="number">3</span>] = &#123; <span class="number">0x736374</span>,<span class="number">0x665f39</span>,<span class="number">0x313032</span> &#125;;</span><br><span class="line">    <span class="built_in">int</span> i0, i1, i2, i3, i4, i5;</span><br><span class="line">    <span class="keyword">for</span> (i0 = <span class="number">0</span>; i0 &lt; <span class="number">3</span>; i0++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i1=<span class="number">32</span>;i1&lt;<span class="number">128</span>;i1++)</span><br><span class="line">            <span class="keyword">for</span> (i2 = <span class="number">32</span>; i2 &lt; <span class="number">128</span>; i2++)</span><br><span class="line">                <span class="keyword">for</span> (i3 = <span class="number">32</span>; i3 &lt; <span class="number">128</span>; i3++)</span><br><span class="line">                    <span class="keyword">for</span> (i4 = <span class="number">32</span>; i4 &lt; <span class="number">128</span>; i4++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        i5 = (((((data[i1] &lt;&lt; <span class="number">6</span>) | data[i2]) &lt;&lt; <span class="number">6</span>) | data[i3]) &lt;&lt; <span class="number">6</span>) | data[i4];</span><br><span class="line">                        <span class="keyword">if</span> (i5 == shuju[i0])</span><br><span class="line">                            printf(<span class="string">&quot;第%d组：%c%c%c%c\n&quot;</span>, i0+<span class="number">1</span>,i1, i2, i3, i4);</span><br><span class="line">                    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306164930776.png" class="" title="image-20220306164930776">

<p>每个都带进入算了一遍，得知：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input2 = <span class="string">&quot;c2N0Zl85MTAy&quot;</span></span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306165055765.png" class="" title="image-20220306165055765">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306165726378.png" class="" title="image-20220306165726378">

<p>麻了，每四位转换成3位，就是唯一不同的地方是，缺4补上@，就是base64加密啊……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306170205538.png" class="" title="image-20220306170205538">

<p>最后进入第三个challenge，参考的是<a target="_blank" rel="noopener" href="http://81.69.232.121/sctf2019babyre/">这位大佬</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall sub_FFA(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> v2; // [rsp+18h] [rbp-158h]</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+18h] [rbp-158h]</span><br><span class="line">  <span class="built_in">int</span> v4; // [rsp+1Ch] [rbp-154h]</span><br><span class="line">  unsigned <span class="built_in">int</span> v5; // [rsp+24h] [rbp-14Ch]</span><br><span class="line">  unsigned <span class="built_in">int</span> v6; // [rsp+28h] [rbp-148h]</span><br><span class="line">  unsigned <span class="built_in">int</span> v7; // [rsp+2Ch] [rbp-144h]</span><br><span class="line">  <span class="built_in">int</span> v8[<span class="number">16</span>]; // [rsp+30h] [rbp-140h]</span><br><span class="line">  <span class="built_in">int</span> v9[<span class="number">16</span>]; // [rsp+70h] [rbp-100h]</span><br><span class="line">  <span class="built_in">int</span> v10[<span class="number">26</span>]; // [rsp+B0h] [rbp-C0h]</span><br><span class="line">  unsigned <span class="built_in">int</span> v11; // [rsp+118h] [rbp-58h]</span><br><span class="line">  unsigned <span class="built_in">int</span> v12; // [rsp+11Ch] [rbp-54h]</span><br><span class="line">  unsigned <span class="built_in">int</span> v13; // [rsp+120h] [rbp-50h]</span><br><span class="line">  unsigned <span class="built_in">int</span> v14; // [rsp+124h] [rbp-4Ch]</span><br><span class="line">  unsigned __int64 v15; // [rsp+168h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v15 = __readfsqword(0x28u);</span><br><span class="line">  v8[<span class="number">0</span>] = <span class="number">190</span>;</span><br><span class="line">  v8[<span class="number">1</span>] = <span class="number">4</span>;</span><br><span class="line">  v8[<span class="number">2</span>] = <span class="number">6</span>;</span><br><span class="line">  v8[<span class="number">3</span>] = <span class="number">128</span>;</span><br><span class="line">  v8[<span class="number">4</span>] = <span class="number">197</span>;</span><br><span class="line">  v8[<span class="number">5</span>] = <span class="number">175</span>;</span><br><span class="line">  v8[<span class="number">6</span>] = <span class="number">118</span>;</span><br><span class="line">  v8[<span class="number">7</span>] = <span class="number">71</span>;</span><br><span class="line">  v8[<span class="number">8</span>] = <span class="number">159</span>;</span><br><span class="line">  v8[<span class="number">9</span>] = <span class="number">204</span>;</span><br><span class="line">  v8[<span class="number">10</span>] = <span class="number">64</span>;</span><br><span class="line">  v8[<span class="number">11</span>] = <span class="number">31</span>;</span><br><span class="line">  v8[<span class="number">12</span>] = <span class="number">216</span>;</span><br><span class="line">  v8[<span class="number">13</span>] = <span class="number">191</span>;</span><br><span class="line">  v8[<span class="number">14</span>] = <span class="number">146</span>;</span><br><span class="line">  v8[<span class="number">15</span>] = <span class="number">239</span>;</span><br><span class="line">  v5 = (a1[<span class="number">6</span>] &lt;&lt; <span class="number">8</span>) | (a1[<span class="number">5</span>] &lt;&lt; <span class="number">16</span>) | (a1[<span class="number">4</span>] &lt;&lt; <span class="number">24</span>) | a1[<span class="number">7</span>];</span><br><span class="line">  v6 = (a1[<span class="number">10</span>] &lt;&lt; <span class="number">8</span>) | (a1[<span class="number">9</span>] &lt;&lt; <span class="number">16</span>) | (a1[<span class="number">8</span>] &lt;&lt; <span class="number">24</span>) | a1[<span class="number">11</span>];</span><br><span class="line">  v7 = (a1[<span class="number">14</span>] &lt;&lt; <span class="number">8</span>) | (a1[<span class="number">13</span>] &lt;&lt; <span class="number">16</span>) | (a1[<span class="number">12</span>] &lt;&lt; <span class="number">24</span>) | a1[<span class="number">15</span>];</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v2 = <span class="number">4</span>;</span><br><span class="line">  v10[<span class="number">0</span>] = sub_78A((a1[<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | (a1[<span class="number">1</span>] &lt;&lt; <span class="number">16</span>) | (*a1 &lt;&lt; <span class="number">24</span>) | a1[<span class="number">3</span>]);</span><br><span class="line">  v10[<span class="number">1</span>] = sub_78A(v5);</span><br><span class="line">  v10[<span class="number">2</span>] = sub_78A(v6);</span><br><span class="line">  v10[<span class="number">3</span>] = sub_78A(v7);</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    v10[v2] = sub_143B(v10[v4], v10[v4 + <span class="number">1</span>], v10[v4 + <span class="number">2</span>], v10[v4 + <span class="number">3</span>]);</span><br><span class="line">    ++v4;</span><br><span class="line">    ++v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v2 &lt;= <span class="number">29</span> );</span><br><span class="line">  v9[<span class="number">0</span>] = HIBYTE(v11);</span><br><span class="line">  v9[<span class="number">1</span>] = BYTE2(v11);</span><br><span class="line">  v9[<span class="number">2</span>] = BYTE1(v11);</span><br><span class="line">  v9[<span class="number">3</span>] = v11;</span><br><span class="line">  v9[<span class="number">4</span>] = HIBYTE(v12);</span><br><span class="line">  v9[<span class="number">5</span>] = BYTE2(v12);</span><br><span class="line">  v9[<span class="number">6</span>] = BYTE1(v12);</span><br><span class="line">  v9[<span class="number">7</span>] = v12;</span><br><span class="line">  v9[<span class="number">8</span>] = HIBYTE(v13);</span><br><span class="line">  v9[<span class="number">9</span>] = BYTE2(v13);</span><br><span class="line">  v9[<span class="number">10</span>] = BYTE1(v13);</span><br><span class="line">  v9[<span class="number">11</span>] = v13;</span><br><span class="line">  v9[<span class="number">12</span>] = HIBYTE(v14);</span><br><span class="line">  v9[<span class="number">13</span>] = BYTE2(v14);</span><br><span class="line">  v9[<span class="number">14</span>] = BYTE1(v14);</span><br><span class="line">  v9[<span class="number">15</span>] = v14;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v9[i] != v8[i] )</span><br><span class="line">      <span class="keyword">return</span> 0xFFFFFFFFLL;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> 1LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306170406783.png" class="" title="image-20220306170406783">

<p>跟进这个函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306170442709.png" class="" title="image-20220306170442709">

<p>因为v2 初始等于 4 , v4 初始等于 0 ，上面的代码就可以转换成：</p>
<p>v10[n+4] &#x3D; v10[n] ^ function(v10[a+1] ^ v10[a+2] ^ v10[a+3])</p>
<p>根据交换律</p>
<p>&#x3D;&#x3D;&gt;v10[n] &#x3D; v10[n+4] ^ function(v10[a+1] ^ v10[a+2] ^ v10[a+3])</p>
<p>这样就可以通过后四位逆推前一位（心态已经崩了）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">v3 = [<span class="number">214</span>, <span class="number">144</span>, <span class="number">233</span>, <span class="number">254</span>, <span class="number">204</span>, <span class="number">225</span>, <span class="number">61</span>, <span class="number">183</span>, <span class="number">22</span>, <span class="number">182</span>, <span class="number">20</span>, <span class="number">194</span>, <span class="number">40</span>, <span class="number">251</span>, <span class="number">44</span>, <span class="number">5</span>, <span class="number">43</span>, <span class="number">103</span>, <span class="number">154</span>, <span class="number">118</span>, <span class="number">42</span>, <span class="number">190</span>, <span class="number">4</span>, <span class="number">195</span>, <span class="number">170</span>, <span class="number">68</span>, <span class="number">19</span>, <span class="number">38</span>, <span class="number">73</span>, <span class="number">134</span>, <span class="number">6</span>, <span class="number">153</span>, <span class="number">156</span>, <span class="number">66</span>, <span class="number">80</span>, <span class="number">244</span>, <span class="number">145</span>, <span class="number">239</span>, <span class="number">152</span>, <span class="number">122</span>, <span class="number">51</span>, <span class="number">84</span>, <span class="number">11</span>, <span class="number">67</span>, <span class="number">237</span>, <span class="number">207</span>, <span class="number">172</span>, <span class="number">98</span>, <span class="number">228</span>, <span class="number">179</span>, <span class="number">28</span>, <span class="number">169</span>, <span class="number">201</span>, <span class="number">8</span>, <span class="number">232</span>, <span class="number">149</span>, <span class="number">128</span>, <span class="number">223</span>, <span class="number">148</span>, <span class="number">250</span>, <span class="number">117</span>, <span class="number">143</span>, <span class="number">63</span>, <span class="number">166</span>, <span class="number">71</span>, <span class="number">7</span>, <span class="number">167</span>, <span class="number">252</span>, <span class="number">243</span>, <span class="number">115</span>, <span class="number">23</span>, <span class="number">186</span>, <span class="number">131</span>, <span class="number">89</span>, <span class="number">60</span>, <span class="number">25</span>, <span class="number">230</span>, <span class="number">133</span>, <span class="number">79</span>, <span class="number">168</span>, <span class="number">104</span>, <span class="number">107</span>, <span class="number">129</span>, <span class="number">178</span>, <span class="number">113</span>, <span class="number">100</span>, <span class="number">218</span>, <span class="number">139</span>, <span class="number">248</span>, <span class="number">235</span>, <span class="number">15</span>, <span class="number">75</span>, <span class="number">112</span>, <span class="number">86</span>, <span class="number">157</span>, <span class="number">53</span>, <span class="number">30</span>, <span class="number">36</span>, <span class="number">14</span>, <span class="number">94</span>, <span class="number">99</span>, <span class="number">88</span>, <span class="number">209</span>, <span class="number">162</span>, <span class="number">37</span>, <span class="number">34</span>, <span class="number">124</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">33</span>, <span class="number">120</span>, <span class="number">135</span>, <span class="number">212</span>, <span class="number">0</span>, <span class="number">70</span>, <span class="number">87</span>, <span class="number">159</span>, <span class="number">211</span>, <span class="number">39</span>, <span class="number">82</span>, <span class="number">76</span>, <span class="number">54</span>, <span class="number">2</span>, <span class="number">231</span>, <span class="number">160</span>, <span class="number">196</span>, <span class="number">200</span>, <span class="number">158</span>, <span class="number">234</span>, <span class="number">191</span>, <span class="number">138</span>, <span class="number">210</span>, <span class="number">64</span>, <span class="number">199</span>, <span class="number">56</span>, <span class="number">181</span>, <span class="number">163</span>, <span class="number">247</span>, <span class="number">242</span>, <span class="number">206</span>, <span class="number">249</span>, <span class="number">97</span>, <span class="number">21</span>, <span class="number">161</span>, <span class="number">224</span>, <span class="number">174</span>, <span class="number">93</span>, <span class="number">164</span>, <span class="number">155</span>, <span class="number">52</span>, <span class="number">26</span>, <span class="number">85</span>, <span class="number">173</span>, <span class="number">147</span>, <span class="number">50</span>, <span class="number">48</span>, <span class="number">245</span>, <span class="number">140</span>, <span class="number">177</span>, <span class="number">227</span>, <span class="number">29</span>, <span class="number">246</span>, <span class="number">226</span>, <span class="number">46</span>, <span class="number">130</span>, <span class="number">102</span>, <span class="number">202</span>, <span class="number">96</span>, <span class="number">192</span>, <span class="number">41</span>, <span class="number">35</span>, <span class="number">171</span>, <span class="number">13</span>, <span class="number">83</span>, <span class="number">78</span>, <span class="number">111</span>, <span class="number">213</span>, <span class="number">219</span>, <span class="number">55</span>, <span class="number">69</span>, <span class="number">222</span>, <span class="number">253</span>, <span class="number">142</span>, <span class="number">47</span>, <span class="number">3</span>, <span class="number">255</span>, <span class="number">106</span>, <span class="number">114</span>, <span class="number">109</span>, <span class="number">108</span>, <span class="number">91</span>, <span class="number">81</span>, <span class="number">141</span>, <span class="number">27</span>, <span class="number">175</span>, <span class="number">146</span>, <span class="number">187</span>, <span class="number">221</span>, <span class="number">188</span>, <span class="number">127</span>, <span class="number">17</span>, <span class="number">217</span>, <span class="number">92</span>, <span class="number">65</span>, <span class="number">31</span>, <span class="number">16</span>, <span class="number">90</span>, <span class="number">216</span>, <span class="number">10</span>, <span class="number">193</span>, <span class="number">49</span>, <span class="number">136</span>, <span class="number">165</span>, <span class="number">205</span>, <span class="number">123</span>, <span class="number">189</span>, <span class="number">45</span>, <span class="number">116</span>, <span class="number">208</span>, <span class="number">18</span>, <span class="number">184</span>, <span class="number">229</span>, <span class="number">180</span>, <span class="number">176</span>, <span class="number">137</span>, <span class="number">105</span>, <span class="number">151</span>, <span class="number">74</span>, <span class="number">12</span>, <span class="number">150</span>, <span class="number">119</span>, <span class="number">126</span>, <span class="number">101</span>, <span class="number">185</span>, <span class="number">241</span>, <span class="number">9</span>, <span class="number">197</span>, <span class="number">110</span>, <span class="number">198</span>, <span class="number">132</span>, <span class="number">24</span>, <span class="number">240</span>, <span class="number">125</span>, <span class="number">236</span>, <span class="number">58</span>, <span class="number">220</span>, <span class="number">77</span>, <span class="number">32</span>, <span class="number">121</span>, <span class="number">238</span>, <span class="number">95</span>, <span class="number">62</span>, <span class="number">215</span>, <span class="number">203</span>, <span class="number">57</span>, <span class="number">72</span>, <span class="number">198</span>, <span class="number">186</span>, <span class="number">177</span>, <span class="number">163</span>, <span class="number">80</span>, <span class="number">51</span>, <span class="number">170</span>, <span class="number">86</span>, <span class="number">151</span>, <span class="number">145</span>, <span class="number">125</span>, <span class="number">103</span>, <span class="number">220</span>, <span class="number">34</span>, <span class="number">112</span>, <span class="number">178</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HIBYTE</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">return</span> a&gt;&gt;(<span class="number">8</span>*<span class="number">3</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">BYTE2</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">return</span> (a&gt;&gt;(<span class="number">8</span>*<span class="number">2</span>))%<span class="number">256</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">BYTE1</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">return</span> (a&gt;&gt;<span class="number">8</span>)%<span class="number">256</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LOBYTE</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">return</span> a%<span class="number">256</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rol</span>(<span class="params">value, time</span>):</span><br><span class="line">    <span class="keyword">if</span> (time == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    a = (value &amp; (<span class="number">1</span> &lt;&lt; <span class="number">31</span>)) &gt;&gt; <span class="number">31</span></span><br><span class="line">    value &lt;&lt;= <span class="number">1</span></span><br><span class="line">    value &amp;= (<span class="number">1</span> &lt;&lt; <span class="number">32</span>) - <span class="number">1</span></span><br><span class="line">    value += a</span><br><span class="line">    <span class="keyword">return</span> rol(value, time - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ror</span>(<span class="params">value, time</span>):</span><br><span class="line">    <span class="keyword">if</span> (time == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    a = (value &amp; (<span class="number">1</span>)) &lt;&lt; <span class="number">31</span></span><br><span class="line">    value &gt;&gt;= <span class="number">1</span></span><br><span class="line">    value += a</span><br><span class="line">    <span class="keyword">return</span> ror(value, time - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_55B683001464</span>(<span class="params">a</span>):</span><br><span class="line">    v2 = (v3[BYTE2(a)]&lt;&lt;<span class="number">16</span>)|v3[LOBYTE(a)]|(v3[BYTE1(a)]&lt;&lt;<span class="number">8</span>)|(v3[HIBYTE(a)]&lt;&lt;<span class="number">24</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> rol(v2,<span class="number">12</span>)^rol(v2,<span class="number">8</span>)^ror(v2,<span class="number">2</span>)^ror(v2,<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_55B68300143B</span>(<span class="params">a, b, c, d</span>):</span><br><span class="line">    <span class="keyword">return</span> a ^ sub_55B683001464(b ^ c ^ d)</span><br><span class="line"></span><br><span class="line">vx = [<span class="number">190</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">128</span>,<span class="number">197</span>,<span class="number">175</span>,<span class="number">118</span>,<span class="number">71</span>,<span class="number">159</span>,<span class="number">204</span>,<span class="number">64</span>,<span class="number">31</span>,<span class="number">216</span>,<span class="number">191</span>,<span class="number">146</span>,<span class="number">239</span>]</span><br><span class="line">v8 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    x = vx[i*<span class="number">4</span>]</span><br><span class="line">    x &lt;&lt;= <span class="number">8</span></span><br><span class="line">    x += vx[i*<span class="number">4</span>+<span class="number">1</span>]</span><br><span class="line">    x &lt;&lt;= <span class="number">8</span></span><br><span class="line">    x += vx[i*<span class="number">4</span>+<span class="number">2</span>]</span><br><span class="line">    x &lt;&lt;= <span class="number">8</span></span><br><span class="line">    x += vx[i*<span class="number">4</span>+<span class="number">3</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(x))</span><br><span class="line">    v8.append(x)</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span> = [<span class="number">0</span>]*<span class="number">30</span></span><br><span class="line"><span class="built_in">input</span>[<span class="number">26</span>] = v8[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">input</span>[<span class="number">27</span>] = v8[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">input</span>[<span class="number">28</span>] = v8[<span class="number">2</span>]</span><br><span class="line"><span class="built_in">input</span>[<span class="number">29</span>] = v8[<span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="built_in">input</span>[<span class="number">25</span>-i] = <span class="built_in">input</span>[<span class="number">25</span>-i+<span class="number">4</span>]^sub_55B683001464(<span class="built_in">input</span>[<span class="number">25</span>-i+<span class="number">3</span>]^<span class="built_in">input</span>[<span class="number">25</span>-i+<span class="number">2</span>]^<span class="built_in">input</span>[<span class="number">25</span>-i+<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    x = libnum.n2s(<span class="built_in">input</span>[i]).decode()</span><br><span class="line">    x = <span class="built_in">list</span>(x)</span><br><span class="line">    x.reverse()</span><br><span class="line">    x = <span class="string">&#x27;&#x27;</span>.join(x)</span><br><span class="line">    flag += x</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306171102622.png" class="" title="image-20220306171102622">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220306171215105.png" class="" title="image-20220306171215105">

<p>所以最后的flag为：</p>
<p><strong>sctf{ddwwxxssxaxwwaasasyywwdd-c2N0Zl85MTAy(fl4g_is_s0_ug1y!)}</strong></p>
<h1 id="Ecquation-js-fuck加密-z3"><a href="#Ecquation-js-fuck加密-z3" class="headerlink" title="Ecquation (js fuck加密+z3)"></a>Ecquation (js fuck加密+z3)</h1><p><a target="_blank" rel="noopener" href="http://codertab.com/JsUnFuck">http://codertab.com/JsUnFuck</a></p>
<p>题目中提示这个是Js的fuck加密，可以在网站上一个一个的解密，当然也可以用脚本跑</p>
<p>在网上找了一份关于此的解密脚本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">deEquation</span>(<span class="params">str</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;= <span class="number">1</span>; i++) &#123;</span><br><span class="line">  str = str.<span class="title function_">replace</span>(<span class="regexp">/l\[(\D*?)](\+l|-l|==)/g</span>, <span class="function">(<span class="params">m, a, b</span>) =&gt;</span> <span class="string">&#x27;l[&#x27;</span> + <span class="built_in">eval</span>(a) + <span class="string">&#x27;]&#x27;</span> + b);</span><br><span class="line">  &#125;</span><br><span class="line">  str = str.<span class="title function_">replace</span>(<span class="regexp">/==(\D*?)&amp;&amp;/g</span>, <span class="function">(<span class="params">m, a</span>) =&gt;</span> <span class="string">&#x27;==&#x27;</span> + <span class="built_in">eval</span>(a) + <span class="string">&#x27;&amp;&amp;&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line">s=<span class="string">&quot;l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]+l[+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+[]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[+[]]==+(+!+[]+[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(+!+[]+[+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+[+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]-l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]==+(+!+[]+[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]==-+(!+[]+!+[]+!+[]+[+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+[]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]])&amp;&amp;l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]==+(!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]+l[+!+[]+[!+[]+!+[]]]+l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(+!+[]+[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]==+(+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==+(+!+[]+[+[]+[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]==+(!+[]+!+[]+!+[]+[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]]+l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[+[]]]==-+(+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+[]]-l[!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]]==-+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+[+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+!+[]]==-+(!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+[+!+[]+[!+[]+!+[]]])&amp;&amp;l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]])&amp;&amp;l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+!+[]]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]]-l[+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[+[]]+l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==+(+!+[]+[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]==-+(+!+[]+[!+[]+!+[]+[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]==-+(+!+[]+[+!+[]+[!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+[+[]]])&amp;&amp;l[+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]+l[+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]+l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+[+[]+[!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]])&amp;&amp;l[+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(+!+[]+[!+[]+!+[]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]])&quot;</span>;</span><br><span class="line">ss=<span class="title function_">deEquation</span>(s);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(ss);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>解出来之后：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">l[<span class="number">40</span>]+l[<span class="number">35</span>]+l[<span class="number">34</span>]-l[<span class="number">0</span>]-l[<span class="number">15</span>]-l[<span class="number">37</span>]+l[<span class="number">7</span>]+l[<span class="number">6</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]+l[<span class="number">19</span>]+l[<span class="number">8</span>]-l[<span class="number">17</span>]-l[<span class="number">14</span>]-l[<span class="number">38</span>]+l[<span class="number">1</span>]-l[<span class="number">9</span>]+l[<span class="number">22</span>]+l[<span class="number">41</span>]+l[<span class="number">3</span>]-l[<span class="number">29</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]+l[<span class="number">5</span>]+l[<span class="number">32</span>]-l[<span class="number">16</span>]+l[<span class="number">12</span>]-l[<span class="number">24</span>]+l[<span class="number">30</span>]+l[<span class="number">39</span>]+l[<span class="number">10</span>]+l[<span class="number">2</span>]+l[<span class="number">27</span>]+l[<span class="number">28</span>]+l[<span class="number">21</span>]+l[<span class="number">33</span>]-l[<span class="number">18</span>]+l[<span class="number">4</span>]==<span class="number">861</span>&amp;&amp;l[<span class="number">31</span>]+l[<span class="number">26</span>]+l[<span class="number">11</span>]-l[<span class="number">33</span>]+l[<span class="number">27</span>]-l[<span class="number">3</span>]+l[<span class="number">12</span>]+l[<span class="number">30</span>]+l[<span class="number">1</span>]+l[<span class="number">32</span>]-l[<span class="number">16</span>]+l[<span class="number">7</span>]+l[<span class="number">10</span>]-l[<span class="number">25</span>]+l[<span class="number">38</span>]-l[<span class="number">41</span>]-l[<span class="number">14</span>]-l[<span class="number">19</span>]+l[<span class="number">29</span>]+l[<span class="number">36</span>]-l[<span class="number">9</span>]-l[<span class="number">28</span>]-l[<span class="number">6</span>]-l[<span class="number">0</span>]-l[<span class="number">22</span>]-l[<span class="number">18</span>]+l[<span class="number">20</span>]-l[<span class="number">37</span>]+l[<span class="number">4</span>]-l[<span class="number">24</span>]+l[<span class="number">34</span>]-l[<span class="number">21</span>]-l[<span class="number">39</span>]-l[<span class="number">23</span>]-l[<span class="number">8</span>]-l[<span class="number">40</span>]+l[<span class="number">15</span>]-l[<span class="number">35</span>]==-<span class="number">448</span>&amp;&amp;l[<span class="number">26</span>]+l[<span class="number">14</span>]+l[<span class="number">15</span>]+l[<span class="number">9</span>]+l[<span class="number">13</span>]+l[<span class="number">30</span>]-l[<span class="number">11</span>]+l[<span class="number">18</span>]+l[<span class="number">23</span>]+l[<span class="number">7</span>]+l[<span class="number">3</span>]+l[<span class="number">12</span>]+l[<span class="number">25</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]-l[<span class="number">35</span>]-l[<span class="number">20</span>]+l[<span class="number">40</span>]-l[<span class="number">8</span>]+l[<span class="number">10</span>]-l[<span class="number">5</span>]-l[<span class="number">33</span>]-l[<span class="number">31</span>]+l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">21</span>]-l[<span class="number">6</span>]+l[<span class="number">1</span>]+l[<span class="number">16</span>]+l[<span class="number">17</span>]+l[<span class="number">29</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">36</span>]+l[<span class="number">41</span>]+l[<span class="number">38</span>]+l[<span class="number">2</span>]+l[<span class="number">0</span>]==<span class="number">1244</span>&amp;&amp;l[<span class="number">5</span>]+l[<span class="number">22</span>]+l[<span class="number">15</span>]+l[<span class="number">2</span>]-l[<span class="number">28</span>]-l[<span class="number">10</span>]-l[<span class="number">3</span>]-l[<span class="number">13</span>]-l[<span class="number">18</span>]+l[<span class="number">30</span>]-l[<span class="number">9</span>]+l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">34</span>]+l[<span class="number">23</span>]-l[<span class="number">17</span>]+l[<span class="number">16</span>]-l[<span class="number">7</span>]+l[<span class="number">24</span>]-l[<span class="number">39</span>]+l[<span class="number">8</span>]-l[<span class="number">12</span>]-l[<span class="number">40</span>]-l[<span class="number">25</span>]+l[<span class="number">37</span>]-l[<span class="number">35</span>]+l[<span class="number">11</span>]-l[<span class="number">14</span>]+l[<span class="number">20</span>]-l[<span class="number">27</span>]+l[<span class="number">4</span>]-l[<span class="number">33</span>]-l[<span class="number">21</span>]+l[<span class="number">31</span>]-l[<span class="number">6</span>]+l[<span class="number">1</span>]+l[<span class="number">38</span>]-l[<span class="number">29</span>]==-<span class="number">39</span>&amp;&amp;l[<span class="number">41</span>]-l[<span class="number">29</span>]+l[<span class="number">23</span>]-l[<span class="number">4</span>]+l[<span class="number">20</span>]-l[<span class="number">33</span>]+l[<span class="number">35</span>]+l[<span class="number">3</span>]-l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">11</span>]+l[<span class="number">26</span>]-l[<span class="number">24</span>]-l[<span class="number">17</span>]+l[<span class="number">37</span>]+l[<span class="number">1</span>]+l[<span class="number">16</span>]-l[<span class="number">0</span>]-l[<span class="number">13</span>]+l[<span class="number">7</span>]+l[<span class="number">10</span>]+l[<span class="number">14</span>]+l[<span class="number">22</span>]+l[<span class="number">39</span>]-l[<span class="number">40</span>]+l[<span class="number">34</span>]-l[<span class="number">38</span>]+l[<span class="number">32</span>]+l[<span class="number">25</span>]-l[<span class="number">2</span>]+l[<span class="number">15</span>]+l[<span class="number">6</span>]+l[<span class="number">28</span>]-l[<span class="number">8</span>]-l[<span class="number">5</span>]-l[<span class="number">31</span>]-l[<span class="number">30</span>]-l[<span class="number">27</span>]==<span class="number">485</span>&amp;&amp;l[<span class="number">13</span>]+l[<span class="number">19</span>]+l[<span class="number">21</span>]-l[<span class="number">2</span>]-l[<span class="number">33</span>]-l[<span class="number">0</span>]+l[<span class="number">39</span>]+l[<span class="number">31</span>]-l[<span class="number">23</span>]-l[<span class="number">41</span>]+l[<span class="number">38</span>]-l[<span class="number">29</span>]+l[<span class="number">36</span>]+l[<span class="number">24</span>]-l[<span class="number">20</span>]-l[<span class="number">9</span>]-l[<span class="number">32</span>]+l[<span class="number">37</span>]-l[<span class="number">35</span>]+l[<span class="number">40</span>]+l[<span class="number">7</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">10</span>]-l[<span class="number">6</span>]-l[<span class="number">16</span>]-l[<span class="number">4</span>]-l[<span class="number">5</span>]-l[<span class="number">30</span>]-l[<span class="number">14</span>]-l[<span class="number">22</span>]-l[<span class="number">25</span>]-l[<span class="number">34</span>]-l[<span class="number">17</span>]-l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">1</span>]-l[<span class="number">28</span>]==-<span class="number">1068</span>&amp;&amp;l[<span class="number">32</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]+l[<span class="number">14</span>]+l[<span class="number">11</span>]+l[<span class="number">18</span>]-l[<span class="number">13</span>]+l[<span class="number">24</span>]-l[<span class="number">2</span>]-l[<span class="number">15</span>]+l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">1</span>]+l[<span class="number">39</span>]-l[<span class="number">8</span>]-l[<span class="number">3</span>]+l[<span class="number">33</span>]+l[<span class="number">6</span>]-l[<span class="number">5</span>]-l[<span class="number">35</span>]-l[<span class="number">28</span>]+l[<span class="number">25</span>]-l[<span class="number">41</span>]+l[<span class="number">22</span>]-l[<span class="number">17</span>]+l[<span class="number">10</span>]+l[<span class="number">40</span>]+l[<span class="number">34</span>]+l[<span class="number">27</span>]-l[<span class="number">20</span>]+l[<span class="number">23</span>]+l[<span class="number">31</span>]-l[<span class="number">16</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">30</span>]+l[<span class="number">29</span>]-l[<span class="number">4</span>]==<span class="number">939</span>&amp;&amp;l[<span class="number">19</span>]+l[<span class="number">11</span>]+l[<span class="number">20</span>]-l[<span class="number">16</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]+l[<span class="number">1</span>]-l[<span class="number">31</span>]+l[<span class="number">28</span>]-l[<span class="number">23</span>]+l[<span class="number">14</span>]-l[<span class="number">9</span>]-l[<span class="number">27</span>]+l[<span class="number">35</span>]+l[<span class="number">39</span>]-l[<span class="number">37</span>]-l[<span class="number">8</span>]-l[<span class="number">22</span>]+l[<span class="number">5</span>]-l[<span class="number">6</span>]+l[<span class="number">0</span>]-l[<span class="number">32</span>]+l[<span class="number">24</span>]+l[<span class="number">33</span>]+l[<span class="number">29</span>]+l[<span class="number">38</span>]+l[<span class="number">15</span>]-l[<span class="number">2</span>]+l[<span class="number">30</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">3</span>]-l[<span class="number">17</span>]+l[<span class="number">34</span>]+l[<span class="number">41</span>]-l[<span class="number">4</span>]-l[<span class="number">13</span>]-l[<span class="number">26</span>]==<span class="number">413</span>&amp;&amp;l[<span class="number">22</span>]+l[<span class="number">4</span>]-l[<span class="number">9</span>]+l[<span class="number">34</span>]+l[<span class="number">35</span>]+l[<span class="number">17</span>]+l[<span class="number">3</span>]-l[<span class="number">24</span>]+l[<span class="number">38</span>]-l[<span class="number">5</span>]-l[<span class="number">41</span>]-l[<span class="number">31</span>]-l[<span class="number">0</span>]-l[<span class="number">25</span>]+l[<span class="number">33</span>]+l[<span class="number">15</span>]-l[<span class="number">1</span>]-l[<span class="number">10</span>]+l[<span class="number">16</span>]-l[<span class="number">29</span>]-l[<span class="number">12</span>]+l[<span class="number">26</span>]-l[<span class="number">39</span>]-l[<span class="number">21</span>]-l[<span class="number">18</span>]-l[<span class="number">6</span>]-l[<span class="number">40</span>]-l[<span class="number">13</span>]+l[<span class="number">8</span>]+l[<span class="number">37</span>]+l[<span class="number">19</span>]+l[<span class="number">14</span>]+l[<span class="number">32</span>]+l[<span class="number">28</span>]-l[<span class="number">11</span>]+l[<span class="number">23</span>]+l[<span class="number">36</span>]+l[<span class="number">7</span>]==<span class="number">117</span>&amp;&amp;l[<span class="number">32</span>]+l[<span class="number">16</span>]+l[<span class="number">3</span>]+l[<span class="number">11</span>]+l[<span class="number">34</span>]-l[<span class="number">31</span>]+l[<span class="number">14</span>]+l[<span class="number">25</span>]+l[<span class="number">1</span>]-l[<span class="number">30</span>]-l[<span class="number">33</span>]-l[<span class="number">40</span>]-l[<span class="number">4</span>]-l[<span class="number">29</span>]+l[<span class="number">18</span>]-l[<span class="number">27</span>]+l[<span class="number">13</span>]-l[<span class="number">19</span>]-l[<span class="number">12</span>]+l[<span class="number">23</span>]-l[<span class="number">39</span>]-l[<span class="number">41</span>]-l[<span class="number">8</span>]+l[<span class="number">22</span>]-l[<span class="number">5</span>]-l[<span class="number">38</span>]-l[<span class="number">9</span>]-l[<span class="number">37</span>]+l[<span class="number">17</span>]-l[<span class="number">36</span>]+l[<span class="number">24</span>]-l[<span class="number">21</span>]+l[<span class="number">2</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]-l[<span class="number">7</span>]+l[<span class="number">35</span>]-l[<span class="number">0</span>]==-<span class="number">313</span>&amp;&amp;l[<span class="number">40</span>]-l[<span class="number">1</span>]+l[<span class="number">5</span>]+l[<span class="number">7</span>]+l[<span class="number">33</span>]+l[<span class="number">29</span>]+l[<span class="number">12</span>]+l[<span class="number">38</span>]-l[<span class="number">31</span>]+l[<span class="number">2</span>]+l[<span class="number">14</span>]-l[<span class="number">35</span>]-l[<span class="number">8</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]-l[<span class="number">9</span>]-l[<span class="number">28</span>]+l[<span class="number">23</span>]-l[<span class="number">17</span>]-l[<span class="number">22</span>]-l[<span class="number">26</span>]+l[<span class="number">32</span>]-l[<span class="number">11</span>]+l[<span class="number">4</span>]-l[<span class="number">36</span>]+l[<span class="number">10</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]-l[<span class="number">16</span>]+l[<span class="number">6</span>]-l[<span class="number">0</span>]+l[<span class="number">3</span>]-l[<span class="number">30</span>]+l[<span class="number">37</span>]-l[<span class="number">19</span>]+l[<span class="number">21</span>]+l[<span class="number">25</span>]-l[<span class="number">15</span>]==-<span class="number">42</span>&amp;&amp;l[<span class="number">21</span>]+l[<span class="number">26</span>]-l[<span class="number">17</span>]-l[<span class="number">25</span>]+l[<span class="number">27</span>]-l[<span class="number">22</span>]-l[<span class="number">39</span>]-l[<span class="number">23</span>]-l[<span class="number">15</span>]-l[<span class="number">20</span>]-l[<span class="number">32</span>]+l[<span class="number">12</span>]+l[<span class="number">3</span>]-l[<span class="number">6</span>]+l[<span class="number">28</span>]+l[<span class="number">31</span>]+l[<span class="number">13</span>]-l[<span class="number">16</span>]-l[<span class="number">37</span>]-l[<span class="number">30</span>]-l[<span class="number">5</span>]+l[<span class="number">41</span>]+l[<span class="number">29</span>]+l[<span class="number">36</span>]+l[<span class="number">1</span>]+l[<span class="number">11</span>]+l[<span class="number">24</span>]+l[<span class="number">18</span>]-l[<span class="number">40</span>]+l[<span class="number">19</span>]-l[<span class="number">35</span>]+l[<span class="number">2</span>]-l[<span class="number">38</span>]+l[<span class="number">14</span>]-l[<span class="number">9</span>]+l[<span class="number">4</span>]+l[<span class="number">0</span>]-l[<span class="number">33</span>]==<span class="number">289</span>&amp;&amp;l[<span class="number">29</span>]+l[<span class="number">31</span>]+l[<span class="number">32</span>]-l[<span class="number">17</span>]-l[<span class="number">7</span>]+l[<span class="number">34</span>]+l[<span class="number">2</span>]+l[<span class="number">14</span>]+l[<span class="number">23</span>]-l[<span class="number">4</span>]+l[<span class="number">3</span>]+l[<span class="number">35</span>]-l[<span class="number">33</span>]-l[<span class="number">9</span>]-l[<span class="number">20</span>]-l[<span class="number">37</span>]+l[<span class="number">24</span>]-l[<span class="number">27</span>]+l[<span class="number">36</span>]+l[<span class="number">15</span>]-l[<span class="number">18</span>]-l[<span class="number">0</span>]+l[<span class="number">12</span>]+l[<span class="number">11</span>]-l[<span class="number">38</span>]+l[<span class="number">6</span>]+l[<span class="number">22</span>]+l[<span class="number">39</span>]-l[<span class="number">25</span>]-l[<span class="number">10</span>]-l[<span class="number">19</span>]-l[<span class="number">1</span>]+l[<span class="number">13</span>]-l[<span class="number">41</span>]+l[<span class="number">30</span>]-l[<span class="number">16</span>]+l[<span class="number">28</span>]-l[<span class="number">26</span>]==-<span class="number">117</span>&amp;&amp;l[<span class="number">5</span>]+l[<span class="number">37</span>]-l[<span class="number">39</span>]+l[<span class="number">0</span>]-l[<span class="number">27</span>]+l[<span class="number">12</span>]+l[<span class="number">41</span>]-l[<span class="number">22</span>]+l[<span class="number">8</span>]-l[<span class="number">16</span>]-l[<span class="number">38</span>]+l[<span class="number">9</span>]+l[<span class="number">15</span>]-l[<span class="number">35</span>]-l[<span class="number">29</span>]+l[<span class="number">18</span>]+l[<span class="number">6</span>]-l[<span class="number">25</span>]-l[<span class="number">28</span>]+l[<span class="number">36</span>]+l[<span class="number">34</span>]+l[<span class="number">32</span>]-l[<span class="number">14</span>]-l[<span class="number">1</span>]+l[<span class="number">20</span>]+l[<span class="number">40</span>]-l[<span class="number">19</span>]-l[<span class="number">4</span>]-l[<span class="number">7</span>]+l[<span class="number">26</span>]+l[<span class="number">30</span>]-l[<span class="number">10</span>]+l[<span class="number">13</span>]-l[<span class="number">21</span>]+l[<span class="number">2</span>]-l[<span class="number">23</span>]-l[<span class="number">3</span>]-l[<span class="number">33</span>]==-<span class="number">252</span>&amp;&amp;l[<span class="number">29</span>]+l[<span class="number">10</span>]-l[<span class="number">41</span>]-l[<span class="number">9</span>]+l[<span class="number">12</span>]-l[<span class="number">28</span>]+l[<span class="number">11</span>]+l[<span class="number">40</span>]-l[<span class="number">27</span>]-l[<span class="number">8</span>]+l[<span class="number">32</span>]-l[<span class="number">25</span>]-l[<span class="number">23</span>]+l[<span class="number">39</span>]-l[<span class="number">1</span>]-l[<span class="number">36</span>]-l[<span class="number">15</span>]+l[<span class="number">33</span>]-l[<span class="number">20</span>]+l[<span class="number">18</span>]+l[<span class="number">22</span>]-l[<span class="number">3</span>]+l[<span class="number">6</span>]-l[<span class="number">34</span>]-l[<span class="number">21</span>]+l[<span class="number">19</span>]+l[<span class="number">26</span>]+l[<span class="number">13</span>]-l[<span class="number">4</span>]+l[<span class="number">7</span>]-l[<span class="number">37</span>]+l[<span class="number">38</span>]-l[<span class="number">2</span>]-l[<span class="number">30</span>]-l[<span class="number">0</span>]-l[<span class="number">35</span>]+l[<span class="number">5</span>]+l[<span class="number">17</span>]==-<span class="number">183</span>&amp;&amp;l[<span class="number">6</span>]-l[<span class="number">8</span>]-l[<span class="number">20</span>]+l[<span class="number">34</span>]-l[<span class="number">33</span>]-l[<span class="number">25</span>]-l[<span class="number">4</span>]+l[<span class="number">3</span>]+l[<span class="number">17</span>]-l[<span class="number">13</span>]-l[<span class="number">15</span>]-l[<span class="number">40</span>]+l[<span class="number">1</span>]-l[<span class="number">30</span>]-l[<span class="number">14</span>]-l[<span class="number">28</span>]-l[<span class="number">35</span>]+l[<span class="number">38</span>]-l[<span class="number">22</span>]+l[<span class="number">2</span>]+l[<span class="number">24</span>]-l[<span class="number">29</span>]+l[<span class="number">5</span>]+l[<span class="number">9</span>]+l[<span class="number">37</span>]+l[<span class="number">23</span>]-l[<span class="number">18</span>]+l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">11</span>]+l[<span class="number">36</span>]+l[<span class="number">41</span>]-l[<span class="number">7</span>]-l[<span class="number">32</span>]+l[<span class="number">10</span>]+l[<span class="number">26</span>]-l[<span class="number">0</span>]+l[<span class="number">31</span>]==<span class="number">188</span>&amp;&amp;l[<span class="number">3</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]+l[<span class="number">10</span>]+l[<span class="number">39</span>]+l[<span class="number">37</span>]+l[<span class="number">1</span>]+l[<span class="number">8</span>]+l[<span class="number">21</span>]+l[<span class="number">24</span>]+l[<span class="number">29</span>]+l[<span class="number">12</span>]+l[<span class="number">27</span>]-l[<span class="number">38</span>]+l[<span class="number">11</span>]+l[<span class="number">23</span>]+l[<span class="number">28</span>]+l[<span class="number">33</span>]-l[<span class="number">31</span>]+l[<span class="number">14</span>]-l[<span class="number">5</span>]+l[<span class="number">32</span>]-l[<span class="number">17</span>]+l[<span class="number">40</span>]-l[<span class="number">34</span>]+l[<span class="number">20</span>]-l[<span class="number">22</span>]-l[<span class="number">16</span>]+l[<span class="number">19</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]-l[<span class="number">7</span>]+l[<span class="number">18</span>]+l[<span class="number">15</span>]+l[<span class="number">26</span>]-l[<span class="number">0</span>]-l[<span class="number">4</span>]+l[<span class="number">35</span>]==<span class="number">1036</span>&amp;&amp;l[<span class="number">28</span>]-l[<span class="number">33</span>]+l[<span class="number">2</span>]+l[<span class="number">37</span>]-l[<span class="number">12</span>]-l[<span class="number">9</span>]-l[<span class="number">39</span>]+l[<span class="number">16</span>]-l[<span class="number">32</span>]+l[<span class="number">8</span>]-l[<span class="number">36</span>]+l[<span class="number">31</span>]+l[<span class="number">10</span>]-l[<span class="number">4</span>]+l[<span class="number">21</span>]-l[<span class="number">25</span>]+l[<span class="number">18</span>]+l[<span class="number">24</span>]-l[<span class="number">0</span>]+l[<span class="number">29</span>]-l[<span class="number">26</span>]+l[<span class="number">35</span>]-l[<span class="number">22</span>]-l[<span class="number">41</span>]-l[<span class="number">6</span>]+l[<span class="number">15</span>]+l[<span class="number">19</span>]+l[<span class="number">40</span>]+l[<span class="number">7</span>]+l[<span class="number">34</span>]+l[<span class="number">17</span>]-l[<span class="number">3</span>]-l[<span class="number">13</span>]+l[<span class="number">5</span>]+l[<span class="number">23</span>]+l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">1</span>]==<span class="number">328</span>&amp;&amp;l[<span class="number">22</span>]-l[<span class="number">32</span>]+l[<span class="number">17</span>]-l[<span class="number">9</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]-l[<span class="number">34</span>]+l[<span class="number">23</span>]+l[<span class="number">36</span>]-l[<span class="number">35</span>]-l[<span class="number">38</span>]+l[<span class="number">27</span>]+l[<span class="number">4</span>]-l[<span class="number">5</span>]-l[<span class="number">41</span>]+l[<span class="number">29</span>]+l[<span class="number">33</span>]+l[<span class="number">0</span>]-l[<span class="number">37</span>]+l[<span class="number">28</span>]-l[<span class="number">40</span>]-l[<span class="number">11</span>]-l[<span class="number">12</span>]+l[<span class="number">7</span>]+l[<span class="number">1</span>]+l[<span class="number">2</span>]-l[<span class="number">26</span>]-l[<span class="number">16</span>]-l[<span class="number">8</span>]+l[<span class="number">24</span>]-l[<span class="number">25</span>]+l[<span class="number">3</span>]-l[<span class="number">6</span>]-l[<span class="number">19</span>]-l[<span class="number">39</span>]-l[<span class="number">14</span>]-l[<span class="number">31</span>]+l[<span class="number">10</span>]==-<span class="number">196</span>&amp;&amp;l[<span class="number">11</span>]+l[<span class="number">13</span>]+l[<span class="number">14</span>]-l[<span class="number">15</span>]-l[<span class="number">29</span>]-l[<span class="number">2</span>]+l[<span class="number">7</span>]+l[<span class="number">20</span>]+l[<span class="number">30</span>]-l[<span class="number">36</span>]-l[<span class="number">33</span>]-l[<span class="number">19</span>]+l[<span class="number">31</span>]+l[<span class="number">0</span>]-l[<span class="number">39</span>]-l[<span class="number">4</span>]-l[<span class="number">6</span>]+l[<span class="number">38</span>]+l[<span class="number">35</span>]-l[<span class="number">28</span>]+l[<span class="number">34</span>]-l[<span class="number">9</span>]-l[<span class="number">23</span>]-l[<span class="number">26</span>]+l[<span class="number">37</span>]-l[<span class="number">8</span>]-l[<span class="number">27</span>]+l[<span class="number">5</span>]-l[<span class="number">41</span>]+l[<span class="number">3</span>]+l[<span class="number">17</span>]+l[<span class="number">40</span>]-l[<span class="number">10</span>]+l[<span class="number">25</span>]+l[<span class="number">12</span>]-l[<span class="number">24</span>]+l[<span class="number">18</span>]+l[<span class="number">32</span>]==<span class="number">7</span>&amp;&amp;l[<span class="number">34</span>]-l[<span class="number">37</span>]-l[<span class="number">40</span>]+l[<span class="number">4</span>]-l[<span class="number">22</span>]-l[<span class="number">31</span>]-l[<span class="number">6</span>]+l[<span class="number">38</span>]+l[<span class="number">13</span>]-l[<span class="number">28</span>]+l[<span class="number">8</span>]+l[<span class="number">30</span>]-l[<span class="number">20</span>]-l[<span class="number">7</span>]-l[<span class="number">32</span>]+l[<span class="number">26</span>]+l[<span class="number">1</span>]-l[<span class="number">18</span>]+l[<span class="number">5</span>]+l[<span class="number">35</span>]-l[<span class="number">24</span>]-l[<span class="number">41</span>]+l[<span class="number">9</span>]-l[<span class="number">0</span>]-l[<span class="number">2</span>]-l[<span class="number">15</span>]-l[<span class="number">10</span>]+l[<span class="number">12</span>]-l[<span class="number">36</span>]+l[<span class="number">33</span>]-l[<span class="number">16</span>]-l[<span class="number">14</span>]-l[<span class="number">25</span>]-l[<span class="number">29</span>]-l[<span class="number">21</span>]+l[<span class="number">27</span>]+l[<span class="number">3</span>]-l[<span class="number">17</span>]==-<span class="number">945</span>&amp;&amp;l[<span class="number">12</span>]-l[<span class="number">30</span>]-l[<span class="number">8</span>]+l[<span class="number">20</span>]-l[<span class="number">2</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]-l[<span class="number">0</span>]-l[<span class="number">19</span>]-l[<span class="number">28</span>]-l[<span class="number">7</span>]-l[<span class="number">11</span>]-l[<span class="number">33</span>]+l[<span class="number">4</span>]-l[<span class="number">23</span>]+l[<span class="number">10</span>]-l[<span class="number">41</span>]+l[<span class="number">39</span>]-l[<span class="number">32</span>]+l[<span class="number">27</span>]+l[<span class="number">18</span>]+l[<span class="number">15</span>]+l[<span class="number">34</span>]+l[<span class="number">13</span>]-l[<span class="number">40</span>]+l[<span class="number">29</span>]-l[<span class="number">6</span>]+l[<span class="number">37</span>]-l[<span class="number">14</span>]-l[<span class="number">16</span>]+l[<span class="number">38</span>]-l[<span class="number">26</span>]+l[<span class="number">17</span>]+l[<span class="number">31</span>]-l[<span class="number">22</span>]-l[<span class="number">35</span>]+l[<span class="number">5</span>]-l[<span class="number">1</span>]==-<span class="number">480</span>&amp;&amp;l[<span class="number">36</span>]-l[<span class="number">11</span>]-l[<span class="number">34</span>]+l[<span class="number">8</span>]+l[<span class="number">0</span>]+l[<span class="number">15</span>]+l[<span class="number">28</span>]-l[<span class="number">39</span>]-l[<span class="number">32</span>]-l[<span class="number">2</span>]-l[<span class="number">27</span>]+l[<span class="number">22</span>]+l[<span class="number">16</span>]-l[<span class="number">30</span>]-l[<span class="number">3</span>]+l[<span class="number">31</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]+l[<span class="number">17</span>]-l[<span class="number">29</span>]-l[<span class="number">18</span>]+l[<span class="number">19</span>]-l[<span class="number">10</span>]+l[<span class="number">6</span>]-l[<span class="number">5</span>]-l[<span class="number">38</span>]-l[<span class="number">25</span>]-l[<span class="number">24</span>]+l[<span class="number">4</span>]+l[<span class="number">23</span>]+l[<span class="number">9</span>]+l[<span class="number">14</span>]+l[<span class="number">21</span>]-l[<span class="number">37</span>]+l[<span class="number">13</span>]-l[<span class="number">41</span>]-l[<span class="number">12</span>]+l[<span class="number">35</span>]==-<span class="number">213</span>&amp;&amp;l[<span class="number">19</span>]-l[<span class="number">36</span>]-l[<span class="number">12</span>]+l[<span class="number">33</span>]-l[<span class="number">27</span>]-l[<span class="number">37</span>]-l[<span class="number">25</span>]+l[<span class="number">38</span>]+l[<span class="number">16</span>]-l[<span class="number">18</span>]+l[<span class="number">22</span>]-l[<span class="number">39</span>]+l[<span class="number">13</span>]-l[<span class="number">7</span>]-l[<span class="number">31</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">10</span>]-l[<span class="number">9</span>]-l[<span class="number">2</span>]-l[<span class="number">30</span>]-l[<span class="number">11</span>]+l[<span class="number">41</span>]-l[<span class="number">4</span>]+l[<span class="number">24</span>]+l[<span class="number">34</span>]+l[<span class="number">5</span>]+l[<span class="number">17</span>]+l[<span class="number">14</span>]+l[<span class="number">6</span>]+l[<span class="number">8</span>]-l[<span class="number">21</span>]-l[<span class="number">23</span>]+l[<span class="number">32</span>]-l[<span class="number">1</span>]-l[<span class="number">29</span>]-l[<span class="number">0</span>]+l[<span class="number">3</span>]==-<span class="number">386</span>&amp;&amp;l[<span class="number">0</span>]+l[<span class="number">7</span>]-l[<span class="number">28</span>]-l[<span class="number">38</span>]+l[<span class="number">19</span>]+l[<span class="number">31</span>]-l[<span class="number">5</span>]+l[<span class="number">24</span>]-l[<span class="number">3</span>]+l[<span class="number">33</span>]-l[<span class="number">12</span>]-l[<span class="number">29</span>]+l[<span class="number">32</span>]+l[<span class="number">1</span>]-l[<span class="number">34</span>]-l[<span class="number">9</span>]-l[<span class="number">25</span>]+l[<span class="number">26</span>]-l[<span class="number">8</span>]+l[<span class="number">4</span>]-l[<span class="number">10</span>]+l[<span class="number">40</span>]-l[<span class="number">15</span>]-l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">36</span>]+l[<span class="number">14</span>]+l[<span class="number">41</span>]-l[<span class="number">35</span>]-l[<span class="number">13</span>]-l[<span class="number">17</span>]-l[<span class="number">21</span>]-l[<span class="number">18</span>]+l[<span class="number">39</span>]-l[<span class="number">2</span>]+l[<span class="number">20</span>]-l[<span class="number">23</span>]-l[<span class="number">22</span>]==-<span class="number">349</span>&amp;&amp;l[<span class="number">10</span>]+l[<span class="number">22</span>]+l[<span class="number">21</span>]-l[<span class="number">0</span>]+l[<span class="number">15</span>]-l[<span class="number">6</span>]+l[<span class="number">20</span>]-l[<span class="number">29</span>]-l[<span class="number">30</span>]-l[<span class="number">33</span>]+l[<span class="number">19</span>]+l[<span class="number">23</span>]-l[<span class="number">28</span>]+l[<span class="number">41</span>]-l[<span class="number">27</span>]-l[<span class="number">12</span>]-l[<span class="number">37</span>]-l[<span class="number">32</span>]+l[<span class="number">34</span>]-l[<span class="number">36</span>]+l[<span class="number">3</span>]+l[<span class="number">1</span>]-l[<span class="number">13</span>]+l[<span class="number">18</span>]+l[<span class="number">14</span>]+l[<span class="number">9</span>]+l[<span class="number">7</span>]-l[<span class="number">39</span>]+l[<span class="number">8</span>]+l[<span class="number">2</span>]-l[<span class="number">31</span>]-l[<span class="number">5</span>]-l[<span class="number">40</span>]+l[<span class="number">38</span>]-l[<span class="number">26</span>]-l[<span class="number">4</span>]+l[<span class="number">16</span>]-l[<span class="number">25</span>]==<span class="number">98</span>&amp;&amp;l[<span class="number">28</span>]+l[<span class="number">38</span>]+l[<span class="number">20</span>]+l[<span class="number">0</span>]-l[<span class="number">5</span>]-l[<span class="number">34</span>]-l[<span class="number">41</span>]+l[<span class="number">22</span>]-l[<span class="number">26</span>]+l[<span class="number">11</span>]+l[<span class="number">29</span>]+l[<span class="number">31</span>]-l[<span class="number">3</span>]-l[<span class="number">16</span>]+l[<span class="number">23</span>]+l[<span class="number">17</span>]-l[<span class="number">18</span>]+l[<span class="number">9</span>]-l[<span class="number">4</span>]-l[<span class="number">12</span>]-l[<span class="number">19</span>]-l[<span class="number">40</span>]-l[<span class="number">27</span>]+l[<span class="number">33</span>]+l[<span class="number">8</span>]-l[<span class="number">37</span>]+l[<span class="number">2</span>]+l[<span class="number">15</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]+l[<span class="number">10</span>]+l[<span class="number">35</span>]-l[<span class="number">1</span>]+l[<span class="number">30</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]-l[<span class="number">14</span>]-l[<span class="number">32</span>]==-<span class="number">412</span>&amp;&amp;l[<span class="number">1</span>]-l[<span class="number">24</span>]-l[<span class="number">29</span>]+l[<span class="number">39</span>]+l[<span class="number">41</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]-l[<span class="number">19</span>]+l[<span class="number">6</span>]-l[<span class="number">37</span>]-l[<span class="number">22</span>]+l[<span class="number">32</span>]+l[<span class="number">21</span>]+l[<span class="number">28</span>]+l[<span class="number">36</span>]+l[<span class="number">4</span>]-l[<span class="number">17</span>]+l[<span class="number">20</span>]-l[<span class="number">13</span>]-l[<span class="number">35</span>]-l[<span class="number">5</span>]+l[<span class="number">33</span>]-l[<span class="number">27</span>]-l[<span class="number">30</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]-l[<span class="number">18</span>]+l[<span class="number">34</span>]-l[<span class="number">3</span>]-l[<span class="number">10</span>]-l[<span class="number">16</span>]-l[<span class="number">23</span>]-l[<span class="number">38</span>]+l[<span class="number">8</span>]-l[<span class="number">14</span>]-l[<span class="number">11</span>]-l[<span class="number">7</span>]+l[<span class="number">12</span>]==-<span class="number">95</span>&amp;&amp;l[<span class="number">2</span>]-l[<span class="number">24</span>]+l[<span class="number">31</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]-l[<span class="number">6</span>]+l[<span class="number">7</span>]-l[<span class="number">1</span>]-l[<span class="number">22</span>]+l[<span class="number">8</span>]-l[<span class="number">23</span>]+l[<span class="number">40</span>]+l[<span class="number">20</span>]-l[<span class="number">38</span>]-l[<span class="number">11</span>]-l[<span class="number">14</span>]+l[<span class="number">18</span>]-l[<span class="number">36</span>]+l[<span class="number">15</span>]-l[<span class="number">4</span>]-l[<span class="number">41</span>]-l[<span class="number">12</span>]-l[<span class="number">34</span>]+l[<span class="number">32</span>]-l[<span class="number">35</span>]+l[<span class="number">17</span>]-l[<span class="number">21</span>]-l[<span class="number">10</span>]-l[<span class="number">29</span>]+l[<span class="number">39</span>]-l[<span class="number">16</span>]+l[<span class="number">27</span>]+l[<span class="number">26</span>]-l[<span class="number">3</span>]-l[<span class="number">5</span>]+l[<span class="number">13</span>]+l[<span class="number">25</span>]-l[<span class="number">28</span>]==-<span class="number">379</span>&amp;&amp;l[<span class="number">19</span>]-l[<span class="number">17</span>]+l[<span class="number">31</span>]+l[<span class="number">14</span>]+l[<span class="number">6</span>]-l[<span class="number">12</span>]+l[<span class="number">16</span>]-l[<span class="number">8</span>]+l[<span class="number">27</span>]-l[<span class="number">13</span>]+l[<span class="number">41</span>]+l[<span class="number">2</span>]-l[<span class="number">7</span>]+l[<span class="number">32</span>]+l[<span class="number">1</span>]+l[<span class="number">25</span>]-l[<span class="number">9</span>]+l[<span class="number">37</span>]+l[<span class="number">34</span>]-l[<span class="number">18</span>]-l[<span class="number">40</span>]-l[<span class="number">11</span>]-l[<span class="number">10</span>]+l[<span class="number">38</span>]+l[<span class="number">21</span>]+l[<span class="number">3</span>]-l[<span class="number">0</span>]+l[<span class="number">24</span>]+l[<span class="number">15</span>]+l[<span class="number">23</span>]-l[<span class="number">20</span>]+l[<span class="number">26</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">28</span>]-l[<span class="number">5</span>]+l[<span class="number">39</span>]+l[<span class="number">35</span>]==<span class="number">861</span>&amp;&amp;l[<span class="number">35</span>]+l[<span class="number">36</span>]-l[<span class="number">16</span>]-l[<span class="number">26</span>]-l[<span class="number">31</span>]+l[<span class="number">0</span>]+l[<span class="number">21</span>]-l[<span class="number">13</span>]+l[<span class="number">14</span>]+l[<span class="number">39</span>]+l[<span class="number">7</span>]+l[<span class="number">4</span>]+l[<span class="number">34</span>]+l[<span class="number">38</span>]+l[<span class="number">17</span>]+l[<span class="number">22</span>]+l[<span class="number">32</span>]+l[<span class="number">5</span>]+l[<span class="number">15</span>]+l[<span class="number">8</span>]-l[<span class="number">29</span>]+l[<span class="number">40</span>]+l[<span class="number">24</span>]+l[<span class="number">6</span>]+l[<span class="number">30</span>]-l[<span class="number">2</span>]+l[<span class="number">25</span>]+l[<span class="number">23</span>]+l[<span class="number">1</span>]+l[<span class="number">12</span>]+l[<span class="number">9</span>]-l[<span class="number">10</span>]-l[<span class="number">3</span>]-l[<span class="number">19</span>]+l[<span class="number">20</span>]-l[<span class="number">37</span>]-l[<span class="number">33</span>]-l[<span class="number">18</span>]==<span class="number">1169</span>&amp;&amp;l[<span class="number">13</span>]+l[<span class="number">0</span>]-l[<span class="number">25</span>]-l[<span class="number">32</span>]-l[<span class="number">21</span>]-l[<span class="number">34</span>]-l[<span class="number">14</span>]-l[<span class="number">9</span>]-l[<span class="number">8</span>]-l[<span class="number">15</span>]-l[<span class="number">16</span>]+l[<span class="number">38</span>]-l[<span class="number">35</span>]-l[<span class="number">30</span>]-l[<span class="number">40</span>]-l[<span class="number">12</span>]+l[<span class="number">3</span>]-l[<span class="number">19</span>]+l[<span class="number">4</span>]-l[<span class="number">41</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]+l[<span class="number">37</span>]+l[<span class="number">17</span>]-l[<span class="number">1</span>]+l[<span class="number">26</span>]-l[<span class="number">39</span>]-l[<span class="number">10</span>]-l[<span class="number">33</span>]+l[<span class="number">5</span>]-l[<span class="number">27</span>]-l[<span class="number">23</span>]-l[<span class="number">24</span>]-l[<span class="number">7</span>]+l[<span class="number">31</span>]-l[<span class="number">28</span>]-l[<span class="number">18</span>]+l[<span class="number">6</span>]==-<span class="number">1236</span>&amp;&amp;l[<span class="number">20</span>]+l[<span class="number">27</span>]-l[<span class="number">29</span>]-l[<span class="number">25</span>]-l[<span class="number">3</span>]+l[<span class="number">28</span>]-l[<span class="number">32</span>]-l[<span class="number">11</span>]+l[<span class="number">10</span>]+l[<span class="number">31</span>]+l[<span class="number">16</span>]+l[<span class="number">21</span>]-l[<span class="number">7</span>]+l[<span class="number">4</span>]-l[<span class="number">24</span>]-l[<span class="number">35</span>]+l[<span class="number">26</span>]+l[<span class="number">12</span>]-l[<span class="number">37</span>]+l[<span class="number">6</span>]+l[<span class="number">23</span>]+l[<span class="number">41</span>]-l[<span class="number">39</span>]-l[<span class="number">38</span>]+l[<span class="number">40</span>]-l[<span class="number">36</span>]+l[<span class="number">8</span>]-l[<span class="number">9</span>]-l[<span class="number">5</span>]-l[<span class="number">1</span>]-l[<span class="number">13</span>]-l[<span class="number">14</span>]+l[<span class="number">19</span>]+l[<span class="number">0</span>]-l[<span class="number">34</span>]-l[<span class="number">15</span>]+l[<span class="number">17</span>]+l[<span class="number">22</span>]==-<span class="number">114</span>&amp;&amp;l[<span class="number">12</span>]-l[<span class="number">28</span>]-l[<span class="number">13</span>]-l[<span class="number">23</span>]-l[<span class="number">33</span>]+l[<span class="number">18</span>]+l[<span class="number">10</span>]+l[<span class="number">11</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]+l[<span class="number">41</span>]-l[<span class="number">16</span>]+l[<span class="number">39</span>]+l[<span class="number">34</span>]+l[<span class="number">32</span>]+l[<span class="number">37</span>]-l[<span class="number">38</span>]+l[<span class="number">20</span>]+l[<span class="number">6</span>]+l[<span class="number">7</span>]+l[<span class="number">31</span>]+l[<span class="number">5</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">15</span>]-l[<span class="number">24</span>]+l[<span class="number">17</span>]-l[<span class="number">3</span>]+l[<span class="number">1</span>]-l[<span class="number">35</span>]-l[<span class="number">9</span>]+l[<span class="number">30</span>]+l[<span class="number">25</span>]-l[<span class="number">0</span>]-l[<span class="number">8</span>]-l[<span class="number">14</span>]+l[<span class="number">26</span>]+l[<span class="number">21</span>]==<span class="number">659</span>&amp;&amp;l[<span class="number">21</span>]-l[<span class="number">3</span>]+l[<span class="number">7</span>]-l[<span class="number">27</span>]+l[<span class="number">0</span>]-l[<span class="number">32</span>]-l[<span class="number">24</span>]-l[<span class="number">37</span>]+l[<span class="number">4</span>]-l[<span class="number">22</span>]+l[<span class="number">20</span>]-l[<span class="number">5</span>]-l[<span class="number">30</span>]-l[<span class="number">31</span>]-l[<span class="number">1</span>]+l[<span class="number">15</span>]+l[<span class="number">41</span>]+l[<span class="number">12</span>]+l[<span class="number">40</span>]+l[<span class="number">38</span>]-l[<span class="number">17</span>]-l[<span class="number">39</span>]+l[<span class="number">19</span>]-l[<span class="number">13</span>]+l[<span class="number">23</span>]+l[<span class="number">18</span>]-l[<span class="number">2</span>]+l[<span class="number">6</span>]-l[<span class="number">33</span>]-l[<span class="number">9</span>]+l[<span class="number">28</span>]+l[<span class="number">8</span>]-l[<span class="number">16</span>]-l[<span class="number">10</span>]-l[<span class="number">14</span>]+l[<span class="number">34</span>]+l[<span class="number">35</span>]-l[<span class="number">11</span>]==-<span class="number">430</span>&amp;&amp;l[<span class="number">11</span>]-l[<span class="number">23</span>]-l[<span class="number">9</span>]-l[<span class="number">19</span>]+l[<span class="number">17</span>]+l[<span class="number">38</span>]-l[<span class="number">36</span>]-l[<span class="number">22</span>]-l[<span class="number">10</span>]+l[<span class="number">27</span>]-l[<span class="number">14</span>]-l[<span class="number">4</span>]+l[<span class="number">5</span>]+l[<span class="number">31</span>]+l[<span class="number">2</span>]+l[<span class="number">0</span>]-l[<span class="number">16</span>]-l[<span class="number">8</span>]-l[<span class="number">28</span>]+l[<span class="number">3</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]-l[<span class="number">33</span>]+l[<span class="number">13</span>]-l[<span class="number">32</span>]-l[<span class="number">35</span>]+l[<span class="number">26</span>]-l[<span class="number">20</span>]-l[<span class="number">41</span>]-l[<span class="number">30</span>]-l[<span class="number">12</span>]-l[<span class="number">7</span>]+l[<span class="number">37</span>]-l[<span class="number">39</span>]+l[<span class="number">15</span>]+l[<span class="number">18</span>]-l[<span class="number">29</span>]-l[<span class="number">21</span>]==-<span class="number">513</span>&amp;&amp;l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">4</span>]-l[<span class="number">13</span>]-l[<span class="number">17</span>]-l[<span class="number">30</span>]+l[<span class="number">5</span>]-l[<span class="number">33</span>]-l[<span class="number">37</span>]-l[<span class="number">15</span>]-l[<span class="number">18</span>]+l[<span class="number">7</span>]+l[<span class="number">25</span>]-l[<span class="number">14</span>]+l[<span class="number">35</span>]+l[<span class="number">40</span>]+l[<span class="number">16</span>]+l[<span class="number">1</span>]+l[<span class="number">2</span>]+l[<span class="number">26</span>]-l[<span class="number">3</span>]-l[<span class="number">39</span>]-l[<span class="number">22</span>]+l[<span class="number">23</span>]-l[<span class="number">36</span>]-l[<span class="number">27</span>]-l[<span class="number">9</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]-l[<span class="number">0</span>]-l[<span class="number">31</span>]-l[<span class="number">20</span>]+l[<span class="number">12</span>]-l[<span class="number">8</span>]+l[<span class="number">29</span>]-l[<span class="number">11</span>]-l[<span class="number">34</span>]+l[<span class="number">21</span>]==-<span class="number">502</span>&amp;&amp;l[<span class="number">30</span>]-l[<span class="number">31</span>]-l[<span class="number">36</span>]+l[<span class="number">3</span>]+l[<span class="number">9</span>]-l[<span class="number">40</span>]-l[<span class="number">33</span>]+l[<span class="number">25</span>]+l[<span class="number">39</span>]-l[<span class="number">26</span>]+l[<span class="number">23</span>]-l[<span class="number">0</span>]-l[<span class="number">29</span>]-l[<span class="number">32</span>]-l[<span class="number">4</span>]+l[<span class="number">37</span>]+l[<span class="number">28</span>]+l[<span class="number">21</span>]+l[<span class="number">17</span>]+l[<span class="number">2</span>]+l[<span class="number">24</span>]+l[<span class="number">6</span>]+l[<span class="number">5</span>]+l[<span class="number">8</span>]+l[<span class="number">16</span>]+l[<span class="number">27</span>]+l[<span class="number">19</span>]+l[<span class="number">12</span>]+l[<span class="number">20</span>]+l[<span class="number">41</span>]-l[<span class="number">22</span>]+l[<span class="number">15</span>]-l[<span class="number">11</span>]+l[<span class="number">34</span>]-l[<span class="number">18</span>]-l[<span class="number">38</span>]+l[<span class="number">1</span>]-l[<span class="number">14</span>]==<span class="number">853</span>&amp;&amp;l[<span class="number">38</span>]-l[<span class="number">10</span>]+l[<span class="number">16</span>]+l[<span class="number">8</span>]+l[<span class="number">21</span>]-l[<span class="number">25</span>]+l[<span class="number">36</span>]-l[<span class="number">30</span>]+l[<span class="number">31</span>]-l[<span class="number">3</span>]+l[<span class="number">5</span>]-l[<span class="number">15</span>]+l[<span class="number">23</span>]-l[<span class="number">28</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">29</span>]+l[<span class="number">22</span>]-l[<span class="number">0</span>]-l[<span class="number">37</span>]-l[<span class="number">14</span>]-l[<span class="number">11</span>]+l[<span class="number">32</span>]+l[<span class="number">33</span>]-l[<span class="number">9</span>]+l[<span class="number">39</span>]+l[<span class="number">41</span>]-l[<span class="number">19</span>]-l[<span class="number">1</span>]+l[<span class="number">18</span>]-l[<span class="number">4</span>]-l[<span class="number">6</span>]+l[<span class="number">13</span>]+l[<span class="number">20</span>]-l[<span class="number">2</span>]-l[<span class="number">35</span>]-l[<span class="number">26</span>]+l[<span class="number">27</span>]==-<span class="number">28</span>&amp;&amp;l[<span class="number">11</span>]+l[<span class="number">18</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">14</span>]-l[<span class="number">33</span>]+l[<span class="number">7</span>]-l[<span class="number">23</span>]-l[<span class="number">25</span>]+l[<span class="number">0</span>]-l[<span class="number">6</span>]-l[<span class="number">21</span>]-l[<span class="number">16</span>]+l[<span class="number">17</span>]-l[<span class="number">19</span>]-l[<span class="number">28</span>]-l[<span class="number">38</span>]-l[<span class="number">37</span>]+l[<span class="number">9</span>]+l[<span class="number">20</span>]-l[<span class="number">8</span>]-l[<span class="number">3</span>]+l[<span class="number">22</span>]-l[<span class="number">35</span>]-l[<span class="number">10</span>]-l[<span class="number">31</span>]-l[<span class="number">2</span>]+l[<span class="number">41</span>]-l[<span class="number">1</span>]-l[<span class="number">4</span>]+l[<span class="number">24</span>]-l[<span class="number">34</span>]+l[<span class="number">39</span>]+l[<span class="number">40</span>]+l[<span class="number">32</span>]-l[<span class="number">5</span>]+l[<span class="number">36</span>]-l[<span class="number">27</span>]==-<span class="number">529</span>&amp;&amp;l[<span class="number">38</span>]+l[<span class="number">8</span>]+l[<span class="number">36</span>]+l[<span class="number">35</span>]-l[<span class="number">23</span>]-l[<span class="number">34</span>]+l[<span class="number">13</span>]-l[<span class="number">4</span>]-l[<span class="number">27</span>]-l[<span class="number">24</span>]+l[<span class="number">26</span>]+l[<span class="number">31</span>]-l[<span class="number">30</span>]-l[<span class="number">5</span>]-l[<span class="number">40</span>]+l[<span class="number">28</span>]-l[<span class="number">11</span>]-l[<span class="number">2</span>]-l[<span class="number">39</span>]+l[<span class="number">15</span>]+l[<span class="number">10</span>]-l[<span class="number">17</span>]+l[<span class="number">3</span>]+l[<span class="number">19</span>]+l[<span class="number">22</span>]+l[<span class="number">33</span>]+l[<span class="number">0</span>]+l[<span class="number">37</span>]+l[<span class="number">16</span>]-l[<span class="number">9</span>]-l[<span class="number">32</span>]+l[<span class="number">25</span>]-l[<span class="number">21</span>]-l[<span class="number">12</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]==-<span class="number">12</span>&amp;&amp;l[<span class="number">6</span>]-l[<span class="number">30</span>]-l[<span class="number">20</span>]-l[<span class="number">27</span>]-l[<span class="number">14</span>]-l[<span class="number">39</span>]+l[<span class="number">41</span>]-l[<span class="number">33</span>]-l[<span class="number">0</span>]+l[<span class="number">25</span>]-l[<span class="number">32</span>]-l[<span class="number">3</span>]+l[<span class="number">26</span>]-l[<span class="number">12</span>]+l[<span class="number">8</span>]-l[<span class="number">35</span>]-l[<span class="number">24</span>]+l[<span class="number">15</span>]+l[<span class="number">9</span>]-l[<span class="number">4</span>]+l[<span class="number">13</span>]+l[<span class="number">36</span>]+l[<span class="number">34</span>]+l[<span class="number">1</span>]-l[<span class="number">28</span>]-l[<span class="number">21</span>]+l[<span class="number">18</span>]+l[<span class="number">23</span>]+l[<span class="number">29</span>]-l[<span class="number">10</span>]-l[<span class="number">38</span>]+l[<span class="number">22</span>]+l[<span class="number">37</span>]+l[<span class="number">5</span>]+l[<span class="number">19</span>]+l[<span class="number">7</span>]+l[<span class="number">16</span>]-l[<span class="number">31</span>]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]])</span><br></pre></td></tr></table></figure>

<p>可以看到等式最后有个数字没有解出来</p>
<p>我们放到网站中解就行了</p>
<p><a target="_blank" rel="noopener" href="http://codertab.com/JsUnFuck">http://codertab.com/JsUnFuck</a></p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220303105716640.png" class="" title="image-20220303105716640">

<p>是个81，关于等式，我们使用z3</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">l0,l1,l2,l3,l4,l5,l6,l7,l8,l9,l10,l11,l12,l13,l14,l15,l16,l17,l18,l19,l20,l21,l22,l23,l24,l25,l26,l27,l28,l29,l30,l31,l32,l33,l34,l35,l36,l37,l38,l39,l40,l41 \</span><br><span class="line">= Ints(<span class="string">&#x27;l0 l1 l2 l3 l4 l5 l6 l7 l8 l9 l10 l11 l12 l13 l14 l15 l16 l17 l18 l19 l20 l21 l22 l23 l24 l25 l26 l27 l28 l29 l30 l31 l32 l33 l34 l35 l36 l37 l38 l39 l40 l41&#x27;</span>)</span><br><span class="line">x = Solver()</span><br><span class="line">x.add(l40+l35+l34-l0-l15-l37+l7+l6-l26+l20+l19+l8-l17-l14-l38+l1-l9+l22+l41+l3-l29-l36-l25+l5+l32-l16+l12-l24+l30+l39+l10+l2+l27+l28+l21+l33-l18+l4==<span class="number">861</span>)</span><br><span class="line">x.add(l31+l26+l11-l33+l27-l3+l12+l30+l1+l32-l16+l7+l10-l25+l38-l41-l14-l19+l29+l36-l9-l28-l6-l0-l22-l18+l20-l37+l4-l24+l34-l21-l39-l23-l8-l40+l15-l35==-<span class="number">448</span>)</span><br><span class="line">x.add(l26+l14+l15+l9+l13+l30-l11+l18+l23+l7+l3+l12+l25-l24-l39-l35-l20+l40-l8+l10-l5-l33-l31+l32+l19+l21-l6+l1+l16+l17+l29+l22-l4-l36+l41+l38+l2+l0==<span class="number">1244</span>)</span><br><span class="line">x.add(l5+l22+l15+l2-l28-l10-l3-l13-l18+l30-l9+l32+l19+l34+l23-l17+l16-l7+l24-l39+l8-l12-l40-l25+l37-l35+l11-l14+l20-l27+l4-l33-l21+l31-l6+l1+l38-l29==-<span class="number">39</span>)</span><br><span class="line">x.add(l41-l29+l23-l4+l20-l33+l35+l3-l19-l21+l11+l26-l24-l17+l37+l1+l16-l0-l13+l7+l10+l14+l22+l39-l40+l34-l38+l32+l25-l2+l15+l6+l28-l8-l5-l31-l30-l27==<span class="number">485</span>)</span><br><span class="line">x.add(l13+l19+l21-l2-l33-l0+l39+l31-l23-l41+l38-l29+l36+l24-l20-l9-l32+l37-l35+l40+l7-l26+l15-l10-l6-l16-l4-l5-l30-l14-l22-l25-l34-l17-l11-l27+l1-l28==-<span class="number">1068</span>)</span><br><span class="line">x.add(l32+l0+l9+l14+l11+l18-l13+l24-l2-l15+l19-l21+l1+l39-l8-l3+l33+l6-l5-l35-l28+l25-l41+l22-l17+l10+l40+l34+l27-l20+l23+l31-l16+l7+l12-l30+l29-l4==<span class="number">939</span>)</span><br><span class="line">x.add(l19+l11+l20-l16+l40+l25+l1-l31+l28-l23+l14-l9-l27+l35+l39-l37-l8-l22+l5-l6+l0-l32+l24+l33+l29+l38+l15-l2+l30+l7+l12-l3-l17+l34+l41-l4-l13-l26==<span class="number">413</span>)</span><br><span class="line">x.add(l22+l4-l9+l34+l35+l17+l3-l24+l38-l5-l41-l31-l0-l25+l33+l15-l1-l10+l16-l29-l12+l26-l39-l21-l18-l6-l40-l13+l8+l37+l19+l14+l32+l28-l11+l23+l36+l7==<span class="number">117</span>)</span><br><span class="line">x.add(l32+l16+l3+l11+l34-l31+l14+l25+l1-l30-l33-l40-l4-l29+l18-l27+l13-l19-l12+l23-l39-l41-l8+l22-l5-l38-l9-l37+l17-l36+l24-l21+l2-l26+l20-l7+l35-l0==-<span class="number">313</span>)</span><br><span class="line">x.add(l40-l1+l5+l7+l33+l29+l12+l38-l31+l2+l14-l35-l8-l24-l39-l9-l28+l23-l17-l22-l26+l32-l11+l4-l36+l10+l20-l18-l16+l6-l0+l3-l30+l37-l19+l21+l25-l15==-<span class="number">42</span>)</span><br><span class="line">x.add(l21+l26-l17-l25+l27-l22-l39-l23-l15-l20-l32+l12+l3-l6+l28+l31+l13-l16-l37-l30-l5+l41+l29+l36+l1+l11+l24+l18-l40+l19-l35+l2-l38+l14-l9+l4+l0-l33==<span class="number">289</span>)</span><br><span class="line">x.add(l29+l31+l32-l17-l7+l34+l2+l14+l23-l4+l3+l35-l33-l9-l20-l37+l24-l27+l36+l15-l18-l0+l12+l11-l38+l6+l22+l39-l25-l10-l19-l1+l13-l41+l30-l16+l28-l26==-<span class="number">117</span>)</span><br><span class="line">x.add(l5+l37-l39+l0-l27+l12+l41-l22+l8-l16-l38+l9+l15-l35-l29+l18+l6-l25-l28+l36+l34+l32-l14-l1+l20+l40-l19-l4-l7+l26+l30-l10+l13-l21+l2-l23-l3-l33==-<span class="number">252</span>)</span><br><span class="line">x.add(l29+l10-l41-l9+l12-l28+l11+l40-l27-l8+l32-l25-l23+l39-l1-l36-l15+l33-l20+l18+l22-l3+l6-l34-l21+l19+l26+l13-l4+l7-l37+l38-l2-l30-l0-l35+l5+l17==-<span class="number">183</span>)</span><br><span class="line">x.add(l6-l8-l20+l34-l33-l25-l4+l3+l17-l13-l15-l40+l1-l30-l14-l28-l35+l38-l22+l2+l24-l29+l5+l9+l37+l23-l18+l19-l21+l11+l36+l41-l7-l32+l10+l26-l0+l31==<span class="number">188</span>)</span><br><span class="line">x.add(l3+l6-l41+l10+l39+l37+l1+l8+l21+l24+l29+l12+l27-l38+l11+l23+l28+l33-l31+l14-l5+l32-l17+l40-l34+l20-l22-l16+l19+l2-l36-l7+l18+l15+l26-l0-l4+l35==<span class="number">1036</span>)</span><br><span class="line">x.add(l28-l33+l2+l37-l12-l9-l39+l16-l32+l8-l36+l31+l10-l4+l21-l25+l18+l24-l0+l29-l26+l35-l22-l41-l6+l15+l19+l40+l7+l34+l17-l3-l13+l5+l23+l11-l27+l1==<span class="number">328</span>)</span><br><span class="line">x.add(l22-l32+l17-l9+l20-l18-l34+l23+l36-l35-l38+l27+l4-l5-l41+l29+l33+l0-l37+l28-l40-l11-l12+l7+l1+l2-l26-l16-l8+l24-l25+l3-l6-l19-l39-l14-l31+l10==-<span class="number">196</span>)</span><br><span class="line">x.add(l11+l13+l14-l15-l29-l2+l7+l20+l30-l36-l33-l19+l31+l0-l39-l4-l6+l38+l35-l28+l34-l9-l23-l26+l37-l8-l27+l5-l41+l3+l17+l40-l10+l25+l12-l24+l18+l32==<span class="number">7</span>)</span><br><span class="line">x.add(l34-l37-l40+l4-l22-l31-l6+l38+l13-l28+l8+l30-l20-l7-l32+l26+l1-l18+l5+l35-l24-l41+l9-l0-l2-l15-l10+l12-l36+l33-l16-l14-l25-l29-l21+l27+l3-l17==-<span class="number">945</span>)</span><br><span class="line">x.add(l12-l30-l8+l20-l2-l36-l25-l0-l19-l28-l7-l11-l33+l4-l23+l10-l41+l39-l32+l27+l18+l15+l34+l13-l40+l29-l6+l37-l14-l16+l38-l26+l17+l31-l22-l35+l5-l1==-<span class="number">480</span>)</span><br><span class="line">x.add(l36-l11-l34+l8+l0+l15+l28-l39-l32-l2-l27+l22+l16-l30-l3+l31-l26+l20+l17-l29-l18+l19-l10+l6-l5-l38-l25-l24+l4+l23+l9+l14+l21-l37+l13-l41-l12+l35==-<span class="number">213</span>)</span><br><span class="line">x.add(l19-l36-l12+l33-l27-l37-l25+l38+l16-l18+l22-l39+l13-l7-l31-l26+l15-l10-l9-l2-l30-l11+l41-l4+l24+l34+l5+l17+l14+l6+l8-l21-l23+l32-l1-l29-l0+l3==-<span class="number">386</span>)</span><br><span class="line">x.add(l0+l7-l28-l38+l19+l31-l5+l24-l3+l33-l12-l29+l32+l1-l34-l9-l25+l26-l8+l4-l10+l40-l15-l11-l27+l36+l14+l41-l35-l13-l17-l21-l18+l39-l2+l20-l23-l22==-<span class="number">349</span>)</span><br><span class="line">x.add(l10+l22+l21-l0+l15-l6+l20-l29-l30-l33+l19+l23-l28+l41-l27-l12-l37-l32+l34-l36+l3+l1-l13+l18+l14+l9+l7-l39+l8+l2-l31-l5-l40+l38-l26-l4+l16-l25==<span class="number">98</span>)</span><br><span class="line">x.add(l28+l38+l20+l0-l5-l34-l41+l22-l26+l11+l29+l31-l3-l16+l23+l17-l18+l9-l4-l12-l19-l40-l27+l33+l8-l37+l2+l15-l24-l39+l10+l35-l1+l30-l36-l25-l14-l32==-<span class="number">412</span>)</span><br><span class="line">x.add(l1-l24-l29+l39+l41+l0+l9-l19+l6-l37-l22+l32+l21+l28+l36+l4-l17+l20-l13-l35-l5+l33-l27-l30+l40+l25-l18+l34-l3-l10-l16-l23-l38+l8-l14-l11-l7+l12==-<span class="number">95</span>)</span><br><span class="line">x.add(l2-l24+l31+l0+l9-l6+l7-l1-l22+l8-l23+l40+l20-l38-l11-l14+l18-l36+l15-l4-l41-l12-l34+l32-l35+l17-l21-l10-l29+l39-l16+l27+l26-l3-l5+l13+l25-l28==-<span class="number">379</span>)</span><br><span class="line">x.add(l19-l17+l31+l14+l6-l12+l16-l8+l27-l13+l41+l2-l7+l32+l1+l25-l9+l37+l34-l18-l40-l11-l10+l38+l21+l3-l0+l24+l15+l23-l20+l26+l22-l4-l28-l5+l39+l35==<span class="number">861</span>)</span><br><span class="line">x.add(l35+l36-l16-l26-l31+l0+l21-l13+l14+l39+l7+l4+l34+l38+l17+l22+l32+l5+l15+l8-l29+l40+l24+l6+l30-l2+l25+l23+l1+l12+l9-l10-l3-l19+l20-l37-l33-l18==<span class="number">1169</span>)</span><br><span class="line">x.add(l13+l0-l25-l32-l21-l34-l14-l9-l8-l15-l16+l38-l35-l30-l40-l12+l3-l19+l4-l41+l2-l36+l37+l17-l1+l26-l39-l10-l33+l5-l27-l23-l24-l7+l31-l28-l18+l6==-<span class="number">1236</span>)</span><br><span class="line">x.add(l20+l27-l29-l25-l3+l28-l32-l11+l10+l31+l16+l21-l7+l4-l24-l35+l26+l12-l37+l6+l23+l41-l39-l38+l40-l36+l8-l9-l5-l1-l13-l14+l19+l0-l34-l15+l17+l22==-<span class="number">114</span>)</span><br><span class="line">x.add(l12-l28-l13-l23-l33+l18+l10+l11+l2-l36+l41-l16+l39+l34+l32+l37-l38+l20+l6+l7+l31+l5+l22-l4-l15-l24+l17-l3+l1-l35-l9+l30+l25-l0-l8-l14+l26+l21==<span class="number">659</span>)</span><br><span class="line">x.add(l21-l3+l7-l27+l0-l32-l24-l37+l4-l22+l20-l5-l30-l31-l1+l15+l41+l12+l40+l38-l17-l39+l19-l13+l23+l18-l2+l6-l33-l9+l28+l8-l16-l10-l14+l34+l35-l11==-<span class="number">430</span>)</span><br><span class="line">x.add(l11-l23-l9-l19+l17+l38-l36-l22-l10+l27-l14-l4+l5+l31+l2+l0-l16-l8-l28+l3+l40+l25-l33+l13-l32-l35+l26-l20-l41-l30-l12-l7+l37-l39+l15+l18-l29-l21==-<span class="number">513</span>)</span><br><span class="line">x.add(l32+l19+l4-l13-l17-l30+l5-l33-l37-l15-l18+l7+l25-l14+l35+l40+l16+l1+l2+l26-l3-l39-l22+l23-l36-l27-l9+l6-l41-l0-l31-l20+l12-l8+l29-l11-l34+l21==-<span class="number">502</span>)</span><br><span class="line">x.add(l30-l31-l36+l3+l9-l40-l33+l25+l39-l26+l23-l0-l29-l32-l4+l37+l28+l21+l17+l2+l24+l6+l5+l8+l16+l27+l19+l12+l20+l41-l22+l15-l11+l34-l18-l38+l1-l14==<span class="number">853</span>)</span><br><span class="line">x.add(l38-l10+l16+l8+l21-l25+l36-l30+l31-l3+l5-l15+l23-l28+l7+l12-l29+l22-l0-l37-l14-l11+l32+l33-l9+l39+l41-l19-l1+l18-l4-l6+l13+l20-l2-l35-l26+l27==-<span class="number">28</span>)</span><br><span class="line">x.add(l11+l18-l26+l15-l14-l33+l7-l23-l25+l0-l6-l21-l16+l17-l19-l28-l38-l37+l9+l20-l8-l3+l22-l35-l10-l31-l2+l41-l1-l4+l24-l34+l39+l40+l32-l5+l36-l27==-<span class="number">529</span>)</span><br><span class="line">x.add(l38+l8+l36+l35-l23-l34+l13-l4-l27-l24+l26+l31-l30-l5-l40+l28-l11-l2-l39+l15+l10-l17+l3+l19+l22+l33+l0+l37+l16-l9-l32+l25-l21-l12+l6-l41+l20-l18==-<span class="number">12</span>)</span><br><span class="line">x.add(l6-l30-l20-l27-l14-l39+l41-l33-l0+l25-l32-l3+l26-l12+l8-l35-l24+l15+l9-l4+l13+l36+l34+l1-l28-l21+l18+l23+l29-l10-l38+l22+l37+l5+l19+l7+l16-l31==<span class="number">81</span>)</span><br><span class="line"><span class="built_in">print</span>(x.check())</span><br><span class="line"><span class="built_in">print</span>(x.model())</span><br><span class="line"></span><br><span class="line">l = [<span class="number">0</span>]*<span class="number">42</span> </span><br><span class="line">l[<span class="number">14</span>] = <span class="number">78</span></span><br><span class="line">l[<span class="number">28</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">16</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">17</span>] = <span class="number">101</span></span><br><span class="line">l[<span class="number">6</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">30</span>] = <span class="number">52</span></span><br><span class="line">l[<span class="number">36</span>] = <span class="number">84</span></span><br><span class="line">l[<span class="number">38</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">40</span>] = <span class="number">51</span></span><br><span class="line">l[<span class="number">3</span>] = <span class="number">103</span></span><br><span class="line">l[<span class="number">32</span>] = <span class="number">121</span></span><br><span class="line">l[<span class="number">11</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">9</span>] = <span class="number">110</span></span><br><span class="line">l[<span class="number">31</span>] = <span class="number">83</span></span><br><span class="line">l[<span class="number">0</span>] = <span class="number">102</span></span><br><span class="line">l[<span class="number">4</span>] = <span class="number">123</span></span><br><span class="line">l[<span class="number">1</span>] = <span class="number">108</span></span><br><span class="line">l[<span class="number">41</span>] = <span class="number">125</span></span><br><span class="line">l[<span class="number">35</span>] = <span class="number">49</span></span><br><span class="line">l[<span class="number">8</span>] = <span class="number">48</span></span><br><span class="line">l[<span class="number">19</span>] = <span class="number">85</span></span><br><span class="line">l[<span class="number">15</span>] = <span class="number">71</span></span><br><span class="line">l[<span class="number">21</span>] = <span class="number">84</span></span><br><span class="line">l[<span class="number">18</span>] = <span class="number">113</span></span><br><span class="line">l[<span class="number">23</span>] = <span class="number">48</span></span><br><span class="line">l[<span class="number">34</span>] = <span class="number">87</span></span><br><span class="line">l[<span class="number">7</span>] = <span class="number">108</span></span><br><span class="line">l[<span class="number">25</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">13</span>] = <span class="number">48</span></span><br><span class="line">l[<span class="number">33</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">27</span>] = <span class="number">115</span></span><br><span class="line">l[<span class="number">10</span>] = <span class="number">103</span></span><br><span class="line">l[<span class="number">2</span>] = <span class="number">97</span></span><br><span class="line">l[<span class="number">37</span>] = <span class="number">104</span></span><br><span class="line">l[<span class="number">5</span>] = <span class="number">65</span></span><br><span class="line">l[<span class="number">20</span>] = <span class="number">52</span></span><br><span class="line">l[<span class="number">29</span>] = <span class="number">69</span></span><br><span class="line">l[<span class="number">12</span>] = <span class="number">49</span></span><br><span class="line">l[<span class="number">24</span>] = <span class="number">110</span></span><br><span class="line">l[<span class="number">26</span>]= <span class="number">49</span></span><br><span class="line">l[<span class="number">22</span>] = <span class="number">105</span></span><br><span class="line">l[<span class="number">39</span>] = <span class="number">122</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">chr</span>(l[i]),end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>把求出来的手动转换成数组，然后输出</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220303113628202.png" class="" title="image-20220303113628202">

<p>用的是之前的方法做的，感觉不太简洁，看网上还有更好的方法</p>
<p><a target="_blank" rel="noopener" href="https://www.codetd.com/article/10613214">https://www.codetd.com/article/10613214</a></p>
<h1 id="BUUCTF–-V-amp-N2020-公开赛-CSRe"><a href="#BUUCTF–-V-amp-N2020-公开赛-CSRe" class="headerlink" title="BUUCTF–[V&amp;N2020 公开赛]CSRe"></a>BUUCTF–[V&amp;N2020 公开赛]CSRe</h1><p>这题首先是去混淆，然后是逆向.NET文件</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220302190858662.png" class="" title="image-20220302190858662">

<p>exeinfo PE可以得知这是个有混淆的文件.NET文件</p>
<p>使用de4dot文件去混淆</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220302191708667.png" class="" title="image-20220302191708667">

<p>然后用dnSpy逆向.net</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220302192058276.png" class="" title="image-20220302192058276">

<p>str解出来后是1415</p>
<p>text解出来之后是turn</p>
<p>flag{1415turn}</p>
<h1 id="ACTF新生赛2020-SoulLike-elf暴力-x2F-pwntools"><a href="#ACTF新生赛2020-SoulLike-elf暴力-x2F-pwntools" class="headerlink" title="[ACTF新生赛2020]SoulLike (elf暴力&#x2F;pwntools)"></a>[ACTF新生赛2020]SoulLike (elf暴力&#x2F;pwntools)</h1><p>用ida打开</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301171539782.png" class="" title="image-20220301171539782">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301171429735.png" class="" title="image-20220301171429735">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301171400689.png" class="" title="image-20220301171400689">

<p>sub_83A太大了，且篇都是xor,mov,add三个指令，</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301173228830.png" class="" title="image-20220301173228830">

<p>除了最后的几个字符</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301170943991.png" class="" title="image-20220301170943991">

<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://blog.css8.cn/post/1439298.html">https://blog.css8.cn/post/1439298.html</a></p>
<p>原来是配置的问题，需要修改ida &#x2F;ctg目录下的hexrays.cfg文件中的MAX_FUNCSIZE&#x3D;64，改成1024    </p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301175834423.png" class="" title="image-20220301175834423">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301180054634.png" class="" title="image-20220301180054634">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301180749505.png" class="" title="image-20220301180749505">

<p>就是将输入的flag，经过3000行的异或后，与最后的几个进行对比</p>
<p>因为最后有提示错误的位数，所以可以试着用爆破的方法……</p>
<p>这边放上大佬整理的关于pwntools的使用方法：</p>
<p><a target="_blank" rel="noopener" href="https://seamiloak.github.io/2020/10/16/pwntools%E4%BD%BF%E7%94%A8/">https://seamiloak.github.io/2020/10/16/pwntools%E4%BD%BF%E7%94%A8/</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/hanqdi_/article/details/107164199">https://blog.csdn.net/hanqdi_/article/details/107164199</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">table = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">    table.append(<span class="built_in">chr</span>(i))</span><br><span class="line"></span><br><span class="line">now = <span class="string">&quot;actf&#123;&quot;</span></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="comment"># 长度为12，跳出</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">12</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line"></span><br><span class="line">        io = process(<span class="string">&#x27;./SoulLike&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 构造flag</span></span><br><span class="line">        flag = now + i</span><br><span class="line">        flag = flag.ljust(<span class="number">17</span>,<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">        flag += <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"># success(flag)</span></span><br><span class="line">        io.sendline(flag)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#一直读到#出现为止</span></span><br><span class="line">        io.recvuntil(<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#10位之后就读两位</span></span><br><span class="line">        <span class="keyword">if</span> num &lt; <span class="number">9</span> :</span><br><span class="line"></span><br><span class="line">            <span class="comment">#recv里的1是接受的字节长度，n是数值</span></span><br><span class="line">            n = <span class="built_in">int</span>(io.recv(<span class="number">1</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            n = <span class="built_in">int</span>(io.recv(<span class="number">2</span>))</span><br><span class="line">           </span><br><span class="line">        io.close()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果n==num+1，则跳出内层循环</span></span><br><span class="line">        <span class="keyword">if</span> n == num + <span class="number">1</span>:</span><br><span class="line">            now = now + i</span><br><span class="line">            num = num + <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (num)</span><br><span class="line"><span class="built_in">print</span> (now + <span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301212015891.png" class="" title="image-20220301212015891">

<p>太强了！！</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="http://bubuko.com/infodetail-3671012.html">http://bubuko.com/infodetail-3671012.html</a></p>
<h1 id="羊城杯-2020-easyre-（base64-x2F-凯撒）"><a href="#羊城杯-2020-easyre-（base64-x2F-凯撒）" class="headerlink" title="[羊城杯 2020]easyre （base64&#x2F;凯撒）"></a>[羊城杯 2020]easyre （base64&#x2F;凯撒）</h1><p>还是很庆幸自己能独立做出来这一题的</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301004110974.png" class="" title="image-20220301004110974">



<p>第一个加密是base64加密，</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301004230946.png" class="" title="image-20220301004230946">

<p>第二个加密是base64加密后的变换，</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301004300317.png" class="" title="image-20220301004300317">



<p>第三次加密是所有字符向后+3</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301004317379.png" class="" title="image-20220301004317379">

<p>主要是第二次的加密，不知道到底是怎样转换的，</p>
<p>放到x64dbg中动调了一下</p>
<p>输入时带入了字符串</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301004848522.png" class="" title="image-20220301004848522">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789012&quot;</span></span><br></pre></td></tr></table></figure>

<p>一次加密后：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301004929888.png" class="" title="image-20220301004929888">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5MTI=&quot;</span></span><br></pre></td></tr></table></figure>

<p>二次加密后：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301005141723.png" class="" title="image-20220301005141723">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;R1dnd4eXowMTIYWJjZGVmZ2hpazNDU2Nzg5MTI=mtsbW5vcHFyc3&quot;</span></span><br></pre></td></tr></table></figure>

<p>当时看到加密函数之后人傻了，仔细观察发现只是固定字符段调换了位置，就写出了下面的解法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#a3--&gt;a1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode2</span>(<span class="params">decode_string</span>):</span><br><span class="line">    a3 = decode_string</span><br><span class="line">    a = a3[<span class="number">0</span>:<span class="number">13</span>]</span><br><span class="line">    b = a3[<span class="number">13</span>:<span class="number">26</span>]</span><br><span class="line">    c = a3[<span class="number">26</span>:<span class="number">39</span>]</span><br><span class="line">    d = a3[<span class="number">39</span>:<span class="number">52</span>]</span><br><span class="line"></span><br><span class="line">    a1 = b+d+a+c</span><br><span class="line">    <span class="built_in">print</span>(a1)</span><br><span class="line">    <span class="keyword">return</span> a1</span><br></pre></td></tr></table></figure>

<p>三次加密后：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301005257388.png" class="" title="image-20220301005257388">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;U4gqg7hArzPWLBZMmCJYpC5ksdcQGX5Qcj8PWL=pwveZ8yfKIbf6&quot;</span></span><br></pre></td></tr></table></figure>

<p>整体还是不难的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">flag_encode_3_times = <span class="string">&quot;EmBmP5Pmn7QcPU4gLYKv5QcMmB3PWHcP5YkPq3=cT6QckkPckoRG&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#a3--&gt;a1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode2</span>(<span class="params">decode_string</span>):</span><br><span class="line">    a3 = decode_string</span><br><span class="line">    a = a3[<span class="number">0</span>:<span class="number">13</span>]</span><br><span class="line">    b = a3[<span class="number">13</span>:<span class="number">26</span>]</span><br><span class="line">    c = a3[<span class="number">26</span>:<span class="number">39</span>]</span><br><span class="line">    d = a3[<span class="number">39</span>:<span class="number">52</span>]</span><br><span class="line"><span class="comment">##    print(a)</span></span><br><span class="line"><span class="comment">##    print(b)</span></span><br><span class="line"><span class="comment">##    print(c)</span></span><br><span class="line"><span class="comment">##    print(d)</span></span><br><span class="line">    a1 = b+d+a+c</span><br><span class="line">    <span class="built_in">print</span>(a1)</span><br><span class="line">    <span class="keyword">return</span> a1</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode1</span>(<span class="params">string</span>):</span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(string)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">        m = <span class="built_in">ord</span>(i)</span><br><span class="line">        <span class="keyword">if</span> m &gt;= <span class="number">65</span> <span class="keyword">and</span> m &lt;= <span class="number">90</span>:</span><br><span class="line">            s += <span class="built_in">chr</span>((m-<span class="number">65</span>+<span class="number">23</span>)%<span class="number">26</span>+<span class="number">65</span>)      </span><br><span class="line">        <span class="keyword">elif</span> m &gt;= <span class="number">97</span> <span class="keyword">and</span> m &lt;= <span class="number">122</span>:</span><br><span class="line">            s += <span class="built_in">chr</span>((m-<span class="number">97</span>+<span class="number">23</span>)%<span class="number">26</span>+<span class="number">97</span>)      </span><br><span class="line">        <span class="keyword">elif</span> m &gt;= <span class="number">48</span> <span class="keyword">and</span> m &lt;= <span class="number">57</span>:</span><br><span class="line">            s += <span class="built_in">chr</span>((m-<span class="number">48</span>+<span class="number">7</span>)%<span class="number">10</span>+<span class="number">48</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s += i</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">decode_string = decode1(flag_encode_3_times)</span><br><span class="line"></span><br><span class="line">decode2_string = decode2(decode_string)</span><br><span class="line"></span><br><span class="line">decode3_string = base64.b64decode(decode2_string)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decode3_string)</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220301005628789.png" class="" title="image-20220301005628789">



<h1 id="findKey-花指令-正逆向-MD5"><a href="#findKey-花指令-正逆向-MD5" class="headerlink" title="findKey (花指令+正逆向+MD5)"></a>findKey (花指令+正逆向+MD5)</h1><p>先查个壳</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226134232304.png" class="" title="image-20220226134232304">

<p>打开运行之后：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226134352960.png" class="" title="image-20220226134352960">

<p>发现有花指令：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226155541206.png" class="" title="image-20220226155541206">

<p>push了两个一样的指令，需要把下面一个去掉才行，nop一次就好</p>
<p>（大佬z1r0说，下面调用了一个系统的strlen函数，在call函数前，应该会push参数到栈中，而突然跳转本来就很奇怪……）</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226195109395.png" class="" title="image-20220226195109395">

<p>最后选中所有红色的代码，按一下p键，就反汇编成功了</p>
<p>注意，选中的代码一定要包含所有的红色代码，否则会有函数不显示</p>
<p>开始分析代码：（题目是findkey，而且也没有的输入……）</p>
<p>进一下sub_40101E函数，发现关键词8003u，是熟悉的味道：md5</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220227000729758.png" class="" title="image-20220227000729758">

<p>string1经过md5加密之后，与v15异或，需要等于Str的值</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220227004025313.png" class="" title="image-20220227004025313">

<p>经过if判断之后，string1再与v14异或，得到flag</p>
<p>整个程序可以写成以下的伪代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Str = <span class="string">&quot;0kk`d1a`55k222k2a776jbfgd`06cjjb&quot;</span></span><br><span class="line">string1 = string1(md5加密)</span><br><span class="line"><span class="keyword">if</span> string1^v15 == Str:</span><br><span class="line">	flag = string1^v14</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Are you kidding me?&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>逆向思路：</p>
<p>–&gt;Str^v15–&gt;string1(md5加密后)</p>
<p>–&gt;md5解密还原string1</p>
<p>–&gt;string1与v14异或</p>
<p>–&gt;解出flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Str = <span class="string">&quot;0kk`d1a`55k222k2a776jbfgd`06cjjb&quot;</span></span><br><span class="line">v15 = <span class="built_in">ord</span>(<span class="string">&#x27;S&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> _<span class="built_in">str</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)^v15),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>得出string1的值为“123321”</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220227001750115.png" class="" title="image-20220227001750115">

<p>v14的值：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226235622040.png" class="" title="image-20220226235622040">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v14 = [<span class="number">0x57</span>,<span class="number">0x5E</span>,<span class="number">0x52</span>,<span class="number">0x54</span>,<span class="number">0x49</span>,<span class="number">0x5F</span>,<span class="number">0x1</span>,<span class="number">0x6D</span>,<span class="number">0x69</span>,<span class="number">0x46</span>,<span class="number">0x2</span>,<span class="number">0x6E</span>,<span class="number">0x5F</span>,<span class="number">0x2</span>,<span class="number">0x6C</span>,<span class="number">0x57</span>,<span class="number">0x5B</span>,<span class="number">0x54</span>,<span class="number">0x4C</span>]</span><br></pre></td></tr></table></figure>

<p>string1与v15异或：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220227001948047.png" class="" title="image-20220227001948047">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v14 = [<span class="number">0x57</span>,<span class="number">0x5E</span>,<span class="number">0x52</span>,<span class="number">0x54</span>,<span class="number">0x49</span>,<span class="number">0x5F</span>,<span class="number">0x1</span>,<span class="number">0x6D</span>,<span class="number">0x69</span>,<span class="number">0x46</span>,<span class="number">0x2</span>,<span class="number">0x6E</span>,<span class="number">0x5F</span>,<span class="number">0x2</span>,<span class="number">0x6C</span>,<span class="number">0x57</span>,<span class="number">0x5B</span>,<span class="number">0x54</span>,<span class="number">0x4C</span>]</span><br><span class="line">string1 = [<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;1&#x27;</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v14)):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(v14[i]^<span class="built_in">ord</span>(string1[i%<span class="number">6</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{n0_Zu0_n0_die}</p>
<h1 id="GUET-CTF2019-number-game-动调-x2F-二叉树"><a href="#GUET-CTF2019-number-game-动调-x2F-二叉树" class="headerlink" title="[GUET-CTF2019]number_game (动调&#x2F;二叉树)"></a>[GUET-CTF2019]number_game (动调&#x2F;二叉树)</h1><p>ida打开函数，是这个样子：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225104707598.png" class="" title="image-20220225104707598">

<p>4006D6判断输入字符类型，不满足直接输出wrong</p>
<p>400758这块把我看迷糊了，很像二叉树的前序遍历</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225104852111.png" class="" title="image-20220225104852111">

<p>后面的400807也是一个打乱顺序的函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225105038607.png" class="" title="image-20220225105038607">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225104609667.png" class="" title="image-20220225104609667">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225104556654.png" class="" title="image-20220225104556654">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225104546421.png" class="" title="image-20220225104546421">

<p>用户输入字符–&gt;两个函数打乱–&gt;满足数独情况</p>
<p>满足数独的情况是</p>
<p>[0，4，2，1，4，2，1，4，3，0]</p>
<p>下午直接找了大佬z1r0来研究这一题。</p>
<p>首先我们想到的是pwndbg来动态调试这一题，当然调试出来了，但是我们带入的是值，不是下标，没有很好的解决这一题，然后我们选择了爆破，只是我们的方法不太好，也就爆破个几个小时就出来了……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">file_name = <span class="string">&#x27;./z1r0&#x27;</span></span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">r = process(file_name)</span><br><span class="line">d = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">ppp =[<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ppp:  </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> ppp:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> ppp:</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> ppp:</span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> ppp:</span><br><span class="line">                    <span class="keyword">for</span> n <span class="keyword">in</span> ppp:</span><br><span class="line">                        <span class="keyword">for</span> o <span class="keyword">in</span> ppp:</span><br><span class="line">                            <span class="keyword">for</span> p <span class="keyword">in</span> ppp:</span><br><span class="line">                                <span class="keyword">for</span> q <span class="keyword">in</span> ppp:</span><br><span class="line">                                    <span class="keyword">for</span> s <span class="keyword">in</span> ppp:</span><br><span class="line">                                        <span class="keyword">try</span>:</span><br><span class="line">                                            r = process(file_name)</span><br><span class="line">                                            d = i + j + k + l + m + n + o + p + q + s</span><br><span class="line"><span class="comment">#d = &#x27;11342400&#x27; + i + j </span></span><br><span class="line">                                            r.sendline(d)</span><br><span class="line">                                            <span class="keyword">if</span> r.recvline() == <span class="string">b&#x27;TQL!\n&#x27;</span>:</span><br><span class="line">                                                r.interactive()</span><br><span class="line">                                        <span class="keyword">except</span>:</span><br><span class="line">                                            <span class="built_in">print</span>(<span class="string">&#x27;error&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/th1r7een/articles/14532420.html">https://www.cnblogs.com/th1r7een/articles/14532420.html</a></p>
<p>这题最好还是正向来做……</p>
<p>首先是sub_400758函数构建了一颗二叉树</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">index,lenth</span>):</span><br><span class="line">	<span class="built_in">print</span>(index)</span><br><span class="line">	<span class="keyword">if</span> index &gt; lenth:</span><br><span class="line">		<span class="keyword">return</span> </span><br><span class="line">	test(<span class="number">2</span>*index+<span class="number">1</span>,lenth)</span><br><span class="line">	test(<span class="number">2</span>*(index+<span class="number">1</span>),lenth)</span><br><span class="line"></span><br><span class="line">test(<span class="number">0</span>,<span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226132217423.png" class="" title="image-20220226132217423">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226131758417.png" class="" title="image-20220226131758417">

<p>中序遍历后的顺序为：[7,3,8,1,9,4,0,5,2,6]</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226132807385.png" class="" title="image-20220226132807385">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226133115453.png" class="" title="image-20220226133115453">

<p>flag{1134240024}</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226133254228.png" class="" title="image-20220226133254228">

<p>发现IDA还可以动调！！</p>
<p>需要查看IDA权威指南，IDA动调的话，先放一防，先刷题先……</p>
<h1 id="firmware-路由器逆向-x2F-binwalk"><a href="#firmware-路由器逆向-x2F-binwalk" class="headerlink" title="firmware (路由器逆向&#x2F;binwalk)"></a>firmware (路由器逆向&#x2F;binwalk)</h1><p>关于固件分析的文章：</p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/ics-articles/262454.html">https://www.freebuf.com/articles/ics-articles/262454.html</a></p>
<p>关于路由器逆向的文章：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/QQ1084283172/article/details/66971242">https://blog.csdn.net/QQ1084283172/article/details/66971242</a></p>
<p>通常固件文件以bin&#x2F;zip&#x2F;LZMA&#x2F;arj等文件压缩类型封装。</p>
<p>题目给了一个bin文件，</p>
<p>用linux的file命令查看一下，查看是否是二进制镜像文件</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225203902698.png" class="" title="image-20220225203902698">

<p>通常用binwalk对其进行提取，当然也可以再用binwalk查看一下bin文件的细节信息</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225211159584.png" class="" title="image-20220225211159584">

<p>用binwalk对bin文件进行提取（e–extract）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binwalk -e firmware.<span class="built_in">bin</span></span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225212231402.png" class="" title="image-20220225212231402">

<p>可以看到提取出了这些文件<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225212358862.png" class="" title="image-20220225212358862"></p>
<p>我们再通过hexdump或者file确认一下，是否是squashsf文件系统，其地址00包含squashsf的头部特征(hsqs)</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225212052373.png" class="" title="image-20220225212052373">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225213336460.png" class="" title="image-20220225213336460">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225212933596.png" class="" title="image-20220225212933596">

<p>squashsf后缀文件需要进一步解压，从而获得固件的根文件</p>
<p>可能是binwalk没有安装完全，导致squashfs文件系统损坏</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220225214137376.png" class="" title="image-20220225214137376">

<p>binwalk安装传送门：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/QQ1084283172/article/details/65441110">https://blog.csdn.net/QQ1084283172/article/details/65441110</a></p>
<p>摸索了很久，发现firmware-mod-kit可以成功解压squashfs文件系统，</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/sjt670994562/article/details/98071249">https://blog.csdn.net/sjt670994562/article/details/98071249</a></p>
<p>这边放上github的firmware-mod-kit的链接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/mirror/firmware-mod-kit</span><br></pre></td></tr></table></figure>

<p>炸了……搞了很久还是报错kali和ubuntu都试过了……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226123822941.png" class="" title="image-20220226123822941">

<p>再放一放……</p>
<p>–更新–</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install firmware-mod-kit</span><br></pre></td></tr></table></figure>

<p>直接用apt安装即可（感谢大佬z1r0的指导！！）默认路径在opt下，在binwalk提取bin文件后的目录下输入下面的指令就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/opt/firmware-mod-kit/trunk/unsquashfs_all.sh ./<span class="number">120200.</span>squashfs  </span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226190741847.png" class="" title="image-20220226190741847">

<p>进入squashfs-root目录下的tmp文件夹</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226191546507.png" class="" title="image-20220226191546507">

<p>file一下，elf文件，ARM类型，但是无法执行</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226191713847.png" class="" title="image-20220226191713847">

<p>发现有upx壳</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226192055912.png" class="" title="image-20220226192055912">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upx -d backdoor  </span><br></pre></td></tr></table></figure>

<p>脱壳之后放在ida里面反汇编</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226192902860.png" class="" title="image-20220226192902860">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226192916512.png" class="" title="image-20220226192916512">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226193621502.png" class="" title="image-20220226193621502"><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220226193602820.png" class="" title="image-20220226193602820">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo.byethost51.com:<span class="number">36667</span></span><br></pre></td></tr></table></figure>

<p>​    flag{33a422c45d551ac6e4756f59812a954b}</p>
<h1 id="WMCTF2020-easy-re-perl特性"><a href="#WMCTF2020-easy-re-perl特性" class="headerlink" title="[WMCTF2020]easy_re (perl特性)"></a>[WMCTF2020]easy_re (perl特性)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220223233821237.png" class="" title="image-20220223233821237">

<p>查壳后发现没壳，用x64dbg打开</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220223233946722.png" class="" title="image-20220223233946722">

<p>搜索script，并添加断点</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220223234011879.png" class="" title="image-20220223234011879">

<p>向下F8，flag就出来了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220223234126050.png" class="" title="image-20220223234126050">

<p>WMCTF{I_WAnt_dynam1c_F1ag}</p>
<p>据说是因为perl语言解压call有字符串script，</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/Palmer9/article/details/107727922">https://blog.csdn.net/Palmer9/article/details/107727922</a></p>
<h1 id="crackMe-od动调"><a href="#crackMe-od动调" class="headerlink" title="crackMe (od动调)"></a>crackMe (od动调)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220223235000529.png" class="" title="image-20220223235000529">

<p>用ida32打开后</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220223235103466.png" class="" title="image-20220223235103466">

<p>最外层是一个死循环，要想跳出死循环，需要满足后面的if嵌套，</p>
<p>可以发现if嵌套上面的sub_401090是用来给byte_416050赋值的，还把welcomebeijing这个用户名作为了参数传递到了其中</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220223235403104.png" class="" title="image-20220223235403104">



<p>接着跟进sub_401830，说了一大串之后，v17作为二参进入了sub_401470</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220223235600491.png" class="" title="image-20220223235600491">



<p>要使得v14，也就是sub_40147中的a3等于43924,需要满足a2满足所有的if条件，也就是a2&#x3D;”dbappsec”，即v17&#x3D;”dbappsec”，猜测v17是输入的flag经过变换后对比的值</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224000004594.png" class="" title="image-20220224000004594">



<p>返回sub_401830函数，关于v17的值的代码块也就只有这边了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224000610855.png" class="" title="image-20220224000610855">



<p>接下来，我们需要动调，把与byte_416050异或的v16数组求出来</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224002945622.png" class="" title="image-20220224002945622">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224003001845.png" class="" title="image-20220224003001845">

<p>通过明显的地方，可以推算出ida和x32dbg的地址差</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224003105865.png" class="" title="image-20220224003105865">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224003426084.png" class="" title="image-20220224003426084">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224003444325.png" class="" title="image-20220224003444325">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224003506728.png" class="" title="image-20220224003506728">

<p>光标确定到某一参数，按住tab键可以查看其汇编代码，在伪代码窗口的定义部分可以看到这些参数关于ebp的偏移</p>
<p>加上偏移量就能快速定位到需要执行的函数了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224003828267.png" class="" title="image-20220224003828267">

<p>在ida中定位while大循环，然后再dbg中定位，在循环开始和xor处打断点，多按几次F9,记录一下edx低位的值</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224004102569.png" class="" title="image-20220224004102569">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224004135224.png" class="" title="image-20220224004135224">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224004516711.png" class="" title="image-20220224004516711">

<p>正向：</p>
<p>user输入–&gt;byte_406050–&gt;byte_406050^v16[v5-1]–&gt;v17</p>
<p>逆向：</p>
<p>v17–&gt;byte_406050^v17–&gt;v16[v5-1]</p>
<p>byte_406050数组，是user传入之后经过一系列变换生成的，我们需要动调的就是byte_406050的值，然后在与已知的v17异或，就是v16的值了，也就是题目要求的flag</p>
<p>我动调之后的结果是[0x7e,0x98,0xc9,0x95,0x10,0x6d,0xf3,0x67]</p>
<p>先放一放……</p>
<p>—-更新—-</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224214459365.png" class="" title="image-20220224214459365">

<p>在xor的上下有两个反调试指令，所以应该把je改成jmp,动调就行了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224214422437.png" class="" title="image-20220224214422437">

<p>调试结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v16 = [<span class="number">0x2a</span>,<span class="number">0xd7</span>,<span class="number">0x92</span>,<span class="number">0xe9</span>,<span class="number">0x53</span>,<span class="number">0xe2</span>,<span class="number">0xc4</span>,<span class="number">0xcd</span>]</span><br></pre></td></tr></table></figure>

<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v16 = [<span class="number">0x2a</span>,<span class="number">0xd7</span>,<span class="number">0x92</span>,<span class="number">0xe9</span>,<span class="number">0x53</span>,<span class="number">0xe2</span>,<span class="number">0xc4</span>,<span class="number">0xcd</span>]</span><br><span class="line">v17 = <span class="string">&quot;dbappsec&quot;</span></span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    flag.append(<span class="built_in">hex</span>(v16[i]^<span class="built_in">ord</span>(v17[i])).replace(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;&quot;</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(i,end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>关于反调试的可以看看雪大神的这篇文章：</p>
<p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-225740.htm">https://bbs.pediy.com/thread-225740.htm</a></p>
<p>参考文章：</p>
<p><a target="_blank" rel="noopener" href="https://www.songbingjia.com/nginx/show-209658.html">https://www.songbingjia.com/nginx/show-209658.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pppyyyzzz/p/12546844.html">https://www.cnblogs.com/pppyyyzzz/p/12546844.html</a></p>
<h1 id="特殊的base64-base64换表"><a href="#特殊的base64-base64换表" class="headerlink" title="特殊的base64 (base64换表)"></a>特殊的base64 (base64换表)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224020955278.png" class="" title="image-20220224020955278">

<p>经典的base64换表，“mTy……”是换表之后的加密的字符串，字符串搜索之后可以看到换的base64表。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224021231157.png" class="" title="image-20220224021231157">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">string = <span class="string">&quot;mTyqm7wjODkrNLcWl0eqO8K8gc1BPk1GNLgUpI==&quot;</span></span><br><span class="line"></span><br><span class="line">new_base = <span class="string">&quot;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0987654321/+&quot;</span></span><br><span class="line"></span><br><span class="line">base = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(new_base))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(base))</span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(string.translate(<span class="built_in">str</span>.maketrans(new_base,base)))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224021131150.png" class="" title="image-20220224021131150">



<h1 id="网鼎杯-2020-青龙组-singal-vm题-x2F-ponce插件"><a href="#网鼎杯-2020-青龙组-singal-vm题-x2F-ponce插件" class="headerlink" title="[网鼎杯 2020 青龙组]singal (vm题&#x2F;ponce插件)"></a>[网鼎杯 2020 青龙组]singal (vm题&#x2F;ponce插件)</h1><p>传送门：<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1176826-1-1.html">https://www.52pojie.cn/thread-1176826-1-1.html</a></p>
<p>查壳，发现没有壳</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224064930079.png" class="" title="image-20220224064930079">

<p>这个qmemcpy的意思是把unk_403040的456个字符复制到v4中</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224065537262.png" class="" title="image-20220224065537262">

<p>这个题就是首先是需要去摸清楚指令的调用顺序</p>
<p>进行观察，可以发现，v4 与 a1[v10 + 1]比较 是判断条件，a1是输入的opcode, 而v4来自v5，v5由flag进行运算得到: flag—&gt;v5—-&gt;v4 所以我们要得到v4,然后推v5，再得到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"> </span><br><span class="line">unsigned char vmcode[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x10</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x21</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x24</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x25</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x36</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x25</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x41</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x34</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x32</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x72</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x33</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x18</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xA7</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>,</span><br><span class="line">  <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x28</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x84</span>, <span class="number">0xFF</span>,</span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>,</span><br><span class="line">  <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x1E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x7A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="built_in">int</span> * a = (<span class="built_in">int</span> *)vmcode;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> __cdecl vm_operad(<span class="built_in">int</span> *opcode, <span class="built_in">int</span> len_114)</span><br><span class="line">&#123;</span><br><span class="line">        char order[<span class="number">114</span>] = &#123;&#125;;        //顺序         即i</span><br><span class="line">        char flag[<span class="number">100</span>]; // [esp+13h] [ebp-E5h]</span><br><span class="line">        char v4[<span class="number">100</span>]; // [esp+77h] [ebp-81h]</span><br><span class="line">        char v5; // [esp+DBh] [ebp-1Dh]</span><br><span class="line">        <span class="built_in">int</span> j; // [esp+DCh] [ebp-1Ch]</span><br><span class="line">        <span class="built_in">int</span> m; // [esp+E0h] [ebp-18h]</span><br><span class="line">        <span class="built_in">int</span> k; // [esp+E4h] [ebp-14h]</span><br><span class="line">        <span class="built_in">int</span> n; // [esp+E8h] [ebp-10h]</span><br><span class="line">        <span class="built_in">int</span> i; // [esp+ECh] [ebp-Ch]</span><br><span class="line">        <span class="built_in">int</span> s = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">        i = <span class="number">0</span>;</span><br><span class="line">        n = <span class="number">0</span>;</span><br><span class="line">        k = <span class="number">0</span>;</span><br><span class="line">        m = <span class="number">0</span>;</span><br><span class="line">        j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">if</span> (i &gt;= len_114)                         // 成功的地方</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                switch (opcode[i])</span><br><span class="line">                &#123;</span><br><span class="line">                case <span class="number">1</span>:</span><br><span class="line">                        v4[m] = v5;</span><br><span class="line">                        ++i;</span><br><span class="line">                        ++m;</span><br><span class="line">                        ++n;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">2</span>:</span><br><span class="line">                        v5 = opcode[i + <span class="number">1</span>] + flag[n];</span><br><span class="line">                        i += <span class="number">2</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">3</span>:</span><br><span class="line">                        v5 = flag[n] - opcode[i + <span class="number">1</span>];</span><br><span class="line">                        i += <span class="number">2</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">4</span>:</span><br><span class="line">                        v5 = opcode[i + <span class="number">1</span>] ^ flag[n];</span><br><span class="line">                        i += <span class="number">2</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">5</span>:</span><br><span class="line">                        v5 = opcode[i + <span class="number">1</span>] * flag[n];</span><br><span class="line">                        i += <span class="number">2</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">6</span>:</span><br><span class="line">                        ++i;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">7</span>:</span><br><span class="line">                        v4[k] = opcode[i + <span class="number">1</span>];                        // 打印关键数据V4</span><br><span class="line">                        printf(<span class="string">&quot;%#X, &quot;</span>, v4[k]);                </span><br><span class="line">                        ++k;</span><br><span class="line">                        i += <span class="number">2</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">8</span>:</span><br><span class="line">                        flag[j] = v5;</span><br><span class="line">                        ++i;</span><br><span class="line">                        ++j;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">10</span>:</span><br><span class="line">                        scanf(<span class="string">&quot;%s&quot;</span>, flag);                                // 输入flag                //长度是<span class="number">15</span></span><br><span class="line">                        ++i;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">11</span>:</span><br><span class="line">                        v5 = flag[n] - <span class="number">1</span>;</span><br><span class="line">                        ++i;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">12</span>:</span><br><span class="line">                        v5 = flag[n] + <span class="number">1</span>;</span><br><span class="line">                        ++i;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                order[s++] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        printf(<span class="string">&quot;\n执行顺序是: &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> ss = <span class="number">0</span>; ss &lt; strlen(order); ss++) &#123;</span><br><span class="line">                printf(<span class="string">&quot;%d, &quot;</span>, order[ss]);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">int</span> decode(<span class="built_in">int</span> * opcode, <span class="built_in">int</span> len_114)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="built_in">int</span> i;</span><br><span class="line">        //获取flag 的关键数据</span><br><span class="line">        unsigned char v4[] = &#123; <span class="number">0X22</span>, <span class="number">0X3F</span>, <span class="number">0X34</span>, <span class="number">0X32</span>, <span class="number">0X72</span>, <span class="number">0X33</span>, <span class="number">0X18</span>, <span class="number">0XFFFFFFA7</span>, <span class="number">0X31</span>, <span class="number">0XFFFFFFF1</span>, <span class="number">0X28</span>, <span class="number">0XFFFFFF84</span>, <span class="number">0XFFFFFFC1</span>, <span class="number">0X1E</span>, <span class="number">0X7A</span> &#125;;</span><br><span class="line">        //执行opcode 的索引，即执行顺序</span><br><span class="line">        char order[<span class="number">100</span>] = &#123; <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">35</span>, <span class="number">36</span>, <span class="number">38</span>, <span class="number">39</span>, <span class="number">41</span>, <span class="number">42</span>, <span class="number">44</span>, <span class="number">45</span>, <span class="number">46</span>, <span class="number">47</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">57</span>, <span class="number">58</span>, <span class="number">60</span>, <span class="number">61</span>, <span class="number">63</span>, <span class="number">64</span>, <span class="number">66</span>, <span class="number">67</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">72</span>, <span class="number">73</span>, <span class="number">75</span>, <span class="number">76</span>, <span class="number">78</span>, <span class="number">79</span>, <span class="number">81</span>, <span class="number">82</span>, <span class="number">83</span>, <span class="number">84</span>, <span class="number">86</span>, <span class="number">88</span>, <span class="number">90</span>, <span class="number">92</span>, <span class="number">94</span>, <span class="number">96</span>, <span class="number">98</span>, <span class="number">100</span>, <span class="number">102</span>, <span class="number">104</span>, <span class="number">106</span>, <span class="number">108</span>, <span class="number">110</span>, <span class="number">112</span>, <span class="number">114</span> &#125;;</span><br><span class="line">        unsigned char flag[<span class="number">100</span>] = &#123;&#125;;</span><br><span class="line">        <span class="built_in">int</span> m = <span class="number">15</span>;</span><br><span class="line">        <span class="built_in">int</span> n = <span class="number">15</span>;</span><br><span class="line">        <span class="built_in">int</span> j = <span class="number">15</span>;</span><br><span class="line">        <span class="built_in">int</span> v5;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> k = strlen(order) - <span class="number">1</span>; k &gt;= <span class="number">0</span> ; k--)</span><br><span class="line">        &#123;</span><br><span class="line">                i = order[k];</span><br><span class="line">                switch (opcode[i])                                // 倒序执行</span><br><span class="line">                &#123;</span><br><span class="line">                case <span class="number">1</span>:</span><br><span class="line">                        --m;</span><br><span class="line">                        --n;</span><br><span class="line">                        v5 = v4[m];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">2</span>:</span><br><span class="line">                        flag[n] = v5 - char(opcode[i + <span class="number">1</span>]) ;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">3</span>:</span><br><span class="line">                    flag[n] = v5 + char(opcode[i + <span class="number">1</span>]);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">4</span>:</span><br><span class="line">                        flag[n] = (v5 ^ opcode[i + <span class="number">1</span>]) &amp; <span class="number">0XFF</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">5</span>:</span><br><span class="line">                        flag[n] = v5 / opcode[i + <span class="number">1</span>];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">6</span>:</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">8</span>:</span><br><span class="line">                        v5 = flag[--j];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">11</span>:</span><br><span class="line">                        flag[n] = v5 + <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                case <span class="number">12</span>:</span><br><span class="line">                        flag[n] = v5 - <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        printf(<span class="string">&quot;%s&quot;</span>, flag);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;        </span><br><span class="line">        vm_operad(a, <span class="number">114</span>);</span><br><span class="line">        decode(a, <span class="number">114</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224123847090.png" class="" title="image-20220224123847090">

<p>通过case7对比的数组v4来求出v5，即执行的顺序,然后通过v5来求出flag反向推出flag，执行顺序由后往前。</p>
<p>学到一招，可以把多行的数据转换成数组</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220224122330440.png" class="" title="image-20220224122330440">



<p><a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1187493-1-1.html">https://www.52pojie.cn/thread-1187493-1-1.html</a></p>
<p>很好奇还有关于ida插件ponce的使用来解决这一道题</p>
<p>–待更新–</p>
<h1 id="GWCTF-2019-xxor-（xor-plus）"><a href="#GWCTF-2019-xxor-（xor-plus）" class="headerlink" title="[GWCTF 2019]xxor （xor plus）"></a>[GWCTF 2019]xxor （xor plus）</h1><p>当初发现这个题目不是一般的难，就跳过了，这次正好来总结一下。</p>
<p>下载后发现是个linux文件，先放linux运行一下：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209163239111.png" class="" title="image-20220209163239111">

<p>放到ida里面看一下</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209163144253.png" class="" title="image-20220209163144253">

<p>首先是循环输入六次，然后进入一个循环，然后sub_400686这个函数一看就是加密函数了，一参是我们输入的值，二参是一个固定数组。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209163758288.png" class="" title="image-20220209163758288">

<p>2 dup(2) ,就是2出现两次的意思，上次个maze题也出现过</p>
<p>那这样二参我们就知道了：{2,2,3,4}</p>
<p>注意一下第二个循环，j循环了三次</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209163641955.png" class="" title="image-20220209163641955">

<p>后面的的sub_400770则是比较函数了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209164331954.png" class="" title="image-20220209164331954">

<p>我们跟进：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209164409530.png" class="" title="image-20220209164409530">

<p>我这边正好熟悉一下z3的用法：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209151626581.png" class="" title="image-20220209151626581">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a0,a1,a2,a3,a4,a5 = Ints(<span class="string">&#x27;a0 a1 a2 a3 a4 a5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">x = Solver()</span><br><span class="line"></span><br><span class="line">x.add(a2 - a3 == <span class="number">2225223423</span>)</span><br><span class="line">x.add(a3 + a4 == <span class="number">4201428739</span>)</span><br><span class="line">x.add(a2 - a4 == <span class="number">1121399208</span>)</span><br><span class="line">x.add(a0 == <span class="number">3746099070</span>)</span><br><span class="line">x.add(a5 == <span class="number">2230518816</span>)</span><br><span class="line">x.add(a1 == <span class="number">550153460</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x.check())</span><br><span class="line"><span class="built_in">print</span>(x.model())</span><br><span class="line">unsigned lis[] = &#123;<span class="number">3746099070</span>, <span class="number">550153460</span>,<span class="number">3774025685</span>,<span class="number">1548802262</span>,<span class="number">2652626477</span>,<span class="number">2230518816</span>&#125;;</span><br></pre></td></tr></table></figure>

<p>也就是六个数字，循环三次，两两计算</p>
<p>v5初始等于0，那逆向就是0x40*1166789954 &#x3D; 74674557056，原来每次递增，那么最后就递减</p>
<p>别的如果是加，那么就都减去，次序再调换一下</p>
<p>（貌似python对位移运算不够友善，以后做这种计算的题目还是用c吧）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> a[] = &#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line"></span><br><span class="line">unsigned lis[] = &#123;<span class="number">3746099070</span>, <span class="number">550153460</span>,<span class="number">3774025685</span>,<span class="number">1548802262</span>,<span class="number">2652626477</span>,<span class="number">2230518816</span>&#125;;</span><br><span class="line"></span><br><span class="line">void function(unsigned* x)&#123;</span><br><span class="line">    unsigned  v3 = *x;</span><br><span class="line">    unsigned  v4 = *(x + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">int</span> v5 = <span class="number">74674557056</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">63</span> ;i++)&#123;</span><br><span class="line">        v4 -= (v3 + v5 + <span class="number">20</span>) ^ ((v3 &lt;&lt; <span class="number">6</span>) + a[<span class="number">2</span>]) ^ ((v3 &gt;&gt; <span class="number">9</span>) + a[<span class="number">3</span>]) ^ <span class="number">0x10</span>;</span><br><span class="line">        v3 -= (v4 + v5 + <span class="number">11</span>) ^ ((v4 &lt;&lt; <span class="number">6</span>) + a[<span class="number">0</span>]) ^ ((v4 &gt;&gt; <span class="number">9</span>) + a[<span class="number">1</span>]) ^ <span class="number">0x20</span>;</span><br><span class="line">        v5 -= <span class="number">1166789954</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    *x = v3;</span><br><span class="line">    *(x+<span class="number">1</span>) = v4;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">int</span> main()&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span> ;i += <span class="number">2</span>)&#123;</span><br><span class="line">        function(lis+i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>;i &lt; <span class="number">6</span> ;i ++)</span><br><span class="line">        printf(<span class="string">&quot;%c%c%c&quot;</span>,(lis[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>,(lis[i] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>,lis[i] &amp; <span class="number">0xff</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209162950737.png" class="" title="image-20220209162950737">

<p>令我疑惑的是，为什么会有下面的操作？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>;i &lt; <span class="number">6</span> ;i ++)</span><br><span class="line">        printf(<span class="string">&quot;%c%c%c&quot;</span>,(lis[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>,(lis[i] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>,lis[i] &amp; <span class="number">0xff</span>);</span><br></pre></td></tr></table></figure>

<p>思考了一下，发现不加后面的&amp;0xff结果也一样</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209165717260.png" class="" title="image-20220209165717260">



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209165234148.png" class="" title="image-20220209165234148">



<h1 id="WUSTCTF2020-level4（二叉树遍历）"><a href="#WUSTCTF2020-level4（二叉树遍历）" class="headerlink" title="[WUSTCTF2020]level4（二叉树遍历）"></a>[WUSTCTF2020]level4（二叉树遍历）</h1><p>先放linux里面运行了一下</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209183746974.png" class="" title="image-20220209183746974">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2f0t02T&#123;hcsiI_SwA__r7Ee&#125;</span><br><span class="line">20f0Th&#123;2tsIS_icArE&#125;e7__w</span><br><span class="line"> //type3(&amp;x[<span class="number">22</span>]);   No way!</span><br></pre></td></tr></table></figure>



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209183640821.png" class="" title="image-20220209183640821">

<p>ida打开</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209183812773.png" class="" title="image-20220209183812773">

<p>只能理解为顺序错了，两串字符串的内容是一致的。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209195656996.png" class="" title="image-20220209195656996">

<p>两个函数都是递归函数，Type1函数putchar（）在中间，Type2函数putchar（）在后面，而且上面的提示语句（Data Structure）已经告诉我们是关于数据结构的东西。我们便可以想到是树的前中后遍历，那么Type1就是中序遍历,Type2函数就是后序遍历，我们需要的就是Type3就是前序遍历，开始手动绘制……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209204910672.png" class="" title="image-20220209204910672">

<p>wctf2020{This_IS_A_7reE}</p>
<h1 id="ACTF新生赛2020-Universe-final-answer-z3计算"><a href="#ACTF新生赛2020-Universe-final-answer-z3计算" class="headerlink" title="[ACTF新生赛2020]Universe_final_answer (z3计算)"></a>[ACTF新生赛2020]Universe_final_answer (z3计算)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220204210706705.png" class="" title="image-20220204210706705">

<p>查个壳，然后用ida64打开</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220204211536688.png" class="" title="image-20220204211536688">

<p>跟进这个sub_860函数，就能看到一堆的方程</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220204211607624.png" class="" title="image-20220204211607624">

<p>在网上学习了一下python中z3的基本用法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">a,s,d = Ints(<span class="string">&#x27;a s d&#x27;</span>)</span><br><span class="line">x = Solver()</span><br><span class="line">x.add(a-d == <span class="number">18</span>)</span><br><span class="line">x.add(a+s == <span class="number">12</span>)</span><br><span class="line">x.add(s-d == <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">x.check()</span><br><span class="line">x.model()</span><br><span class="line"><span class="built_in">print</span>(x.model())</span><br></pre></td></tr></table></figure>

<p>下面开始着手编写对应脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">v1,v2,v3,v4,v5,v6,v7,v8,v9,v11 = Ints(<span class="string">&#x27;v1 v2 v3 v4 v5 v6 v7 v8 v9 v11&#x27;</span>)</span><br><span class="line">x = Solver()</span><br><span class="line">x.add(-<span class="number">85</span> * v9 + <span class="number">58</span> * v8 + <span class="number">97</span> * v6 + v7 + -<span class="number">45</span> * v5 + <span class="number">84</span> * v4 + <span class="number">95</span> * v2 - <span class="number">20</span> * v1 + <span class="number">12</span> * v3 == <span class="number">12613</span>)</span><br><span class="line">x.add(<span class="number">30</span> * v11 + -<span class="number">70</span> * v9 + -<span class="number">122</span> * v6 + -<span class="number">81</span> * v7 + -<span class="number">66</span> * v5 + -<span class="number">115</span> * v4 + -<span class="number">41</span> * v3 + -<span class="number">86</span> * v1 - <span class="number">15</span> * v2 - <span class="number">30</span> * v8 == -<span class="number">54400</span>)</span><br><span class="line">x.add(-<span class="number">103</span> * v11 + <span class="number">120</span> * v8 + <span class="number">108</span> * v7 + <span class="number">48</span> * v4 + -<span class="number">89</span> * v3 + <span class="number">78</span> * v1 - <span class="number">41</span> * v2 + <span class="number">31</span> * v5 - v6 * <span class="number">64</span> - <span class="number">120</span> * v9 == -<span class="number">10283</span>)</span><br><span class="line">x.add(<span class="number">71</span> * v6 + v7 * <span class="number">128</span> + <span class="number">99</span> * v5 + -<span class="number">111</span> * v3 + <span class="number">85</span> * v1 + <span class="number">79</span> * v2 - <span class="number">30</span> * v4 - <span class="number">119</span> * v8 + <span class="number">48</span> * v9 - <span class="number">16</span> * v11 == <span class="number">22855</span>)</span><br><span class="line">x.add( <span class="number">5</span> * v11 + <span class="number">23</span> * v9 + <span class="number">122</span> * v8 + -<span class="number">19</span> * v6 + <span class="number">99</span> * v7 + -<span class="number">117</span> * v5 + -<span class="number">69</span> * v3 + <span class="number">22</span> * v1 - <span class="number">98</span> * v2 + <span class="number">10</span> * v4 == -<span class="number">2944</span>)</span><br><span class="line">x.add(-<span class="number">54</span> * v11 + -<span class="number">23</span> * v8 + -<span class="number">82</span> * v3 + -<span class="number">85</span> * v2 + <span class="number">124</span> * v1 - <span class="number">11</span> * v4 - <span class="number">8</span> * v5 - <span class="number">60</span> * v7 + <span class="number">95</span> * v6 + <span class="number">100</span> * v9 == -<span class="number">2222</span>)</span><br><span class="line">x.add(-<span class="number">83</span> * v11 + -<span class="number">111</span> * v7 + -<span class="number">57</span> * v2 + <span class="number">41</span> * v1 + <span class="number">73</span> * v3 - <span class="number">18</span> * v4 + <span class="number">26</span> * v5 + <span class="number">16</span> * v6 + <span class="number">77</span> * v8 - <span class="number">63</span> * v9 == -<span class="number">13258</span>)</span><br><span class="line">x.add(<span class="number">81</span> * v11 + -<span class="number">48</span> * v9 + <span class="number">66</span> * v8 + -<span class="number">104</span> * v6 + -<span class="number">121</span> * v7 + <span class="number">95</span> * v5 + <span class="number">85</span> * v4 + <span class="number">60</span> * v3 + -<span class="number">85</span> * v2 + <span class="number">80</span> * v1 == -<span class="number">1559</span>)</span><br><span class="line">x.add(<span class="number">101</span> * v11 + -<span class="number">85</span> * v9 + <span class="number">7</span> * v6 + <span class="number">117</span> * v7 + -<span class="number">83</span> * v5 + -<span class="number">101</span> * v4 + <span class="number">90</span> * v3 + -<span class="number">28</span> * v1 + <span class="number">18</span> * v2 - v8 == <span class="number">6308</span>)</span><br><span class="line">x.add(<span class="number">99</span> * v11 + -<span class="number">28</span> * v9 + <span class="number">5</span> * v8 + <span class="number">93</span> * v6 + -<span class="number">18</span> * v7 + -<span class="number">127</span> * v5 + <span class="number">6</span> * v4 + -<span class="number">9</span> * v3 + -<span class="number">93</span> * v1 + <span class="number">58</span> * v2 == -<span class="number">1697</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x.check())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x.model())</span><br></pre></td></tr></table></figure>

<p>解出来之后，还需要转化一下，且注意顺序，v2是a1[0]，v6与v5的次序是对调的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[v1 = <span class="number">48</span>,</span><br><span class="line"> v6 = <span class="number">95</span>,</span><br><span class="line"> v2 = <span class="number">70</span>,</span><br><span class="line"> v4 = <span class="number">82</span>,</span><br><span class="line"> v11 = <span class="number">64</span>,</span><br><span class="line"> v3 = <span class="number">117</span>,</span><br><span class="line"> v5 = <span class="number">84</span>,</span><br><span class="line"> v7 = <span class="number">121</span>,</span><br><span class="line"> v9 = <span class="number">119</span>,</span><br><span class="line"> v8 = <span class="number">55</span>]</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220204214039212.png" class="" title="image-20220204214039212">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lis = [ <span class="number">70</span>,<span class="number">48</span>,<span class="number">117</span>,<span class="number">82</span>,<span class="number">84</span>,<span class="number">121</span>,<span class="number">95</span>,<span class="number">55</span>,<span class="number">119</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lis:</span><br><span class="line">    flag+=<span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>F0uRTy_7w@</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220204215738605.png" class="" title="image-20220204215738605">

<p>所以说sub_860的值出来了，进入一个sub_C50()函数判断，我们只需要用Linux虚拟机运行一下，将我们求得的字符串带入输入到其中，使得条件成立，flag就出来了。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220204215721116.png" class="" title="image-20220204215721116">

<p>flag{F0uRTy_7w@_42}</p>
<h1 id="UTCTF2020-basic-re-水题"><a href="#UTCTF2020-basic-re-水题" class="headerlink" title="[UTCTF2020]basic-re (水题)"></a>[UTCTF2020]basic-re (水题)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220203092702710.png" class="" title="image-20220203092702710">

<p>用ida64打开看看</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220203092957697.png" class="" title="image-20220203092957697">

<p>flag{str1ngs_1s_y0ur_fr13nd}</p>
<h1 id="Zer0pts2020-easy-strcmp-binascii-函数变址"><a href="#Zer0pts2020-easy-strcmp-binascii-函数变址" class="headerlink" title="[Zer0pts2020]easy strcmp (binascii+函数变址)"></a>[Zer0pts2020]easy strcmp (binascii+函数变址)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220203195316587.png" class="" title="image-20220203195316587">

<p>查壳后用ida64打开</p>
<p>这题貌似没有我想的那么简单</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall main(<span class="built_in">int</span> a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1 &gt; <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !strcmp(a2[<span class="number">1</span>], <span class="string">&quot;zer0pts&#123;********CENSORED********&#125;&quot;</span>) )</span><br><span class="line">      puts(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      puts(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;Usage: %s &lt;FLAG&gt;\n&quot;</span>, *a2);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这边的mian函数只是一个比较的函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220203202445218.png" class="" title="image-20220203202445218">

<p>参考资料：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mayfly-nymph/p/13154909.html">https://www.cnblogs.com/Mayfly-nymph/p/13154909.html</a></p>
<p>但是人没写怎么查找到加密输入符号的函数</p>
<p>这边放上z1r0的解析:</p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/people/xu-xu-xuxu-94">https://www.zhihu.com/people/xu-xu-xuxu-94</a></p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220203202835059.png" class="" title="image-20220203202835059">

<p>在机智聪明，成熟老练的z1r0的指导下，我逐渐摸清楚为两个函数是如何变幻的，并且还学到了很多东西，我总结一下：</p>
<p>在sub_795这个函数中，可以看到：</p>
<p>qword_201090这个全局变量（在.bss表中，所以是全局变量）保存的是strcmp的地址</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220204221924764.png" class="" title="image-20220204221924764">

<p>off_201028&#x3D;sub_6EA是什么意思？我们跟进一下</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220204222111763.png" class="" title="image-20220204222111763">

<p>首先理解一下offset是什么意思：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/deniece1/article/details/102934346">https://blog.csdn.net/deniece1/article/details/102934346</a></p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220204222755624.png" class="" title="image-20220204222755624">

<p>offset为属性操作符，表示应该把其后面的符号地址的值，不是内容作为操作数，所以off_201028应该存放的是strcmp的地址</p>
<p>所以，off_201028 &#x3D; sub_6EA，相当于把sub_6EA的地址赋值给了strcmp！！！再推理一下，全局变量qword_201090保存的是strcmp的地址，所以如果要执行strcmp函数，我们需要用qword_201090来实现。</p>
<p>据z1r0所说：.plt段存放的一般是puts&#x2F;printf函数，.bss存放的是全局变量，init放置的是程序初始化的代码块，.text存放代码段。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220204221814094.png" class="" title="image-20220204221814094">

<p>因此，在main函数中的strcmp函数，其实调用的是sub_6EA这个函数</p>
<p>我们跟进sub_6EA这个函数：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220204223755043.png" class="" title="image-20220204223755043">

<p>第一个for循环是用来测定输入字符串的长度，v4除以8再+1，相当于组数。然后第二个for循环，每组减去qword_201060这个数组，我们跟进</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220204224204161.png" class="" title="image-20220204224204161">

<p>程序后面的qword_201090，我们推理过了，就相当于于是strcmp，用来于外面的”zer0pts{<em><strong>*<strong><strong>CENSORED*</strong></strong></strong></em>}”相比较</p>
<p>所以我们应该是加上qword_201060的值才对，上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">string = <span class="string">&quot;********CENSORED********&quot;</span></span><br><span class="line">qword_201060 = [<span class="number">0x410A4335494A0942</span>, <span class="number">0x0B0EF2F50BE619F0</span>, <span class="number">0x4F0A3A064A35282B</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):  </span><br><span class="line">    <span class="comment">#这边就是把string均分成长度为8的三段</span></span><br><span class="line">    z = string[i * <span class="number">8</span> : (i + <span class="number">1</span>) * <span class="number">8</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#这个函数就是把每一段字符串都转换为十六进制ascii码</span></span><br><span class="line">    x = binascii.b2a_hex(z.encode(<span class="string">&#x27;ascii&#x27;</span>)[::-<span class="number">1</span>])  </span><br><span class="line">    </span><br><span class="line">    <span class="comment">#逆向操作，加上qword_201060中对应的值</span></span><br><span class="line">    y = binascii.a2b_hex(<span class="built_in">hex</span>(<span class="built_in">int</span>(x, <span class="number">16</span>) + qword_201060[i])[<span class="number">2</span>:])[::-<span class="number">1</span>]   </span><br><span class="line">    flag += y</span><br><span class="line"><span class="built_in">print</span>(flag + <span class="string">b&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>binascii.b2a_hex()函数运行之后的结果为b’4445524f534e4543’，为byte类型的字符串，所以需要转换一下，hex(x,16)</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220204225849101.png" class="" title="image-20220204225849101">

<p>奇怪啊，为什么要把每一段字符串逆一下？([::-1])</p>
<p>如果说这个是因为ida的小段存储机制，所以要逆一下，那后面求完之后的y为什么要逆一下？奇怪？？</p>
<p>b’flag{l3ts_m4k3_4_DETOUR_t0d4y}’</p>
<h1 id="FlareOn3-Challenge1-base64换表"><a href="#FlareOn3-Challenge1-base64换表" class="headerlink" title="[FlareOn3]Challenge1 (base64换表)"></a>[FlareOn3]Challenge1 (base64换表)</h1><p>先查个壳，再用ida32打开</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202195326757.png" class="" title="image-20220202195326757">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202201318346.png" class="" title="image-20220202201318346">

<p>输入的字符串经过sub_401260函数的转换，变成了str2，然后与str1进行比较</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202201500946.png" class="" title="image-20220202201500946">

<p>可以看到这边是很熟悉的base64算法，我们点进去byte_413000看看</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202201547184.png" class="" title="image-20220202201547184">

<p>一个很经典的base64换标操作，下面是代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">string = <span class="string">&quot;x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q&quot;</span></span><br><span class="line"></span><br><span class="line">new_base = <span class="string">&#x27;ZYXABCDEFGHIJKLMNOPQRSTUVWzy\</span></span><br><span class="line"><span class="string">xabcdefghijklmnopqrstuvw0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line">base = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(string.translate(<span class="built_in">str</span>.maketrans(new_base,base)))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{<a href="mailto:sh00ting_phish_in_a_barrel@flare-on.com">sh00ting_phish_in_a_barrel@flare-on.com</a>}</p>
<h1 id="ACTF新生赛2020-Oruga（迷宫plus）"><a href="#ACTF新生赛2020-Oruga（迷宫plus）" class="headerlink" title="[ACTF新生赛2020]Oruga（迷宫plus）"></a>[ACTF新生赛2020]Oruga（迷宫plus）</h1><p>oruga是什么文件？不管了，先插个壳看看</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202201907288.png" class="" title="image-20220202201907288">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202202330585.png" class="" title="image-20220202202330585">

<p>用ida64打开看看</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202205318996.png" class="" title="image-20220202205318996">

<p>前面五个字符告诉我们了，继续跟进sub_78A看看</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202205422125.png" class="" title="image-20220202205422125">

<p>再到byte_201020看看</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202205517899.png" class="" title="image-20220202205517899">

<p>到这就傻了，琢磨了半天……</p>
<p><a target="_blank" rel="noopener" href="https://www.cxybb.com/article/weixin_43876357/107525490">https://www.cxybb.com/article/weixin_43876357/107525490</a></p>
<p>原来是迷宫啊，但是这个迷宫怎么用上面的查看的……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202205708976.png" class="" title="image-20220202205708976">

<p>原来下面的这个意思是代表这4个0x00的意思，那这样就能把ida中的这一组数据转换成列表了，这边我搬运的大佬z1r0的代码</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202210456271.png" class="" title="image-20220202210456271">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mz = [<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x23</span>, <span class="number">0x23</span>, <span class="number">0x23</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4C</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4C</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x50</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4C</span>, <span class="number">0x4C</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x50</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x50</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x45</span>, <span class="number">0x45</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x45</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x45</span>, <span class="number">0x45</span>,<span class="number">54</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x49</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x45</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x54</span>, <span class="number">0x00</span>, <span class="number">0x49</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x45</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x54</span>, <span class="number">0x00</span>, <span class="number">0x49</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x21</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x45</span>, <span class="number">0x45</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span> <span class="keyword">and</span> j == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;V&#x27;</span>, end = <span class="string">&#x27;  &#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> mz[<span class="number">16</span> * i + j] == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>, end = <span class="string">&#x27;  &#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> mz[<span class="number">16</span> * i + j] == <span class="number">0x21</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;X&#x27;</span>, end= <span class="string">&#x27;  &#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;O&#x27;</span>, end=<span class="string">&#x27;  &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>

<p>还有三个问题我没有解决：</p>
<ol>
<li>地图大小如何确定</li>
<li>游戏规则如何建立（碰到障碍物才能停下再继续操作）</li>
<li>障碍物如何显示？</li>
</ol>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202211152882.png" class="" title="image-20220202211152882">

<p>16*16 &#x3D; 256，所以可以确定地图的大小</p>
<p>第二层while循环中就限制了移动的范围，一是在地图的边缘，而是碰到障碍物</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202212011477.png" class="" title="image-20220202212011477">

<p>而障碍物貌似就是第二层循环中的后面的限制条件，可以把实体化，打印出来……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220202212142881.png" class="" title="image-20220202212142881">

<p>flag{MEWEMEWJMEWJM} 吧</p>
<h1 id="BJDCTF2020-BJD-hamburger-competition（unity逆向-sha1-mod5）"><a href="#BJDCTF2020-BJD-hamburger-competition（unity逆向-sha1-mod5）" class="headerlink" title="[BJDCTF2020]BJD hamburger competition（unity逆向+sha1+mod5）"></a>[BJDCTF2020]BJD hamburger competition（unity逆向+sha1+mod5）</h1><p>我惊了……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201115630299.png" class="" title="image-20220201115630299">

<p>查个壳子看看，没有壳，用ida64打开，貌似查壳+ida不是正确的打开方式</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201115548374.png" class="" title="image-20220201115548374">

<p>看看z1r0的博客（下面的这句话才是最装逼的，哈哈哈），用到的是dnSPY这个软件：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201165642660.png" class="" title="image-20220201165642660">

<p>‘<a target="_blank" rel="noopener" href="https://www.zhihu.com/people/xu-xu-xuxu-94">https://www.zhihu.com/people/xu-xu-xuxu-94</a></p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201162228577.png" class="" title="image-20220201162228577">

<p>成功下载，并打开</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_47158947/article/details/107818896">https://blog.csdn.net/weixin_47158947/article/details/107818896</a></p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201170105217.png" class="" title="image-20220201170105217">

<p>主要看第二点，反编译这个Assembly-CSharp.dll这个文件，直接修改unity的C#源代码</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201162720109.png" class="" title="image-20220201162720109">

<p>然后放到dnspy中……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201163130432.png" class="" title="image-20220201163130432">

<p>顺利找到一个BJDCTF的字眼</p>
<p>踩坑了，我都不知道哈希函数基本是不可逆的</p>
<p>看z1r0的博客才知道文中的Sha1只是判断第一个字符，我们通过这个获得了密文，接着将1001这个密文进行MOD5加密</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201164451780.png" class="" title="image-20220201164451780">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201165018190.png" class="" title="image-20220201165018190">

<p>可以看到，哈希值是下面这个，（我看z1r0的博客，会有两个值……）</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201165103438.png" class="" title="image-20220201165103438">

<p>不管了，继续看</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201165130180.png" class="" title="image-20220201165130180">

<p>作者的意图是获取mod5加密的前20个字符</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&#x27;b8c37e33defde51cf91e1e03e51657da&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;flag&#123;&#x27;</span>+string[<span class="number">0</span>:<span class="number">20</span>].upper()+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{B8C37E33DEFDE51CF91E}</p>
<h1 id="WUSTCTF2020-Cr0ssfun-水题"><a href="#WUSTCTF2020-Cr0ssfun-水题" class="headerlink" title="[WUSTCTF2020]Cr0ssfun(水题)"></a>[WUSTCTF2020]Cr0ssfun(水题)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220131151007881.png" class="" title="image-20220131151007881">

<p>先查个壳，用ida64打开</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220131151140745.png" class="" title="image-20220131151140745">

<p>可以看到v4是我们输入的flag,check函数是比较函数，我们跟进</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220131151248543.png" class="" title="image-20220131151248543">

<p>继续跟进……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220131151325311.png" class="" title="image-20220131151325311">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __fastcall iven_1s_educated(_BYTE *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> *a1 == <span class="number">119</span> &amp;&amp; a1[<span class="number">6</span>] == <span class="number">50</span> &amp;&amp; a1[<span class="number">22</span>] == <span class="number">115</span> &amp;&amp; a1[<span class="number">31</span>] == <span class="number">110</span> &amp;&amp; a1[<span class="number">12</span>] == <span class="number">95</span> &amp;&amp; (unsigned <span class="built_in">int</span>)iven_1s_brave(a1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>继续跟进……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __fastcall iven_1s_brave(_BYTE *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> a1[<span class="number">15</span>] == <span class="number">100</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">8</span>] == <span class="number">123</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">18</span>] == <span class="number">51</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">28</span>] == <span class="number">95</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">21</span>] == <span class="number">114</span></span><br><span class="line">      &amp;&amp; (unsigned <span class="built_in">int</span>)iven_1s_great(a1);</span><br><span class="line">&#125;</span><br><span class="line">_BOOL8 __fastcall iven_1s_great(_BYTE *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> a1[<span class="number">2</span>] == <span class="number">116</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">9</span>] == <span class="number">99</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">32</span>] == <span class="number">125</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">19</span>] == <span class="number">118</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">5</span>] == <span class="number">48</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">14</span>] == <span class="number">110</span></span><br><span class="line">      &amp;&amp; (unsigned <span class="built_in">int</span>)iven_and_grace(a1);</span><br><span class="line">&#125;</span><br><span class="line">_BOOL8 __fastcall iven_and_grace(_BYTE *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> a1[<span class="number">4</span>] == <span class="number">50</span> &amp;&amp; a1[<span class="number">17</span>] == <span class="number">114</span> &amp;&amp; a1[<span class="number">29</span>] == <span class="number">102</span> &amp;&amp; a1[<span class="number">17</span>] == <span class="number">114</span> &amp;&amp; a1[<span class="number">24</span>] == <span class="number">95</span> &amp;&amp; (unsigned <span class="built_in">int</span>)finally_fun(a1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这iven也太自恋了吧……下面是代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">a1 = [<span class="number">0</span>]*<span class="number">40</span></span><br><span class="line"></span><br><span class="line">a1[<span class="number">10</span>] = <span class="number">112</span></span><br><span class="line">a1[<span class="number">13</span>] = <span class="number">64</span></span><br><span class="line">a1[<span class="number">3</span>] = <span class="number">102</span></span><br><span class="line">a1[<span class="number">26</span>] = <span class="number">114</span></span><br><span class="line">a1[<span class="number">20</span>] = <span class="number">101</span></span><br><span class="line">a1[<span class="number">7</span>] = <span class="number">48</span></span><br><span class="line">a1[<span class="number">16</span>] = <span class="number">95</span></span><br><span class="line">a1[<span class="number">11</span>] = <span class="number">112</span></span><br><span class="line">a1[<span class="number">23</span>] = <span class="number">101</span></span><br><span class="line">a1[<span class="number">30</span>] = <span class="number">117</span></span><br><span class="line">a1[<span class="number">0</span>] = <span class="number">119</span></span><br><span class="line">a1[<span class="number">6</span>] = <span class="number">50</span></span><br><span class="line">a1[<span class="number">22</span>] = <span class="number">115</span></span><br><span class="line">a1[<span class="number">31</span>] = <span class="number">110</span></span><br><span class="line">a1[<span class="number">12</span>] = <span class="number">95</span></span><br><span class="line">a1[<span class="number">15</span>] = <span class="number">100</span></span><br><span class="line">a1[<span class="number">8</span>] = <span class="number">123</span></span><br><span class="line">a1[<span class="number">18</span>] = <span class="number">51</span></span><br><span class="line">a1[<span class="number">28</span>] = <span class="number">95</span></span><br><span class="line">a1[<span class="number">21</span>] = <span class="number">114</span></span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">116</span></span><br><span class="line">a1[<span class="number">9</span>] = <span class="number">99</span></span><br><span class="line">a1[<span class="number">32</span>] = <span class="number">125</span></span><br><span class="line">a1[<span class="number">19</span>] = <span class="number">118</span></span><br><span class="line">a1[<span class="number">5</span>] = <span class="number">48</span></span><br><span class="line">a1[<span class="number">14</span>] = <span class="number">110</span></span><br><span class="line">a1[<span class="number">4</span>] = <span class="number">50</span></span><br><span class="line">a1[<span class="number">17</span>] = <span class="number">114</span></span><br><span class="line">a1[<span class="number">29</span>] = <span class="number">102</span></span><br><span class="line">a1[<span class="number">17</span>] = <span class="number">114</span></span><br><span class="line">a1[<span class="number">24</span>] = <span class="number">95</span></span><br><span class="line">a1[<span class="number">1</span>] = <span class="number">99</span></span><br><span class="line">a1[<span class="number">25</span>] = <span class="number">64</span></span><br><span class="line">a1[<span class="number">27</span>] = <span class="number">101</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a1:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>wctf2020{cpp*@nd_r3verse*@re_fun}</p>
<h1 id="FlareOn6-Overlong-od动调"><a href="#FlareOn6-Overlong-od动调" class="headerlink" title="[FlareOn6]Overlong(od动调)"></a>[FlareOn6]Overlong(od动调)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220131152212520.png" class="" title="image-20220131152212520">

<p>差壳，啥意思？要用ide试试？</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220131152301428.png" class="" title="image-20220131152301428">

<p>我也没看出来个啥，运行了一下，到时候上ida直接查找这句话。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220131152338798.png" class="" title="image-20220131152338798">

<p>打开ida32查看，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __stdcall start(<span class="built_in">int</span> a1, <span class="built_in">int</span> a2, <span class="built_in">int</span> a3, <span class="built_in">int</span> a4)</span><br><span class="line">&#123;</span><br><span class="line">  CHAR Text[<span class="number">128</span>]; // [esp+0h] [ebp-84h] BYREF</span><br><span class="line">  <span class="built_in">int</span> v6; // [esp+80h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  v6 = sub_401160(Text, &amp;unk_402008, <span class="number">28</span>);</span><br><span class="line">  Text[v6] = <span class="number">0</span>;</span><br><span class="line">  MessageBoxA(<span class="number">0</span>, Text, Caption, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>unk_402008,中有很多数字，但最后弹出的框中，只有28个数字……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201095845756.png" class="" title="image-20220201095845756">

<p>写了很多代码之后，解不出来……</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/P_Black_K/article/details/122342264">https://blog.csdn.net/P_Black_K/article/details/122342264</a></p>
<p>原来是要去用od去动调这个28啊……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201095716636.png" class="" title="image-20220201095716636">

<p>我用的是吾爱破解的od,打开后可以看到push 0x1c,而这个数字正好是28,我们做的就是去修改这个0x1c。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201100036946.png" class="" title="image-20220201100036946">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201100051808.png" class="" title="image-20220201100051808">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201100026237.png" class="" title="image-20220201100026237">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201100115461.png" class="" title="image-20220201100115461">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201100142177.png" class="" title="image-20220201100142177">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220201095327787.png" class="" title="image-20220201095327787">

<p>出来了！第一次用od动调程序！！</p>
<p>flag{<a href="mailto:I_a_M_t_h_e_e_n_C_o_D_i_n_g@flare-on.com">I_a_M_t_h_e_e_n_C_o_D_i_n_g@flare-on.com</a>}</p>
<h1 id="GWCTF-2019-xxor-xor-plus"><a href="#GWCTF-2019-xxor-xor-plus" class="headerlink" title="[GWCTF 2019]xxor (xor plus++)"></a>[GWCTF 2019]xxor (xor plus++)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130094803900.png" class="" title="image-20220130094803900">

<p>先查个壳，用IDA64打开</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// positive sp value has been detected, the output may be wrong!</span><br><span class="line">void __fastcall __noreturn start(__int64 a1, __int64 a2, void (*a3)(void))</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; // rax</span><br><span class="line">  <span class="built_in">int</span> v4; // esi</span><br><span class="line">  __int64 v5; // [rsp-8h] [rbp-8h] BYREF</span><br><span class="line">  char *retaddr; // [rsp+0h] [rbp+0h] BYREF</span><br><span class="line"></span><br><span class="line">  v4 = v5;</span><br><span class="line">  v5 = v3;</span><br><span class="line">  __libc_start_main((<span class="built_in">int</span> (__fastcall *)(<span class="built_in">int</span>, char **, char **))main, v4, &amp;retaddr, init, fini, a3, &amp;v5);</span><br><span class="line">  __halt();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们跟进main</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall main(<span class="built_in">int</span> a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+8h] [rbp-68h]</span><br><span class="line">  <span class="built_in">int</span> j; // [rsp+Ch] [rbp-64h]</span><br><span class="line">  __int64 v6[<span class="number">6</span>]; // [rsp+10h] [rbp-60h] BYREF</span><br><span class="line">  __int64 v7[<span class="number">6</span>]; // [rsp+40h] [rbp-30h] BYREF</span><br><span class="line"></span><br><span class="line">  v7[<span class="number">5</span>] = __readfsqword(0x28u);</span><br><span class="line">  puts(<span class="string">&quot;Let us play a game?&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;you have six chances to input&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;Come on!&quot;</span>);</span><br><span class="line">  memset(v6, <span class="number">0</span>, <span class="number">40</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">5</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;%s&quot;</span>, <span class="string">&quot;input: &quot;</span>);</span><br><span class="line">    a2 = (char **)((char *)v6 + <span class="number">4</span> * i);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%d&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  memset(v7, <span class="number">0</span>, <span class="number">40</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">2</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    dword_601078 = v6[j];</span><br><span class="line">    dword_60107C = HIDWORD(v6[j]);</span><br><span class="line">    a2 = (char **)dword_601060;</span><br><span class="line">    sub_400686((unsigned <span class="built_in">int</span> *)&amp;dword_601078, dword_601060);// 加密函数</span><br><span class="line">    LODWORD(v7[j]) = dword_601078;</span><br><span class="line">    HIDWORD(v7[j]) = dword_60107C;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( (unsigned <span class="built_in">int</span>)sub_400770(v7, a2) != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;NO NO NO~ &quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  puts(<span class="string">&quot;Congratulation!\n&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;You seccess half\n&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;Do not forget to change input to hex and combine~\n&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;ByeBye&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输入六次，</p>
<p>先是循环三次，可以看出sub_400686是一个加密的函数</p>
<p>而sub_400770是一个对比的函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall sub_400770(_DWORD *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1[<span class="number">2</span>] - a1[<span class="number">3</span>] == 2225223423LL</span><br><span class="line">    &amp;&amp; a1[<span class="number">3</span>] + a1[<span class="number">4</span>] == 4201428739LL</span><br><span class="line">    &amp;&amp; a1[<span class="number">2</span>] - a1[<span class="number">4</span>] == 1121399208LL</span><br><span class="line">    &amp;&amp; *a1 == <span class="number">3746099070</span></span><br><span class="line">    &amp;&amp; a1[<span class="number">5</span>] == <span class="number">2230518816</span></span><br><span class="line">    &amp;&amp; a1[<span class="number">1</span>] == <span class="number">550153460</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;good!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> 1LL;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> 0LL;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加密之后的v7数组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v7 = [3746099070,550153460,3774025685,1548802262,2652626477,2230518816]</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130121448843.png" class="" title="image-20220130121448843">

<p>这边可以看到，dword_601060数组为[2,2,3,4]</p>
<p>然后看看加密算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall sub_400686(unsigned <span class="built_in">int</span> *a1, _DWORD *a2)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; // rax</span><br><span class="line">  unsigned <span class="built_in">int</span> v3; // [rsp+1Ch] [rbp-24h]</span><br><span class="line">  unsigned <span class="built_in">int</span> v4; // [rsp+20h] [rbp-20h]</span><br><span class="line">  <span class="built_in">int</span> v5; // [rsp+24h] [rbp-1Ch]</span><br><span class="line">  unsigned <span class="built_in">int</span> i; // [rsp+28h] [rbp-18h]</span><br><span class="line"></span><br><span class="line">  v3 = *a1;</span><br><span class="line">  v4 = a1[<span class="number">1</span>];</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">63</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 += <span class="number">1166789954</span>;</span><br><span class="line">    v3 += (v4 + v5 + <span class="number">11</span>) ^ ((v4 &lt;&lt; <span class="number">6</span>) + *a2) ^ ((v4 &gt;&gt; <span class="number">9</span>) + a2[<span class="number">1</span>]) ^ <span class="number">0x20</span>;</span><br><span class="line">    v4 += (v3 + v5 + <span class="number">20</span>) ^ ((v3 &lt;&lt; <span class="number">6</span>) + a2[<span class="number">2</span>]) ^ ((v3 &gt;&gt; <span class="number">9</span>) + a2[<span class="number">3</span>]) ^ <span class="number">0x10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *a1 = v3;</span><br><span class="line">  result = v4;</span><br><span class="line">  a1[<span class="number">1</span>] = v4;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>好！到这边就没了，炸了！</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/HardDebugger/article/details/108625220">https://blog.csdn.net/HardDebugger/article/details/108625220</a></p>
<p><a target="_blank" rel="noopener" href="https://www.programminghunter.com/article/3800202454/">https://www.programminghunter.com/article/3800202454/</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">v6=[<span class="number">3746099070</span>,<span class="number">550153460</span>,<span class="number">3774025685</span>,<span class="number">1548802262</span>,<span class="number">2652626477</span>,<span class="number">2230518816</span>]</span><br><span class="line">unk=[<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">5</span>,<span class="number">2</span>):</span><br><span class="line">    v5=(c_int(<span class="number">1166789954</span>*<span class="number">0x40</span>))</span><br><span class="line">    v3 = c_uint(v6[i])</span><br><span class="line">    v4 = c_uint(v6[i+<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x40</span>):</span><br><span class="line">        v4.value -= ((v3.value+v5.value+<span class="number">20</span>)^((v3.value&lt;&lt;<span class="number">6</span>)+unk[<span class="number">2</span>])^((v3.value&gt;&gt;<span class="number">9</span>)+unk[<span class="number">3</span>])^<span class="number">0x10</span>)</span><br><span class="line">        v3.value -= ((v4.value+v5.value+<span class="number">11</span>)^((v4.value&lt;&lt;<span class="number">6</span>)+unk[<span class="number">0</span>])^((v4.value&gt;&gt;<span class="number">9</span>)+unk[<span class="number">1</span>])^<span class="number">0x20</span>)</span><br><span class="line">        v5.value = (v5.value - <span class="number">1166789954</span>)</span><br><span class="line">    v6[i] =v3.value</span><br><span class="line">    v6[i+<span class="number">1</span>] = v4.value</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(v6[k]).decode(),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>分析一下这个代码：</p>
<p>ctypes是python的外部函数库，提供与C兼容的数据类型，并允许调用DLL或共享库中的函数（我暂时不需要了解这个）</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130122635014.png" class="" title="image-20220130122635014">

<p>我们这边就探讨这个c_uint 这是个无符号数，对数组中的类型进行限制，限制为无符号数，最后还需要进行long_to_bytes的转换？？太强了，先放这边搁着，先下一题看看</p>
<h1 id="MRCTF2020-Xor"><a href="#MRCTF2020-Xor" class="headerlink" title="[MRCTF2020]Xor"></a>[MRCTF2020]Xor</h1><p>没有壳子，直接用ida32打开。</p>
<p>啥情况？</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130164803722.png" class="" title="image-20220130164803722">

<p>我就先用跳转，跳转到401095这个地址</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130164850493.png" class="" title="image-20220130164850493">

<p>进入sub_401020之后，我按了一下tab，貌似就可以反汇编了，我返回主函数看一下，成功反汇编！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned <span class="built_in">int</span> i; // eax</span><br><span class="line"></span><br><span class="line">  sub_401020((<span class="built_in">int</span>)<span class="string">&quot;Give Me Your Flag String:\n&quot;</span>);</span><br><span class="line">  sub_401050(<span class="string">&quot;%s&quot;</span>, byte_4212C0);</span><br><span class="line">  <span class="keyword">if</span> ( strlen(byte_4212C0) != <span class="number">27</span> )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_6:</span><br><span class="line">    sub_401020((<span class="built_in">int</span>)<span class="string">&quot;Wrong!\n&quot;</span>);</span><br><span class="line">    sub_404B7E(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    _loaddll(<span class="number">0</span>);</span><br><span class="line">    __debugbreak();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">0x1B</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ((unsigned __int8)i ^ (unsigned __int8)byte_4212C0[i]) != byte_41EA08[i] )</span><br><span class="line">      goto LABEL_6;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_401020((<span class="built_in">int</span>)<span class="string">&quot;Right!\n&quot;</span>);</span><br><span class="line">  sub_404B7E(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>byte_4212C0来存放字符串，然后在后面的for语句中，与i异或之后，与byte_41EA08比较，如下所示，我们开始编写代码</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130165125764.png" class="" title="image-20220130165125764">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130170233824.png" class="" title="image-20220130170233824">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130170256564.png" class="" title="image-20220130170256564">

<p>奇怪了，暴力和正常的异或都没用啊，这肯定是错的……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&#x27;SAWB~FXZ:J:`tQJ&quot;N@ bpdd&#125;8g&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(string))</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        k = j</span><br><span class="line">        <span class="keyword">if</span> j^i == <span class="built_in">ord</span>(string[i]):</span><br><span class="line">            flag+=<span class="built_in">chr</span>(k)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130172201131.png" class="" title="image-20220130172201131">

<p>发现了暗门</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130172316971.png" class="" title="image-20220130172316971">

<p>那是什么暗门，这个这个函数包含了我们刚刚看过的主函数</p>
<p>算了，看看吧……</p>
<p>麻了，原来串个字符的前面有个M，没注意到，脚本编写没有问题的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&#x27;MSAWB~FXZ:J:`tQJ&quot;N@ bpdd&#125;8g&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(string))</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        k = j</span><br><span class="line">        <span class="keyword">if</span> j^i == <span class="built_in">ord</span>(string[i]):</span><br><span class="line">            flag+=<span class="built_in">chr</span>(k)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>27 MRCTF{@_R3@1ly_E2_R3verse!}</p>
<h1 id="MRCTF2020-hello-world-go"><a href="#MRCTF2020-hello-world-go" class="headerlink" title="[MRCTF2020]hello_world_go"></a>[MRCTF2020]hello_world_go</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130173403251.png" class="" title="image-20220130173403251">

<p>没看到壳子，用ida64打开</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130173814857.png" class="" title="image-20220130173814857">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130173741210.png" class="" title="image-20220130173741210">

<p>？？？</p>
<p>下一题</p>
<h1 id="WUSTCTF2020-level3-base64换表"><a href="#WUSTCTF2020-level3-base64换表" class="headerlink" title="[WUSTCTF2020]level3(base64换表)"></a>[WUSTCTF2020]level3(base64换表)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130173940402.png" class="" title="image-20220130173940402">

<p>用64位的IDA打开</p>
<p>一个base64有问题的题目</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130175653130.png" class="" title="image-20220130175653130">

<p>这个是</p>
<p><strong><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130175635860.png" class="" title="image-20220130175635860"></strong></p>
<p>本程序里面的，我特地找了之前做过的reverse_3，纯正的base64题目，中的码表，用来做了个对比</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130180018571.png" class="" title="image-20220130180018571">

<p>这边是少了个&#x3D;号，base62倒是可以解出来，结果却都是数字</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130180059778.png" class="" title="image-20220130180059778">

<p>像我之前做过的一个换码表的题目了，我正好反过来看一看</p>
<p>[ACTF新生赛2020]usualCrypt这道题</p>
<p>刚刚试了一下，换表的话，长度相等才行……新表的明显短了，这怎样才好？？</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130181239212.png" class="" title="image-20220130181239212">

<p>我懂了，题目中的表的次序换了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130184722352.png" class="" title="image-20220130184722352">

<p>在table上按x，果真有引用这个的函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__int64 O_OLookAtYou()</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; // rax</span><br><span class="line">  char v1; // [rsp+1h] [rbp-5h]</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+2h] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = base64_table[i];</span><br><span class="line">    base64_table[i] = base64_table[<span class="number">19</span> - i];</span><br><span class="line">    result = <span class="number">19</span> - i;</span><br><span class="line">    base64_table[result] = v1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这就简单了，换表之后，就能解码了，下面就是代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">string = <span class="string">&#x27;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==&#x27;</span></span><br><span class="line"></span><br><span class="line">base = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;</span></span><br><span class="line"></span><br><span class="line">newbase =  <span class="built_in">list</span>(<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">9</span>):</span><br><span class="line">    newbase[i] , newbase[<span class="number">19</span>-i] = newbase[<span class="number">19</span>-i] , newbase[i]</span><br><span class="line"></span><br><span class="line">newbase = <span class="string">&#x27;&#x27;</span>.join(newbase)</span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(string.translate(<span class="built_in">str</span>.maketrans(newbase,base)))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>b’wctf2020{Base64_is_the_start_of_reverse}’</p>
<h1 id="FlareOn4-IgniteMe"><a href="#FlareOn4-IgniteMe" class="headerlink" title="[FlareOn4]IgniteMe()"></a>[FlareOn4]IgniteMe()</h1><p>先查个壳，发现没有壳，用32位IDA打开</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220130190207248.png" class="" title="image-20220130190207248">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">void __noreturn start()</span><br><span class="line">&#123;</span><br><span class="line">  DWORD NumberOfBytesWritten; // [esp+0h] [ebp-4h] BYREF</span><br><span class="line"></span><br><span class="line">  NumberOfBytesWritten = <span class="number">0</span>;</span><br><span class="line">  hFile = GetStdHandle(<span class="number">0xFFFFFFF6</span>);</span><br><span class="line">  dword_403074 = GetStdHandle(<span class="number">0xFFFFFFF5</span>);</span><br><span class="line">  WriteFile(dword_403074, aG1v3M3T3hFl4g, 19u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  sub_4010F0();</span><br><span class="line">  <span class="keyword">if</span> ( sub_401050() )</span><br><span class="line">    WriteFile(dword_403074, aG00dJ0b, 10u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    WriteFile(dword_403074, aN0tT00H0tRWe7r, 36u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  ExitProcess(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一眼看出if语句是用来判断的，我们跟进这个sub_401050()函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> sub_401050()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> v1; // [esp+0h] [ebp-Ch]</span><br><span class="line">  <span class="built_in">int</span> i; // [esp+4h] [ebp-8h]</span><br><span class="line">  unsigned <span class="built_in">int</span> j; // [esp+4h] [ebp-8h]</span><br><span class="line">  char v4; // [esp+Bh] [ebp-1h]</span><br><span class="line"></span><br><span class="line">  v1 = my_return_i(my_arr);</span><br><span class="line">  v4 = my_rol();</span><br><span class="line">  <span class="keyword">for</span> ( i = v1 - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    my_flag[i] = v4 ^ my_arr[i];</span><br><span class="line">    v4 = my_arr[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">39</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( my_flag[j] != model[j] )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>判断数组我命名成为model，转换后的数组我命名成my_flag,而中间的转换数组，我命名成为my_arr</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> sub_4010F0()</span><br><span class="line">&#123;</span><br><span class="line">  unsigned <span class="built_in">int</span> v0; // eax</span><br><span class="line">  char Buffer[<span class="number">260</span>]; // [esp+0h] [ebp-<span class="number">1</span>10h] BYREF</span><br><span class="line">  DWORD NumberOfBytesRead; // [esp+104h] [ebp-Ch] BYREF</span><br><span class="line">  unsigned <span class="built_in">int</span> i; // [esp+108h] [ebp-8h]</span><br><span class="line">  char v5; // [esp+10Fh] [ebp-1h]</span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">260</span>; ++i )</span><br><span class="line">    Buffer[i] = <span class="number">0</span>;</span><br><span class="line">  ReadFile(hFile, Buffer, 260u, &amp;NumberOfBytesRead, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = my_return_i(Buffer);</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= v0 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v5 = Buffer[i];</span><br><span class="line">    <span class="keyword">if</span> ( v5 != <span class="string">&#x27;\n&#x27;</span> &amp;&amp; v5 != <span class="string">&#x27;\r&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v5 )</span><br><span class="line">        my_arr[i] = v5;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>发现在判断函数的上面的sub_4010F0()函数，已经开辟了my_arr数组了，</p>
<p>可以推理出my_arr里面的元素都是0，总数没细看，再回到判断函数。</p>
<p>v4 &#x3D;的这个函数，我给它命名为my_rol,我属实没看懂这个是什么意思</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__int16 sub_401000()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> __ROL4__(<span class="number">2147942400</span>, <span class="number">4</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我假设就是向左移动一位的意思，为1,073,971,200</p>
<p>那也就是v4 &#x3D; 1,073,971,200,i &#x3D; v1 - 1,那么这个v1我猜是40</p>
<p>看了人家的脚本之后，v4&#x3D;4??</p>
<p>这是我没想到的，差别大了……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">model = [<span class="number">0x0D</span>,<span class="number">0x26</span>,<span class="number">0x49</span>,<span class="number">0x45</span>,<span class="number">0x2A</span>,<span class="number">0x17</span>,<span class="number">0x78</span>,<span class="number">0x44</span>,<span class="number">0x2B</span>,<span class="number">0x6C</span>,<span class="number">0x5D</span>,<span class="number">0x5E</span>,<span class="number">0x45</span>,<span class="number">0x12</span>,<span class="number">0x2F</span>,<span class="number">0x17</span>,</span><br><span class="line"><span class="number">0x2B</span>,<span class="number">0x44</span>,<span class="number">0x6F</span>,<span class="number">0x6E</span>,<span class="number">0x56</span>,<span class="number">0x09</span>,<span class="number">0x5F</span>,<span class="number">0x45</span>,<span class="number">0x47</span>,<span class="number">0x73</span>,<span class="number">0x26</span>,<span class="number">0x0A</span>,<span class="number">0x0D</span>,<span class="number">0x13</span>,<span class="number">0x17</span>,<span class="number">0x48</span>,</span><br><span class="line"><span class="number">0x42</span>,<span class="number">0x01</span>,<span class="number">0x40</span>,<span class="number">0x4D</span>,<span class="number">0x0C</span>,<span class="number">0x02</span>,<span class="number">0x69</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(model)</span><br><span class="line"></span><br><span class="line">v4 = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">my_flag = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    my_flag.append(model[i]^v4)</span><br><span class="line">    v4 = my_flag[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> my_flag:</span><br><span class="line">    flag += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(flag[::-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<p><a href="mailto:R_y0u_H0t_3n0ugH_t0_1gn1t3@flare-on.com">R_y0u_H0t_3n0ugH_t0_1gn1t3@flare-on.com</a></p>
<p>网上还有一个爆破版本，不想动脑子了，球球了,我用python实现一下。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Palmer9/article/details/105253318">https://blog.csdn.net/Palmer9/article/details/105253318</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">model = [<span class="number">0x0D</span>,<span class="number">0x26</span>,<span class="number">0x49</span>,<span class="number">0x45</span>,<span class="number">0x2A</span>,<span class="number">0x17</span>,<span class="number">0x78</span>,<span class="number">0x44</span>,<span class="number">0x2B</span>,<span class="number">0x6C</span>,<span class="number">0x5D</span>,<span class="number">0x5E</span>,<span class="number">0x45</span>,<span class="number">0x12</span>,<span class="number">0x2F</span>,<span class="number">0x17</span>,</span><br><span class="line"><span class="number">0x2B</span>,<span class="number">0x44</span>,<span class="number">0x6F</span>,<span class="number">0x6E</span>,<span class="number">0x56</span>,<span class="number">0x09</span>,<span class="number">0x5F</span>,<span class="number">0x45</span>,<span class="number">0x47</span>,<span class="number">0x73</span>,<span class="number">0x26</span>,<span class="number">0x0A</span>,<span class="number">0x0D</span>,<span class="number">0x13</span>,<span class="number">0x17</span>,<span class="number">0x48</span>,</span><br><span class="line"><span class="number">0x42</span>,<span class="number">0x01</span>,<span class="number">0x40</span>,<span class="number">0x4D</span>,<span class="number">0x0C</span>,<span class="number">0x02</span>,<span class="number">0x69</span>]</span><br><span class="line"></span><br><span class="line">v4 = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">40</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        k = j</span><br><span class="line">        j ^= v4</span><br><span class="line">        <span class="keyword">if</span> j == model[i]:</span><br><span class="line">            flag[i] = k</span><br><span class="line">            v4 = k</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>2.9日补充：</p>
<p>最近比赛挺多，压力都很大，特地过来复习一下od动调：</p>
<p>关于od调试常用的快捷键：</p>
<p><a target="_blank" rel="noopener" href="https://mambainveins.gitee.io/2020/09/02/2020-09-02-GDB_common_instructions/">https://mambainveins.gitee.io/2020/09/02/2020-09-02-GDB_common_instructions/</a></p>
<p>F7步进，也就是遇到一个函数会进去，就是步入call的意思。</p>
<p>F8步过，也就是遇到一个函数，执行完之后，不会进入call.</p>
<p>F9,直接执行</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209133749062.png" class="" title="image-20220209133749062">

<p>我们需要做的就是动态调试v4的值，v4在sub_401050这个函数中</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209133853302.png" class="" title="image-20220209133853302">

<p>然后值等于sub_401000()函数的返回值</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209133953613.png" class="" title="image-20220209133953613">

<p>首先我们是搜索字符串，定位提示性语句</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209134125223.png" class="" title="image-20220209134125223">

<p>F8一直步过，到输入字符串的位置停下</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209141131299.png" class="" title="image-20220209141131299">

<p>我们随便输入一串字符串，回车就能一直运行</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209141208264.png" class="" title="image-20220209141208264">

<p>现在到达401050这个位置，我们F7步进</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209141316860.png" class="" title="image-20220209141316860">

<p>然后F7一直步过</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209141441719.png" class="" title="image-20220209141441719">

<p>到401000下面，我们就能看到v4的值了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220209141758032.png" class="" title="image-20220209141758032">

<p>al &#x3D; 4</p>
<h1 id="Youngter-drive-windows多线程-index逆向"><a href="#Youngter-drive-windows多线程-index逆向" class="headerlink" title="Youngter-drive(windows多线程+index逆向)"></a>Youngter-drive(windows多线程+index逆向)</h1><p>Exeinfo:</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129144406725.png" class="" title="image-20220129144406725">

<p>有壳，咱们脱壳先，对比一下，没有了貌似</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129144508755.png" class="" title="image-20220129144508755">

<p>继续，咱们用IDA32打开</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129144614806.png" class="" title="image-20220129144614806">

<p>下一步</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main_0(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  HANDLE Thread; // [esp+D0h] [ebp-14h]</span><br><span class="line">  HANDLE hObject; // [esp+DCh] [ebp-8h]</span><br><span class="line"></span><br><span class="line">  ((void (*)(void))sub_4110FF)();</span><br><span class="line">  ::hObject = CreateMutexW(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  j_strcpy(Destination, &amp;Source);</span><br><span class="line">  hObject = CreateThread(<span class="number">0</span>, <span class="number">0</span>, StartAddress, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  Thread = CreateThread(<span class="number">0</span>, <span class="number">0</span>, sub_41119F, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  CloseHandle(hObject);</span><br><span class="line">  CloseHandle(Thread);</span><br><span class="line">  <span class="keyword">while</span> ( dword_418008 != -<span class="number">1</span> )</span><br><span class="line">    ;</span><br><span class="line">  sub_411190();</span><br><span class="line">  CloseHandle(::hObject);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先是sub_4110FF()函数，我们跟进</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((void (*)(void))sub_4110FF)();</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129135058234.png" class="" title="image-20220129135058234">

<p>输入语句，将输出的flag给Source，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">::hObject = CreateMutexW(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  ::hObject = CreateMutexW(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>CreateMutexW函数，创建或者打开一个命名或未命名的互斥对象</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129134815205.png" class="" title="image-20220129134815205">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">j_strcpy(Destination, Source);</span><br></pre></td></tr></table></figure>

<p>将source赋值给destination</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hObject = CreateThread(<span class="number">0</span>, <span class="number">0</span>, StartAddress, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">Thread = CreateThread(<span class="number">0</span>, <span class="number">0</span>, sub_41119F, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">CloseHandle(hObject);</span><br><span class="line">CloseHandle(Thread);</span><br></pre></td></tr></table></figure>

<p>创建线程 CreateThread(0, 0, StartAddress, 0, 0, 0)，通常起始地址是程序代码中定义的函数名称</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129135924654.png" class="" title="image-20220129135924654">

<p>后面的CloseHandle真实关闭前面线程对象的句柄</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129135830137.png" class="" title="image-20220129135830137">

<p>我们跟进StartAddress</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">void __stdcall __noreturn StartAddress_0(<span class="built_in">int</span> a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    WaitForSingleObject(hObject, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">    <span class="keyword">if</span> ( dword_418008 &gt; -<span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_41112C(Source, dword_418008);</span><br><span class="line">      --dword_418008;</span><br><span class="line">      Sleep(0x64u);</span><br><span class="line">    &#125;</span><br><span class="line">    ReleaseMutex(hObject);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这边的sleep(0x64u)要当心，这个函数对字符串的加密是隔一个字符加密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// 已检测到正的sp值, 输出可能错误!     </span><br><span class="line">char *__cdecl sub_411940(<span class="built_in">int</span> a1, <span class="built_in">int</span> a2)</span><br><span class="line">&#123;</span><br><span class="line">  char *result; // eax</span><br><span class="line">  char v3; // [esp+D3h] [ebp-5h]</span><br><span class="line"></span><br><span class="line">  v3 = *(a2 + a1);</span><br><span class="line">  <span class="keyword">if</span> ( (v3 &lt; <span class="string">&#x27;a&#x27;</span> || v3 &gt; <span class="string">&#x27;z&#x27;</span>) &amp;&amp; (v3 &lt; <span class="string">&#x27;A&#x27;</span> || v3 &gt; <span class="string">&#x27;Z&#x27;</span>) )</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt; <span class="string">&#x27;a&#x27;</span> || v3 &gt; <span class="string">&#x27;z&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = off_418000[<span class="number">0</span>];</span><br><span class="line">    *(a2 + a1) = off_418000[<span class="number">0</span>][*(a2 + a1) - <span class="number">38</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = off_418000[<span class="number">0</span>];</span><br><span class="line">    *(a2 + a1) = off_418000[<span class="number">0</span>][*(a2 + a1) - <span class="number">96</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mayfly-nymph/p/12573658.html">https://www.cnblogs.com/Mayfly-nymph/p/12573658.html</a></p>
<p>第二个线程执行的函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">void __stdcall __noreturn sub_411B10(<span class="built_in">int</span> a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    WaitForSingleObject(hObject, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">    <span class="keyword">if</span> ( dword_418008 &gt; -<span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      Sleep(0x64u);</span><br><span class="line">      --dword_418008;</span><br><span class="line">    &#125;</span><br><span class="line">    ReleaseMutex(hObject);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>有两个线程，别人博客上面，还得确认哪一个线程先执行，说是第二个先执行</p>
<p>也就是偶数不变，奇数会变。</p>
<p>下面是代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line">secret = <span class="string">&quot;TOiZiZtOrYaToUwPnToBsOaOapsyS&quot;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">model = <span class="string">&quot;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret)):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        flag += secret[i]</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span>(secret[i].isupper()):</span><br><span class="line">        flag += <span class="built_in">chr</span>(model.find(secret[i]) + <span class="number">96</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(model.find(secret[i]) + <span class="number">38</span>)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;flag&#123;&#x27;</span>+flag+<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>不用看了，我甚至连线程的工作原理都不知道，先去看看python的多线程机制</p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-multithreading.html">https://www.runoob.com/python/python-multithreading.html</a></p>
<p>创建线程类，生成线程对象，将需要运行的函数放入run（）这个方法中，而且每运行一次都需要获得锁，来保证线程的同步性，在运行完成之后需要释放锁，还可以把线程放入线程列表中，使其具有优先级，使其可以交替执行</p>
<p>现在可以理解了。。</p>
<p>flag{ThisisthreadofwindowshahaIsES}</p>
<p>z1r0的博客上说，最后差了一位，确实</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129153052066.png" class="" title="image-20220129153052066">

<p>传入的参数a2,是29，而我们要求的flag为30位</p>
<p>该爆破是就爆破：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;ThisisthreadofwindowshahaIsES&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="built_in">print</span>(flag+<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)+i))</span><br></pre></td></tr></table></figure>

<p>flag{ThisisthreadofwindowshahaIsESE}</p>
<h1 id="WUSTCTF2020-level2（upx脱壳）"><a href="#WUSTCTF2020-level2（upx脱壳）" class="headerlink" title="[WUSTCTF2020]level2（upx脱壳）"></a>[WUSTCTF2020]level2（upx脱壳）</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129153658202.png" class="" title="image-20220129153658202">

<p>查壳后发现有壳，upx工具走起</p>
<p>打开之后，没看到正确的主函数</p>
<p>在string窗口中，找到了，试试呗</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129154256504.png" class="" title="image-20220129154256504">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129154427554.png" class="" title="image-20220129154427554">

<p>好家伙，还真是</p>
<p>flag{Just_upx_-d}</p>
<p>去看看z1r0的博客吧，z1r0老师傅专程详解了汇编代码，我得好好看看</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129171210185.png" class="" title="image-20220129171210185">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129171219143.png" class="" title="image-20220129171219143">



<h1 id="相册（apk病毒-base64）"><a href="#相册（apk病毒-base64）" class="headerlink" title="相册（apk病毒+base64）"></a>相册（apk病毒+base64）</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129171350990.png" class="" title="image-20220129171350990">

<p>有意思……</p>
<p>看了一段时间就麻了</p>
<p>看看z1r0的博客中，用的是导航中的搜索文本功能，搜索的是email</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129175216855.png" class="" title="image-20220129175216855">

<p>然后直接跟进sendMailjavamail</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129175243844.png" class="" title="image-20220129175243844">

<p>这个软件的操作和ida一样啊，x键就能看到引用的地方，跟进之后</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129175331994.png" class="" title="image-20220129175331994">

<p>跟进后面的的MAILSERVER</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129175358635.png" class="" title="image-20220129175358635">

<p>嗯，base64加密……</p>
<p>然后是解压apk,找到.so文件，我都不知道so文件是干嘛的</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129175521613.png" class="" title="image-20220129175521613">

<p>百度了一下，so文件对于linux系统来说，就像dll文件相对于windows系统一样，一般来讲，so文件称为共享库</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wangquan1992/article/details/113770115">https://blog.csdn.net/wangquan1992/article/details/113770115</a></p>
<p>我搞了半天也不知道so文件怎么打开</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129175809172.png" class="" title="image-20220129175809172">

<p>什么叫strings看一下，哈哈哈</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">string = <span class="string">&#x27;MTgyMTg0NjUxMjVAMTYzLmNvbQ==&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(string)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p><a href="mailto:18218465125@163.com">18218465125@163.com</a></p>
<p>我的心态是这样的：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220127122839967.png" class="" title="image-20220127122839967">



<h1 id="HDCTF2019-Maze-easy-迷宫"><a href="#HDCTF2019-Maze-easy-迷宫" class="headerlink" title="[HDCTF2019]Maze (easy 迷宫)"></a>[HDCTF2019]Maze (easy 迷宫)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129181047234.png" class="" title="image-20220129181047234">

<p>有壳，万能脱壳FFI，没有壳了应该</p>
<p>maze是迷宫的意思，之前做过一个迷宫的题目，被虐了</p>
<p>上来啥也别干，直接查看strings窗口</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129192932805.png" class="" title="image-20220129192932805">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129193037102.png" class="" title="image-20220129193037102">

<p>找到了！</p>
<p>用python 算了一下是70个字符，我猜是7*10</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">maze = <span class="string">&quot;*******+********* ******    ****   ******* **F******    **************&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(maze))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="built_in">print</span>(maze[i*<span class="number">10</span>+j],end = <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129193119897.png" class="" title="image-20220129193119897">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220129193159522.png" class="" title="image-20220129193159522">

<p>这边是输入14个字符，看我上面的图案，还真是</p>
<p>接下来就是寻找规则了</p>
<p>22333233224441？</p>
<p>ssaaasaassdddw?</p>
<p>好家伙，第二个就对了，笑死了</p>
<p>flag{ssaaasaassdddw}</p>
<h1 id="WUSTCTF2020-level1"><a href="#WUSTCTF2020-level1" class="headerlink" title="[WUSTCTF2020]level1"></a>[WUSTCTF2020]level1</h1><p>先查壳</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145727716.png" class="" title="image-20220128145727716">

<p>没有壳,然后放到ida64中打开</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+4h] [rbp-2Ch]</span><br><span class="line">  FILE *stream; // [rsp+8h] [rbp-28h]</span><br><span class="line">  char ptr[<span class="number">24</span>]; // [rsp+10h] [rbp-20h] BYREF</span><br><span class="line">  unsigned __int64 v7; // [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(0x28u);</span><br><span class="line">  stream = fopen(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  fread(ptr, 1uLL, 0x14uLL, stream);</span><br><span class="line">  fclose(stream);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">1</span>; i &lt;= <span class="number">19</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (i &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      printf(<span class="string">&quot;%ld\n&quot;</span>, (unsigned <span class="built_in">int</span>)(ptr[i] &lt;&lt; i));</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      printf(<span class="string">&quot;%ld\n&quot;</span>, (unsigned <span class="built_in">int</span>)(i * ptr[i]));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很清晰，output文本文件是输出之后的文件</p>
<p>直接上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">lists = [<span class="number">198</span>,<span class="number">232</span>,<span class="number">816</span>,<span class="number">200</span>,<span class="number">1536</span>,<span class="number">300</span>,<span class="number">6144</span>,<span class="number">984</span>,<span class="number">51200</span>,<span class="number">570</span>,<span class="number">92160</span>,\</span><br><span class="line"><span class="number">1200</span>,<span class="number">565248</span>,<span class="number">756</span>,<span class="number">1474560</span>,<span class="number">800</span>,<span class="number">6291456</span>,<span class="number">1782</span>,<span class="number">65536000</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(lists)</span><br><span class="line">lists2 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">    <span class="keyword">if</span> ((i+<span class="number">1</span>) &amp; <span class="number">1</span>) :</span><br><span class="line">        n = <span class="built_in">int</span>(lists[i] &gt;&gt; (i+<span class="number">1</span>))</span><br><span class="line">        lists2.append(n)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        n = <span class="built_in">int</span>(lists[i] // (i+<span class="number">1</span>))</span><br><span class="line">        lists2.append(n)</span><br><span class="line"><span class="built_in">print</span>(lists2)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lists2)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(lists2[i]),end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>需要注意的是</p>
<ol>
<li>i&amp;1 &#x3D;&#x3D; 1代表是奇数，i&amp;1&#x3D;&#x3D;0代表是偶数，</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>[<span class="number">0</span>]		没有输出</span><br><span class="line"><span class="built_in">str</span>[<span class="number">1</span>]		&lt;&lt; <span class="number">1</span></span><br><span class="line"><span class="built_in">str</span>[<span class="number">2</span>]		* <span class="number">2</span></span><br><span class="line"><span class="built_in">str</span>[<span class="number">3</span>]		&lt;&lt; <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>而对于我们output文件，我们看到的第一个数字198其实是在第二个，所以，可以理解为什么是 int(lists[i] &gt;&gt; (i+1))</p>
<ol>
<li>i &amp; 1 &#x3D;&#x3D; 0 代表i是偶数                i &amp; 1 &#x3D;&#x3D; 1代表i是奇数</li>
</ol>
<p>最终结果：ctf2020{d9-dE6-20c}</p>
<h1 id="MRCTF2020-Transform-index-逆向"><a href="#MRCTF2020-Transform-index-逆向" class="headerlink" title="[MRCTF2020]Transform(index 逆向)"></a>[MRCTF2020]Transform(index 逆向)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145716102.png" class="" title="image-20220128145716102">

<p>首先是查壳，没有壳，我们用ida64打开</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char Str[<span class="number">104</span>]; // [rsp+20h] [rbp-70h] BYREF</span><br><span class="line">  <span class="built_in">int</span> j; // [rsp+88h] [rbp-8h]</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+8Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  sub_402230(argc, argv, envp);</span><br><span class="line">  sub_40E640(<span class="string">&quot;Give me your code:\n&quot;</span>);</span><br><span class="line">  sub_40E5F0(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">  <span class="keyword">if</span> ( strlen(Str) != <span class="number">33</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_40E640(<span class="string">&quot;Wrong!\n&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">32</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    byte_414040[i] = Str[dword_40F040[i]];</span><br><span class="line">    byte_414040[i] ^= LOBYTE(dword_40F040[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">32</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( byte_40F0E0[j] != byte_414040[j] )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_40E640(<span class="string">&quot;Wrong!\n&quot;</span>);</span><br><span class="line">      system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">      exit(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_40E640(<span class="string">&quot;Right!Good Job!\n&quot;</span>);</span><br><span class="line">  sub_40E640(<span class="string">&quot;Here is your flag: %s\n&quot;</span>, Str);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，第一个for循环是把输入的字符放到了str中，str[dword_40F040[i]]把值给了byte_414040，byte_414040再与dword_40F040[i]进行异或</p>
<p>下面的for 循环是将dword_40F040[i]与byte_40F0E0做比较</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mayfly-nymph/p/12806027.html">https://www.cnblogs.com/Mayfly-nymph/p/12806027.html</a></p>
<p>总体来说</p>
<p>就是将输入的flag使用dword数组作为索引，打乱顺序</p>
<p>再将打乱后的flag数组，与dword数组异或，得到byte</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">dword = [<span class="number">0x9</span>, <span class="number">0x0A</span>, <span class="number">0x0F</span>, <span class="number">0x17</span>, <span class="number">0x7</span>, <span class="number">0x18</span>, <span class="number">0x0C</span>, <span class="number">0x6</span>, <span class="number">0x1</span>, <span class="number">0x10</span>,\</span><br><span class="line">     <span class="number">0x3</span>, <span class="number">0x11</span>, <span class="number">0x20</span>,<span class="number">0x1D</span>, <span class="number">0x0B</span>, <span class="number">0x1E</span>, <span class="number">0x1B</span>, <span class="number">0x16</span>, <span class="number">4</span>, <span class="number">0x0D</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, \</span><br><span class="line">         <span class="number">0x15</span>, <span class="number">0x2</span>, <span class="number">0x19</span>, <span class="number">0x5</span>, <span class="number">0x1F</span>, <span class="number">0x8</span>, <span class="number">0x12</span>, <span class="number">0x1A</span>, <span class="number">0x1C</span>, <span class="number">0x0E</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">byte = [ <span class="number">0x67</span>, <span class="number">0x79</span>, <span class="number">0x7B</span>, <span class="number">0x7F</span>, <span class="number">0x75</span>, <span class="number">0x2B</span>,\</span><br><span class="line"><span class="number">0x3C</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x79</span>, <span class="number">0x57</span>, <span class="number">0x5E</span>, <span class="number">0x5D</span>, <span class="number">0x42</span>,\</span><br><span class="line">     <span class="number">0x7B</span>, <span class="number">0x2D</span>, <span class="number">0x2A</span>, <span class="number">0x66</span>, <span class="number">0x42</span>, <span class="number">0x7E</span>, <span class="number">0x4C</span>, <span class="number">0x57</span>,\</span><br><span class="line">    <span class="number">0x79</span>, <span class="number">0x41</span>, <span class="number">0x6B</span>, <span class="number">0x7E</span>, <span class="number">0x65</span>, <span class="number">0x3C</span>, <span class="number">0x5C</span>, <span class="number">0x45</span>,\</span><br><span class="line">         <span class="number">0x6F</span>, <span class="number">0x62</span>, <span class="number">0x4D</span>]</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">33</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dword)):</span><br><span class="line">    byte[i] ^= dword[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dword)):</span><br><span class="line">    flag[dword[i]] = byte[i]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> flag])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{Tr4nsp0sltiON_Clph3r_1s_3z}</p>
<p>原来关于index转换的题目还能这么做，创建一个全为0的flag列表，然后正序的推理……</p>
<h1 id="ACTF新生赛2020-usualCrypt"><a href="#ACTF新生赛2020-usualCrypt" class="headerlink" title="[ACTF新生赛2020]usualCrypt"></a>[ACTF新生赛2020]usualCrypt</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128141926469.png" class="" title="image-20220128141926469">

<p>查个壳，没有壳，用IDA32打开</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> v3; // esi</span><br><span class="line">  <span class="built_in">int</span> v5[<span class="number">3</span>]; // [esp+8h] [ebp-74h] BYREF</span><br><span class="line">  __int16 v6; // [esp+14h] [ebp-68h]</span><br><span class="line">  char v7; // [esp+16h] [ebp-66h]</span><br><span class="line">  char v8[<span class="number">100</span>]; // [esp+18h] [ebp-64h] BYREF</span><br><span class="line"></span><br><span class="line">  sub_403CF8((<span class="built_in">int</span>)&amp;unk_40E140);</span><br><span class="line">  scanf(<span class="string">&quot;%s&quot;</span>, v8);</span><br><span class="line">  memset(v5, <span class="number">0</span>, sizeof(v5));</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  sub_401080(v8, strlen(v8), v5);	//加密函数</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)v5 + v3) == byte_40E0E4[v3] ) //匹配函数</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v3 &gt; strlen((const char *)v5) )</span><br><span class="line">      goto LABEL_6;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_403CF8((<span class="built_in">int</span>)aError);</span><br><span class="line">LABEL_6:</span><br><span class="line">  <span class="keyword">if</span> ( v3 - <span class="number">1</span> == strlen(byte_40E0E4) )</span><br><span class="line">    <span class="keyword">return</span> sub_403CF8((<span class="built_in">int</span>)aAreYouHappyYes);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> sub_403CF8((<span class="built_in">int</span>)aAreYouHappyNo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析一下：</p>
<p>首先是输入将flag放入v8数组中，然后进入了sub_401080这个函数，猜测应该是加密函数，我们继续跟进。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl sub_401080(<span class="built_in">int</span> a1, <span class="built_in">int</span> a2, <span class="built_in">int</span> a3)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> v3; // edi</span><br><span class="line">  <span class="built_in">int</span> v4; // esi</span><br><span class="line">  <span class="built_in">int</span> v5; // edx</span><br><span class="line">  <span class="built_in">int</span> v6; // eax</span><br><span class="line">  <span class="built_in">int</span> v7; // ecx</span><br><span class="line">  <span class="built_in">int</span> v8; // esi</span><br><span class="line">  <span class="built_in">int</span> v9; // esi</span><br><span class="line">  <span class="built_in">int</span> v10; // esi</span><br><span class="line">  <span class="built_in">int</span> v11; // esi</span><br><span class="line">  _BYTE *v12; // ecx</span><br><span class="line">  <span class="built_in">int</span> v13; // esi</span><br><span class="line">  <span class="built_in">int</span> v15; // [esp+18h] [ebp+8h]</span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  sub_401000();</span><br><span class="line">  v5 = a2 % <span class="number">3</span>;</span><br><span class="line">  v6 = a1;</span><br><span class="line">  v7 = a2 - a2 % <span class="number">3</span>;</span><br><span class="line">  v15 = a2 % <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v7 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">      LOBYTE(v5) = *(a1 + v3);</span><br><span class="line">      v3 += <span class="number">3</span>;</span><br><span class="line">      v8 = v4 + <span class="number">1</span>;</span><br><span class="line">      *(v8 + a3 - <span class="number">1</span>) = base[(v5 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">      *(++v8 + a3 - <span class="number">1</span>) = base[<span class="number">16</span> * (*(a1 + v3 - <span class="number">3</span>) &amp; <span class="number">3</span>) + ((*(a1 + v3 - <span class="number">2</span>) &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xF</span>)];</span><br><span class="line">      *(++v8 + a3 - <span class="number">1</span>) = base[<span class="number">4</span> * (*(a1 + v3 - <span class="number">2</span>) &amp; <span class="number">0xF</span>) + ((*(a1 + v3 - <span class="number">1</span>) &gt;&gt; <span class="number">6</span>) &amp; <span class="number">3</span>)];</span><br><span class="line">      v5 = *(a1 + v3 - <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">      v4 = v8 + <span class="number">1</span>;</span><br><span class="line">      *(v4 + a3 - <span class="number">1</span>) = base[v5];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v3 &lt; v7 );</span><br><span class="line">    v5 = v15;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    LOBYTE(v7) = *(v3 + a1);</span><br><span class="line">    v9 = v4 + <span class="number">1</span>;</span><br><span class="line">    *(v9 + a3 - <span class="number">1</span>) = base[(v7 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v10 = v9 + <span class="number">1</span>;</span><br><span class="line">    *(v10 + a3 - <span class="number">1</span>) = base[<span class="number">16</span> * (*(v3 + a1) &amp; <span class="number">3</span>)];</span><br><span class="line">    *(v10 + a3) = <span class="number">61</span>;</span><br><span class="line">LABEL_8:</span><br><span class="line">    v13 = v10 + <span class="number">1</span>;</span><br><span class="line">    *(v13 + a3) = <span class="number">61</span>;</span><br><span class="line">    v4 = v13 + <span class="number">1</span>;</span><br><span class="line">    goto LABEL_9;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 = v4 + <span class="number">1</span>;</span><br><span class="line">    *(v11 + a3 - <span class="number">1</span>) = base[(*(v3 + a1) &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v12 = (v3 + a1 + <span class="number">1</span>);</span><br><span class="line">    LOBYTE(v6) = *v12;</span><br><span class="line">    v10 = v11 + <span class="number">1</span>;</span><br><span class="line">    *(v10 + a3 - <span class="number">1</span>) = base[<span class="number">16</span> * (*(v3 + a1) &amp; <span class="number">3</span>) + ((v6 &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xF</span>)];</span><br><span class="line">    *(v10 + a3) = base[<span class="number">4</span> * (*v12 &amp; <span class="number">0xF</span>)];</span><br><span class="line">    goto LABEL_8;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_9:</span><br><span class="line">  *(v4 + a3) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> sub_401030(a3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一开始是一个sub_401000函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> sub_401000()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> result; // eax</span><br><span class="line">  char v1; // cl</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( result = <span class="number">6</span>; result &lt; <span class="number">15</span>; ++result )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = byte_40E0AA[result];</span><br><span class="line">    byte_40E0AA[result] = base[result];</span><br><span class="line">    base[result] = v1; //怎么这么熟悉，C语言里的替换？？</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个函数的意思是将base表中的</p>
<p>我们进入这个byte_40E0AA查看，貌似不是普通的base64加密函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128150310298.png" class="" title="image-20220128150310298">

<p>我们已知：</p>
<p>base:ABCDEFGHIJ</p>
<p>byte_40E0AA：KLMNOPQRS…………</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128150758655.png" class="" title="image-20220128150758655">

<p>查看跳出sub_401000，查看后面代码，可以看出是base64加密</p>
<p>我们再继续往后看</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> sub_401030(a3);</span><br></pre></td></tr></table></figure>

<p>最后有一个sub_401030函数，我们继续跟进python</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl sub_401030(const char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; // rax</span><br><span class="line">  char v2; // al</span><br><span class="line"></span><br><span class="line">  v1 = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> ( strlen(a1) )</span><br><span class="line">  &#123;</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = a1[HIDWORD(v1)];</span><br><span class="line">      <span class="keyword">if</span> ( v2 &lt; <span class="string">&#x27;a&#x27;</span> || v2 &gt; <span class="string">&#x27;z&#x27;</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v2 &lt; <span class="string">&#x27;A&#x27;</span> || v2 &gt; <span class="string">&#x27;Z&#x27;</span> )</span><br><span class="line">          goto LABEL_9;</span><br><span class="line">        LOBYTE(v1) = v2 + <span class="number">32</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        LOBYTE(v1) = v2 - <span class="number">32</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      a1[HIDWORD(v1)] = v1;</span><br><span class="line">LABEL_9:</span><br><span class="line">      LODWORD(v1) = <span class="number">0</span>;</span><br><span class="line">      ++HIDWORD(v1);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( HIDWORD(v1) &lt; strlen(a1) );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看出这个函数的意思就是把加密后的结果大小写字母转换，</p>
<p>看最后的比较函数，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">while</span> ( *(v5 + v3) == byte_40E0E4[v3] )       // 匹配函数</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v3 &gt; strlen(v5) )</span><br><span class="line">      goto LABEL_6;</span><br><span class="line">  &#125;</span><br><span class="line">  my_print(aError);</span><br><span class="line">LABEL_6:</span><br><span class="line">  <span class="keyword">if</span> ( v3 - <span class="number">1</span> == strlen(byte_40E0E4) )</span><br><span class="line">    <span class="keyword">return</span> my_print(aAreYouHappyYes);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> my_print(aAreYouHappyNo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这么多应该都是比较函数，我是这么理解的:</p>
<p>如果v5这个字符串与byte_40E0E4这个字符串相等，则会一直执行while循环对比，直到v3&#x3D;strlen(v5)+1，然后进入LABEL_6比较，相等则v3-1&#x3D;strlen(v5)，就输出正确的提示信息；</p>
<p>如果v5与这个字符串有一个不相等，则直接会退出while循环，这时</p>
<p>然后跟进byte_40E0E4，这个时候长度一定不相等，就输出错误的提示信息。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128151448946.png" class="" title="image-20220128151448946">

<p>最后与加密之后对比的字符串为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&quot;</span></span><br></pre></td></tr></table></figure>

<p>有个疑问哈，这个z和后面的是分离的，所以怎么分辨那些块是那个字符串，还是可以共用？？如果是aMxh3……字符串这他对应的内容是多少，是和string一致，还是比string少一个z……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128152905444.png" class="" title="image-20220128152905444">

<p>在询问大佬z1r0之后，得知，A 键可以使字符串连接起来</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128161958815.png" class="" title="image-20220128161958815">

<p>所以，base64对应的字符串：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br></pre></td></tr></table></figure>

<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/yhfgs/article/details/117449856?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.pc_relevant_default&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=3">https://blog.csdn.net/yhfgs/article/details/117449856?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.pc_relevant_default&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=3</a></p>
<p>我们理一下，</p>
<ol>
<li>先把这个string大小写先转换</li>
<li>修改base64转换表</li>
<li>加密结果通过转换表得到正常加密的结果</li>
<li>base64解密</li>
</ol>
<p>上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># 大小写转换</span></span><br><span class="line">string = <span class="string">&#x27;zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&#x27;</span>.swapcase()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 换表</span></span><br><span class="line">base = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line">lis = <span class="built_in">list</span>(base)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>,<span class="number">15</span>):</span><br><span class="line">    lis[<span class="number">10</span>+i],lis[i] = lis[i],lis[<span class="number">10</span>+i]</span><br><span class="line"></span><br><span class="line">new_base = <span class="string">&#x27;&#x27;</span>.join(lis)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># base64换表解密</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">flag += <span class="built_in">str</span>(base64.b64decode(string.translate(<span class="built_in">str</span>.maketrans(new_base,base))))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{bAse64_h2s_a_Surprise}</p>
<h1 id="2019红帽杯-easyRE（-fini）"><a href="#2019红帽杯-easyRE（-fini）" class="headerlink" title="[2019红帽杯]easyRE（.fini）"></a>[2019红帽杯]easyRE（.fini）</h1><p>查壳之后没有壳，直接用ida64打开，我一般是直接按Tab键看伪代码的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">__int64 sub_4009C6()</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; // rax</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+Ch] [rbp-114h]</span><br><span class="line">  __int64 v2; // [rsp+10h] [rbp-<span class="number">1</span>10h]</span><br><span class="line">  __int64 v3; // [rsp+18h] [rbp-108h]</span><br><span class="line">  __int64 v4; // [rsp+20h] [rbp-100h]</span><br><span class="line">  __int64 v5; // [rsp+28h] [rbp-F8h]</span><br><span class="line">  __int64 v6; // [rsp+30h] [rbp-F0h]</span><br><span class="line">  __int64 v7; // [rsp+38h] [rbp-E8h]</span><br><span class="line">  __int64 v8; // [rsp+40h] [rbp-E0h]</span><br><span class="line">  __int64 v9; // [rsp+48h] [rbp-D8h]</span><br><span class="line">  __int64 v10; // [rsp+50h] [rbp-D0h]</span><br><span class="line">  __int64 v11; // [rsp+58h] [rbp-C8h]</span><br><span class="line">  char v12[<span class="number">13</span>]; // [rsp+60h] [rbp-C0h] BYREF</span><br><span class="line">  char v13[<span class="number">4</span>]; // [rsp+6Dh] [rbp-B3h] BYREF</span><br><span class="line">  char v14[<span class="number">19</span>]; // [rsp+71h] [rbp-AFh] BYREF</span><br><span class="line">  char v15[<span class="number">32</span>]; // [rsp+90h] [rbp-90h] BYREF</span><br><span class="line">  <span class="built_in">int</span> v16; // [rsp+B0h] [rbp-70h]</span><br><span class="line">  char v17; // [rsp+B4h] [rbp-6Ch]</span><br><span class="line">  char v18[<span class="number">72</span>]; // [rsp+C0h] [rbp-60h] BYREF</span><br><span class="line">  unsigned __int64 v19; // [rsp+108h] [rbp-18h]</span><br><span class="line"></span><br><span class="line">  v19 = __readfsqword(0x28u);</span><br><span class="line">  qmemcpy(v12, <span class="string">&quot;Iodl&gt;Qnb(ocy&quot;</span>, <span class="number">12</span>);</span><br><span class="line">  v12[<span class="number">12</span>] = <span class="number">127</span>;</span><br><span class="line">  qmemcpy(v13, <span class="string">&quot;y.i&quot;</span>, <span class="number">3</span>);</span><br><span class="line">  v13[<span class="number">3</span>] = <span class="number">127</span>;</span><br><span class="line">  qmemcpy(v14, <span class="string">&quot;d`3w&#125;wek9&#123;iy=~yL@EC&quot;</span>, sizeof(v14));</span><br><span class="line">  memset(v15, <span class="number">0</span>, sizeof(v15));</span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">  v17 = <span class="number">0</span>;</span><br><span class="line">  sub_4406E0(<span class="number">0</span>, v15, 37LL);</span><br><span class="line">  v17 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( sub_424BA0(v15) == <span class="number">36</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; sub_424BA0(v15); ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (v15[i] ^ i) != v12[i] )</span><br><span class="line">      &#123;</span><br><span class="line">        result = 4294967294LL;</span><br><span class="line">        goto LABEL_13;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_410CC0(<span class="string">&quot;continue!&quot;</span>);</span><br><span class="line">    memset(v18, <span class="number">0</span>, <span class="number">65</span>);</span><br><span class="line">    sub_4406E0(<span class="number">0</span>, v18, 64LL);</span><br><span class="line">    v18[<span class="number">39</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( sub_424BA0(v18) == <span class="string">&#x27;\&#x27;&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = my_base64(v18);</span><br><span class="line">      v3 = my_base64(v2);</span><br><span class="line">      v4 = my_base64(v3);</span><br><span class="line">      v5 = my_base64(v4);</span><br><span class="line">      v6 = my_base64(v5);</span><br><span class="line">      v7 = my_base64(v6);</span><br><span class="line">      v8 = my_base64(v7);</span><br><span class="line">      v9 = my_base64(v8);</span><br><span class="line">      v10 = my_base64(v9);</span><br><span class="line">      v11 = my_base64(v10);</span><br><span class="line">      <span class="keyword">if</span> ( !sub_400360(v11, off_6CC090) )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_410CC0(<span class="string">&quot;You found me!!!&quot;</span>);</span><br><span class="line">        sub_410CC0(<span class="string">&quot;bye bye~&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      result = 0LL;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = 4294967293LL;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = 0xFFFFFFFFLL;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(0x28u) != v19 )</span><br><span class="line">    sub_444020();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220127111824258.png" class="" title="image-20220127111824258">

<p>当我发现这个sub_400E44是base64之后，n键改个名字：my_base64</p>
<p>上面有一堆混淆人的伪代码，咱们直接看重点就行，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">memset(v18, <span class="number">0</span>, <span class="number">65</span>);</span><br></pre></td></tr></table></figure>

<p>为v18初始化</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_4406E0(<span class="number">0</span>, v18, 64LL);</span><br></pre></td></tr></table></figure>

<p>结合上下文可以知道这个sub_44065E0是赋值给v18的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( sub_424BA0(v18) == <span class="string">&#x27;\&#x27;&#x27;</span> )</span><br><span class="line">&#123;</span><br><span class="line">  v2 = my_base64(v18);</span><br><span class="line">  v3 = my_base64(v2);</span><br><span class="line">  v4 = my_base64(v3);</span><br><span class="line">  v5 = my_base64(v4);</span><br><span class="line">  v6 = my_base64(v5);</span><br><span class="line">  v7 = my_base64(v6);</span><br><span class="line">  v8 = my_base64(v7);</span><br><span class="line">  v9 = my_base64(v8);</span><br><span class="line">  v10 = my_base64(v9);</span><br><span class="line">  v11 = my_base64(v10);</span><br><span class="line">  <span class="keyword">if</span> ( !sub_400360(v11, off_6CC090) )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_410CC0(<span class="string">&quot;You found me!!!&quot;</span>);</span><br><span class="line">    sub_410CC0(<span class="string">&quot;bye bye~&quot;</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>然后就是将v18base64加密十次，与off_6cc090比较，我们直接把off_6cc090反向解密10次就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&#x27;Vm0wd2VHUXhTWGhpUm1SWVYwZDRWVll3Wkc5WFJsbDNXa1pPVlUxV2NIcFhhMk0xVmpKS1\</span></span><br><span class="line"><span class="string">NHVkdXbFpOYmtKVVZtcEtTMUl5VGtsaVJtUk9ZV3hhZVZadGVHdFRNVTVYVW01T2FGSnRVbGhhVjNoaF\</span></span><br><span class="line"><span class="string">ZWWmtWMXBFVWxSTmJFcElWbTAxVDJGV1NuTlhia0pXWWxob1dGUnJXbXRXTVZaeVdrWm9hVlpyV1hwV1\</span></span><br><span class="line"><span class="string">IzaGhXVmRHVjFOdVVsWmlhMHBZV1ZSR1lWZEdVbFZTYlhSWFRWWndNRlZ0TVc5VWJGcFZWbXR3VjJKSF\</span></span><br><span class="line"><span class="string">VYZFdha1pXWlZaT2NtRkhhRk5pVjJoWVYxZDBhMVV3TlhOalJscFlZbGhTY1ZsclduZGxiR1J5VmxSR1\</span></span><br><span class="line"><span class="string">ZXSlZjRWhaTUZKaFZqSktWVkZZYUZkV1JWcFlWV3BHYTFkWFRrZFRiV3hvVFVoQ1dsWXhaRFJpTWtsM1\</span></span><br><span class="line"><span class="string">RVaG9hbEpYYUhOVmJUVkRZekZhY1ZKcmRGTk5Wa3A2VjJ0U1ExWlhTbFpqUldoYVRVWndkbFpxUmtwbG\</span></span><br><span class="line"><span class="string">JVWklZVVprYUdFeGNHOVhXSEJIWkRGS2RGSnJhR2hTYXpWdlZGVm9RMlJzV25STldHUlZUVlpXTlZadE\</span></span><br><span class="line"><span class="string">5VOVdiVXBJVld4c1dtSllUWGhXTUZwell6RmFkRkpzVWxOaVNFSktWa1phVTFFeFduUlRhMlJxVWxad1\</span></span><br><span class="line"><span class="string">YxWnRlRXRXTVZaSFVsUnNVVlZVTURrPQ==&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#十次base64解密之后：?????</span></span><br><span class="line">string_2 = <span class="string">&#x27;https://bbs.pediy.com/thread-254172.htm&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(string)</span><br></pre></td></tr></table></figure>

<p>炸了，给我跳出一个网址。在查看z1r0的博客后，有些不理解的地方，不知道他关于真正flag函数是怎么找到的，在询问z1r0之后，z1r0贴心地给了我提示，我总结一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">v10 = my_base64(v9);</span><br><span class="line">v11 = my_base64(v10);</span><br><span class="line"><span class="keyword">if</span> ( !sub_400360(v11, off_6CC090) )</span><br><span class="line">&#123;</span><br><span class="line">sub_410CC0(<span class="string">&quot;You found me!!!&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>这个off_6cc090就是我们上面要比对的字符串，我们跟进之后：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220127115027774.png" class="" title="image-20220127115027774">

<p>我们可以先对off_6CC090这个字符串按x,就会弹出下面的框框，可以看到</p>
<ol>
<li>引用这个字符串所在的函数(也就是上面10个base64加密的坑人的那个……)</li>
<li>引用类型r，</li>
<li>文本（应该是汇编指令）</li>
</ol>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220127115108851.png" class="" title="image-20220127115108851">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220127115321346.png" class="" title="image-20220127115321346">

<p>（看来我得好好的去看看IDA权威指南了，一脸蒙蔽……）</p>
<p>然后看颜色就可以知道，下面的byte_6CC0A0，处在同一个段中，我们跟进，然后切换伪代码视图：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220127120358169.png" class="" title="image-20220127120358169">

<p>我们继续按x,然后就可以看到引用了,我们继续跟进：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220127120537804.png" class="" title="image-20220127120537804">

<p>地址为.fini_array:00000000006CBEE8</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220127120735043.png" class="" title="image-20220127120735043">

<p>进程终止代码的一部分。程序正常退出时，系统将安排执行这边的代码！！！</p>
<p>所以这个函数很重要的！！！我们直接点击 sub_400D35这个函数跟进，然后按下tab:</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145640876.png" class="" title="image-20220128145640876">

<p>出来了！！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (v1 ^ byte_6CC0A0[<span class="number">0</span>]) == <span class="string">&#x27;f&#x27;</span> &amp;&amp; (HIBYTE(v4) ^ byte_6CC0A3) == <span class="string">&#x27;g&#x27;</span> )</span><br></pre></td></tr></table></figure>

<p>瞧瞧这第20行的地方，一个f，一个g，很有希望！！</p>
<p>看上面一行，v4&#x3D;v1,那就很好理解了：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220127121425081.png" class="" title="image-20220127121425081">

<p>直接把大佬的原话搬出来：</p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/people/xu-xu-xuxu-94">https://www.zhihu.com/people/xu-xu-xuxu-94</a></p>
<p>后面我看不懂z1r0博客中exp的十六进制数从哪里来的，我就去寻找资料</p>
<p><a target="_blank" rel="noopener" href="https://www.i4k.xyz/article/Palmer9/103940709">https://www.i4k.xyz/article/Palmer9/103940709</a></p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145623995.png" class="" title="image-20220128145623995">

<p>说找到这串不随机的数，怎么找的，我就用IDA跳转地址的功能，G就可以了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145612821.png" class="" title="image-20220128145612821">

<p>手动输入了一下，发现还真有</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220127122455977.png" class="" title="image-20220127122455977">

<p>用刚学的知识分析一下:</p>
<p>r代表读取交叉引用，说明sub_400D35函数引用了这串字符，我怎么没看到……</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145555693.png" class="" title="image-20220128145555693">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145545532.png" class="" title="image-20220128145545532">

<p>跟进去发现，就是这个byte_6CC0A0……(百度一下眼瞎怎么治)</p>
<p>直接上z1r0的代码，不解释了，看懂就行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">v4 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">str1 = <span class="string">&#x27;flag&#x27;</span></span><br><span class="line"></span><br><span class="line">key1 = [<span class="number">0x40</span>,<span class="number">0x35</span>,<span class="number">0x20</span>,<span class="number">0x56</span>,<span class="number">0x5D</span>,<span class="number">0x18</span>,<span class="number">0x22</span>,<span class="number">0x45</span>,<span class="number">0x17</span>,<span class="number">0x2F</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x62</span>,<span class="number">0x3C</span>,<span class="number">0x27</span>,<span class="number">0x54</span>,<span class="number">0x48</span>,<span class="number">0x6C</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x72</span>,<span class="number">0x3C</span>,<span class="number">0x32</span>,<span class="number">0x45</span>,<span class="number">0x5B</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    v4 += <span class="built_in">chr</span>(key1[i] ^ <span class="built_in">ord</span>(str1[i]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(v4)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(key1[i] ^ <span class="built_in">ord</span>(v4[i % <span class="number">4</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>看这个代码就清晰多了，key里面的是那些特殊字符的16进制形式，我们需要求出v4,使得v4的前四位能与key中的前四位进行异或操作时，等于flag，所以我们进行了key1[i]与ord(str1[i])的异或操作，将其还原回来，嗯，可以理解……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v4 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">str1 = <span class="string">&#x27;flag&#x27;</span></span><br><span class="line"></span><br><span class="line">key1 = [<span class="number">0x40</span>,<span class="number">0x35</span>,<span class="number">0x20</span>,<span class="number">0x56</span>,<span class="number">0x5D</span>,<span class="number">0x18</span>,<span class="number">0x22</span>,<span class="number">0x45</span>,<span class="number">0x17</span>,<span class="number">0x2F</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x62</span>,<span class="number">0x3C</span>,<span class="number">0x27</span>,<span class="number">0x54</span>,<span class="number">0x48</span>,<span class="number">0x6C</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x72</span>,<span class="number">0x3C</span>,<span class="number">0x32</span>,<span class="number">0x45</span>,<span class="number">0x5B</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    v4 += <span class="built_in">chr</span>(key1[i] ^ <span class="built_in">ord</span>(str1[i]))</span><br></pre></td></tr></table></figure>

<p>然后就是让key1中的每个字符，与v4[i%4]进行异或操作，为什么要求余4？因为v4一共就四位。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(key1[i] ^ <span class="built_in">ord</span>(v4[i % <span class="number">4</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{Act1ve_Defen5e_Test}</p>
<p>这也真“easy”，真不错……</p>
<h1 id="GUET-CTF2019-re-暴力-次序"><a href="#GUET-CTF2019-re-暴力-次序" class="headerlink" title="[GUET-CTF2019]re (暴力+次序)"></a>[GUET-CTF2019]re (暴力+次序)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145526875.png" class="" title="image-20220128145526875">

<p>先查壳，发现有upx壳子，然后我们用upx脱个壳</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145514036.png" class="" title="image-20220128145514036">

<p>然后放到IDA 64里面查看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall sub_400E28(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)</span><br><span class="line">&#123;</span><br><span class="line">  int v6; // edx</span><br><span class="line">  int v7; // ecx</span><br><span class="line">  int v8; // er8</span><br><span class="line">  int v9; // er9</span><br><span class="line">  __int64 result; // rax</span><br><span class="line">  __int64 v11[5]; // [rsp+0h] [rbp-30h] BYREF</span><br><span class="line">  unsigned __int64 v12; // [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(0x28u);</span><br><span class="line">  memset(&amp;v11[1], 0, 24);</span><br><span class="line">  sub_40F950((__int64)&quot;input your flag:&quot;, a2, a3, a4, a5, a6);</span><br><span class="line">  sub_40FA80((unsigned int)&quot;%s&quot;, (unsigned int)v11, v6, v7, v8, v9, 0);</span><br><span class="line">  if ( sub_4009AE((char *)v11) )</span><br><span class="line">    sub_410350((__int64)&quot;Correct!&quot;);</span><br><span class="line">  else</span><br><span class="line">    sub_410350((__int64)&quot;Wrong!&quot;);</span><br><span class="line">  result = 0LL;</span><br><span class="line">  if ( __readfsqword(0x28u) != v12 )</span><br><span class="line">    sub_443550();</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不要慌张，我们直接看correct的上一行，根据我的推测，从键盘输入的字符应该是放到了v11中，我们直接看sub_4009AE这个函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145501132.png" class="" title="image-20220128145501132">

<p>我们需要求的就是a1这个数组了</p>
<p>然后我们直接上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">lists1 = [<span class="number">1629056</span>,<span class="number">6771600</span>,<span class="number">3682944</span>,<span class="number">10431000</span>,<span class="number">3977328</span>, <span class="number">5138336</span>,<span class="number">7532250</span>,\</span><br><span class="line">          <span class="number">5551632</span>,<span class="number">3409728</span>,<span class="number">13013670</span>,<span class="number">6088797</span>,<span class="number">7884663</span>,<span class="number">8944053</span>,<span class="number">5198490</span>,\</span><br><span class="line">          <span class="number">4544518</span>,<span class="number">3645600</span>,<span class="number">10115280</span>,<span class="number">9667504</span>,<span class="number">5364450</span>,<span class="number">13464540</span>, <span class="number">5488432</span>,\</span><br><span class="line">          <span class="number">14479500</span>,<span class="number">6451830</span>,<span class="number">6252576</span>,<span class="number">7763364</span>,<span class="number">7327320</span>,<span class="number">8741520</span>,<span class="number">8871876</span>,\</span><br><span class="line">          <span class="number">4086720</span>,<span class="number">9374400</span>,<span class="number">5759124</span>]</span><br><span class="line"></span><br><span class="line">lists2 = [<span class="number">166163712</span>,<span class="number">731332800</span> ,<span class="number">357245568</span>,<span class="number">1074393000</span>,<span class="number">489211344</span>,<span class="number">518971936</span>,\</span><br><span class="line">          <span class="number">406741500</span>,<span class="number">294236496</span>,<span class="number">177305856</span>,<span class="number">650683500</span>,<span class="number">298351053</span>,<span class="number">386348487</span>,\</span><br><span class="line">          <span class="number">438258597</span>,<span class="number">249527520</span>,<span class="number">445362764</span>,<span class="number">174988800</span>,<span class="number">981182160</span>,<span class="number">493042704</span>,\</span><br><span class="line">          <span class="number">257493600</span>,<span class="number">767478780</span>,<span class="number">312840624</span>,<span class="number">1404511500</span>,<span class="number">316139670</span>,<span class="number">619005024</span>,\</span><br><span class="line">          <span class="number">372641472</span>,<span class="number">373693320</span>,<span class="number">498266640</span>,<span class="number">452465676</span>,<span class="number">208422720</span>,<span class="number">515592000</span>,\</span><br><span class="line">          <span class="number">719890500</span>]</span><br><span class="line"></span><br><span class="line">lists = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lists1)):</span><br><span class="line"></span><br><span class="line">    lists.append(<span class="built_in">chr</span>(<span class="built_in">int</span>(lists2[i]/lists1[i])))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lists:</span><br><span class="line">    <span class="built_in">print</span>(i,end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>flag{e65421110b0a3099a1c039337}，提交之后竟然错了。。。</p>
<p>知错就改，z1r0中的博客说a[6]不存在，z1r0然后用暴力枚举，把a[6]给爆破出来了，上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">lists1 = [<span class="number">1629056</span>,<span class="number">6771600</span>,<span class="number">3682944</span>,<span class="number">10431000</span>,<span class="number">3977328</span>, <span class="number">5138336</span>,<span class="number">7532250</span>,\</span><br><span class="line">          <span class="number">5551632</span>,<span class="number">3409728</span>,<span class="number">13013670</span>,<span class="number">6088797</span>,<span class="number">7884663</span>,<span class="number">8944053</span>,<span class="number">5198490</span>,\</span><br><span class="line">          <span class="number">4544518</span>,<span class="number">3645600</span>,<span class="number">10115280</span>,<span class="number">9667504</span>,<span class="number">5364450</span>,<span class="number">13464540</span>, <span class="number">5488432</span>,\</span><br><span class="line">          <span class="number">14479500</span>,<span class="number">6451830</span>,<span class="number">6252576</span>,<span class="number">7763364</span>,<span class="number">7327320</span>,<span class="number">8741520</span>,<span class="number">8871876</span>,\</span><br><span class="line">          <span class="number">4086720</span>,<span class="number">9374400</span>,<span class="number">5759124</span>]</span><br><span class="line"></span><br><span class="line">lists2 = [<span class="number">166163712</span>,<span class="number">731332800</span> ,<span class="number">357245568</span>,<span class="number">1074393000</span>,<span class="number">489211344</span>,<span class="number">518971936</span>,\</span><br><span class="line">          <span class="number">406741500</span>,<span class="number">294236496</span>,<span class="number">177305856</span>,<span class="number">650683500</span>,<span class="number">298351053</span>,<span class="number">386348487</span>,\</span><br><span class="line">          <span class="number">438258597</span>,<span class="number">249527520</span>,<span class="number">445362764</span>,<span class="number">174988800</span>,<span class="number">981182160</span>,<span class="number">493042704</span>,\</span><br><span class="line">          <span class="number">257493600</span>,<span class="number">767478780</span>,<span class="number">312840624</span>,<span class="number">1404511500</span>,<span class="number">316139670</span>,<span class="number">619005024</span>,\</span><br><span class="line">          <span class="number">372641472</span>,<span class="number">373693320</span>,<span class="number">498266640</span>,<span class="number">452465676</span>,<span class="number">208422720</span>,<span class="number">515592000</span>,\</span><br><span class="line">          <span class="number">719890500</span>]</span><br><span class="line"></span><br><span class="line">lists = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lists1)):</span><br><span class="line"></span><br><span class="line">    lists.append(<span class="built_in">chr</span>(<span class="built_in">int</span>(lists2[i]/lists1[i])))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span>.join(lists)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="built_in">print</span>(flag[<span class="number">0</span>:<span class="number">6</span>]+<span class="built_in">chr</span>(<span class="number">48</span>+i)+flag[<span class="number">6</span>:<span class="built_in">len</span>(flag)])</span><br></pre></td></tr></table></figure>

<p>奇怪啊，z1r0说，结果为第二个，为什么还是错的？？</p>
<p>返回ADI中，我看到了：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145436333.png" class="" title="image-20220128145436333">还得注意次序！！

<p>flag{e165421110ba03099a1c039337}</p>
<h1 id="SUCTF-2019-SignIn（rsa-plus）"><a href="#SUCTF-2019-SignIn（rsa-plus）" class="headerlink" title="[SUCTF 2019] SignIn（rsa plus）"></a>[SUCTF 2019] SignIn（rsa plus）</h1><p>RSA绝对是当今应用最为广泛的公钥加密算法</p>
<p>这是我第二次碰到rsa算法了，这次不能放过它了</p>
<p>这里我参考了b站油管rsa的介绍</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV14y4y1272w?from=search&amp;seid=6444314376553406414&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV14y4y1272w?from=search&amp;seid=6444314376553406414&amp;spm_id_from=333.337.0.0</a></p>
<p>看看z1r0的博客，发现一篇文章也说的很好</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/dbs1215/article/details/48953589">https://blog.csdn.net/dbs1215/article/details/48953589</a></p>
<ol>
<li>什么是rsa?</li>
</ol>
<p>rsa是一种加密和解密使用不同密码的方式，因此公钥密码通常车给非对称密码</p>
<ol>
<li>rsa加密</li>
</ol>
<p>密文＝明文^E mod N</p>
<p>常说的公钥为E和N的组合，我们就用（E，N）来表示公钥</p>
<ol>
<li>rsa解密</li>
</ol>
<p>明文＝密文^D mod N</p>
<p>对密文进行D次方后除以N的余数就是明文，这就是RSA解密过程，知道D和N就能进行</p>
<ol>
<li>一般题目的解题方法</li>
</ol>
<p>一般的题目中会给出我们E和N，这两个是属于公钥，我们可以先把N放到因式分解工具找出P和Q，然后通过rsatool求出d——需要把N,E,Q,P都放到rsatool中并且调试对应的配置，最后是脚本的编写，具体我会放在后面</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">因式分解工具：http://www.factordb.com/index.php</span><br></pre></td></tr></table></figure>

<p>先查看题目，记得是没有壳的</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145420892.png" class="" title="image-20220128145420892">

<p>记住rsa的特性，一个非常长的数字N，还有一个很短的数字E</p>
<p>分析一下题目，v8用来接受输入的字符，然后v8,v9进入了一个sub_96A的函数,我们跟进查看</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145409093.png" class="" title="image-20220128145409093">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> byte_202010[<span class="number">16</span>] = &#123;<span class="number">0x30</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x66</span>&#125;;</span><br><span class="line"></span><br><span class="line">size_t sub_96A(const char *a1, char *a2)</span><br><span class="line">&#123;</span><br><span class="line">    size_t result;</span><br><span class="line">    <span class="built_in">int</span> v3 = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>;; i += <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        result = strlen(a1);</span><br><span class="line">        result = strlen(a1);</span><br><span class="line">        <span class="keyword">if</span> (v3 &gt;= result)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        a2[i] = byte_202010[a1[v3] &gt;&gt; <span class="number">4</span>];</span><br><span class="line">        a2[i + <span class="number">1</span>] = byte_202010[a1[v3++] &amp; <span class="number">0xF</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">int</span> main(<span class="built_in">int</span> argc,char **argv)</span><br><span class="line">&#123;</span><br><span class="line">    char v8[<span class="number">20</span>];</span><br><span class="line">    char v9[<span class="number">101</span>];</span><br><span class="line">    scanf(<span class="string">&quot;%s&quot;</span>, v8);</span><br><span class="line">    sub_96A(v8, v9);</span><br><span class="line">    printf(<span class="string">&quot;%s\n&quot;</span>, v9);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">//C语言，<span class="number">16</span>进制位0x,和python一致</span><br><span class="line">//size_t为无符号整数类型</span><br><span class="line">//字符数组的形式参数，用char * a</span><br><span class="line">//字符数组的输出，直接用%s就行了</span><br></pre></td></tr></table></figure>

<p>以上参考z1r0的代码，该函数的功能是将v8的字符串转换为16进制放入v9,然后就是下面的两个函数，<strong>gmpz_init_set_str和</strong>gmpz_powm</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145239546.png" class="" title="image-20220128145239546">

<p>是GNU的高精度算法？？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">__gmpz_init_set_str(v7, <span class="string">&quot;ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35&quot;</span>, 16LL);</span><br><span class="line">__gmpz_init_set_str(v6, v9, 16LL);</span><br><span class="line"></span><br><span class="line">__gmpz_init_set_str(v4, <span class="string">&quot;103461035900816914121390101299049044413950405173712170434161686539878160984549&quot;</span>, 10LL);</span><br><span class="line"></span><br><span class="line">__gmpz_init_set_str(v5, <span class="string">&quot;65537&quot;</span>, 10LL);</span><br><span class="line">__gmpz_powm(v6, v6, v5, v4);</span><br><span class="line"><span class="keyword">if</span> ( __gmpz_cmp(v6, v7) )</span><br><span class="line">puts(<span class="string">&quot;GG!&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">puts(<span class="string">&quot;TTTTTTTTTTql!&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>将ad939ff59~~这个字符串以16进制写入v7</p>
<p>将1034~~这个数字以10进制写入v4</p>
<p>将65537这个字符串以10进制写入v5</p>
<p>__gmpz_pown(v6,v6,v5,v4)，意思是计算v6的v5次方，并对v4取模，写入v6，现在我终于看明白了，v6相当于明文，v5相当于E，v4相当于N，</p>
<p>rsa的加密算法：明文^E%N</p>
<p>__gmpz_cmp是一个比较函数，看名字就知道了</p>
<p>rsa加密之后与ad939ff59~~这个函数作比较</p>
<p>我们先用因式分解工具来算出P和Q</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145216926.png" class="" title="image-20220128145216926">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">P：<span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">Q：<span class="number">366669102002966856876605669837014229419</span></span><br></pre></td></tr></table></figure>

<p>然后用rsatool求出d</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220128145130446.png" class="" title="image-20220128145130446">

<p>记住要先选择number base，即进制，然后再输入数据。</p>
<p>D &#x3D; 91646299298871237857836940212608056141193465208586711901499120163393577626813</p>
<p>上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">N = <span class="number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></span><br><span class="line">E = <span class="number">65537</span></span><br><span class="line">p = <span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">q = <span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">D = <span class="number">91646299298871237857836940212608056141193465208586711901499120163393577626813</span></span><br><span class="line">C = <span class="number">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span></span><br><span class="line"></span><br><span class="line">M = gmpy2.powmod(C, D, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(M)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_60553183/article/details/122084511">https://blog.csdn.net/weixin_60553183/article/details/122084511</a></p>
<p>我得理一下，gmpy2是干嘛的。</p>
<p>下面是关于gmpy2的常见函数的使用</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43790779/article/details/108473984">https://blog.csdn.net/weixin_43790779/article/details/108473984</a></p>
<p>powmod是求大整数x的y次幂m取余，</p>
<p>b‘suctf{Pwn*@*hundred_years}’</p>
<h1 id="xor-异或"><a href="#xor-异或" class="headerlink" title="xor (异或)"></a>xor (异或)</h1><p>首先用exeinfoPE判断一下</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220119000639056.png" class="" title="image-20220119000639056">

<p>是64位的，没有加壳，然后用IDA 64位打开，找到main函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220119000804834.png" class="" title="image-20220119000804834">

<p>然后就是分析主函数，输入v6,让v6和global作比较，由题目得知，如果如数v6的长度没有33，则直接跳转到LABLE_12的位置，输出Failed</p>
<p>然后就是分析伪代码</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220119001051349.png" class="" title="image-20220119001051349">

<p>下面是脚本的编写：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">lists = [<span class="string">&#x27;f&#x27;</span>,<span class="number">0x0A</span>,<span class="string">&#x27;k&#x27;</span>,<span class="number">0x0C</span>,<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;O&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;@&#x27;</span>,<span class="number">0x11</span>,\</span><br><span class="line">         <span class="string">&#x27;x&#x27;</span>,<span class="number">0x0D</span>,<span class="string">&#x27;Z&#x27;</span>,<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="number">0x11</span>,<span class="string">&#x27;p&#x27;</span>,<span class="number">0x19</span>,<span class="string">&#x27;F&#x27;</span>,<span class="number">0x1F</span>,\</span><br><span class="line">         <span class="string">&#x27;v&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="number">0x0E</span>,<span class="string">&#x27;g&#x27;</span>,<span class="number">6</span>,<span class="string">&#x27;h&#x27;</span>,<span class="number">0x0F</span>,<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;O&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(lists)):</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">isinstance</span>(lists[i],<span class="built_in">int</span>)):</span><br><span class="line">        lists[i] = <span class="built_in">chr</span>(lists[i])</span><br><span class="line"></span><br><span class="line">string = <span class="string">&#x27;&#x27;</span>.join(lists)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;f&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(lists)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(lists[i]) ^ <span class="built_in">ord</span>(lists[i-<span class="number">1</span>]))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(lists))</span><br></pre></td></tr></table></figure>

<ol>
<li><p>将伪代码中的单个字符保持不动，连起来的字符分开，十六进制的在前面填上0x进制符号，并删除后面的h，然后放入列表lists</p>
</li>
<li><p>将列表中的int类型转换位char类型，用isinstance( x, type)方法来比较</p>
</li>
<li><p>将列表中的元素转换为字符串，如果这时输出，那么十六进制的那一块将转换为空格</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220119001858906.png" class="" title="image-20220119001858906">
</li>
<li><p>然后将字符串的字符一次进行异或运算，最终输出得到flag</p>
</li>
</ol>
<h1 id="hello-word（apk逆向）"><a href="#hello-word（apk逆向）" class="headerlink" title="hello word（apk逆向）"></a>hello word（apk逆向）</h1><p>写在后面的话:</p>
<p>apk反汇编推荐用jadx-gui和GDAE</p>
<p>–正文–</p>
<p>参考资料：<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/29370382">https://www.zhihu.com/question/29370382</a></p>
<ol>
<li>使用apktool</li>
</ol>
<p>cmd+D，打开dos，找到apk的目录，然后键入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apktool d 名字.apk</span><br></pre></td></tr></table></figure>

<p>即可。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220119112636466.png" class="" title="image-20220119112636466">

<p>解出以上资源</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CD			进入</span><br><span class="line">CD ../		进入上一层目录</span><br></pre></td></tr></table></figure>

<p>但是我们需要的是.dex文件，所以此时应该再运行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apktool d -s -f 名字.apk</span><br></pre></td></tr></table></figure>

<p>-s    不反编译dex文件，而是将其保留</p>
<p>-f    如果目标文件夹存在，则删除后重新反编译</p>
<p>d    反编译apk文件</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220119113436982.png" class="" title="image-20220119113436982">



<p>将修改完的apk重新打包</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apktool b 目录名 -o newtest.apk</span><br></pre></td></tr></table></figure>

<p>-b        build</p>
<p>-o    新的文件名</p>
<ol>
<li>使用dex2jar工具</li>
</ol>
<p>参考链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/dbe579f6cc84">https://www.jianshu.com/p/dbe579f6cc84</a></p>
<p>将apktool反汇编所得文件的classes.dex复制到dex2jar.bat所在目录</p>
<p>我的存放地址是：C:\Users\Lenovo\Desktop\dex2jar-2.0</p>
<p>然后在命令行中键入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d2j-dex2jar classes.dex</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220119115917849.png" class="" title="image-20220119115917849">

<p>生成了一个class-dex2jar.jar文件，就是反编译后的java源码文件</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220119120045923.png" class="" title="image-20220119120045923">



<ol>
<li>使用jd-gui.exe运行生成的反编译的Java源码</li>
</ol>
<p>然后用jd-gui.exe运行生成的class-dex2jar.jar文件，就可以看到源码了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220119120445359.png" class="" title="image-20220119120445359">



<h1 id="reverse-3-base64"><a href="#reverse-3-base64" class="headerlink" title="reverse_3 (base64)"></a>reverse_3 (base64)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220119123546467.png" class="" title="image-20220119123546467">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( !strncmp(Dest, Str2, v6) )</span><br></pre></td></tr></table></figure>

<p>strncmp()函数，str2与Dest作比较，最多比较前v6个字符串长度</p>
<p>结果为0，则两个字符串相等</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strncpy(Dest, v5, 40u);</span><br></pre></td></tr></table></figure>

<p>strncpy()函数，v5复制到Dest字符数组中，长度为40u</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">memset(<span class="built_in">str</span>,<span class="string">&#x27;$&#x27;</span>,<span class="number">7</span>)</span><br></pre></td></tr></table></figure>

<p>memset()函数，将符号‘$’复制到str字符数组中，长度为7</p>
<p>根据大佬写的知乎，发现这个是base64的编码，好家伙，python两行搞完。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">str1 = <span class="string">&quot;e3nifIH9b_C@n@dH&quot;</span></span><br><span class="line">lists = [i <span class="keyword">for</span> i <span class="keyword">in</span> str1]</span><br><span class="line"></span><br><span class="line">str2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lists)):</span><br><span class="line">    lists[i] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(lists[i])-i)</span><br><span class="line">    str2 += lists[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(str2)</span><br><span class="line">str3 = base64.b64decode(str2)</span><br><span class="line"><span class="built_in">print</span>(str3)</span><br></pre></td></tr></table></figure>



<h1 id="Simple-Rev-ADI小端存储"><a href="#Simple-Rev-ADI小端存储" class="headerlink" title="Simple_Rev (ADI小端存储)"></a>Simple_Rev (ADI小端存储)</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_47158947/article/details/107461010?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1.pc_relevant_default&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1.pc_relevant_default&utm_relevant_index=1">参考链接</a></p>
<p>今天吃了个大亏</p>
<p>ADA里面的字符存储是小端存储</p>
<p>小端存储就是低地址存放到底位上，高地址存放到高位上。</p>
<p>以下是小端存储模式下的0x123456的存储，明显看到次序是颠倒的</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220120113226152.png" class="" title="image-20220120113226152">

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220120112352092.png" class="" title="image-20220120112352092">

<p>所以，遇到这种直接把字符需要小心，先转换一下次序再说</p>
<p>首先我们测一下这个exe文件是否有壳</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220120112611270.png" class="" title="image-20220120112611270">

<p>说句实话，我看不出来，貌似有一个压缩壳，然后是需要64位的Ada使用</p>
<p>打开之后看一下伪代码</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220120112731449.png" class="" title="image-20220120112731449">

<p>主要是进Decry()函数看一下，进去之后就是新世界</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220120112824095.png" class="" title="image-20220120112824095">

<p>这边就是主要算法了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220120112441435.png" class="" title="image-20220120112441435">

<p>这种的意思是字母大写转换为小写，key由大写转换为小写</p>
<p>通过循环上面的得知，</p>
<p>key &#x3D; ‘adsfkndcls’                        text &#x3D; ‘killshadow’</p>
<p>看一下算法主题，就是一个while()循环，输入字符，如果碰到换行符直接退出。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&#x27;adsfkndcls&#x27;</span></span><br><span class="line">text = <span class="string">&#x27;killshadow&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#flag长度</span></span><br><span class="line">n = <span class="built_in">len</span>(text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#ASCII码一共128个，依次循环</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line"></span><br><span class="line">        <span class="comment">#不是字符，直接下一次循环</span></span><br><span class="line">        <span class="keyword">if</span> j &lt; <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">or</span> j &gt; <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>) \</span><br><span class="line">           <span class="keyword">or</span> (j &lt; <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">and</span> j &gt; <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)):</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#枚举</span></span><br><span class="line">        <span class="keyword">if</span> (j - <span class="number">39</span> - <span class="built_in">ord</span>(key[n % <span class="number">10</span>]) +<span class="number">97</span>) %<span class="number">26</span> +<span class="number">97</span> \</span><br><span class="line">           == <span class="built_in">ord</span>(text[i]):</span><br><span class="line"></span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>就是要把题目给理解透彻了才行</p>
<p>题目的意思是如果不是字母（大写小写皆可），就直接退出，如果是字母，就执行下面的转换，转换的里面还挺复杂的，所以直接就暴力枚举。</p>
<p>判断是不是字母还有点小绕<img src="/2022/01/28/BUU-reverse/BUU-reverse/0565AE05.png" class="" title="img"></p>
<h1 id="GXYCTF2019-luck-guy-ADI小端存储"><a href="#GXYCTF2019-luck-guy-ADI小端存储" class="headerlink" title="[GXYCTF2019]luck_guy (ADI小端存储)"></a>[GXYCTF2019]luck_guy (ADI小端存储)</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">f1 = <span class="string">&quot;GXY&#123;do_not_&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#小端，所以逆一下</span></span><br><span class="line">f2 = <span class="string">&#x27;fo`guci&#x27;</span>[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">lists = [i <span class="keyword">for</span> i <span class="keyword">in</span> f2]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> j%<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        lists[j] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(lists[j]) -<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        lists[j] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(lists[j]) -<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">string = <span class="string">&#x27;&#x27;</span>.join(lists)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f1+string)</span><br></pre></td></tr></table></figure>

<p>memset参考文档<a target="_blank" rel="noopener" href="http://c.biancheng.net/view/231.html">http://c.biancheng.net/view/231.html</a></p>
<p>memset()是初始化内存的万能函数，初始化之后，再向内存空间中存放需要的值，一般来说使用“0”初始化内存单元，通常给数组或结构体进行初始化，其实相当于结束标志‘\0’,最后面的参数是长度，一般专业一点会写sizeof(XX)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	char f1[] = <span class="string">&quot;GXY&#123;do_not_&quot;</span>;</span><br><span class="line">	char f2[] = <span class="string">&quot;hate_me&#125;&quot;</span>;</span><br><span class="line">	char flag[<span class="number">20</span>];</span><br><span class="line">	memset(flag,<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">	printf(<span class="string">&quot;%s&quot;</span>,flag);</span><br><span class="line">	strcat(flag,f1);</span><br><span class="line">	strcat(flag,f2);</span><br><span class="line">	puts(flag);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以基础很重要啊！！！</p>
<p>首先我们来分析一下题目，</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220120151801706.png" class="" title="image-20220120151801706">



<p>进入patch_me函数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220120151822801.png" class="" title="image-20220120151822801">



<p>再进入get_flag函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">v7 = __readfsqword(40u);</span><br><span class="line"> v0 = time(0LL);</span><br><span class="line"> srand(v0);</span><br><span class="line"> <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line"> &#123;</span><br><span class="line">   switch ( rand() % <span class="number">200</span> )</span><br><span class="line">   &#123;</span><br><span class="line">     case <span class="number">1</span>:</span><br><span class="line">       puts(<span class="string">&quot;OK, it&#x27;s flag:&quot;</span>);</span><br><span class="line">       memset(&amp;s, <span class="number">0</span>, 40uLL);</span><br><span class="line">       strcat((char *)&amp;s, f1);</span><br><span class="line">       strcat((char *)&amp;s, &amp;f2);</span><br><span class="line">       printf(<span class="string">&quot;%s&quot;</span>, &amp;s);</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     case <span class="number">2</span>:</span><br><span class="line">       printf(<span class="string">&quot;Solar not like you&quot;</span>);</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     case <span class="number">3</span>:</span><br><span class="line">       printf(<span class="string">&quot;Solar want a girlfriend&quot;</span>);</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     case <span class="number">4</span>:</span><br><span class="line">       v6 = <span class="number">0</span>;</span><br><span class="line">       s = <span class="string">&#x27;fo`guci&#x27;</span>;</span><br><span class="line">       strcat(&amp;f2, (const char *)&amp;s);</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     case <span class="number">5</span>:</span><br><span class="line">       <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">7</span>; ++j )</span><br><span class="line">       &#123;</span><br><span class="line">         <span class="keyword">if</span> ( j % <span class="number">2</span> == <span class="number">1</span> )</span><br><span class="line">           char_1 = *(&amp;f2 + j) - <span class="number">2</span>;</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">           char_1 = *(&amp;f2 + j) - <span class="number">1</span>;</span><br><span class="line">         *(&amp;f2 + j) = char_1;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     default:</span><br><span class="line">       puts(<span class="string">&quot;emmm,you can&#x27;t find flag 23333&quot;</span>);</span><br><span class="line">       <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>

<p>产生一个随机数，并进入switch结构，我们可以看出，按照4、5、1的顺序，就能求出flag，记得要注意ADI的小端优先</p>
<p>代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;GXY&#123;do_not_&#x27;</span></span><br><span class="line">f2 = [<span class="number">0x7F</span>, <span class="number">0x66</span>, <span class="number">0x6F</span>, <span class="number">0x60</span>, <span class="number">0x67</span>, <span class="number">0x75</span>, <span class="number">0x63</span>, <span class="number">0x69</span>][::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f2)</span><br><span class="line"></span><br><span class="line">ss = <span class="string">&#x27;&#x27;</span></span><br><span class="line">final = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        s = <span class="built_in">chr</span>(f2[i] - <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s = <span class="built_in">chr</span>(f2[i] - <span class="number">1</span>)</span><br><span class="line">    flag += s</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{do_not_hate_me}</p>
<h1 id="刮开有奖-ASCII排序-base64"><a href="#刮开有奖-ASCII排序-base64" class="headerlink" title="刮开有奖 (ASCII排序+base64)"></a>刮开有奖 (ASCII排序+base64)</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123105715388.png" class="" title="image-20220123105715388">

<p>首先查壳，分析一下是32位的程序，没有壳，所以用ida32打开</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123105820633.png" class="" title="image-20220123105820633">

<p>DialogFunc是一个函数，咱们跟进去</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( strlen(String) == <span class="number">8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      str1[<span class="number">0</span>] = <span class="string">&#x27;Z&#x27;</span>;</span><br><span class="line">      str1[<span class="number">1</span>] = <span class="string">&#x27;J&#x27;</span>;</span><br><span class="line">      str2 = <span class="string">&#x27;S&#x27;</span>;</span><br><span class="line">      str3 = <span class="string">&#x27;E&#x27;</span>;</span><br><span class="line">      str4 = <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">      str5 = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">      str6 = <span class="string">&#x27;N&#x27;</span>;</span><br><span class="line">      str7 = <span class="string">&#x27;H&#x27;</span>;</span><br><span class="line">      str8 = <span class="string">&#x27;3&#x27;</span>;</span><br><span class="line">      str9 = <span class="string">&#x27;n&#x27;</span>;</span><br><span class="line">      str10 = <span class="string">&#x27;g&#x27;</span>;</span><br><span class="line">      my_results(str1, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">      memset(v18, <span class="number">0</span>, 0xFFFFu);</span><br><span class="line">      v18[<span class="number">0</span>] = String[<span class="number">5</span>];</span><br><span class="line">      v18[<span class="number">2</span>] = String[<span class="number">7</span>];</span><br><span class="line">      v18[<span class="number">1</span>] = String[<span class="number">6</span>];</span><br><span class="line">      v4 = base_64(v18, strlen(v18));</span><br><span class="line">      memset(v18, <span class="number">0</span>, 0xFFFFu);</span><br><span class="line">      v18[<span class="number">1</span>] = String[<span class="number">3</span>];</span><br><span class="line">      v18[<span class="number">0</span>] = String[<span class="number">2</span>];</span><br><span class="line">      v18[<span class="number">2</span>] = String[<span class="number">4</span>];</span><br><span class="line">      v5 = base_64(v18, strlen(v18));</span><br><span class="line">      <span class="keyword">if</span> ( String[<span class="number">0</span>] == str1[<span class="number">0</span>] + <span class="number">34</span></span><br><span class="line">        &amp;&amp; String[<span class="number">1</span>] == str4</span><br><span class="line">        &amp;&amp; <span class="number">4</span> * String[<span class="number">2</span>] - <span class="number">141</span> == <span class="number">3</span> * str2</span><br><span class="line">        &amp;&amp; String[<span class="number">3</span>] / <span class="number">4</span> == <span class="number">2</span> * (str7 / <span class="number">9</span>)</span><br><span class="line">        &amp;&amp; !strcmp(v4, <span class="string">&quot;ak1w&quot;</span>)</span><br><span class="line">        &amp;&amp; !strcmp(v5, <span class="string">&quot;V1Ax&quot;</span>) )</span><br><span class="line">      &#123;</span><br><span class="line">        MessageBoxA(hDlg, <span class="string">&quot;U g3t 1T!&quot;</span>, <span class="string">&quot;@_@&quot;</span>, <span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>查看定义的字符的汇编代码</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123110108245.png" class="" title="image-20220123110108245">

<p>可以发现其实就是一连串的连续空间，就是一个字符数组</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123110839806.png" class="" title="image-20220123110839806">

<p>然后进入一个函数，看参数，第二个是0，第三个是10,既然看不懂，就直接把它改一改，放到vscode里面运行一下，因为我们知道它的参数了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># include &lt;stdio.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> my_results (char arr[], <span class="built_in">int</span> a, <span class="built_in">int</span> b)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> result; // eax</span><br><span class="line">  <span class="built_in">int</span> i; // esi</span><br><span class="line">  <span class="built_in">int</span> v5; // ecx</span><br><span class="line">  <span class="built_in">int</span> v6; // edx</span><br><span class="line"></span><br><span class="line">  result = b;</span><br><span class="line">  <span class="keyword">for</span> ( i = a; i &lt;= b; a = i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = i;</span><br><span class="line">    v6 = arr[i];</span><br><span class="line">    <span class="keyword">if</span> ( a &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">    &#123;</span><br><span class="line">      do</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt; arr[result] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          ++i;</span><br><span class="line">          arr[v5] = arr[result];</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">while</span> ( arr[i] &lt;= v6 )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( ++i &gt;= result )</span><br><span class="line">              goto LABEL_13;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v5 = i;</span><br><span class="line">          arr[result] = arr[i];</span><br><span class="line">        &#125;</span><br><span class="line">        --result;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( i &lt; result );</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">    arr[result] = v6;</span><br><span class="line">    my_results(arr, a, i - <span class="number">1</span>);</span><br><span class="line">    result = b;</span><br><span class="line">    ++i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">int</span> main()&#123;</span><br><span class="line">    char arr[<span class="number">20</span>] = &#123;<span class="number">90</span>,<span class="number">74</span>,<span class="number">83</span>,<span class="number">69</span>,<span class="number">67</span>,<span class="number">97</span>,<span class="number">78</span>,<span class="number">72</span>,<span class="number">51</span>,<span class="number">110</span>,<span class="number">103</span>&#125;;</span><br><span class="line">    puts(arr);</span><br><span class="line">    my_results(arr, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">    puts(arr);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不怎么接触c语言，昨天才知道，*（a+i）其实相当于数组a[i],a是基准地址，i是偏移量，后面我就知道了，这个函数的形参的第一个其实就是字符数组，之前定义的。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123111218527.png" class="" title="image-20220123111218527">

<p>运行完成后，其实就是对定义的字符进行了排序，有ASCII从小到大排序</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123110250975.png" class="" title="image-20220123110250975">

<p>再看这边，String就是我们输入的数字</p>
<p>用v18这个数组来存储，然后把v18放置在函数中，第二个参数是长度</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">v2 = a2 / <span class="number">3</span>;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 % <span class="number">3</span> &gt; <span class="number">0</span> )</span><br><span class="line">    ++v2;</span><br><span class="line">  v4 = <span class="number">4</span> * v2 + <span class="number">1</span>;</span><br><span class="line">  v5 = malloc(v4);</span><br><span class="line">  v6 = v5;</span><br><span class="line">  v15 = v5;</span><br><span class="line">  <span class="keyword">if</span> ( !v5 )</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  memset(v5, <span class="number">0</span>, v4);</span><br><span class="line">  v7 = a2;</span><br><span class="line">  v8 = v6;</span><br><span class="line">  v16 = v6;</span><br><span class="line">  <span class="keyword">if</span> ( a2 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = <span class="number">0</span>;</span><br><span class="line">      v10 = <span class="number">0</span>;</span><br><span class="line">      v18 = <span class="number">0</span>;</span><br><span class="line">      do</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v3 &gt;= v7 )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        ++v10;</span><br><span class="line">        v9 = *(v3 + a1) | (v9 &lt;&lt; <span class="number">8</span>);</span><br><span class="line">        ++v3;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v10 &lt; <span class="number">3</span> );</span><br><span class="line">      v11 = v9 &lt;&lt; (<span class="number">8</span> * (<span class="number">3</span> - v10));</span><br><span class="line">      v12 = <span class="number">0</span>;</span><br><span class="line">      v17 = v3;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">18</span>; i &gt; -<span class="number">6</span>; i -= <span class="number">6</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v10 &gt;= v12 )</span><br><span class="line">        &#123;</span><br><span class="line">          *(&amp;v18 + v12) = (v11 &gt;&gt; i) &amp; <span class="number">0x3F</span>;</span><br><span class="line">          v8 = v16;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          *(&amp;v18 + v12) = <span class="number">64</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        *v8++ = byte_407830[*(&amp;v18 + v12++)];</span><br><span class="line">        v16 = v8;</span><br><span class="line">      &#125;</span><br><span class="line">      v3 = v17;</span><br><span class="line">      <span class="keyword">if</span> ( v17 &gt;= a2 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v7 = a2;</span><br><span class="line">    &#125;</span><br><span class="line">    v6 = v15;</span><br><span class="line">  &#125;</span><br><span class="line">  result = v6;</span><br><span class="line">  *v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用z1r0的话就是盲猜是base64解码</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123110436886.png" class="" title="image-20220123110436886">

<p>这边会有移动，是base64的最明显的特征，把这个函数取名为base_64，后面还有一个base64的编码</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123110744566.png" class="" title="image-20220123110744566">

<p>这边就很简单了，注意，str1[0]的值是排序完成之后的值</p>
<p>ZJSECaNH3ng</p>
<p>3CEHJNSZagn</p>
<p>str1[0] &#x3D; 3, string[0] &#x3D; U                    </p>
<p>str4 &#x3D; J, string[1] &#x3D; J</p>
<p>string [3] &#x3D; P</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&#x27;Z&#x27;</span></span><br><span class="line">b = <span class="string">&#x27;Z&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(a)+<span class="number">34</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">ord</span>(b)/<span class="number">9</span>*<span class="number">8</span>)))</span><br></pre></td></tr></table></figure>

<p>最后结合起来string，即flag{UJWP1jMp}</p>
<h1 id="BJDCTF2020-JustRE-（水题）"><a href="#BJDCTF2020-JustRE-（水题）" class="headerlink" title="[BJDCTF2020]JustRE （水题）"></a>[BJDCTF2020]JustRE （水题）</h1><img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123120158498.png" class="" title="image-20220123120158498">

<p>既然程序看不懂，就找找字符列表中，有没有能看懂的，发现最后有个可疑字符</p>
<p>咱们点进去</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123120616818.png" class="" title="image-20220123120616818">

<p>内存中的数字直接按住tab是不能显示伪代码的,得点击函数才行</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123120457079.png" class="" title="image-20220123120457079">

<p>然后就是读一下程序</p>
<p>我认为上面的19999是鼠标点击的次数，点击这么多次后，然后就会弹出flag</p>
<p>sprintf函数，共有三个参数，第二个是格式，第一个是需要赋值的字符串，后面两个是被格式化的变量，所以flag{1999902069a45792d233ac}</p>
<h1 id="简单注册器-apk逆向"><a href="#简单注册器-apk逆向" class="headerlink" title="简单注册器(apk逆向)"></a>简单注册器(apk逆向)</h1><p>写在后面的话:</p>
<p>apk反汇编推荐用jadx-gui或GDAE</p>
<p>首先用apkide打开apk文件</p>
<ol>
<li><p>打开apkIDE,然后把apk文件拖到右边（不是直接将apk拖入apkIDE）</p>
</li>
<li><p>等它自动转换后，找到输出目录</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123160704146.png" class="" title="image-20220123160704146"></li>
</ol>
<p>直接复制到地址栏跳转，找到MainActivity.class文件</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123160740215.png" class="" title="image-20220123160740215">

<ol>
<li>最后将这个文件用jd-gui打开</li>
</ol>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123160927516.png" class="" title="image-20220123160927516">

<p>so easy</p>
<p>然后就是阅读程序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">package com.example.flag;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">null</span> implements View.OnClickListener &#123;</span><br><span class="line">  public void onClick(View paramView) &#123;</span><br><span class="line">    <span class="built_in">int</span> i = <span class="number">1</span>;</span><br><span class="line">    String <span class="built_in">str</span> = editview.getText().toString();</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">str</span>.length() != <span class="number">32</span> || <span class="built_in">str</span>.charAt(<span class="number">31</span>) != <span class="string">&#x27;a&#x27;</span> || <span class="built_in">str</span>.charAt(<span class="number">1</span>) != <span class="string">&#x27;b&#x27;</span> || <span class="built_in">str</span>.charAt(<span class="number">0</span>) + <span class="built_in">str</span>.charAt(<span class="number">2</span>) - <span class="number">48</span> != <span class="number">56</span>)</span><br><span class="line">      i = <span class="number">0</span>; </span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">1</span>) &#123;</span><br><span class="line">      char[] arrayOfChar = <span class="string">&quot;dd2940c04462b4dd7c450528835cca15&quot;</span>.toCharArray();</span><br><span class="line">      arrayOfChar[<span class="number">2</span>] = (char)(arrayOfChar[<span class="number">2</span>] + arrayOfChar[<span class="number">3</span>] - <span class="number">50</span>);</span><br><span class="line">      arrayOfChar[<span class="number">4</span>] = (char)(arrayOfChar[<span class="number">2</span>] + arrayOfChar[<span class="number">5</span>] - <span class="number">48</span>);</span><br><span class="line">      arrayOfChar[<span class="number">30</span>] = (char)(arrayOfChar[<span class="number">31</span>] + arrayOfChar[<span class="number">9</span>] - <span class="number">48</span>);</span><br><span class="line">      arrayOfChar[<span class="number">14</span>] = (char)(arrayOfChar[<span class="number">27</span>] + arrayOfChar[<span class="number">28</span>] - <span class="number">97</span>);</span><br><span class="line">      <span class="keyword">for</span> (i = <span class="number">0</span>;; i++) &#123;</span><br><span class="line">        String str1;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= <span class="number">16</span>) &#123;</span><br><span class="line">          str1 = String.valueOf(arrayOfChar);</span><br><span class="line">          textview.setText(<span class="string">&quot;flag&#123;&quot;</span> + str1 + <span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125; </span><br><span class="line">        String str2 = str1[<span class="number">31</span> - i];</span><br><span class="line">        str1[<span class="number">31</span> - i] = str1[i];</span><br><span class="line">        str1[i] = str2;</span><br><span class="line">      &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    textview.setText(<span class="string">&quot;);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p>字符数组转换一下，然后再反向一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;dd2940c04462b4dd7c450528835cca15&quot;</span></span><br><span class="line"></span><br><span class="line">lists = [i <span class="keyword">for</span> i <span class="keyword">in</span>  string]</span><br><span class="line"></span><br><span class="line">lists[<span class="number">2</span>] = <span class="built_in">chr</span>((<span class="built_in">ord</span>(lists[<span class="number">2</span>]) + <span class="built_in">ord</span>(lists[<span class="number">3</span>]) - <span class="number">50</span>))</span><br><span class="line">lists[<span class="number">4</span>] = <span class="built_in">chr</span>((<span class="built_in">ord</span>(lists[<span class="number">2</span>]) + <span class="built_in">ord</span>(lists[<span class="number">5</span>]) - <span class="number">48</span>))</span><br><span class="line">lists[<span class="number">30</span>] = <span class="built_in">chr</span>((<span class="built_in">ord</span>(lists[<span class="number">31</span>]) + <span class="built_in">ord</span>(lists[<span class="number">9</span>]) - <span class="number">48</span>))</span><br><span class="line">lists[<span class="number">14</span>] = <span class="built_in">chr</span>((<span class="built_in">ord</span>(lists[<span class="number">27</span>]) + <span class="built_in">ord</span>(lists[<span class="number">28</span>]) - <span class="number">97</span>))</span><br><span class="line"></span><br><span class="line">string = <span class="string">&#x27;&#x27;</span>.join(lists)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(string[::-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<p>flag{“59acc538825054c7de4b26440c0999dd”}</p>
<h1 id="findit-apk逆向"><a href="#findit-apk逆向" class="headerlink" title="findit(apk逆向)"></a>findit(apk逆向)</h1><p>写在后面的话:</p>
<p>apk反汇编推荐用jadx-gui或GDAE</p>
<p>–正文–</p>
<p>好家伙，做一个安卓题目就新换一个工具，这次用的是安卓杀手，</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123180649811.png" class="" title="image-20220123180649811">

<p>z1r0的博客里说，{ 的ascii码是123，十六进制是0x7b,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">texts = [<span class="number">0x70</span>,<span class="number">0x76</span>,<span class="number">0x6b</span>,<span class="number">0x71</span>,<span class="number">0x7b</span>,<span class="number">0x6d</span>,<span class="number">0x31</span>,<span class="number">0x36</span>,<span class="number">0x34</span>,<span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x35</span>,\</span><br><span class="line"><span class="number">0x32</span>,<span class="number">0x36</span>,<span class="number">0x32</span>,<span class="number">0x30</span>,<span class="number">0x33</span>,<span class="number">0x33</span>,<span class="number">0x6c</span>,<span class="number">0x34</span>,<span class="number">0x6d</span>,<span class="number">0x34</span>,<span class="number">0x39</span>,<span class="number">0x6c</span>,<span class="number">0x6e</span>,<span class="number">0x70</span>,<span class="number">0x37</span>,\</span><br><span class="line"><span class="number">0x70</span>,<span class="number">0x39</span>,<span class="number">0x6d</span>,<span class="number">0x6e</span>,<span class="number">0x6b</span>,<span class="number">0x32</span>,<span class="number">0x38</span>,<span class="number">0x6b</span>,<span class="number">0x37</span>,<span class="number">0x35</span>,<span class="number">0x7d</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> texts:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>pvkq{m164675262033l4m49lnp7p9mnk28k75}</p>
<p>说实话结果很像了，</p>
<p>然后就是凯撒加密，偏移量为10，解密之后就是：</p>
<p>flag{c164675262033b4c49bdf7f9cda28a75}</p>
<h1 id="pyre-的逆推"><a href="#pyre-的逆推" class="headerlink" title="pyre(%的逆推)"></a>pyre(%的逆推)</h1><p>在线反汇编pyr</p>
<p>然后分析一下代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;Welcome to Re World!&#x27;</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;Your input1 is your flag~&#x27;</span></span><br><span class="line">l = <span class="built_in">len</span>(input1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    num = ((input1[i] + i) % <span class="number">128</span> + <span class="number">128</span>) % <span class="number">128</span></span><br><span class="line">    code += num</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l - <span class="number">1</span>):</span><br><span class="line">    code[i] = code[i] ^ code[i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> code</span><br><span class="line">code = [</span><br><span class="line">    <span class="string">&#x27;\x1f&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x12&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x1d&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;(&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x06&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x14&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;,&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x1b&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;?&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;o&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;:&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;%&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x13&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>最后输出的code已经给出了</p>
<p>首先是异或一下，从最后一个元素开始</p>
<p>for i in range(l-2,-1,-1),倒数第二个元素和最后一个元素异或，以此类推</p>
<p>然后就是关于%~~公式的逆向了</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220123213626075.png" class="" title="image-20220123213626075">

<p>关于z1r0的分析，就是以上这样，反过来就是(input[i] - i)%128</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">code = [</span><br><span class="line">    <span class="string">&#x27;\x1f&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x12&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x1d&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;(&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x06&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x14&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;,&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x1b&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;?&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;o&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;:&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;%&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x13&#x27;</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">l = <span class="built_in">len</span>(code)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">2</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    code[i] = code[i] ^ code[i-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(code)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    flag = <span class="built_in">chr</span>((<span class="built_in">ord</span>(code[i]) - i) % <span class="number">128</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(code)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="ACTF新生赛2020-easyre-index的推导"><a href="#ACTF新生赛2020-easyre-index的推导" class="headerlink" title="[ACTF新生赛2020]easyre(index的推导)"></a>[ACTF新生赛2020]easyre(index的推导)</h1><p>参考链接：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mayfly-nymph/p/12664201.html">https://www.cnblogs.com/Mayfly-nymph/p/12664201.html</a></p>
<p>先是查壳，然后万能脱壳工具脱一下，然后放到ADI中看看</p>
<p>好家伙，7.5版本和7.0版本是打开是不一样的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="built_in">int</span> __cdecl main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line"> <span class="number">2</span> &#123;</span><br><span class="line"> <span class="number">3</span>   char v4; // [esp+12h] [ebp-2Eh]</span><br><span class="line"> <span class="number">4</span>   char v5; // [esp+13h] [ebp-2Dh]</span><br><span class="line"> <span class="number">5</span>   char v6; // [esp+14h] [ebp-2Ch]</span><br><span class="line"> <span class="number">6</span>   char v7; // [esp+15h] [ebp-2Bh]</span><br><span class="line"> <span class="number">7</span>   char v8; // [esp+16h] [ebp-2Ah]</span><br><span class="line"> <span class="number">8</span>   char v9; // [esp+17h] [ebp-29h]</span><br><span class="line"> <span class="number">9</span>   char v10; // [esp+18h] [ebp-28h]</span><br><span class="line"><span class="number">10</span>   char v11; // [esp+19h] [ebp-27h]</span><br><span class="line"><span class="number">11</span>   char v12; // [esp+1Ah] [ebp-26h]</span><br><span class="line"><span class="number">12</span>   char v13; // [esp+1Bh] [ebp-25h]</span><br><span class="line"><span class="number">13</span>   char v14; // [esp+1Ch] [ebp-24h]</span><br><span class="line"><span class="number">14</span>   char v15; // [esp+1Dh] [ebp-23h]</span><br><span class="line"><span class="number">15</span>   <span class="built_in">int</span> v16; // [esp+1Eh] [ebp-22h]</span><br><span class="line"><span class="number">16</span>   <span class="built_in">int</span> v17; // [esp+22h] [ebp-1Eh]</span><br><span class="line"><span class="number">17</span>   <span class="built_in">int</span> v18; // [esp+26h] [ebp-1Ah]</span><br><span class="line"><span class="number">18</span>   __int16 v19; // [esp+2Ah] [ebp-16h]</span><br><span class="line"><span class="number">19</span>   char v20; // [esp+2Ch] [ebp-14h]</span><br><span class="line"><span class="number">20</span>   char v21; // [esp+2Dh] [ebp-13h]</span><br><span class="line"><span class="number">21</span>   char v22; // [esp+2Eh] [ebp-12h]</span><br><span class="line"><span class="number">22</span>   <span class="built_in">int</span> v23; // [esp+2Fh] [ebp-11h]</span><br><span class="line"><span class="number">23</span>   <span class="built_in">int</span> v24; // [esp+33h] [ebp-Dh]</span><br><span class="line"><span class="number">24</span>   <span class="built_in">int</span> v25; // [esp+37h] [ebp-9h]</span><br><span class="line"><span class="number">25</span>   char v26; // [esp+3Bh] [ebp-5h]</span><br><span class="line"><span class="number">26</span>   <span class="built_in">int</span> i; // [esp+3Ch] [ebp-4h]</span><br><span class="line"><span class="number">27</span> </span><br><span class="line"><span class="number">28</span>   __main();</span><br><span class="line"><span class="number">29</span>   v4 = <span class="number">42</span>;</span><br><span class="line"><span class="number">30</span>   v5 = <span class="number">70</span>;</span><br><span class="line"><span class="number">31</span>   v6 = <span class="number">39</span>;</span><br><span class="line"><span class="number">32</span>   v7 = <span class="number">34</span>;</span><br><span class="line"><span class="number">33</span>   v8 = <span class="number">78</span>;</span><br><span class="line"><span class="number">34</span>   v9 = <span class="number">44</span>;</span><br><span class="line"><span class="number">35</span>   v10 = <span class="number">34</span>;</span><br><span class="line"><span class="number">36</span>   v11 = <span class="number">40</span>;</span><br><span class="line"><span class="number">37</span>   v12 = <span class="number">73</span>;</span><br><span class="line"><span class="number">38</span>   v13 = <span class="number">63</span>;</span><br><span class="line"><span class="number">39</span>   v14 = <span class="number">43</span>;</span><br><span class="line"><span class="number">40</span>   v15 = <span class="number">64</span>;</span><br><span class="line"><span class="number">41</span>   printf(<span class="string">&quot;Please input:&quot;</span>);</span><br><span class="line"><span class="number">42</span>   scanf(<span class="string">&quot;%s&quot;</span>, &amp;v19);</span><br><span class="line"><span class="number">43</span>   <span class="keyword">if</span> ( (_BYTE)v19 != <span class="number">65</span> || HIBYTE(v19) != <span class="number">67</span> || v20 != <span class="number">84</span> || v21 != <span class="number">70</span> || v22 != <span class="number">123</span> || v26 != <span class="number">125</span> )</span><br><span class="line"><span class="number">44</span>     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">45</span>   v16 = v23;</span><br><span class="line"><span class="number">46</span>   v17 = v24;</span><br><span class="line"><span class="number">47</span>   v18 = v25;</span><br><span class="line"><span class="number">48</span>   <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">11</span>; ++i )</span><br><span class="line"><span class="number">49</span>   &#123;</span><br><span class="line"><span class="number">50</span>     <span class="keyword">if</span> ( *(&amp;v4 + i) != _data_ start__[*((char *)&amp;v16 + i) - <span class="number">1</span>] )</span><br><span class="line"><span class="number">51</span>       <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">52</span>   &#125;</span><br><span class="line"><span class="number">53</span>   printf(<span class="string">&quot;You are correct!&quot;</span>);</span><br><span class="line"><span class="number">54</span>   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">55</span> &#125;</span><br></pre></td></tr></table></figure>

<p>这多清晰。。。</p>
<p>感谢z1r0的指导！</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220124221823565.png" class="" title="image-20220124221823565">

<p>所以第50行相当于，v4[i] ！&#x3D; byte_402000[v16[i] - 1]</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220124222332023.png" class="" title="image-20220124222332023">

<p>以下是python脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&#x27;~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(\&#x27;&amp;%$# !&quot;&#x27;</span> <span class="comment">#&#x27;一定要加\</span></span><br><span class="line"></span><br><span class="line">encrypt = [<span class="number">42</span>,<span class="number">70</span>,<span class="number">39</span>,<span class="number">34</span>,<span class="number">78</span>,<span class="number">44</span>,<span class="number">34</span>,<span class="number">40</span>,<span class="number">73</span>,<span class="number">63</span>,<span class="number">43</span>,<span class="number">64</span>]</span><br><span class="line"></span><br><span class="line">x = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encrypt)):</span><br><span class="line"></span><br><span class="line">    m = key.find(<span class="built_in">chr</span>(encrypt[i]))+<span class="number">1</span></span><br><span class="line">    x.append(<span class="built_in">chr</span>(m))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">    <span class="built_in">print</span>(x[i],end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>仔细想了一下，用公式推一下就好理解了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">v4[i] == key [v16[i] - <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">key.find(v4[i]) == v16[i] - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">v16[i] == key.find(v4[i]) +<span class="number">1</span></span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220124224812767.png" class="" title="image-20220124224812767">

<p>v16这个数组就相当于是flag,我们需要做的就是逆着推一下。</p>
<p>flag{U9X_1S_W6@T?}</p>
<h1 id="rsa-非对称解密"><a href="#rsa-非对称解密" class="headerlink" title="rsa (非对称解密)"></a>rsa (非对称解密)</h1><p>非常6+1的重要！！</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ao52426055/article/details/110221943">https://blog.csdn.net/ao52426055/article/details/110221943</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/kevin66654/article/details/54087647">https://blog.csdn.net/kevin66654/article/details/54087647</a></p>
<p>首先直接把两个文件的后缀改成.txt的</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125221639994.png" class="" title="image-20220125221639994">

<p>可以看到pub是个公钥解析，我们放到随便一个RSA公钥分解的网站中分解，解除模数和指数</p>
<table>
<thead>
<tr>
<th>key长度：</th>
<th>256</th>
</tr>
</thead>
<tbody><tr>
<td>模数N：</td>
<td>8693448229604811919066606200349480058890565601720302561721665405 8378322103517</td>
</tr>
<tr>
<td>指数e：</td>
<td>65537 (0x10001)</td>
</tr>
</tbody></table>
<p>然后分解N</p>
<p>[<a target="_blank" rel="noopener" href="http://factordb.com/index.php?query=8693448229604811919066606200349480058890565601720302561721665405%208378322103517%5D">http://factordb.com/index.php?query=8693448229604811919066606200349480058890565601720302561721665405%208378322103517]</a>(<a target="_blank" rel="noopener" href="http://factordb.com/index.php?query=8693448229604811919066606200349480058890565601720302561721665405">http://factordb.com/index.php?query=8693448229604811919066606200349480058890565601720302561721665405</a> 8378322103517)</p>
<p>P：285960468890451637935629440372639283459</p>
<p>q:   304008741604601924494328155975272418463</p>
<p>得知p、q、r、e之后，直接用rsatool2解出d</p>
<p>81176168860169991027846870170527607562179635470395365333547868786951080991441</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125224708543.png" class="" title="image-20220125224708543">

<p>算出来之后</p>
<p>通过这五个值，e、n、p、q、d来计算最后的值</p>
<p>记得要安装一下rsa库</p>
<p>dos直接键入： pip3 install rsa</p>
<p>上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">n= <span class="number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span></span><br><span class="line">p= <span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">q= <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line">d= <span class="number">81176168860169991027846870170527607562179635470395365333547868786951080991441</span></span><br><span class="line"></span><br><span class="line">key = rsa.PrivateKey(n,e,d,q,p)         <span class="comment">#在pkcs标准中,pkcs#1规定,私钥包含(n,e,d,p,q)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;E:\\A_Oasis\\逆向工程文件\\Reverse题目\\rsa\\output\\flagenc.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:  <span class="comment">#以二进制读模式，读取密文</span></span><br><span class="line">    f = f.read()</span><br><span class="line">    <span class="built_in">print</span>(rsa.decrypt(f,key))           <span class="comment"># f:公钥加密结果  key:私钥</span></span><br></pre></td></tr></table></figure>

<p>b’flag{decrypt_256}\n’</p>
<h1 id="ACTF新生赛2020-rome-ASCII暴力破解"><a href="#ACTF新生赛2020-rome-ASCII暴力破解" class="headerlink" title="[ACTF新生赛2020]rome(ASCII暴力破解)"></a>[ACTF新生赛2020]rome(ASCII暴力破解)</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> func()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> result; // eax</span><br><span class="line">  <span class="built_in">int</span> v1[<span class="number">4</span>]; // [esp+14h] [ebp-44h]</span><br><span class="line">  unsigned __int8 v2; // [esp+24h] [ebp-34h] BYREF</span><br><span class="line">  unsigned __int8 v3; // [esp+25h] [ebp-33h]</span><br><span class="line">  unsigned __int8 v4; // [esp+26h] [ebp-32h]</span><br><span class="line">  unsigned __int8 v5; // [esp+27h] [ebp-31h]</span><br><span class="line">  unsigned __int8 v6; // [esp+28h] [ebp-30h]</span><br><span class="line">  <span class="built_in">int</span> v7; // [esp+29h] [ebp-2Fh]</span><br><span class="line">  <span class="built_in">int</span> v8; // [esp+2Dh] [ebp-2Bh]</span><br><span class="line">  <span class="built_in">int</span> v9; // [esp+31h] [ebp-27h]</span><br><span class="line">  <span class="built_in">int</span> v10; // [esp+35h] [ebp-23h]</span><br><span class="line">  unsigned __int8 v11; // [esp+39h] [ebp-1Fh]</span><br><span class="line">  char v12[<span class="number">29</span>]; // [esp+3Bh] [ebp-1Dh] BYREF</span><br><span class="line"></span><br><span class="line">  strcpy(v12, <span class="string">&quot;Qsw3sj_lz4_Ujw@l&quot;</span>);</span><br><span class="line">  printf(<span class="string">&quot;Please input:&quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%s&quot;</span>, &amp;v2);</span><br><span class="line">  result = v2;</span><br><span class="line">  <span class="keyword">if</span> ( v2 == <span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = v3;</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="string">&#x27;C&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      result = v4;</span><br><span class="line">      <span class="keyword">if</span> ( v4 == <span class="string">&#x27;T&#x27;</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        result = v5;</span><br><span class="line">        <span class="keyword">if</span> ( v5 == <span class="string">&#x27;F&#x27;</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          result = v6;</span><br><span class="line">          <span class="keyword">if</span> ( v6 == <span class="string">&#x27;&#123;&#x27;</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            result = v11;</span><br><span class="line">            <span class="keyword">if</span> ( v11 == <span class="string">&#x27;&#125;&#x27;</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              v1[<span class="number">0</span>] = v7;</span><br><span class="line">              v1[<span class="number">1</span>] = v8;</span><br><span class="line">              v1[<span class="number">2</span>] = v9;</span><br><span class="line">              v1[<span class="number">3</span>] = v10;</span><br><span class="line">              *&amp;v12[<span class="number">17</span>] = <span class="number">0</span>;</span><br><span class="line">              <span class="keyword">while</span> ( *&amp;v12[<span class="number">17</span>] &lt;= <span class="number">15</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">if</span> ( *(v1 + *&amp;v12[<span class="number">17</span>]) &gt; <span class="number">64</span> &amp;&amp; *(v1 + *&amp;v12[<span class="number">17</span>]) &lt;= <span class="number">90</span> )</span><br><span class="line">                  *(v1 + *&amp;v12[<span class="number">17</span>]) = (*(v1 + *&amp;v12[<span class="number">17</span>]) - <span class="number">51</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">                <span class="keyword">if</span> ( *(v1 + *&amp;v12[<span class="number">17</span>]) &gt; <span class="number">96</span> &amp;&amp; *(v1 + *&amp;v12[<span class="number">17</span>]) &lt;= <span class="number">122</span> )</span><br><span class="line">                  *(v1 + *&amp;v12[<span class="number">17</span>]) = (*(v1 + *&amp;v12[<span class="number">17</span>]) - <span class="number">79</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">                ++*&amp;v12[<span class="number">17</span>];</span><br><span class="line">              &#125;</span><br><span class="line">              *&amp;v12[<span class="number">17</span>] = <span class="number">0</span>;</span><br><span class="line">              <span class="keyword">while</span> ( *&amp;v12[<span class="number">17</span>] &lt;= <span class="number">15</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                result = v12[*&amp;v12[<span class="number">17</span>]];</span><br><span class="line">                <span class="keyword">if</span> ( *(v1 + *&amp;v12[<span class="number">17</span>]) != result )</span><br><span class="line">                  <span class="keyword">return</span> result;</span><br><span class="line">                ++*&amp;v12[<span class="number">17</span>];</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">return</span> printf(<span class="string">&quot;You are correct!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在检查没有壳之后，直接IDA打开，然后进入这个函数，其实就是输入一段字符之后，进行一系列的转换，根据z1r0的知乎得知，可以运用暴力破解（太棒了）！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&#x27;Qsw3sj_lz4_Ujw@l&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(string)):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line"></span><br><span class="line">        k = j</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> j &gt; <span class="number">64</span> <span class="keyword">and</span> j &lt;= <span class="number">90</span>:</span><br><span class="line">            j = (j - <span class="number">51</span>) % <span class="number">26</span> + <span class="number">65</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">if</span> j &gt; <span class="number">96</span> <span class="keyword">and</span> j &lt;= <span class="number">122</span>:</span><br><span class="line">            j = (j - <span class="number">79</span>) % <span class="number">26</span> + <span class="number">97</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> j == <span class="built_in">ord</span>(string[i]):</span><br><span class="line"></span><br><span class="line">            flag += <span class="built_in">chr</span>(k)</span><br><span class="line">            </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>字符已经给出</p>
<p>循环这个这个字符串，用变量k来保存j的值，j来循环ASCII码，如果j经过转换之后，与对应的string相等，那就是flag了。</p>
<h1 id="CrackRTF1-散列算法-Win32API-文件头"><a href="#CrackRTF1-散列算法-Win32API-文件头" class="headerlink" title="CrackRTF1 (散列算法+Win32API+文件头)"></a>CrackRTF1 (散列算法+Win32API+文件头)</h1><p>这题对于我这种re新手，确实属于难度的天花板了……</p>
<p>首先是查壳，发现没有壳。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125150721603.png" class="" title="image-20220125150721603">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main_0(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  DWORD v3; // eax</span><br><span class="line">  DWORD v4; // eax</span><br><span class="line">  char Str[<span class="number">260</span>]; // [esp+4Ch] [ebp-<span class="number">3</span>10h] BYREF</span><br><span class="line">  <span class="built_in">int</span> v7; // [esp+150h] [ebp-20Ch]</span><br><span class="line">  char String1[<span class="number">260</span>]; // [esp+154h] [ebp-208h] BYREF</span><br><span class="line">  char Destination[<span class="number">260</span>]; // [esp+258h] [ebp-104h] BYREF</span><br><span class="line"></span><br><span class="line">  memset(Destination, <span class="number">0</span>, sizeof(Destination));</span><br><span class="line">  memset(String1, <span class="number">0</span>, sizeof(String1));</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  printf(<span class="string">&quot;pls input the first passwd(1): &quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%s&quot;</span>, Destination);</span><br><span class="line">  <span class="keyword">if</span> ( strlen(Destination) != <span class="number">6</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;Must be 6 characters!\n&quot;</span>);</span><br><span class="line">    ExitProcess(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v7 = atoi(Destination);</span><br><span class="line">  <span class="keyword">if</span> ( v7 &lt; <span class="number">100000</span> )</span><br><span class="line">    ExitProcess(<span class="number">0</span>);</span><br><span class="line">  strcat(Destination, <span class="string">&quot;@DBApp&quot;</span>);</span><br><span class="line">  v3 = strlen(Destination);</span><br><span class="line">  sub_40100A((BYTE *)Destination, v3, String1);</span><br><span class="line">  <span class="keyword">if</span> ( !_strcmpi(String1, <span class="string">&quot;6E32D0943418C2C33385BC35A1470250DD8923A9&quot;</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;continue...\n\n&quot;</span>);</span><br><span class="line">    printf(<span class="string">&quot;pls input the first passwd(2): &quot;</span>);</span><br><span class="line">    memset(Str, <span class="number">0</span>, sizeof(Str));</span><br><span class="line">    scanf(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">    <span class="keyword">if</span> ( strlen(Str) != <span class="number">6</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      printf(<span class="string">&quot;Must be 6 characters!\n&quot;</span>);</span><br><span class="line">      ExitProcess(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    strcat(Str, Destination);</span><br><span class="line">    memset(String1, <span class="number">0</span>, sizeof(String1));</span><br><span class="line">    v4 = strlen(Str);</span><br><span class="line">    sub_401019((BYTE *)Str, v4, String1);</span><br><span class="line">    <span class="keyword">if</span> ( !_strcmpi(<span class="string">&quot;27019e688a4e62a649fd99cadaafdb4e&quot;</span>, String1) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(unsigned __int8)sub_40100F(Str) )</span><br><span class="line">      &#123;</span><br><span class="line">        printf(<span class="string">&quot;Error!!\n&quot;</span>);</span><br><span class="line">        ExitProcess(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      printf(<span class="string">&quot;bye ~~\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>又触碰盲区了，再参考一下大佬z1r0的博客：</p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/people/xu-xu-xuxu-94">https://www.zhihu.com/people/xu-xu-xuxu-94</a></p>
<p>这边先是输入第一个password,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scanf(<span class="string">&quot;%s&quot;</span>, Destination);</span><br></pre></td></tr></table></figure>

<p>然后就要当心了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v7 = atoi(Destination);</span><br></pre></td></tr></table></figure>

<p>根据z1r0所说，atoi在pawnh中很常见，用于将字符串转换为整形</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v7 &lt; <span class="number">100000</span> )</span><br></pre></td></tr></table></figure>

<p>所以我们确定了第一个password的位数是6位，并且不小于100000</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strcat(Destination, <span class="string">&quot;@DBApp&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>然后是与“@DBApp”连接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strcat(Destination, <span class="string">&quot;@DBApp&quot;</span>);</span><br></pre></td></tr></table></figure>



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125162641284.png" class="" title="image-20220125162641284">

<p>进入了一个奇奇怪怪的函数，不要害怕</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( CryptCreateHash(phProv, 0x8004u, <span class="number">0</span>, <span class="number">0</span>, &amp;phHash) )</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125162841435.png" class="" title="image-20220125162841435">



<p>直接进大本营干这个函数，第二个参数是属于加密的类型，跟进去看</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125162949156.png" class="" title="image-20220125162949156">

<p>发现，08004是sha1哈希算法，就把main函数的里面的改成sha1(改名很重要)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sha1(Destination, v3, String1);</span><br></pre></td></tr></table></figure>

<p>v3是长度，String1就是加密之后的数值了，然后与”6E32D0943418C2C33385BC35A1470250DD8923A9”作比较，python里面需要小写才行</p>
<p>然后就是编写算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment">#大写转小写</span></span><br><span class="line">string = <span class="string">&quot;6E32D0943418C2C33385BC35A1470250DD8923A9&quot;</span>.lower()</span><br><span class="line"></span><br><span class="line">a = <span class="string">&#x27;@DBApp&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>,<span class="number">999999</span>):</span><br><span class="line"></span><br><span class="line">    data = <span class="built_in">str</span>(i) + a</span><br><span class="line"></span><br><span class="line">    sha1 = hashlib.sha1(data.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"></span><br><span class="line">    flags = sha1.hexdigest()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> flags == string:</span><br><span class="line">        <span class="built_in">print</span>(data)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;done&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>解出来之后就是123321@DBApp</p>
<p>在往下看，输入第二个密码，既然知道是第二个密码了，就提前把str改成second_password</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">printf(<span class="string">&quot;pls input the first passwd(2): &quot;</span>);</span><br><span class="line">memset(second_password, <span class="number">0</span>, sizeof(Str));</span><br><span class="line">scanf(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line"><span class="keyword">if</span> ( strlen(Str) != <span class="number">6</span> )</span><br></pre></td></tr></table></figure>

<p>长度也是6位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strcat(second_password, Destination);</span><br></pre></td></tr></table></figure>

<p>把第一个密码的值加到第二个密码后面</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_401019(second_password, v4, String1);</span><br></pre></td></tr></table></figure>

<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220126134055329.png" class="" title="image-20220126134055329">

<p>又进入了一个奇奇怪怪的函数，和上面一个差不多，加密之后与”27019e688a4e62a649fd99cadaafdb4e”进行比较</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( CryptCreateHash(phProv, 0x8003u, <span class="number">0</span>, <span class="number">0</span>, &amp;phHash) )</span><br></pre></td></tr></table></figure>

<p>这边的编码参数是0x8003，这个是MD5的哈希算法，看似可以直接暴力，但是，题目中并没有像第一个password一样，告诉我们类型以及范围，如果要暴力，就需要把ASCII全部循环一遍，所以还是想想别的办法。</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125163915344.png" class="" title="image-20220125163915344">



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125181222437.png" class="" title="image-20220125181222437">

<p>发现这边还有函数，参数还是第二个密码</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125181352039.png" class="" title="image-20220125181352039">

<p>进去直接好家伙，一堆win32的API，在官网上面找找到底是什么意思。</p>
<p>官方API链接：<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/api/">https://docs.microsoft.com/en-us/windows/win32/api/</a></p>
<p>先是FindResourceA 函数，粗略的看一遍之后，说的第一个参数是啥啥句柄，第二个参数是资源名称，第三个是资源类型，返回的是指定信息块的句柄</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125181458404.png" class="" title="image-20220125181458404">

<p>再看SizeofResource,返回值为资源中的字节数</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125200409894.png" class="" title="image-20220125200409894">



<p>同样的，LoadResource，没见过，最好都看看</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220126133723911.png" class="" title="image-20220126133723911">

<p>返回值为资源关联的数据的句柄。</p>
<p>再看LockResource</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125200656556.png" class="" title="image-20220125200656556">

<p>返回值为指向资源第一个字节的指针</p>
<p>createFileA,用来创建，或者打开文件</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125200946033.png" class="" title="image-20220125200946033">



<p>最重要的来了，关于WriteFileA的</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125201122825.png" class="" title="image-20220125201122825">



<p>还有它的形参：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220126133830673.png" class="" title="image-20220126133830673">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_401005(lpString, lpBuffer, nNumberOfBytesToWrite);</span><br></pre></td></tr></table></figure>

<p>这个函数把我们的总password放入第一个形参，lpBuffer是一个指针，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">v5 = lstrlenA(lpString);</span><br><span class="line"> <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line"> &#123;</span><br><span class="line">   result = i;</span><br><span class="line">   <span class="keyword">if</span> ( i &gt;= a3 )</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">   *(i + a2) ^= lpString[i % v5];</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> result;</span><br></pre></td></tr></table></figure>

<p>现在就是这关键的地方了</p>
<p>a2也就是我们的lpBuffer,经过异或之后，成为我们需要生成文件，即rtf的头，才能传入下面WriteFile中，根据z1r0的博客所说，rtf的头一般为{\rtf1\ansi，</p>
<p>而AAA这个文件我们可以用Resource Hacker打开，只要查看开头6个就行了</p>
<p>然后就是匹配算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rtf = <span class="string">&#x27;&#123;\\rtf1&#x27;</span></span><br><span class="line"></span><br><span class="line">AAA = [<span class="number">0x05</span>,<span class="number">0x7D</span>,<span class="number">0x41</span>,<span class="number">0x15</span>,<span class="number">0x26</span>,<span class="number">0x01</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(rtf)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(rtf[i]) ^ AAA[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>结果为：~!3a@0</p>
<p>程序的意思是输入第二个密码之后，生成一个rtf文件,最后输出的rtf中，就是最终的答案</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220125215455097.png" class="" title="image-20220125215455097">

<p>如你所见，flag{N0_M0re_Free_Bugs}</p>
<h1 id="login-JS逆向-x2F-凯撒"><a href="#login-JS逆向-x2F-凯撒" class="headerlink" title="login (JS逆向&#x2F;凯撒)"></a>login (JS逆向&#x2F;凯撒)</h1><p>第一次做网页的逆向题目，有点激动，F12进入源代码查看</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220126172846920.png" class="" title="image-20220126172846920">



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220126172459610.png" class="" title="image-20220126172459610">

<p>哪里不会搜哪里，返回一个element对象？？</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220126172620240.png" class="" title="image-20220126172620240">



<p>好吧，只是键入最基本的按钮值而已</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220126172655030.png" class="" title="image-20220126172655030">



<p>主要是下面的rotFlag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script <span class="built_in">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">            document.getElementById(<span class="string">&quot;prompt&quot;</span>).onclick = function () &#123;</span><br><span class="line">                var flag = document.getElementById(<span class="string">&quot;flag&quot;</span>).value;</span><br><span class="line">                var rotFlag = flag.replace(/[a-zA-Z]/g, function(c)&#123;<span class="keyword">return</span> String.fromCharCode((c &lt;= <span class="string">&quot;Z&quot;</span> ? <span class="number">90</span> : <span class="number">122</span>) &gt;= (c = c.charCodeAt(<span class="number">0</span>) + <span class="number">13</span>) ? c : c - <span class="number">26</span>);&#125;);</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span> == rotFlag) &#123;</span><br><span class="line">                    alert(<span class="string">&quot;Correct flag!&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    alert(<span class="string">&quot;Incorrect flag, rot again&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &lt;/script&gt;</span><br></pre></td></tr></table></figure>



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220126174212912.png" class="" title="image-20220126174212912">



<p>charCodeAt(),返回第一个位置的Unicode编码，</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220126174444525.png" class="" title="image-20220126174444525">



<p>再看看replace()方法，如果找到第一个参数的字符串，就被第二个参数替换</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220126174826556.png" class="" title="image-20220126174826556">



<p>fromCharCode()相当于python里面的chr()</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220126175120324.png" class="" title="image-20220126175120324">



<p>参考链接：<a target="_blank" rel="noopener" href="https://www.zhihu.com/people/xu-xu-xuxu-94">https://www.zhihu.com/people/xu-xu-xuxu-94</a></p>
<p>后面不太懂了，根据z1r0的知乎中写到，flag.replace(&#x2F;[a-zA-Z]&#x2F;g，function(c){XXX})，是让flag中的a-z,A-Z字符，被后面的function(c)所替换。</p>
<p>后面的算法就是rot13算法了：</p>
<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220126181035628.png" class="" title="image-20220126181035628">



<img src="/2022/01/28/BUU-reverse/BUU-reverse/image-20220126181313709.png" class="" title="image-20220126181313709">



<p>flag{<a href="mailto:ClientSideLoginsAreEasy@flare-on.com">ClientSideLoginsAreEasy@flare-on.com</a>}</p>
<p>我还看了半天……</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/BUU-reverse%E7%BB%83%E4%B9%A0/">BUU-reverse练习</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/02/07/CTF/TheCyberGrabs_reverse/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">TheCyberGrabs</div></div></a></div><div class="next-post pull-right"><a href="/2022/01/22/test/readme/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">test for my first blog</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/ke1os.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">ke1os</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">27</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">14</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RCTF2019-DontEatMe"><span class="toc-number">1.</span> <span class="toc-text">[RCTF2019]DontEatMe</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-Bytecode-py%E5%AD%97%E8%8A%82%E7%A0%81"><span class="toc-number">2.</span> <span class="toc-text">[羊城杯 2020]Bytecode (py字节码)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-fungame-%E6%BA%A2%E5%87%BA"><span class="toc-number">3.</span> <span class="toc-text">[ACTF新生赛2020]fungame (溢出)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%AA%E5%AE%8CFlareOn2-very-success"><span class="toc-number">4.</span> <span class="toc-text">[未完FlareOn2]very_success</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SCTF2019-Strange-apk-apk%E5%8A%A8%E6%80%81%E9%87%8A%E6%94%BE%E6%96%87%E4%BB%B6"><span class="toc-number">5.</span> <span class="toc-text">[SCTF2019]Strange apk (apk动态释放文件)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RoarCTF2019-polyre-OLLVM%E6%8E%A7%E5%88%B6%E6%B5%81%E7%A8%8B%E5%B9%B3%E5%9D%A6%E5%8C%96-CRC"><span class="toc-number">6.</span> <span class="toc-text">[RoarCTF2019]polyre (OLLVM控制流程平坦化+CRC)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GKCTF-2021-QQQQT-base58"><span class="toc-number">7.</span> <span class="toc-text">[GKCTF 2021]QQQQT (base58)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NPUCTF2020-%E4%BD%A0%E5%A5%BDsao%E5%95%8A-base64%E6%8D%A2%E8%A1%A8%E8%A7%A3%E5%AF%86"><span class="toc-number">8.</span> <span class="toc-text">[NPUCTF2020]你好sao啊(base64换表解密)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#UTCTF2020-babymips-mips-%E5%BC%82%E6%88%96%E8%BF%90%E7%AE%97"><span class="toc-number">9.</span> <span class="toc-text">[UTCTF2020]babymips (mips+异或运算)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-funnyre-%E8%8A%B1%E6%8C%87%E4%BB%A4-%E5%BC%82%E6%88%96%E8%BF%90%E7%AE%97"><span class="toc-number">10.</span> <span class="toc-text">[WUSTCTF2020]funnyre (花指令+异或运算)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#QCTF2018-Xman-babymips-mips-%E4%BD%8D%E7%A7%BB%E8%BF%90%E7%AE%97"><span class="toc-number">11.</span> <span class="toc-text">[QCTF2018]Xman-babymips (mips+位移运算)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-login-pyinstaller%E8%A7%A3%E5%8C%85-pyc%E8%BF%94%E6%B1%87%E7%BC%96-z3"><span class="toc-number">12.</span> <span class="toc-text">[羊城杯 2020]login (pyinstaller解包+pyc返汇编+z3)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MRCTF2020-PixelShooter%EF%BC%88apk%E9%80%86%E5%90%91-x2F-C-%E9%80%86%E5%90%91%EF%BC%89"><span class="toc-number">13.</span> <span class="toc-text">[MRCTF2020]PixelShooter（apk逆向&#x2F;C#逆向）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FlareOn5-Ultimate-Minesweeper-NET%E9%80%86%E5%90%91"><span class="toc-number">14.</span> <span class="toc-text">[FlareOn5]Ultimate Minesweeper (.NET逆向)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-jocker-%E6%B7%B7%E6%B7%86-%E5%8A%A8%E8%B0%83"><span class="toc-number">15.</span> <span class="toc-text">[网鼎杯 2020 青龙组]jocker [混淆+动调]</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GWCTF-2019-re3-%E6%B7%B7%E6%B7%86-%E5%8A%A8%E8%B0%83-AES"><span class="toc-number">16.</span> <span class="toc-text">[GWCTF 2019]re3 (混淆+动调+AES)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RCTF2019-DontEatMe-1"><span class="toc-number">17.</span> <span class="toc-text">[RCTF2019]DontEatMe</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BA%A2%E5%B8%BD%E6%9D%AF2019-xx"><span class="toc-number">18.</span> <span class="toc-text">[红帽杯2019] xx</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%99%8E%E7%AC%A62022-%E6%9C%AA%E5%AE%8C-fpbe"><span class="toc-number">19.</span> <span class="toc-text">[虎符2022 未完] fpbe</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GUET-CTF2019-encrypt-RC4-x2F-elf%E5%8A%A8%E8%B0%83-x2F-base64%E5%88%86%E5%9D%97"><span class="toc-number">20.</span> <span class="toc-text">[GUET CTF2019] encrypt RC4&#x2F;elf动调&#x2F;base64分块</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HDCTF-MFC-Win%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81-DES%E5%8A%A0%E5%AF%86"><span class="toc-number">21.</span> <span class="toc-text">[HDCTF] MFC (Win消息发送+DES加密)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CISCN2018-2ex-base64%E6%8D%A2%E8%A1%A8"><span class="toc-number">22.</span> <span class="toc-text">[CISCN2018]2ex (base64换表)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-crackMe-SM4-base64%E9%AD%94%E6%94%B9-hook"><span class="toc-number">23.</span> <span class="toc-text">[安洵杯 2019]crackMe (SM4+base64魔改+hook)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-level4-idc-or-%E7%AE%97%E6%B3%95"><span class="toc-number">24.</span> <span class="toc-text">[WUSTCTF2020]level4 (idc or 算法)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A"><span class="toc-number">24.1.</span> <span class="toc-text">方法一：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A"><span class="toc-number">24.2.</span> <span class="toc-text">方法二：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%89%EF%BC%9A"><span class="toc-number">24.3.</span> <span class="toc-text">方法三：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CFI-CTF-2018-IntroToPE-NET%E9%80%86%E5%90%91"><span class="toc-number">25.</span> <span class="toc-text">[CFI-CTF 2018]IntroToPE (.NET逆向)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GXYCTF2019-simple-CPP-z3-%E5%8F%8D%E8%B0%83%E8%AF%95-%E5%8A%A8%E8%B0%83"><span class="toc-number">26.</span> <span class="toc-text">[GXYCTF2019]simple CPP (z3+反调试+动调)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FlareOn1-Bob-Doge-%EF%BC%88-net%E9%80%86%E5%90%91-dnspy%E9%80%86%E5%90%91%EF%BC%89"><span class="toc-number">27.</span> <span class="toc-text">[FlareOn1]Bob Doge （.net逆向+dnspy逆向）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SWPU2019-ReverseMe-%EF%BC%88od%E5%8A%A8%E8%B0%83plus%EF%BC%89"><span class="toc-number">28.</span> <span class="toc-text">[SWPU2019]ReverseMe （od动调plus）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SCTF2019-babyre-%E8%8A%B1%E6%8C%87%E4%BB%A4-%E4%B8%89%E7%BB%B4%E8%BF%B7%E5%AE%AB-%E6%9A%97%E8%97%8Fbase64-%EF%BC%9F%EF%BC%9F%EF%BC%9F"><span class="toc-number">29.</span> <span class="toc-text">[SCTF2019]babyre (花指令+三维迷宫+暗藏base64+？？？)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Ecquation-js-fuck%E5%8A%A0%E5%AF%86-z3"><span class="toc-number">30.</span> <span class="toc-text">Ecquation (js fuck加密+z3)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BUUCTF%E2%80%93-V-amp-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B-CSRe"><span class="toc-number">31.</span> <span class="toc-text">BUUCTF–[V&amp;N2020 公开赛]CSRe</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-SoulLike-elf%E6%9A%B4%E5%8A%9B-x2F-pwntools"><span class="toc-number">32.</span> <span class="toc-text">[ACTF新生赛2020]SoulLike (elf暴力&#x2F;pwntools)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-easyre-%EF%BC%88base64-x2F-%E5%87%AF%E6%92%92%EF%BC%89"><span class="toc-number">33.</span> <span class="toc-text">[羊城杯 2020]easyre （base64&#x2F;凯撒）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#findKey-%E8%8A%B1%E6%8C%87%E4%BB%A4-%E6%AD%A3%E9%80%86%E5%90%91-MD5"><span class="toc-number">34.</span> <span class="toc-text">findKey (花指令+正逆向+MD5)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GUET-CTF2019-number-game-%E5%8A%A8%E8%B0%83-x2F-%E4%BA%8C%E5%8F%89%E6%A0%91"><span class="toc-number">35.</span> <span class="toc-text">[GUET-CTF2019]number_game (动调&#x2F;二叉树)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#firmware-%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91-x2F-binwalk"><span class="toc-number">36.</span> <span class="toc-text">firmware (路由器逆向&#x2F;binwalk)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WMCTF2020-easy-re-perl%E7%89%B9%E6%80%A7"><span class="toc-number">37.</span> <span class="toc-text">[WMCTF2020]easy_re (perl特性)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crackMe-od%E5%8A%A8%E8%B0%83"><span class="toc-number">38.</span> <span class="toc-text">crackMe (od动调)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E7%9A%84base64-base64%E6%8D%A2%E8%A1%A8"><span class="toc-number">39.</span> <span class="toc-text">特殊的base64 (base64换表)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-singal-vm%E9%A2%98-x2F-ponce%E6%8F%92%E4%BB%B6"><span class="toc-number">40.</span> <span class="toc-text">[网鼎杯 2020 青龙组]singal (vm题&#x2F;ponce插件)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GWCTF-2019-xxor-%EF%BC%88xor-plus%EF%BC%89"><span class="toc-number">41.</span> <span class="toc-text">[GWCTF 2019]xxor （xor plus）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-level4%EF%BC%88%E4%BA%8C%E5%8F%89%E6%A0%91%E9%81%8D%E5%8E%86%EF%BC%89"><span class="toc-number">42.</span> <span class="toc-text">[WUSTCTF2020]level4（二叉树遍历）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-Universe-final-answer-z3%E8%AE%A1%E7%AE%97"><span class="toc-number">43.</span> <span class="toc-text">[ACTF新生赛2020]Universe_final_answer (z3计算)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#UTCTF2020-basic-re-%E6%B0%B4%E9%A2%98"><span class="toc-number">44.</span> <span class="toc-text">[UTCTF2020]basic-re (水题)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Zer0pts2020-easy-strcmp-binascii-%E5%87%BD%E6%95%B0%E5%8F%98%E5%9D%80"><span class="toc-number">45.</span> <span class="toc-text">[Zer0pts2020]easy strcmp (binascii+函数变址)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FlareOn3-Challenge1-base64%E6%8D%A2%E8%A1%A8"><span class="toc-number">46.</span> <span class="toc-text">[FlareOn3]Challenge1 (base64换表)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-Oruga%EF%BC%88%E8%BF%B7%E5%AE%ABplus%EF%BC%89"><span class="toc-number">47.</span> <span class="toc-text">[ACTF新生赛2020]Oruga（迷宫plus）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BJDCTF2020-BJD-hamburger-competition%EF%BC%88unity%E9%80%86%E5%90%91-sha1-mod5%EF%BC%89"><span class="toc-number">48.</span> <span class="toc-text">[BJDCTF2020]BJD hamburger competition（unity逆向+sha1+mod5）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-Cr0ssfun-%E6%B0%B4%E9%A2%98"><span class="toc-number">49.</span> <span class="toc-text">[WUSTCTF2020]Cr0ssfun(水题)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FlareOn6-Overlong-od%E5%8A%A8%E8%B0%83"><span class="toc-number">50.</span> <span class="toc-text">[FlareOn6]Overlong(od动调)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GWCTF-2019-xxor-xor-plus"><span class="toc-number">51.</span> <span class="toc-text">[GWCTF 2019]xxor (xor plus++)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MRCTF2020-Xor"><span class="toc-number">52.</span> <span class="toc-text">[MRCTF2020]Xor</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MRCTF2020-hello-world-go"><span class="toc-number">53.</span> <span class="toc-text">[MRCTF2020]hello_world_go</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-level3-base64%E6%8D%A2%E8%A1%A8"><span class="toc-number">54.</span> <span class="toc-text">[WUSTCTF2020]level3(base64换表)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FlareOn4-IgniteMe"><span class="toc-number">55.</span> <span class="toc-text">[FlareOn4]IgniteMe()</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Youngter-drive-windows%E5%A4%9A%E7%BA%BF%E7%A8%8B-index%E9%80%86%E5%90%91"><span class="toc-number">56.</span> <span class="toc-text">Youngter-drive(windows多线程+index逆向)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-level2%EF%BC%88upx%E8%84%B1%E5%A3%B3%EF%BC%89"><span class="toc-number">57.</span> <span class="toc-text">[WUSTCTF2020]level2（upx脱壳）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%B8%E5%86%8C%EF%BC%88apk%E7%97%85%E6%AF%92-base64%EF%BC%89"><span class="toc-number">58.</span> <span class="toc-text">相册（apk病毒+base64）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HDCTF2019-Maze-easy-%E8%BF%B7%E5%AE%AB"><span class="toc-number">59.</span> <span class="toc-text">[HDCTF2019]Maze (easy 迷宫)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-level1"><span class="toc-number">60.</span> <span class="toc-text">[WUSTCTF2020]level1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MRCTF2020-Transform-index-%E9%80%86%E5%90%91"><span class="toc-number">61.</span> <span class="toc-text">[MRCTF2020]Transform(index 逆向)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-usualCrypt"><span class="toc-number">62.</span> <span class="toc-text">[ACTF新生赛2020]usualCrypt</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-easyRE%EF%BC%88-fini%EF%BC%89"><span class="toc-number">63.</span> <span class="toc-text">[2019红帽杯]easyRE（.fini）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GUET-CTF2019-re-%E6%9A%B4%E5%8A%9B-%E6%AC%A1%E5%BA%8F"><span class="toc-number">64.</span> <span class="toc-text">[GUET-CTF2019]re (暴力+次序)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SUCTF-2019-SignIn%EF%BC%88rsa-plus%EF%BC%89"><span class="toc-number">65.</span> <span class="toc-text">[SUCTF 2019] SignIn（rsa plus）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#xor-%E5%BC%82%E6%88%96"><span class="toc-number">66.</span> <span class="toc-text">xor (异或)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hello-word%EF%BC%88apk%E9%80%86%E5%90%91%EF%BC%89"><span class="toc-number">67.</span> <span class="toc-text">hello word（apk逆向）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#reverse-3-base64"><span class="toc-number">68.</span> <span class="toc-text">reverse_3 (base64)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Simple-Rev-ADI%E5%B0%8F%E7%AB%AF%E5%AD%98%E5%82%A8"><span class="toc-number">69.</span> <span class="toc-text">Simple_Rev (ADI小端存储)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GXYCTF2019-luck-guy-ADI%E5%B0%8F%E7%AB%AF%E5%AD%98%E5%82%A8"><span class="toc-number">70.</span> <span class="toc-text">[GXYCTF2019]luck_guy (ADI小端存储)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96-ASCII%E6%8E%92%E5%BA%8F-base64"><span class="toc-number">71.</span> <span class="toc-text">刮开有奖 (ASCII排序+base64)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BJDCTF2020-JustRE-%EF%BC%88%E6%B0%B4%E9%A2%98%EF%BC%89"><span class="toc-number">72.</span> <span class="toc-text">[BJDCTF2020]JustRE （水题）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%B3%A8%E5%86%8C%E5%99%A8-apk%E9%80%86%E5%90%91"><span class="toc-number">73.</span> <span class="toc-text">简单注册器(apk逆向)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#findit-apk%E9%80%86%E5%90%91"><span class="toc-number">74.</span> <span class="toc-text">findit(apk逆向)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pyre-%E7%9A%84%E9%80%86%E6%8E%A8"><span class="toc-number">75.</span> <span class="toc-text">pyre(%的逆推)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-easyre-index%E7%9A%84%E6%8E%A8%E5%AF%BC"><span class="toc-number">76.</span> <span class="toc-text">[ACTF新生赛2020]easyre(index的推导)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#rsa-%E9%9D%9E%E5%AF%B9%E7%A7%B0%E8%A7%A3%E5%AF%86"><span class="toc-number">77.</span> <span class="toc-text">rsa (非对称解密)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-rome-ASCII%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">78.</span> <span class="toc-text">[ACTF新生赛2020]rome(ASCII暴力破解)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CrackRTF1-%E6%95%A3%E5%88%97%E7%AE%97%E6%B3%95-Win32API-%E6%96%87%E4%BB%B6%E5%A4%B4"><span class="toc-number">79.</span> <span class="toc-text">CrackRTF1 (散列算法+Win32API+文件头)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#login-JS%E9%80%86%E5%90%91-x2F-%E5%87%AF%E6%92%92"><span class="toc-number">80.</span> <span class="toc-text">login (JS逆向&#x2F;凯撒)</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/05/13/mobile/anroid%E7%9A%84%E5%AD%A6%E4%B9%A0/" title="anroid的学习"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="anroid的学习"/></a><div class="content"><a class="title" href="/2022/05/13/mobile/anroid%E7%9A%84%E5%AD%A6%E4%B9%A0/" title="anroid的学习">anroid的学习</a><time datetime="2022-05-13T09:29:43.000Z" title="Created 2022-05-13 17:29:43">2022-05-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/10/CTF/2022catf1agctf/" title="2022catf1agctf"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022catf1agctf"/></a><div class="content"><a class="title" href="/2022/05/10/CTF/2022catf1agctf/" title="2022catf1agctf">2022catf1agctf</a><time datetime="2022-05-10T07:56:51.000Z" title="Created 2022-05-10 15:56:51">2022-05-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/08/CTF/2022angstromctf/" title="2022angstromctf"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022angstromctf"/></a><div class="content"><a class="title" href="/2022/05/08/CTF/2022angstromctf/" title="2022angstromctf">2022angstromctf</a><time datetime="2022-05-08T01:58:39.000Z" title="Created 2022-05-08 09:58:39">2022-05-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/06/reverse/angr%E7%9A%84%E5%AD%A6%E4%B9%A0/" title="angr的学习"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="angr的学习"/></a><div class="content"><a class="title" href="/2022/05/06/reverse/angr%E7%9A%84%E5%AD%A6%E4%B9%A0/" title="angr的学习">angr的学习</a><time datetime="2022-05-06T02:31:19.000Z" title="Created 2022-05-06 10:31:19">2022-05-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/02/CTF/2022NahamConCTF/" title="2022NahamConCTF"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022NahamConCTF"/></a><div class="content"><a class="title" href="/2022/05/02/CTF/2022NahamConCTF/" title="2022NahamConCTF">2022NahamConCTF</a><time datetime="2022-05-02T03:40:43.000Z" title="Created 2022-05-02 11:40:43">2022-05-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By ke1os</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>