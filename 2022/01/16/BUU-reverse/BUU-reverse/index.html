<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>BUU_reverse | ke1os' blog</title><meta name="keywords" content="BUU-reverse"><meta name="author" content="ke1os"><meta name="copyright" content="ke1os"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="[HDCTF] MFC (Win消息发送+DES加密)刚开始用的火绒剑，感觉没啥用 去下了个spy类工具，用来查看windows的窗口，消息和进程等等 这边用的是大佬推荐的CometAssistant，彗星小助手     还去下载了一个spy++ (但是看着有点膈应人)     关于xspy的使用很简单，只需要把这个放大镜拖动放到需要嗅探的窗口中就可以了     突破口在这边，当然也涉及我的知">
<meta property="og:type" content="article">
<meta property="og:title" content="BUU_reverse">
<meta property="og:url" content="http://ke1os.top/2022/01/16/BUU-reverse/BUU-reverse/index.html">
<meta property="og:site_name" content="ke1os&#39; blog">
<meta property="og:description" content="[HDCTF] MFC (Win消息发送+DES加密)刚开始用的火绒剑，感觉没啥用 去下了个spy类工具，用来查看windows的窗口，消息和进程等等 这边用的是大佬推荐的CometAssistant，彗星小助手     还去下载了一个spy++ (但是看着有点膈应人)     关于xspy的使用很简单，只需要把这个放大镜拖动放到需要嗅探的窗口中就可以了     突破口在这边，当然也涉及我的知">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2022-01-16T12:18:36.000Z">
<meta property="article:modified_time" content="2022-03-17T12:45:35.285Z">
<meta property="article:author" content="ke1os">
<meta property="article:tag" content="BUU-reverse">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/img/ke1os.jpg"><link rel="canonical" href="http://ke1os.top/2022/01/16/BUU-reverse/BUU-reverse/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BUU_reverse',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-03-17 20:45:35'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/ke1os.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">10</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">ke1os' blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUU_reverse</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-01-16T12:18:36.000Z" title="Created 2022-01-16 20:18:36">2022-01-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-03-17T12:45:35.285Z" title="Updated 2022-03-17 20:45:35">2022-03-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BUU_reverse"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><span id="more"></span>

<h1 id="HDCTF-MFC-Win消息发送-DES加密"><a href="#HDCTF-MFC-Win消息发送-DES加密" class="headerlink" title="[HDCTF] MFC (Win消息发送+DES加密)"></a>[HDCTF] MFC (Win消息发送+DES加密)</h1><p>刚开始用的火绒剑，感觉没啥用</p>
<p>去下了个spy类工具，用来查看windows的窗口，消息和进程等等</p>
<p>这边用的是大佬推荐的CometAssistant，彗星小助手</p>




<p>还去下载了一个spy++ (但是看着有点膈应人)</p>




<p>关于xspy的使用很简单，只需要把这个放大镜拖动放到需要嗅探的窗口中就可以了</p>




<p>突破口在这边，当然也涉及我的知识盲区了：向窗口发送信息</p>




<p>这边直接把<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39268483/article/details/90611852">大佬博客</a>里的代码贴过来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;Windows.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	HWND h = ::FindWindowA(NULL, <span class="string">&quot;Flag就在控件里&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (h)</span><br><span class="line">	&#123;</span><br><span class="line">		SendMessage(h, <span class="number">0x464</span>, NULL, NULL);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		printf(<span class="string">&quot;false&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>分析一下：</p>
<p>首先Win32 API的使用需要导入Windows.h的库</p>
<p>FindWindowA:检索其类名和窗口名与指定字符串匹配的顶级窗口的句柄。此函数不搜索子窗口。此函数不执行区分大小写的搜索。返回值是一个窗口句柄。一参是窗口的类名，可为空。二参是窗口的标题名称。</p>




<p>SendMessage:将指定的消息发送到一个或多个窗口。SendMessage函数调用指定窗口的窗口过程，直到窗口过程处理完消息后才返回。</p>


<p>贴上<a target="_blank" rel="noopener" href="https://blog.csdn.net/u011392772/article/details/52245584">详细解释</a>，长话短说就是一参是接受窗口的句柄，二参是指定被发送的消息，三四参数是附加消息指定信息。</p>
<p>这个窗口的窗口名称为“Flag就在控件中”，我们就去寻找这个窗口的句柄，并赋值为h。</p>




<p>找到句柄之后我们向其发送一个数字：0x464（至于为什么要发送0x464，还得让我琢磨琢磨……）</p>




<p>当发送完数字之后，窗口变了</p>
<p>DES是一个常见的分组加密形式，需要一个密钥+明文&#x3D;&#x3D;&gt;明文</p>




<p>貌似这个名字就是明文了</p>


<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">crypto: <span class="number">944</span>c8d100f82f0c18b682f63e4dbaa207a2f1e72581c2f1b</span><br><span class="line">key: &#123;I am a Des key&#125;</span><br></pre></td></tr></table></figure>





<p>flag{thIs_Is_real_kEy_hahaaa}</p>
<h1 id="CISCN2018-2ex-base64换表"><a href="#CISCN2018-2ex-base64换表" class="headerlink" title="[CISCN2018]2ex (base64换表)"></a>[CISCN2018]2ex (base64换表)</h1><p>啊这……</p>


<p>放到ida中，这个字符很起疑心：</p>


<p>长度竟然为64？base64换表走起：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">string =  <span class="string">&quot;|_r-+_Cl5;vgq_pdme7#7eC0=&quot;</span></span><br><span class="line"></span><br><span class="line">new_base = <span class="string">&quot;@,.1fgvw#`/2ehux$~\&quot;3dity%_;4cjsz^+&#123;5bkrA&amp;=&#125;6alqB*-[70mpC()]89noD&quot;</span></span><br><span class="line"></span><br><span class="line">base = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(string.translate(<span class="built_in">str</span>.maketrans(new_base,base)))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;change53233&#125;)&#x27;</span></span><br></pre></td></tr></table></figure>

<p>CTFtools也成，得把表中的转义字符\给去掉才行</p>


<p>（太棒了，水了一题）</p>
<h1 id="安洵杯-2019-crackMe-SM4-base64魔改-hook"><a href="#安洵杯-2019-crackMe-SM4-base64魔改-hook" class="headerlink" title="[安洵杯 2019]crackMe (SM4+base64魔改+hook)"></a>[安洵杯 2019]crackMe (SM4+base64魔改+hook)</h1>



<p>搞不懂为什么我运行不起来，修复了半天，去装了个win7</p>
<p>运行之后，应该是这样的界面：</p>


<p>猜测这道题的考点是hook</p>


















<p>正向：</p>
<p>——–&gt;base64表大小写转换</p>
<p>——–&gt;SM4加密（key &#x3D; “where_are_you_now?”）</p>
<p>——–&gt;SM4加密后，密码相邻位互换</p>
<p>——–&gt;base64表，先进行大小写转换，再进行（a1+24）%64转换[相当于把字母表向左移动了24位]</p>
<p>——–&gt;base64解密</p>
<p>逆向</p>
<p>——–&gt;base64表转换（大小写与移位）</p>
<p>——–&gt;加密字符转换（相邻位置互换）</p>
<p>——–&gt;base64换表解密</p>
<p>——–&gt;SM4解密（需要pysm4的包）</p>
<p>这道base64是用”!”，来替换’&#x3D;’ ，先来转换base64的表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">base = <span class="built_in">list</span>(<span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    base[i] = base[i].swapcase()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(base))</span><br><span class="line"></span><br><span class="line">new_base = [base[(i+<span class="number">24</span>)%<span class="number">64</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(base))]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(new_base))</span><br><span class="line"><span class="comment"># new_base = yzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/abcdefghijklmnopqrstuvwx</span></span><br></pre></td></tr></table></figure>



<p>再把需要转换的字符两两转换，换表base64解码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">base = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">new_base = <span class="string">&quot;yzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/abcdefghijklmnopqrstuvwx&quot;</span></span><br><span class="line"></span><br><span class="line">raw_string = <span class="built_in">list</span>(<span class="string">&quot;1UTAOIkpyOSWGv/mOYFY4R!!&quot;</span>.replace(<span class="string">&quot;!&quot;</span>,<span class="string">&quot;=&quot;</span>))</span><br><span class="line"><span class="comment"># 1UTAOIkpyOSWGv/mOYFY4R==</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(raw_string),<span class="number">2</span>):</span><br><span class="line">	raw_string[i],raw_string[i+<span class="number">1</span>] = raw_string[i+<span class="number">1</span>],raw_string[i]</span><br><span class="line"><span class="comment"># U1ATIOpkOyWSvGm/YOYFR4==</span></span><br><span class="line"></span><br><span class="line">string = <span class="string">&quot;&quot;</span>.join(raw_string)</span><br><span class="line">s = base64.b64decode(string.translate(<span class="built_in">str</span>.maketrans(new_base,base)))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(s))</span><br><span class="line"><span class="comment"># [89, 208, 149, 41, 13, 242, 64, 6, 20, 244, 141, 39, 105, 6, 135, 78]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串转换成16进制</span></span><br><span class="line">hex_s = binascii.b2a_hex(s)</span><br><span class="line"><span class="built_in">print</span>(hex_s)</span><br><span class="line"><span class="comment"># b&#x27;59d095290df2400614f48d276906874e&#x27;</span></span><br></pre></td></tr></table></figure>



<p>然后把生成的两个16进制数:需要解密的数hex_key以及轮回秘钥hex_s，放到SM4解密函数decode()中解密，将生成的Int类型数字，转换成16进制，再转换成bytes类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> pysm4 <span class="keyword">import</span> encrypt,decrypt</span><br><span class="line">key = <span class="string">&quot;where_are_u_now?&quot;</span></span><br><span class="line">hex_key = <span class="built_in">hex</span>(binascii.b2a_hex(key.encode(<span class="string">&#x27;utf-8&#x27;</span>)))</span><br><span class="line"><span class="comment"># b&#x27;77686572655f6172655f755f6e6f773f&#x27;</span></span><br><span class="line"></span><br><span class="line">hex_s = <span class="number">0x59d095290df2400614f48d276906874e</span></span><br><span class="line">hex_key = <span class="number">0x77686572655f6172655f755f6e6f773f</span></span><br><span class="line"></span><br><span class="line">clear_num = decrypt(cipher_num, mk)</span><br><span class="line"><span class="comment"># clear_num = 110726793309279461591673877471154814753</span></span><br><span class="line"><span class="comment"># 将生成的int型结果转换成16进制字符串</span></span><br><span class="line"><span class="comment"># 再将16进制字符串去除头两位，转换成bytes类型</span></span><br><span class="line"><span class="comment"># 最后再将bytes类型编码</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span>+<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(clear_num)[<span class="number">2</span>:]).decode()+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;SM4foRExcepioN?!&#125;</span></span><br></pre></td></tr></table></figure>



<p>参考链接：<a target="_blank" rel="noopener" href="http://81.69.232.121/%E5%AE%89%E6%B4%B5%E6%9D%AF-2019crackme-%E6%88%91%E4%BA%BA%E5%82%BB%E4%BA%86/">http://81.69.232.121/%E5%AE%89%E6%B4%B5%E6%9D%AF-2019crackme-%E6%88%91%E4%BA%BA%E5%82%BB%E4%BA%86/</a></p>
<h1 id="WUSTCTF2020-level4-idc-or-算法"><a href="#WUSTCTF2020-level4-idc-or-算法" class="headerlink" title="[WUSTCTF2020]level4 (idc or 算法)"></a>[WUSTCTF2020]level4 (idc or 算法)</h1><p>没想到这题竟然有三种解法，之前写这篇的时候，没有深入的研究：</p>
<p>ida打开:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  puts(<span class="string">&quot;Practice my Data Structure code.....&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;Typing....Struct.....char....*left....*right............emmmmm...OK!&quot;</span>);</span><br><span class="line">  init(<span class="string">&quot;Typing....Struct.....char....*left....*right............emmmmm...OK!&quot;</span>, argv);</span><br><span class="line">  puts(<span class="string">&quot;Traversal!&quot;</span>);</span><br><span class="line">  printf(<span class="string">&quot;Traversal type 1:&quot;</span>);</span><br><span class="line">  type1(&amp;unk_601290);</span><br><span class="line">  printf(<span class="string">&quot;\nTraversal type 2:&quot;</span>);</span><br><span class="line">  type2(&amp;unk_601290);</span><br><span class="line">  printf(<span class="string">&quot;\nTraversal type 3:&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;    //type3(&amp;x[22]);   No way!&quot;</span>);</span><br><span class="line">  puts(&amp;byte_400A37);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>跟进type1：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall type1(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; // rax</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    type1(*((_QWORD *)a1 + <span class="number">1</span>));</span><br><span class="line">    putchar(*a1);</span><br><span class="line">    <span class="keyword">return</span> type1(*((_QWORD *)a1 + <span class="number">2</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>跟进type2:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __fastcall type2(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> result; // eax</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    type2(*((_QWORD *)a1 + <span class="number">1</span>));</span><br><span class="line">    type2(*((_QWORD *)a1 + <span class="number">2</span>));</span><br><span class="line">    <span class="keyword">return</span> putchar(*a1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br></pre></td></tr></table></figure>

<p>两个递归调用，可以确定type1是中序遍历二叉树，type2是后序遍历二叉树，我们需要做的就是通过type1,type2，我们可以尝试还原出二叉树的构造。</p>
<h2 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h2><p>手算，如果二叉树太大，耗时耗力。</p>
<h2 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h2><p>可以猜测出flag应为前序遍历，使用idc脚本编写</p>


<p>跟进type2，查看反汇编代码，发现只需要调整代码块的位置，就使type2函数变成前序遍历</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">static main()</span><br><span class="line">&#123;</span><br><span class="line">    auto address1=<span class="number">0x4007CA</span>;</span><br><span class="line">    auto address2=<span class="number">0x4007EA</span>;</span><br><span class="line">    auto address3=<span class="number">0x4007FB</span>;</span><br><span class="line">    auto code1=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    auto i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(i=address1;i&lt;address2;i++)</span><br><span class="line">    &#123;</span><br><span class="line">    	code1=code1+Byte(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    j=address1;</span><br><span class="line">    <span class="keyword">for</span>(i=address2;i&lt;address3;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        PatchByte(j++,Byte(i));</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;strlen(code1);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        PatchByte(j++,<span class="built_in">ord</span>(code1[i]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>在计算机中，汇编指令和数据其实都是一码事，都是二进制代码，为了方便使用的是16进制数，一个字节8位，使用的是两个十六进制数。Byte是根据给出的虚拟地址，取一个字节，PatchByte则是用二参的字节去patch一参的地址。</p>
<p>idc代码就是把address1-address2处的字节与address2-address3的字节交换</p>
<p>可以在这边输入6，可以看到指令的字节</p>








<p>选中代码，右键分析，强制执行之后：</p>




<p>改变前：</p>




<p>改变后：</p>




<p>别的大佬的博客用的都是keypatch插件，我是直接把对应地址的call指令重新patch了</p>




<p>最后，把patch完的程序，apply patches to应用</p>




<p>出来了：</p>




<h2 id="方法三："><a href="#方法三：" class="headerlink" title="方法三："></a>方法三：</h2><p>上手C++代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;iostream&gt;</span></span><br><span class="line">using namespace std;</span><br><span class="line">char post[] = <span class="string">&quot;20f0Th&#123;2tsIS_icArE&#125;e7__w&quot;</span>; // 后序遍历结果</span><br><span class="line">char mid[] = <span class="string">&quot;2f0t02T&#123;hcsiI_SwA__r7Ee&#125;&quot;</span>; // 中序遍历结果</span><br><span class="line">void pre(<span class="built_in">int</span> root, <span class="built_in">int</span> start, <span class="built_in">int</span> end)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (start &gt; end)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">int</span> i = start;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; end &amp;&amp; mid[i] != post[root]) i++;  //定位根在中序的位置</span><br><span class="line">    cout &lt;&lt; mid[i];  //访问当前处理的树的根</span><br><span class="line">    pre(root - <span class="number">1</span> - (end - i), start, i - <span class="number">1</span>);  //递归处理左子树</span><br><span class="line">    pre(root - <span class="number">1</span>, i + <span class="number">1</span>, end);  //递归处理右子树  </span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    pre(<span class="number">24</span>, <span class="number">0</span>, <span class="number">24</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;This_IS_A_7reE&#125;</span></span><br></pre></td></tr></table></figure>

<p>感谢师傅送我的代码！！</p>
<h1 id="CFI-CTF-2018-IntroToPE-NET逆向"><a href="#CFI-CTF-2018-IntroToPE-NET逆向" class="headerlink" title="[CFI-CTF 2018]IntroToPE (.NET逆向)"></a>[CFI-CTF 2018]IntroToPE (.NET逆向)</h1><p>打开看一下：</p>




<p>查个壳，这让我有点害怕，第一次遇到带红的</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Big sec. <span class="number">1</span> .text ,  Explore <span class="keyword">and</span> analyze .NET assemblies <span class="keyword">with</span> .NET Reflector v10 - www.red-gate.com</span><br><span class="line"> - IF file <span class="keyword">is</span> packed <span class="keyword">try</span> .NET <span class="type">Generic</span> unpacker : www.quequero.org/Pack_Unpack</span><br></pre></td></tr></table></figure>

<p>还去下载了.net Reflector 和 .NET Generic unpacker</p>
<p>我们直接用dnSpy打开，</p>


<p>找到对应的函数</p>




<p>热泪盈眶</p>


<h1 id="GXYCTF2019-simple-CPP-z3-反调试-动调"><a href="#GXYCTF2019-simple-CPP-z3-反调试-动调" class="headerlink" title="[GXYCTF2019]simple CPP (z3+反调试+动调)"></a>[GXYCTF2019]simple CPP (z3+反调试+动调)</h1><p>这题折磨的我没有脾气……</p>
<p>先查个壳，C++逆向，据我所知，c++的题目，一般都得调试……</p>




<p>瞧瞧这是人看的题目么</p>




<p>main函数中，还出现了反调试函数，调试会崩，需要打补丁。我用ida调试了很久，太菜，无果……</p>




<p>题目的意思是将输入的字符转换成16进制字符串，假设输入abc，则字符串为616263</p>
<p>我们需要求出v20数组</p>






<p>用x,y,z,w分别代表v20[0]~v20[3]，还是耐住性子写了一遍本题的位运算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">v20[<span class="number">3</span>] = w</span><br><span class="line"></span><br><span class="line">v20[<span class="number">2</span>] = z</span><br><span class="line"></span><br><span class="line">v20[<span class="number">1</span>] = y</span><br><span class="line"></span><br><span class="line">v20[<span class="number">0</span>] = x</span><br><span class="line"></span><br><span class="line">v41 = v20[<span class="number">2</span>] = z</span><br><span class="line"></span><br><span class="line">v21 = v20[<span class="number">1</span>] = y</span><br><span class="line"></span><br><span class="line">v22 = v20[<span class="number">0</span>] = x</span><br><span class="line"></span><br><span class="line">v24 = v21 &amp; v22 = x &amp; y</span><br><span class="line"></span><br><span class="line">v25 = z &amp; ~x = <span class="number">0x11204161012</span></span><br><span class="line"></span><br><span class="line">v26 = ~v21 = ~y</span><br><span class="line"></span><br><span class="line">v27 = v41 &amp; v26 = z &amp; ~y</span><br><span class="line"></span><br><span class="line">v28 = x &amp; ~y</span><br><span class="line"></span><br><span class="line">v23[<span class="number">0</span>] = v21 &amp; v22 = x &amp; y</span><br><span class="line"></span><br><span class="line">v23[<span class="number">1</span>] = v25 = z &amp; ~x = </span><br><span class="line"></span><br><span class="line">v23[<span class="number">2</span>] = v41 &amp; v26 = z &amp; ~y</span><br><span class="line"></span><br><span class="line">v23[<span class="number">3</span>] = v28 = x &amp; ~y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">v29 = v25 | v24 | v27 | v28</span><br><span class="line">    = (z &amp; ~x)|(x &amp; y)|(z &amp; ~y)|(x &amp; ~y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">v30 = y</span><br><span class="line"></span><br><span class="line">v31 = z</span><br><span class="line"></span><br><span class="line">v32 = v27 &amp; *v20 | v31 &amp; (v24 | v30 &amp; ~*v20 | ~(v30 | *v20))</span><br><span class="line">    ==&gt; (z &amp; ~y) &amp; x | z &amp; (x &amp; y | y &amp; ~(x)) | ~(y | x)</span><br><span class="line">    ==&gt; <span class="number">0x8020717153E3013</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">v33 = v29 ==&gt; (z &amp; ~x)|(x &amp; y)|(z &amp; ~y)|(x &amp; ~y)</span><br><span class="line">	  ==&gt;  <span class="number">0x3E3A4717373E7F1F</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(v29 ^ v20[<span class="number">3</span>]) == <span class="number">0x3E3A4717050F791F</span></span><br><span class="line">==&gt; ((z &amp; ~x)|(x &amp; y)|(z &amp; ~y)|(x &amp; ~y)）^ w </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">v3 = v33</span><br><span class="line"></span><br><span class="line"> (v25 | v24 | v30 &amp; v31) == (~v20[<span class="number">0</span>] &amp; v31 | 0xC00020130082C0Ci64) &amp;&amp; v33</span><br><span class="line"></span><br><span class="line">==&gt; <span class="number">0x11204161012</span> | (x &amp; y) | (y &amp; z) == ((~x &amp; z) | <span class="number">0xC00020130082C0C</span>) &amp;&amp; <span class="number">0x3E3A4717373E7F1F</span></span><br></pre></td></tr></table></figure>

<p>在Z3中，只有BitVecs可以进行位运算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x,y,z,w=BitVecs(<span class="string">&#x27;x y z w&#x27;</span>,<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">s=Solver()</span><br><span class="line"></span><br><span class="line">s.add(z &amp; ~x == <span class="number">0x11204161012</span>)</span><br><span class="line"></span><br><span class="line">s.add(((z &amp; ~y) &amp; x | z &amp; (x &amp; y | y &amp; ~(x)) | ~(y | x)) == <span class="number">0x8020717153E3013</span>)</span><br><span class="line"></span><br><span class="line">s.add(((z &amp; ~x)|(x &amp; y)|(z &amp; ~y)|(x &amp; ~y)) == <span class="number">0x3E3A4717373E7F1F</span>)</span><br><span class="line"></span><br><span class="line">s.add(<span class="number">0x11204161012</span> | (x &amp; y) | (y &amp; z) == ((~x &amp; z) | <span class="number">0xC00020130082C0C</span>))</span><br><span class="line"></span><br><span class="line">s.add((((z &amp; ~x)|(x &amp; y)|(z &amp; ~y)|(x &amp; ~y))^ w ) == <span class="number">0x3E3A4717050F791F</span>)</span><br><span class="line"></span><br><span class="line">s.check()</span><br><span class="line"></span><br><span class="line">m = s.model()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%s = 0x%x&quot;</span>%(i,m[i].as_long()))</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">y = <span class="number">0xcdc5bae9f8c9acec</span></span><br><span class="line">x = <span class="number">0x3e3a460533286f0d</span></span><br><span class="line">w = <span class="number">0x32310600</span></span><br><span class="line">z = <span class="number">0x8020717153e3013</span></span><br></pre></td></tr></table></figure>

<p>然而我的代码和大佬的代码运行结果只有一个变量不一致……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">y = <span class="number">0xc00020130082c0c</span></span><br><span class="line">x = <span class="number">0x3e3a460533286f0d</span></span><br><span class="line">w = <span class="number">0x32310600</span></span><br><span class="line">z = <span class="number">0x8020717153e3013</span></span><br></pre></td></tr></table></figure>

<p>在动调中发现了这些字符</p>


<p>下面的代码是大佬的代码，我实在没有搞懂lis中0x8c之后的十六进制数是哪里来的……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">lis = [<span class="number">0x3E</span>,<span class="number">0x3A</span>,<span class="number">0x46</span>,<span class="number">0x05</span>,<span class="number">0x33</span>,<span class="number">0x28</span>,<span class="number">0x6F</span>,<span class="number">0x0D</span>,<span class="number">0x8C</span>,<span class="number">0x00</span>,<span class="number">0x8A</span>,<span class="number">0x09</span>,<span class="number">0x78</span>,<span class="number">0x49</span>,<span class="number">0x2C</span>,<span class="number">0xAC</span>,<span class="number">0x08</span>,<span class="number">0x02</span>,<span class="number">0x07</span>,<span class="number">0x17</span>,<span class="number">0x15</span>,<span class="number">0x3E</span>,<span class="number">0x30</span>,<span class="number">0x13</span>,<span class="number">0x32</span>,<span class="number">0x31</span>,<span class="number">0x06</span>]</span><br><span class="line">string = <span class="string">&#x27;i_will_check_is_debug_or_noi_wil&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lis)):</span><br><span class="line">	flag += <span class="built_in">chr</span>(lis[i] ^ <span class="built_in">ord</span>(string[i]))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>We1l_D0näeéb’ _ólgebra_am_i</p>
<p>第二部分的解，比赛的时候已经给出e!P0or_a</p>
<p>所以flag{We1l_D0ne!P0or_algebra_am_i}</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/mcmuyanga/article/details/113628506">https://blog.csdn.net/mcmuyanga/article/details/113628506</a></p>
<h1 id="FlareOn1-Bob-Doge-（-net逆向-dnspy逆向）"><a href="#FlareOn1-Bob-Doge-（-net逆向-dnspy逆向）" class="headerlink" title="[FlareOn1]Bob Doge （.net逆向+dnspy逆向）"></a>[FlareOn1]Bob Doge （.net逆向+dnspy逆向）</h1>

<p>先查个壳，发现没有壳，c++编写</p>
<p>运行一下，发现是个安装的程序</p>




<p>安装成功之后，会在安装目录下，生成一个.exe文件，我们再扫个壳，这边就能看出来是C#编写的.net程序了</p>
<p>（麻了，我还以为要逆向安装程序，给我ida给我看呆了）</p>




<p>点击decode之后变成了doge，哈哈哈</p>


<p>我们放到dnSpy中进行反编译</p>
<p>找到加密函数之后，text3就是flag</p>


<p>断点打在加密函数最后的text3处，F5运行到这边，flag就出来了</p>
<p>（我跟个憨憨一样用逆向算法算了半天还没算出来……）</p>




<h1 id="SWPU2019-ReverseMe-（od动调plus）"><a href="#SWPU2019-ReverseMe-（od动调plus）" class="headerlink" title="[SWPU2019]ReverseMe （od动调plus）"></a>[SWPU2019]ReverseMe （od动调plus）</h1><p>首先是查壳：</p>


<p>因为是c++编写的，ida静态分析难度较大，所以选择od动调分析：</p>
<p>快过来熟悉一下od的操作！！！</p>
<p>首先通过中文搜索引擎跳转到提示性语句：</p>




<p>可以确定的是call语句的下一条cmp指令，与0x20，也就是32，决定是否跳转，也就是0x20是长度</p>
<p>我们输入一个符合条件的数值，继续向下调试。我这边输入了32个1</p>




<p>可以看到，在执行lea语句后，esi被赋值成”SWPU_2019_CTF”</p>




<p>这边是与输入字符进行异或，ord(1) ^ ord(S) &#x3D; ord(‘b’)</p>




<p>可以在循环之外下断点，然后F9快速跳到断点出，再往下看，下面则是把数据依次压入栈：</p>




<p>再往下看，遇到一个函数，我们进入一个函数</p>


<p>F7跟进，我们遇到了xor，从0xae58b8地址读取数据赋给ecx，进行异或</p>


<p>选中下面的框框，我们选择在数据窗口中跟随地址</p>




<p>就能看到是什么数据进行对比了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string2 = [<span class="number">0x86</span>,<span class="number">0x0C</span>,<span class="number">0x3E</span>,<span class="number">0xCA</span>,<span class="number">0x98</span>,<span class="number">0xD7</span>,<span class="number">0xAE</span>,<span class="number">0x19</span>,<span class="number">0xE2</span>,<span class="number">0x77</span>,<span class="number">0x6B</span>,<span class="number">0xA6</span>,<span class="number">0x6A</span>,<span class="number">0xA1</span>,<span class="number">0x77</span>,<span class="number">0xB0</span>,<span class="number">0x69</span>,<span class="number">0x91</span>,<span class="number">0x37</span>,<span class="number">0x05</span>,<span class="number">0x7A</span>,<span class="number">0xF9</span>,<span class="number">0x7B</span>,<span class="number">0x30</span>,<span class="number">0x43</span>,<span class="number">0x5A</span>,<span class="number">0x4B</span>,<span class="number">0x10</span>,<span class="number">0x86</span>,<span class="number">0x7D</span>,<span class="number">0xD4</span>,<span class="number">0x28</span>]</span><br></pre></td></tr></table></figure>



<p>跳出这个函数之后，接着往下看：</p>




<p>开始了第三次异或，和第二次一样，我们只需要找这个地址的数据就行了</p>


<p>继续跟随数据窗口，跳转如下，我们找到了需要最终对比的数据了：</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">final = [<span class="number">0xB3</span>,<span class="number">0x37</span>,<span class="number">0x0F</span>,<span class="number">0xF8</span>,<span class="number">0xBC</span>,<span class="number">0xBC</span>,<span class="number">0xAE</span>,<span class="number">0x5D</span>,<span class="number">0xBA</span>,<span class="number">0x5A</span>,<span class="number">0x4D</span>,<span class="number">0x86</span>,<span class="number">0x44</span>,<span class="number">0x97</span>,<span class="number">0x62</span>,<span class="number">0xD3</span>,<span class="number">0x4F</span>,<span class="number">0xBA</span>,<span class="number">0x24</span>,<span class="number">0x16</span>,<span class="number">0x0B</span>,<span class="number">0x9F</span>,<span class="number">0x72</span>,<span class="number">0x1A</span>,<span class="number">0x65</span>,<span class="number">0x68</span>,<span class="number">0x6D</span>,<span class="number">0x26</span>,<span class="number">0xBA</span>,<span class="number">0x6B</span>,<span class="number">0xC8</span>,<span class="number">0x67</span>]</span><br></pre></td></tr></table></figure>

<p>最终脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 正  final[i] = input[i]^string1[i%13]^string2[i]</span></span><br><span class="line"><span class="comment"># 逆  input[i] = final[i]^string1[i%13]^string2[i]</span></span><br><span class="line"></span><br><span class="line">string1 = <span class="string">&quot;SWPU_2019_CTF&quot;</span></span><br><span class="line">string2 = [<span class="number">0x86</span>,<span class="number">0x0C</span>,<span class="number">0x3E</span>,<span class="number">0xCA</span>,<span class="number">0x98</span>,<span class="number">0xD7</span>,<span class="number">0xAE</span>,<span class="number">0x19</span>,<span class="number">0xE2</span>,<span class="number">0x77</span>,<span class="number">0x6B</span>,<span class="number">0xA6</span>,<span class="number">0x6A</span>,<span class="number">0xA1</span>,<span class="number">0x77</span>,<span class="number">0xB0</span>,<span class="number">0x69</span>,<span class="number">0x91</span>,<span class="number">0x37</span>,<span class="number">0x05</span>,<span class="number">0x7A</span>,<span class="number">0xF9</span>,<span class="number">0x7B</span>,<span class="number">0x30</span>,<span class="number">0x43</span>,<span class="number">0x5A</span>,<span class="number">0x4B</span>,<span class="number">0x10</span>,<span class="number">0x86</span>,<span class="number">0x7D</span>,<span class="number">0xD4</span>,<span class="number">0x28</span>]</span><br><span class="line">final = [<span class="number">0xB3</span>,<span class="number">0x37</span>,<span class="number">0x0F</span>,<span class="number">0xF8</span>,<span class="number">0xBC</span>,<span class="number">0xBC</span>,<span class="number">0xAE</span>,<span class="number">0x5D</span>,<span class="number">0xBA</span>,<span class="number">0x5A</span>,<span class="number">0x4D</span>,<span class="number">0x86</span>,<span class="number">0x44</span>,<span class="number">0x97</span>,<span class="number">0x62</span>,<span class="number">0xD3</span>,<span class="number">0x4F</span>,<span class="number">0xBA</span>,<span class="number">0x24</span>,<span class="number">0x16</span>,<span class="number">0x0B</span>,<span class="number">0x9F</span>,<span class="number">0x72</span>,<span class="number">0x1A</span>,<span class="number">0x65</span>,<span class="number">0x68</span>,<span class="number">0x6D</span>,<span class="number">0x26</span>,<span class="number">0xBA</span>,<span class="number">0x6B</span>,<span class="number">0xC8</span>,<span class="number">0x67</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(final[i] ^ <span class="built_in">ord</span>(string1[i%<span class="number">13</span>]) ^ string2[i])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{Y0uaretheB3st!#@_VirtualCC}</p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://blog.nowcoder.net/n/aa8086cbf8c54e3b8dd49c52e2fcefe0?from=nowcoder_improve">https://blog.nowcoder.net/n/aa8086cbf8c54e3b8dd49c52e2fcefe0?from=nowcoder_improve</a></p>
<h1 id="SCTF2019-babyre-花指令-三维迷宫-暗藏base64-？？？"><a href="#SCTF2019-babyre-花指令-三维迷宫-暗藏base64-？？？" class="headerlink" title="[SCTF2019]babyre (花指令+三维迷宫+暗藏base64+？？？)"></a>[SCTF2019]babyre (花指令+三维迷宫+暗藏base64+？？？)</h1><p>ida打开后一瞅，我就知道事情不简单</p>


<p>发现了海量的花指令</p>




<p>第一处：</p>


<p>修改之后</p>




<p>第二处，下面的jrcxz也需要nop掉(细节上出问题后面就得重修……)</p>




<p>第三处：</p>




<p>第四处：</p>
<p>E13处，in指令第二个字节C7是mov指令，就需要去把第一个字节给nop掉了</p>




<p>第五处：</p>




<p>所以说，一共 是五处花指令？</p>
<p>下面是转换main函数，快捷键P</p>




<p>这边的话，先d键，转换为数据，再c键，force转换为代码</p>






<p>（注意，需要把所有的花指令修完之后，再去转换main函数和C22函数，重复了n次，每次都再C22处JUMPOUT）</p>
<p>选中798到C21，按P键转换成函数，还原main函数</p>




<p>这边也类似，选中到c22，按住P键，就可以把刚刚的loc_C22声明成函数，之后就可以F5反汇编了</p>


<p>以下就是成功反汇编出的主函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [rsp+Fh] [rbp-151h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+10h] [rbp-150h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+14h] [rbp-14Ch]</span></span><br><span class="line">  <span class="type">char</span> *v7; <span class="comment">// [rsp+18h] [rbp-148h]</span></span><br><span class="line">  <span class="type">char</span> v8[<span class="number">10</span>]; <span class="comment">// [rsp+26h] [rbp-13Ah] BYREF</span></span><br><span class="line">  _QWORD input3[<span class="number">2</span>]; <span class="comment">// [rsp+30h] [rbp-130h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+40h] [rbp-120h]</span></span><br><span class="line">  __int64 input2[<span class="number">3</span>]; <span class="comment">// [rsp+50h] [rbp-110h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// [rsp+68h] [rbp-F8h]</span></span><br><span class="line">  __int64 v13[<span class="number">3</span>]; <span class="comment">// [rsp+70h] [rbp-F0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v14; <span class="comment">// [rsp+88h] [rbp-D8h]</span></span><br><span class="line">  __int64 input1[<span class="number">6</span>]; <span class="comment">// [rsp+90h] [rbp-D0h] BYREF</span></span><br><span class="line">  __int16 v16; <span class="comment">// [rsp+C0h] [rbp-A0h]</span></span><br><span class="line">  <span class="type">char</span> v17[<span class="number">136</span>]; <span class="comment">// [rsp+D0h] [rbp-90h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v18; <span class="comment">// [rsp+158h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v18 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(input2, <span class="number">0</span>, <span class="keyword">sizeof</span>(input2));</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v13, <span class="number">0</span>, <span class="keyword">sizeof</span>(v13));</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(input1, <span class="number">0</span>, <span class="keyword">sizeof</span>(input1));</span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(</span><br><span class="line">    v17,</span><br><span class="line">    <span class="string">&quot;**************.****.**s..*..******.****.***********..***..**..#*..***..***.********************.**..*******..**...*..*.*.**.*&quot;</span>);</span><br><span class="line">  input3[<span class="number">0</span>] = <span class="number">0LL</span>;</span><br><span class="line">  input3[<span class="number">1</span>] = <span class="number">0LL</span>;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v7 = &amp;v17[<span class="number">22</span>];</span><br><span class="line">  <span class="built_in">strcpy</span>(v8, <span class="string">&quot;sctf_9102&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>((<span class="type">const</span> <span class="type">char</span> *)(<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;plz tell me the shortest password1:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, input1);</span><br><span class="line">  v6 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = *((_BYTE *)input1 + v5);</span><br><span class="line">    <span class="keyword">switch</span> ( v4 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">        v7 -= <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">        v7 += <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">        ++v7;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">        --v7;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">        v7 += <span class="number">25</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">        v7 -= <span class="number">25</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        v6 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v5;</span><br><span class="line">    <span class="keyword">if</span> ( *v7 != <span class="number">46</span> &amp;&amp; *v7 != <span class="number">35</span> )</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( *v7 == <span class="number">35</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;good!you find the right way!\nBut there is another challenge!&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>((<span class="type">const</span> <span class="type">char</span> *)(<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;plz tell me the password2:&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, input2);</span><br><span class="line">    sub_C22(input2, v13);</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)sub_F67(v13, v8) == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Congratulation!&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>((<span class="type">const</span> <span class="type">char</span> *)(<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;Now,this is the last!&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;plz tell me the password3:&quot;</span>);</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, input3);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)sub_FFA(input3) == <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Congratulation!Here is your flag!:&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;sctf&#123;%s-%s(%s)&#125;&quot;</span>, (<span class="type">const</span> <span class="type">char</span> *)input1, (<span class="type">const</span> <span class="type">char</span> *)input2, (<span class="type">const</span> <span class="type">char</span> *)input3);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;something srong...&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;sorry,somthing wrong...&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;sorry,is&#x27;t not a right way...&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看出这是个迷宫题，而且看起来方向键很多，是三维迷宫，长度为125 &#x3D; 5 * 5 * 5</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">maze = <span class="string">&#x27;**************.****.**s..*..******.****.***********..***..**..#*..***..***.********************.**..*******..**...*..*.*.**.*&#x27;</span></span><br><span class="line"></span><br><span class="line">maze_3d = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    maze_3d.append(maze[<span class="number">5</span>*i:<span class="number">5</span>*(i+<span class="number">1</span>)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(maze_3d)+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> maze_3d[i]:</span><br><span class="line">        <span class="built_in">print</span>(j,end = <span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>





<p>得出：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input1 = <span class="string">&#x27;ddwwxssxaxwwaasasyywwdd&#x27;</span></span><br></pre></td></tr></table></figure>







<p>第二个挑战，就是每输入四个字符，就将其转换成3个字符：</p>


<p>下面附上<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46296905/article/details/115731435?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164655410816781683929544%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=164655410816781683929544&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-8-115731435.pc_search_result_cache&utm_term=%5BSCTTF2019%5Dbabyre&spm=1018.2226.3001.4187">大佬的爆破代码</a>：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> data[<span class="number">128</span>] = &#123;</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x3E</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x3F</span>,</span><br><span class="line">    <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x3A</span>, <span class="number">0x3B</span>,</span><br><span class="line">    <span class="number">0x3C</span>, <span class="number">0x3D</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x40</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>,</span><br><span class="line">    <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>,</span><br><span class="line">    <span class="number">0x0F</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>,</span><br><span class="line">    <span class="number">0x17</span>, <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>,</span><br><span class="line">    <span class="number">0x7F</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x1C</span>, <span class="number">0x1D</span>, <span class="number">0x1E</span>, <span class="number">0x1F</span>, <span class="number">0x20</span>,</span><br><span class="line">    <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x23</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x27</span>, <span class="number">0x28</span>,</span><br><span class="line">    <span class="number">0x29</span>, <span class="number">0x2A</span>, <span class="number">0x2B</span>, <span class="number">0x2C</span>, <span class="number">0x2D</span>, <span class="number">0x2E</span>, <span class="number">0x2F</span>, <span class="number">0x30</span>,</span><br><span class="line">    <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> shuju[<span class="number">3</span>] = &#123; <span class="number">0x736374</span>,<span class="number">0x665f39</span>,<span class="number">0x313032</span> &#125;;</span><br><span class="line">    <span class="type">int</span> i0, i1, i2, i3, i4, i5;</span><br><span class="line">    <span class="keyword">for</span> (i0 = <span class="number">0</span>; i0 &lt; <span class="number">3</span>; i0++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i1=<span class="number">32</span>;i1&lt;<span class="number">128</span>;i1++)</span><br><span class="line">            <span class="keyword">for</span> (i2 = <span class="number">32</span>; i2 &lt; <span class="number">128</span>; i2++)</span><br><span class="line">                <span class="keyword">for</span> (i3 = <span class="number">32</span>; i3 &lt; <span class="number">128</span>; i3++)</span><br><span class="line">                    <span class="keyword">for</span> (i4 = <span class="number">32</span>; i4 &lt; <span class="number">128</span>; i4++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        i5 = (((((data[i1] &lt;&lt; <span class="number">6</span>) | data[i2]) &lt;&lt; <span class="number">6</span>) | data[i3]) &lt;&lt; <span class="number">6</span>) | data[i4];</span><br><span class="line">                        <span class="keyword">if</span> (i5 == shuju[i0])</span><br><span class="line">                            <span class="built_in">printf</span>(<span class="string">&quot;第%d组：%c%c%c%c\n&quot;</span>, i0+<span class="number">1</span>,i1, i2, i3, i4);</span><br><span class="line">                    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>每个都带进入算了一遍，得知：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input2 = <span class="string">&quot;c2N0Zl85MTAy&quot;</span></span><br></pre></td></tr></table></figure>





<p>麻了，每四位转换成3位，就是唯一不同的地方是，缺4补上@，就是base64加密啊……</p>


<p>最后进入第三个challenge，参考的是<a target="_blank" rel="noopener" href="http://81.69.232.121/sctf2019babyre/">这位大佬</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_FFA</span><span class="params">(<span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [rsp+18h] [rbp-158h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+18h] [rbp-158h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+1Ch] [rbp-154h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+24h] [rbp-14Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+28h] [rbp-148h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [rsp+2Ch] [rbp-144h]</span></span><br><span class="line">  <span class="type">int</span> v8[<span class="number">16</span>]; <span class="comment">// [rsp+30h] [rbp-140h]</span></span><br><span class="line">  <span class="type">int</span> v9[<span class="number">16</span>]; <span class="comment">// [rsp+70h] [rbp-100h]</span></span><br><span class="line">  <span class="type">int</span> v10[<span class="number">26</span>]; <span class="comment">// [rsp+B0h] [rbp-C0h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v11; <span class="comment">// [rsp+118h] [rbp-58h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v12; <span class="comment">// [rsp+11Ch] [rbp-54h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v13; <span class="comment">// [rsp+120h] [rbp-50h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v14; <span class="comment">// [rsp+124h] [rbp-4Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v15; <span class="comment">// [rsp+168h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v15 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v8[<span class="number">0</span>] = <span class="number">190</span>;</span><br><span class="line">  v8[<span class="number">1</span>] = <span class="number">4</span>;</span><br><span class="line">  v8[<span class="number">2</span>] = <span class="number">6</span>;</span><br><span class="line">  v8[<span class="number">3</span>] = <span class="number">128</span>;</span><br><span class="line">  v8[<span class="number">4</span>] = <span class="number">197</span>;</span><br><span class="line">  v8[<span class="number">5</span>] = <span class="number">175</span>;</span><br><span class="line">  v8[<span class="number">6</span>] = <span class="number">118</span>;</span><br><span class="line">  v8[<span class="number">7</span>] = <span class="number">71</span>;</span><br><span class="line">  v8[<span class="number">8</span>] = <span class="number">159</span>;</span><br><span class="line">  v8[<span class="number">9</span>] = <span class="number">204</span>;</span><br><span class="line">  v8[<span class="number">10</span>] = <span class="number">64</span>;</span><br><span class="line">  v8[<span class="number">11</span>] = <span class="number">31</span>;</span><br><span class="line">  v8[<span class="number">12</span>] = <span class="number">216</span>;</span><br><span class="line">  v8[<span class="number">13</span>] = <span class="number">191</span>;</span><br><span class="line">  v8[<span class="number">14</span>] = <span class="number">146</span>;</span><br><span class="line">  v8[<span class="number">15</span>] = <span class="number">239</span>;</span><br><span class="line">  v5 = (a1[<span class="number">6</span>] &lt;&lt; <span class="number">8</span>) | (a1[<span class="number">5</span>] &lt;&lt; <span class="number">16</span>) | (a1[<span class="number">4</span>] &lt;&lt; <span class="number">24</span>) | a1[<span class="number">7</span>];</span><br><span class="line">  v6 = (a1[<span class="number">10</span>] &lt;&lt; <span class="number">8</span>) | (a1[<span class="number">9</span>] &lt;&lt; <span class="number">16</span>) | (a1[<span class="number">8</span>] &lt;&lt; <span class="number">24</span>) | a1[<span class="number">11</span>];</span><br><span class="line">  v7 = (a1[<span class="number">14</span>] &lt;&lt; <span class="number">8</span>) | (a1[<span class="number">13</span>] &lt;&lt; <span class="number">16</span>) | (a1[<span class="number">12</span>] &lt;&lt; <span class="number">24</span>) | a1[<span class="number">15</span>];</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v2 = <span class="number">4</span>;</span><br><span class="line">  v10[<span class="number">0</span>] = sub_78A((a1[<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | (a1[<span class="number">1</span>] &lt;&lt; <span class="number">16</span>) | (*a1 &lt;&lt; <span class="number">24</span>) | a1[<span class="number">3</span>]);</span><br><span class="line">  v10[<span class="number">1</span>] = sub_78A(v5);</span><br><span class="line">  v10[<span class="number">2</span>] = sub_78A(v6);</span><br><span class="line">  v10[<span class="number">3</span>] = sub_78A(v7);</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v10[v2] = sub_143B(v10[v4], v10[v4 + <span class="number">1</span>], v10[v4 + <span class="number">2</span>], v10[v4 + <span class="number">3</span>]);</span><br><span class="line">    ++v4;</span><br><span class="line">    ++v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v2 &lt;= <span class="number">29</span> );</span><br><span class="line">  v9[<span class="number">0</span>] = HIBYTE(v11);</span><br><span class="line">  v9[<span class="number">1</span>] = BYTE2(v11);</span><br><span class="line">  v9[<span class="number">2</span>] = BYTE1(v11);</span><br><span class="line">  v9[<span class="number">3</span>] = v11;</span><br><span class="line">  v9[<span class="number">4</span>] = HIBYTE(v12);</span><br><span class="line">  v9[<span class="number">5</span>] = BYTE2(v12);</span><br><span class="line">  v9[<span class="number">6</span>] = BYTE1(v12);</span><br><span class="line">  v9[<span class="number">7</span>] = v12;</span><br><span class="line">  v9[<span class="number">8</span>] = HIBYTE(v13);</span><br><span class="line">  v9[<span class="number">9</span>] = BYTE2(v13);</span><br><span class="line">  v9[<span class="number">10</span>] = BYTE1(v13);</span><br><span class="line">  v9[<span class="number">11</span>] = v13;</span><br><span class="line">  v9[<span class="number">12</span>] = HIBYTE(v14);</span><br><span class="line">  v9[<span class="number">13</span>] = BYTE2(v14);</span><br><span class="line">  v9[<span class="number">14</span>] = BYTE1(v14);</span><br><span class="line">  v9[<span class="number">15</span>] = v14;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v9[i] != v8[i] )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>跟进这个函数</p>


<p>因为v2 初始等于 4 , v4 初始等于 0 ，上面的代码就可以转换成：</p>
<p>v10[n+4] &#x3D; v10[n] ^ function(v10[a+1] ^ v10[a+2] ^ v10[a+3])</p>
<p>根据交换律</p>
<p>&#x3D;&#x3D;&gt;v10[n] &#x3D; v10[n+4] ^ function(v10[a+1] ^ v10[a+2] ^ v10[a+3])</p>
<p>这样就可以通过后四位逆推前一位（心态已经崩了）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">v3 = [<span class="number">214</span>, <span class="number">144</span>, <span class="number">233</span>, <span class="number">254</span>, <span class="number">204</span>, <span class="number">225</span>, <span class="number">61</span>, <span class="number">183</span>, <span class="number">22</span>, <span class="number">182</span>, <span class="number">20</span>, <span class="number">194</span>, <span class="number">40</span>, <span class="number">251</span>, <span class="number">44</span>, <span class="number">5</span>, <span class="number">43</span>, <span class="number">103</span>, <span class="number">154</span>, <span class="number">118</span>, <span class="number">42</span>, <span class="number">190</span>, <span class="number">4</span>, <span class="number">195</span>, <span class="number">170</span>, <span class="number">68</span>, <span class="number">19</span>, <span class="number">38</span>, <span class="number">73</span>, <span class="number">134</span>, <span class="number">6</span>, <span class="number">153</span>, <span class="number">156</span>, <span class="number">66</span>, <span class="number">80</span>, <span class="number">244</span>, <span class="number">145</span>, <span class="number">239</span>, <span class="number">152</span>, <span class="number">122</span>, <span class="number">51</span>, <span class="number">84</span>, <span class="number">11</span>, <span class="number">67</span>, <span class="number">237</span>, <span class="number">207</span>, <span class="number">172</span>, <span class="number">98</span>, <span class="number">228</span>, <span class="number">179</span>, <span class="number">28</span>, <span class="number">169</span>, <span class="number">201</span>, <span class="number">8</span>, <span class="number">232</span>, <span class="number">149</span>, <span class="number">128</span>, <span class="number">223</span>, <span class="number">148</span>, <span class="number">250</span>, <span class="number">117</span>, <span class="number">143</span>, <span class="number">63</span>, <span class="number">166</span>, <span class="number">71</span>, <span class="number">7</span>, <span class="number">167</span>, <span class="number">252</span>, <span class="number">243</span>, <span class="number">115</span>, <span class="number">23</span>, <span class="number">186</span>, <span class="number">131</span>, <span class="number">89</span>, <span class="number">60</span>, <span class="number">25</span>, <span class="number">230</span>, <span class="number">133</span>, <span class="number">79</span>, <span class="number">168</span>, <span class="number">104</span>, <span class="number">107</span>, <span class="number">129</span>, <span class="number">178</span>, <span class="number">113</span>, <span class="number">100</span>, <span class="number">218</span>, <span class="number">139</span>, <span class="number">248</span>, <span class="number">235</span>, <span class="number">15</span>, <span class="number">75</span>, <span class="number">112</span>, <span class="number">86</span>, <span class="number">157</span>, <span class="number">53</span>, <span class="number">30</span>, <span class="number">36</span>, <span class="number">14</span>, <span class="number">94</span>, <span class="number">99</span>, <span class="number">88</span>, <span class="number">209</span>, <span class="number">162</span>, <span class="number">37</span>, <span class="number">34</span>, <span class="number">124</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">33</span>, <span class="number">120</span>, <span class="number">135</span>, <span class="number">212</span>, <span class="number">0</span>, <span class="number">70</span>, <span class="number">87</span>, <span class="number">159</span>, <span class="number">211</span>, <span class="number">39</span>, <span class="number">82</span>, <span class="number">76</span>, <span class="number">54</span>, <span class="number">2</span>, <span class="number">231</span>, <span class="number">160</span>, <span class="number">196</span>, <span class="number">200</span>, <span class="number">158</span>, <span class="number">234</span>, <span class="number">191</span>, <span class="number">138</span>, <span class="number">210</span>, <span class="number">64</span>, <span class="number">199</span>, <span class="number">56</span>, <span class="number">181</span>, <span class="number">163</span>, <span class="number">247</span>, <span class="number">242</span>, <span class="number">206</span>, <span class="number">249</span>, <span class="number">97</span>, <span class="number">21</span>, <span class="number">161</span>, <span class="number">224</span>, <span class="number">174</span>, <span class="number">93</span>, <span class="number">164</span>, <span class="number">155</span>, <span class="number">52</span>, <span class="number">26</span>, <span class="number">85</span>, <span class="number">173</span>, <span class="number">147</span>, <span class="number">50</span>, <span class="number">48</span>, <span class="number">245</span>, <span class="number">140</span>, <span class="number">177</span>, <span class="number">227</span>, <span class="number">29</span>, <span class="number">246</span>, <span class="number">226</span>, <span class="number">46</span>, <span class="number">130</span>, <span class="number">102</span>, <span class="number">202</span>, <span class="number">96</span>, <span class="number">192</span>, <span class="number">41</span>, <span class="number">35</span>, <span class="number">171</span>, <span class="number">13</span>, <span class="number">83</span>, <span class="number">78</span>, <span class="number">111</span>, <span class="number">213</span>, <span class="number">219</span>, <span class="number">55</span>, <span class="number">69</span>, <span class="number">222</span>, <span class="number">253</span>, <span class="number">142</span>, <span class="number">47</span>, <span class="number">3</span>, <span class="number">255</span>, <span class="number">106</span>, <span class="number">114</span>, <span class="number">109</span>, <span class="number">108</span>, <span class="number">91</span>, <span class="number">81</span>, <span class="number">141</span>, <span class="number">27</span>, <span class="number">175</span>, <span class="number">146</span>, <span class="number">187</span>, <span class="number">221</span>, <span class="number">188</span>, <span class="number">127</span>, <span class="number">17</span>, <span class="number">217</span>, <span class="number">92</span>, <span class="number">65</span>, <span class="number">31</span>, <span class="number">16</span>, <span class="number">90</span>, <span class="number">216</span>, <span class="number">10</span>, <span class="number">193</span>, <span class="number">49</span>, <span class="number">136</span>, <span class="number">165</span>, <span class="number">205</span>, <span class="number">123</span>, <span class="number">189</span>, <span class="number">45</span>, <span class="number">116</span>, <span class="number">208</span>, <span class="number">18</span>, <span class="number">184</span>, <span class="number">229</span>, <span class="number">180</span>, <span class="number">176</span>, <span class="number">137</span>, <span class="number">105</span>, <span class="number">151</span>, <span class="number">74</span>, <span class="number">12</span>, <span class="number">150</span>, <span class="number">119</span>, <span class="number">126</span>, <span class="number">101</span>, <span class="number">185</span>, <span class="number">241</span>, <span class="number">9</span>, <span class="number">197</span>, <span class="number">110</span>, <span class="number">198</span>, <span class="number">132</span>, <span class="number">24</span>, <span class="number">240</span>, <span class="number">125</span>, <span class="number">236</span>, <span class="number">58</span>, <span class="number">220</span>, <span class="number">77</span>, <span class="number">32</span>, <span class="number">121</span>, <span class="number">238</span>, <span class="number">95</span>, <span class="number">62</span>, <span class="number">215</span>, <span class="number">203</span>, <span class="number">57</span>, <span class="number">72</span>, <span class="number">198</span>, <span class="number">186</span>, <span class="number">177</span>, <span class="number">163</span>, <span class="number">80</span>, <span class="number">51</span>, <span class="number">170</span>, <span class="number">86</span>, <span class="number">151</span>, <span class="number">145</span>, <span class="number">125</span>, <span class="number">103</span>, <span class="number">220</span>, <span class="number">34</span>, <span class="number">112</span>, <span class="number">178</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HIBYTE</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">return</span> a&gt;&gt;(<span class="number">8</span>*<span class="number">3</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">BYTE2</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">return</span> (a&gt;&gt;(<span class="number">8</span>*<span class="number">2</span>))%<span class="number">256</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">BYTE1</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">return</span> (a&gt;&gt;<span class="number">8</span>)%<span class="number">256</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LOBYTE</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">return</span> a%<span class="number">256</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rol</span>(<span class="params">value, time</span>):</span><br><span class="line">    <span class="keyword">if</span> (time == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    a = (value &amp; (<span class="number">1</span> &lt;&lt; <span class="number">31</span>)) &gt;&gt; <span class="number">31</span></span><br><span class="line">    value &lt;&lt;= <span class="number">1</span></span><br><span class="line">    value &amp;= (<span class="number">1</span> &lt;&lt; <span class="number">32</span>) - <span class="number">1</span></span><br><span class="line">    value += a</span><br><span class="line">    <span class="keyword">return</span> rol(value, time - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ror</span>(<span class="params">value, time</span>):</span><br><span class="line">    <span class="keyword">if</span> (time == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    a = (value &amp; (<span class="number">1</span>)) &lt;&lt; <span class="number">31</span></span><br><span class="line">    value &gt;&gt;= <span class="number">1</span></span><br><span class="line">    value += a</span><br><span class="line">    <span class="keyword">return</span> ror(value, time - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_55B683001464</span>(<span class="params">a</span>):</span><br><span class="line">    v2 = (v3[BYTE2(a)]&lt;&lt;<span class="number">16</span>)|v3[LOBYTE(a)]|(v3[BYTE1(a)]&lt;&lt;<span class="number">8</span>)|(v3[HIBYTE(a)]&lt;&lt;<span class="number">24</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> rol(v2,<span class="number">12</span>)^rol(v2,<span class="number">8</span>)^ror(v2,<span class="number">2</span>)^ror(v2,<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_55B68300143B</span>(<span class="params">a, b, c, d</span>):</span><br><span class="line">    <span class="keyword">return</span> a ^ sub_55B683001464(b ^ c ^ d)</span><br><span class="line"></span><br><span class="line">vx = [<span class="number">190</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">128</span>,<span class="number">197</span>,<span class="number">175</span>,<span class="number">118</span>,<span class="number">71</span>,<span class="number">159</span>,<span class="number">204</span>,<span class="number">64</span>,<span class="number">31</span>,<span class="number">216</span>,<span class="number">191</span>,<span class="number">146</span>,<span class="number">239</span>]</span><br><span class="line">v8 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    x = vx[i*<span class="number">4</span>]</span><br><span class="line">    x &lt;&lt;= <span class="number">8</span></span><br><span class="line">    x += vx[i*<span class="number">4</span>+<span class="number">1</span>]</span><br><span class="line">    x &lt;&lt;= <span class="number">8</span></span><br><span class="line">    x += vx[i*<span class="number">4</span>+<span class="number">2</span>]</span><br><span class="line">    x &lt;&lt;= <span class="number">8</span></span><br><span class="line">    x += vx[i*<span class="number">4</span>+<span class="number">3</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(x))</span><br><span class="line">    v8.append(x)</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span> = [<span class="number">0</span>]*<span class="number">30</span></span><br><span class="line"><span class="built_in">input</span>[<span class="number">26</span>] = v8[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">input</span>[<span class="number">27</span>] = v8[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">input</span>[<span class="number">28</span>] = v8[<span class="number">2</span>]</span><br><span class="line"><span class="built_in">input</span>[<span class="number">29</span>] = v8[<span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="built_in">input</span>[<span class="number">25</span>-i] = <span class="built_in">input</span>[<span class="number">25</span>-i+<span class="number">4</span>]^sub_55B683001464(<span class="built_in">input</span>[<span class="number">25</span>-i+<span class="number">3</span>]^<span class="built_in">input</span>[<span class="number">25</span>-i+<span class="number">2</span>]^<span class="built_in">input</span>[<span class="number">25</span>-i+<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    x = libnum.n2s(<span class="built_in">input</span>[i]).decode()</span><br><span class="line">    x = <span class="built_in">list</span>(x)</span><br><span class="line">    x.reverse()</span><br><span class="line">    x = <span class="string">&#x27;&#x27;</span>.join(x)</span><br><span class="line">    flag += x</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>




<p>所以最后的flag为：</p>
<p><strong>sctf{ddwwxxssxaxwwaasasyywwdd-c2N0Zl85MTAy(fl4g_is_s0_ug1y!)}</strong></p>
<h1 id="Ecquation-js-fuck加密-z3"><a href="#Ecquation-js-fuck加密-z3" class="headerlink" title="Ecquation (js fuck加密+z3)"></a>Ecquation (js fuck加密+z3)</h1><p><a target="_blank" rel="noopener" href="http://codertab.com/JsUnFuck">http://codertab.com/JsUnFuck</a></p>
<p>题目中提示这个是Js的fuck加密，可以在网站上一个一个的解密，当然也可以用脚本跑</p>
<p>在网上找了一份关于此的解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">function deEquation(<span class="built_in">str</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (let i = <span class="number">0</span>; i &lt;= <span class="number">1</span>; i++) &#123;</span><br><span class="line">  <span class="built_in">str</span> = <span class="built_in">str</span>.replace(/l\[(\D*?)](\+l|-l|==)/g, (m, a, b) =&gt; <span class="string">&#x27;l[&#x27;</span> + <span class="built_in">eval</span>(a) + <span class="string">&#x27;]&#x27;</span> + b);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">str</span> = <span class="built_in">str</span>.replace(/==(\D*?)&amp;&amp;/g, (m, a) =&gt; <span class="string">&#x27;==&#x27;</span> + <span class="built_in">eval</span>(a) + <span class="string">&#x27;&amp;&amp;&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">str</span>;</span><br><span class="line">&#125;</span><br><span class="line">s=<span class="string">&quot;l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]+l[+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+[]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[+[]]==+(+!+[]+[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(+!+[]+[+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+[+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]-l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]==+(+!+[]+[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]==-+(!+[]+!+[]+!+[]+[+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+[]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]])&amp;&amp;l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]==+(!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]+l[+!+[]+[!+[]+!+[]]]+l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(+!+[]+[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]==+(+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==+(+!+[]+[+[]+[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]==+(!+[]+!+[]+!+[]+[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]]+l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[+[]]]==-+(+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+[]]-l[!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]]==-+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+[+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+!+[]]==-+(!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+[+!+[]+[!+[]+!+[]]])&amp;&amp;l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]])&amp;&amp;l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+!+[]]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]]-l[+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[+[]]+l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==+(+!+[]+[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]==-+(+!+[]+[!+[]+!+[]+[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]==-+(+!+[]+[+!+[]+[!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+[+[]]])&amp;&amp;l[+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]+l[+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]+l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+[+[]+[!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]])&amp;&amp;l[+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(+!+[]+[!+[]+!+[]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]])&quot;</span>;</span><br><span class="line">ss=deEquation(s);</span><br><span class="line">document.write(ss);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>解出来之后：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">l[<span class="number">40</span>]+l[<span class="number">35</span>]+l[<span class="number">34</span>]-l[<span class="number">0</span>]-l[<span class="number">15</span>]-l[<span class="number">37</span>]+l[<span class="number">7</span>]+l[<span class="number">6</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]+l[<span class="number">19</span>]+l[<span class="number">8</span>]-l[<span class="number">17</span>]-l[<span class="number">14</span>]-l[<span class="number">38</span>]+l[<span class="number">1</span>]-l[<span class="number">9</span>]+l[<span class="number">22</span>]+l[<span class="number">41</span>]+l[<span class="number">3</span>]-l[<span class="number">29</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]+l[<span class="number">5</span>]+l[<span class="number">32</span>]-l[<span class="number">16</span>]+l[<span class="number">12</span>]-l[<span class="number">24</span>]+l[<span class="number">30</span>]+l[<span class="number">39</span>]+l[<span class="number">10</span>]+l[<span class="number">2</span>]+l[<span class="number">27</span>]+l[<span class="number">28</span>]+l[<span class="number">21</span>]+l[<span class="number">33</span>]-l[<span class="number">18</span>]+l[<span class="number">4</span>]==<span class="number">861</span>&amp;&amp;l[<span class="number">31</span>]+l[<span class="number">26</span>]+l[<span class="number">11</span>]-l[<span class="number">33</span>]+l[<span class="number">27</span>]-l[<span class="number">3</span>]+l[<span class="number">12</span>]+l[<span class="number">30</span>]+l[<span class="number">1</span>]+l[<span class="number">32</span>]-l[<span class="number">16</span>]+l[<span class="number">7</span>]+l[<span class="number">10</span>]-l[<span class="number">25</span>]+l[<span class="number">38</span>]-l[<span class="number">41</span>]-l[<span class="number">14</span>]-l[<span class="number">19</span>]+l[<span class="number">29</span>]+l[<span class="number">36</span>]-l[<span class="number">9</span>]-l[<span class="number">28</span>]-l[<span class="number">6</span>]-l[<span class="number">0</span>]-l[<span class="number">22</span>]-l[<span class="number">18</span>]+l[<span class="number">20</span>]-l[<span class="number">37</span>]+l[<span class="number">4</span>]-l[<span class="number">24</span>]+l[<span class="number">34</span>]-l[<span class="number">21</span>]-l[<span class="number">39</span>]-l[<span class="number">23</span>]-l[<span class="number">8</span>]-l[<span class="number">40</span>]+l[<span class="number">15</span>]-l[<span class="number">35</span>]==-<span class="number">448</span>&amp;&amp;l[<span class="number">26</span>]+l[<span class="number">14</span>]+l[<span class="number">15</span>]+l[<span class="number">9</span>]+l[<span class="number">13</span>]+l[<span class="number">30</span>]-l[<span class="number">11</span>]+l[<span class="number">18</span>]+l[<span class="number">23</span>]+l[<span class="number">7</span>]+l[<span class="number">3</span>]+l[<span class="number">12</span>]+l[<span class="number">25</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]-l[<span class="number">35</span>]-l[<span class="number">20</span>]+l[<span class="number">40</span>]-l[<span class="number">8</span>]+l[<span class="number">10</span>]-l[<span class="number">5</span>]-l[<span class="number">33</span>]-l[<span class="number">31</span>]+l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">21</span>]-l[<span class="number">6</span>]+l[<span class="number">1</span>]+l[<span class="number">16</span>]+l[<span class="number">17</span>]+l[<span class="number">29</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">36</span>]+l[<span class="number">41</span>]+l[<span class="number">38</span>]+l[<span class="number">2</span>]+l[<span class="number">0</span>]==<span class="number">1244</span>&amp;&amp;l[<span class="number">5</span>]+l[<span class="number">22</span>]+l[<span class="number">15</span>]+l[<span class="number">2</span>]-l[<span class="number">28</span>]-l[<span class="number">10</span>]-l[<span class="number">3</span>]-l[<span class="number">13</span>]-l[<span class="number">18</span>]+l[<span class="number">30</span>]-l[<span class="number">9</span>]+l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">34</span>]+l[<span class="number">23</span>]-l[<span class="number">17</span>]+l[<span class="number">16</span>]-l[<span class="number">7</span>]+l[<span class="number">24</span>]-l[<span class="number">39</span>]+l[<span class="number">8</span>]-l[<span class="number">12</span>]-l[<span class="number">40</span>]-l[<span class="number">25</span>]+l[<span class="number">37</span>]-l[<span class="number">35</span>]+l[<span class="number">11</span>]-l[<span class="number">14</span>]+l[<span class="number">20</span>]-l[<span class="number">27</span>]+l[<span class="number">4</span>]-l[<span class="number">33</span>]-l[<span class="number">21</span>]+l[<span class="number">31</span>]-l[<span class="number">6</span>]+l[<span class="number">1</span>]+l[<span class="number">38</span>]-l[<span class="number">29</span>]==-<span class="number">39</span>&amp;&amp;l[<span class="number">41</span>]-l[<span class="number">29</span>]+l[<span class="number">23</span>]-l[<span class="number">4</span>]+l[<span class="number">20</span>]-l[<span class="number">33</span>]+l[<span class="number">35</span>]+l[<span class="number">3</span>]-l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">11</span>]+l[<span class="number">26</span>]-l[<span class="number">24</span>]-l[<span class="number">17</span>]+l[<span class="number">37</span>]+l[<span class="number">1</span>]+l[<span class="number">16</span>]-l[<span class="number">0</span>]-l[<span class="number">13</span>]+l[<span class="number">7</span>]+l[<span class="number">10</span>]+l[<span class="number">14</span>]+l[<span class="number">22</span>]+l[<span class="number">39</span>]-l[<span class="number">40</span>]+l[<span class="number">34</span>]-l[<span class="number">38</span>]+l[<span class="number">32</span>]+l[<span class="number">25</span>]-l[<span class="number">2</span>]+l[<span class="number">15</span>]+l[<span class="number">6</span>]+l[<span class="number">28</span>]-l[<span class="number">8</span>]-l[<span class="number">5</span>]-l[<span class="number">31</span>]-l[<span class="number">30</span>]-l[<span class="number">27</span>]==<span class="number">485</span>&amp;&amp;l[<span class="number">13</span>]+l[<span class="number">19</span>]+l[<span class="number">21</span>]-l[<span class="number">2</span>]-l[<span class="number">33</span>]-l[<span class="number">0</span>]+l[<span class="number">39</span>]+l[<span class="number">31</span>]-l[<span class="number">23</span>]-l[<span class="number">41</span>]+l[<span class="number">38</span>]-l[<span class="number">29</span>]+l[<span class="number">36</span>]+l[<span class="number">24</span>]-l[<span class="number">20</span>]-l[<span class="number">9</span>]-l[<span class="number">32</span>]+l[<span class="number">37</span>]-l[<span class="number">35</span>]+l[<span class="number">40</span>]+l[<span class="number">7</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">10</span>]-l[<span class="number">6</span>]-l[<span class="number">16</span>]-l[<span class="number">4</span>]-l[<span class="number">5</span>]-l[<span class="number">30</span>]-l[<span class="number">14</span>]-l[<span class="number">22</span>]-l[<span class="number">25</span>]-l[<span class="number">34</span>]-l[<span class="number">17</span>]-l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">1</span>]-l[<span class="number">28</span>]==-<span class="number">1068</span>&amp;&amp;l[<span class="number">32</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]+l[<span class="number">14</span>]+l[<span class="number">11</span>]+l[<span class="number">18</span>]-l[<span class="number">13</span>]+l[<span class="number">24</span>]-l[<span class="number">2</span>]-l[<span class="number">15</span>]+l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">1</span>]+l[<span class="number">39</span>]-l[<span class="number">8</span>]-l[<span class="number">3</span>]+l[<span class="number">33</span>]+l[<span class="number">6</span>]-l[<span class="number">5</span>]-l[<span class="number">35</span>]-l[<span class="number">28</span>]+l[<span class="number">25</span>]-l[<span class="number">41</span>]+l[<span class="number">22</span>]-l[<span class="number">17</span>]+l[<span class="number">10</span>]+l[<span class="number">40</span>]+l[<span class="number">34</span>]+l[<span class="number">27</span>]-l[<span class="number">20</span>]+l[<span class="number">23</span>]+l[<span class="number">31</span>]-l[<span class="number">16</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">30</span>]+l[<span class="number">29</span>]-l[<span class="number">4</span>]==<span class="number">939</span>&amp;&amp;l[<span class="number">19</span>]+l[<span class="number">11</span>]+l[<span class="number">20</span>]-l[<span class="number">16</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]+l[<span class="number">1</span>]-l[<span class="number">31</span>]+l[<span class="number">28</span>]-l[<span class="number">23</span>]+l[<span class="number">14</span>]-l[<span class="number">9</span>]-l[<span class="number">27</span>]+l[<span class="number">35</span>]+l[<span class="number">39</span>]-l[<span class="number">37</span>]-l[<span class="number">8</span>]-l[<span class="number">22</span>]+l[<span class="number">5</span>]-l[<span class="number">6</span>]+l[<span class="number">0</span>]-l[<span class="number">32</span>]+l[<span class="number">24</span>]+l[<span class="number">33</span>]+l[<span class="number">29</span>]+l[<span class="number">38</span>]+l[<span class="number">15</span>]-l[<span class="number">2</span>]+l[<span class="number">30</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">3</span>]-l[<span class="number">17</span>]+l[<span class="number">34</span>]+l[<span class="number">41</span>]-l[<span class="number">4</span>]-l[<span class="number">13</span>]-l[<span class="number">26</span>]==<span class="number">413</span>&amp;&amp;l[<span class="number">22</span>]+l[<span class="number">4</span>]-l[<span class="number">9</span>]+l[<span class="number">34</span>]+l[<span class="number">35</span>]+l[<span class="number">17</span>]+l[<span class="number">3</span>]-l[<span class="number">24</span>]+l[<span class="number">38</span>]-l[<span class="number">5</span>]-l[<span class="number">41</span>]-l[<span class="number">31</span>]-l[<span class="number">0</span>]-l[<span class="number">25</span>]+l[<span class="number">33</span>]+l[<span class="number">15</span>]-l[<span class="number">1</span>]-l[<span class="number">10</span>]+l[<span class="number">16</span>]-l[<span class="number">29</span>]-l[<span class="number">12</span>]+l[<span class="number">26</span>]-l[<span class="number">39</span>]-l[<span class="number">21</span>]-l[<span class="number">18</span>]-l[<span class="number">6</span>]-l[<span class="number">40</span>]-l[<span class="number">13</span>]+l[<span class="number">8</span>]+l[<span class="number">37</span>]+l[<span class="number">19</span>]+l[<span class="number">14</span>]+l[<span class="number">32</span>]+l[<span class="number">28</span>]-l[<span class="number">11</span>]+l[<span class="number">23</span>]+l[<span class="number">36</span>]+l[<span class="number">7</span>]==<span class="number">117</span>&amp;&amp;l[<span class="number">32</span>]+l[<span class="number">16</span>]+l[<span class="number">3</span>]+l[<span class="number">11</span>]+l[<span class="number">34</span>]-l[<span class="number">31</span>]+l[<span class="number">14</span>]+l[<span class="number">25</span>]+l[<span class="number">1</span>]-l[<span class="number">30</span>]-l[<span class="number">33</span>]-l[<span class="number">40</span>]-l[<span class="number">4</span>]-l[<span class="number">29</span>]+l[<span class="number">18</span>]-l[<span class="number">27</span>]+l[<span class="number">13</span>]-l[<span class="number">19</span>]-l[<span class="number">12</span>]+l[<span class="number">23</span>]-l[<span class="number">39</span>]-l[<span class="number">41</span>]-l[<span class="number">8</span>]+l[<span class="number">22</span>]-l[<span class="number">5</span>]-l[<span class="number">38</span>]-l[<span class="number">9</span>]-l[<span class="number">37</span>]+l[<span class="number">17</span>]-l[<span class="number">36</span>]+l[<span class="number">24</span>]-l[<span class="number">21</span>]+l[<span class="number">2</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]-l[<span class="number">7</span>]+l[<span class="number">35</span>]-l[<span class="number">0</span>]==-<span class="number">313</span>&amp;&amp;l[<span class="number">40</span>]-l[<span class="number">1</span>]+l[<span class="number">5</span>]+l[<span class="number">7</span>]+l[<span class="number">33</span>]+l[<span class="number">29</span>]+l[<span class="number">12</span>]+l[<span class="number">38</span>]-l[<span class="number">31</span>]+l[<span class="number">2</span>]+l[<span class="number">14</span>]-l[<span class="number">35</span>]-l[<span class="number">8</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]-l[<span class="number">9</span>]-l[<span class="number">28</span>]+l[<span class="number">23</span>]-l[<span class="number">17</span>]-l[<span class="number">22</span>]-l[<span class="number">26</span>]+l[<span class="number">32</span>]-l[<span class="number">11</span>]+l[<span class="number">4</span>]-l[<span class="number">36</span>]+l[<span class="number">10</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]-l[<span class="number">16</span>]+l[<span class="number">6</span>]-l[<span class="number">0</span>]+l[<span class="number">3</span>]-l[<span class="number">30</span>]+l[<span class="number">37</span>]-l[<span class="number">19</span>]+l[<span class="number">21</span>]+l[<span class="number">25</span>]-l[<span class="number">15</span>]==-<span class="number">42</span>&amp;&amp;l[<span class="number">21</span>]+l[<span class="number">26</span>]-l[<span class="number">17</span>]-l[<span class="number">25</span>]+l[<span class="number">27</span>]-l[<span class="number">22</span>]-l[<span class="number">39</span>]-l[<span class="number">23</span>]-l[<span class="number">15</span>]-l[<span class="number">20</span>]-l[<span class="number">32</span>]+l[<span class="number">12</span>]+l[<span class="number">3</span>]-l[<span class="number">6</span>]+l[<span class="number">28</span>]+l[<span class="number">31</span>]+l[<span class="number">13</span>]-l[<span class="number">16</span>]-l[<span class="number">37</span>]-l[<span class="number">30</span>]-l[<span class="number">5</span>]+l[<span class="number">41</span>]+l[<span class="number">29</span>]+l[<span class="number">36</span>]+l[<span class="number">1</span>]+l[<span class="number">11</span>]+l[<span class="number">24</span>]+l[<span class="number">18</span>]-l[<span class="number">40</span>]+l[<span class="number">19</span>]-l[<span class="number">35</span>]+l[<span class="number">2</span>]-l[<span class="number">38</span>]+l[<span class="number">14</span>]-l[<span class="number">9</span>]+l[<span class="number">4</span>]+l[<span class="number">0</span>]-l[<span class="number">33</span>]==<span class="number">289</span>&amp;&amp;l[<span class="number">29</span>]+l[<span class="number">31</span>]+l[<span class="number">32</span>]-l[<span class="number">17</span>]-l[<span class="number">7</span>]+l[<span class="number">34</span>]+l[<span class="number">2</span>]+l[<span class="number">14</span>]+l[<span class="number">23</span>]-l[<span class="number">4</span>]+l[<span class="number">3</span>]+l[<span class="number">35</span>]-l[<span class="number">33</span>]-l[<span class="number">9</span>]-l[<span class="number">20</span>]-l[<span class="number">37</span>]+l[<span class="number">24</span>]-l[<span class="number">27</span>]+l[<span class="number">36</span>]+l[<span class="number">15</span>]-l[<span class="number">18</span>]-l[<span class="number">0</span>]+l[<span class="number">12</span>]+l[<span class="number">11</span>]-l[<span class="number">38</span>]+l[<span class="number">6</span>]+l[<span class="number">22</span>]+l[<span class="number">39</span>]-l[<span class="number">25</span>]-l[<span class="number">10</span>]-l[<span class="number">19</span>]-l[<span class="number">1</span>]+l[<span class="number">13</span>]-l[<span class="number">41</span>]+l[<span class="number">30</span>]-l[<span class="number">16</span>]+l[<span class="number">28</span>]-l[<span class="number">26</span>]==-<span class="number">117</span>&amp;&amp;l[<span class="number">5</span>]+l[<span class="number">37</span>]-l[<span class="number">39</span>]+l[<span class="number">0</span>]-l[<span class="number">27</span>]+l[<span class="number">12</span>]+l[<span class="number">41</span>]-l[<span class="number">22</span>]+l[<span class="number">8</span>]-l[<span class="number">16</span>]-l[<span class="number">38</span>]+l[<span class="number">9</span>]+l[<span class="number">15</span>]-l[<span class="number">35</span>]-l[<span class="number">29</span>]+l[<span class="number">18</span>]+l[<span class="number">6</span>]-l[<span class="number">25</span>]-l[<span class="number">28</span>]+l[<span class="number">36</span>]+l[<span class="number">34</span>]+l[<span class="number">32</span>]-l[<span class="number">14</span>]-l[<span class="number">1</span>]+l[<span class="number">20</span>]+l[<span class="number">40</span>]-l[<span class="number">19</span>]-l[<span class="number">4</span>]-l[<span class="number">7</span>]+l[<span class="number">26</span>]+l[<span class="number">30</span>]-l[<span class="number">10</span>]+l[<span class="number">13</span>]-l[<span class="number">21</span>]+l[<span class="number">2</span>]-l[<span class="number">23</span>]-l[<span class="number">3</span>]-l[<span class="number">33</span>]==-<span class="number">252</span>&amp;&amp;l[<span class="number">29</span>]+l[<span class="number">10</span>]-l[<span class="number">41</span>]-l[<span class="number">9</span>]+l[<span class="number">12</span>]-l[<span class="number">28</span>]+l[<span class="number">11</span>]+l[<span class="number">40</span>]-l[<span class="number">27</span>]-l[<span class="number">8</span>]+l[<span class="number">32</span>]-l[<span class="number">25</span>]-l[<span class="number">23</span>]+l[<span class="number">39</span>]-l[<span class="number">1</span>]-l[<span class="number">36</span>]-l[<span class="number">15</span>]+l[<span class="number">33</span>]-l[<span class="number">20</span>]+l[<span class="number">18</span>]+l[<span class="number">22</span>]-l[<span class="number">3</span>]+l[<span class="number">6</span>]-l[<span class="number">34</span>]-l[<span class="number">21</span>]+l[<span class="number">19</span>]+l[<span class="number">26</span>]+l[<span class="number">13</span>]-l[<span class="number">4</span>]+l[<span class="number">7</span>]-l[<span class="number">37</span>]+l[<span class="number">38</span>]-l[<span class="number">2</span>]-l[<span class="number">30</span>]-l[<span class="number">0</span>]-l[<span class="number">35</span>]+l[<span class="number">5</span>]+l[<span class="number">17</span>]==-<span class="number">183</span>&amp;&amp;l[<span class="number">6</span>]-l[<span class="number">8</span>]-l[<span class="number">20</span>]+l[<span class="number">34</span>]-l[<span class="number">33</span>]-l[<span class="number">25</span>]-l[<span class="number">4</span>]+l[<span class="number">3</span>]+l[<span class="number">17</span>]-l[<span class="number">13</span>]-l[<span class="number">15</span>]-l[<span class="number">40</span>]+l[<span class="number">1</span>]-l[<span class="number">30</span>]-l[<span class="number">14</span>]-l[<span class="number">28</span>]-l[<span class="number">35</span>]+l[<span class="number">38</span>]-l[<span class="number">22</span>]+l[<span class="number">2</span>]+l[<span class="number">24</span>]-l[<span class="number">29</span>]+l[<span class="number">5</span>]+l[<span class="number">9</span>]+l[<span class="number">37</span>]+l[<span class="number">23</span>]-l[<span class="number">18</span>]+l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">11</span>]+l[<span class="number">36</span>]+l[<span class="number">41</span>]-l[<span class="number">7</span>]-l[<span class="number">32</span>]+l[<span class="number">10</span>]+l[<span class="number">26</span>]-l[<span class="number">0</span>]+l[<span class="number">31</span>]==<span class="number">188</span>&amp;&amp;l[<span class="number">3</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]+l[<span class="number">10</span>]+l[<span class="number">39</span>]+l[<span class="number">37</span>]+l[<span class="number">1</span>]+l[<span class="number">8</span>]+l[<span class="number">21</span>]+l[<span class="number">24</span>]+l[<span class="number">29</span>]+l[<span class="number">12</span>]+l[<span class="number">27</span>]-l[<span class="number">38</span>]+l[<span class="number">11</span>]+l[<span class="number">23</span>]+l[<span class="number">28</span>]+l[<span class="number">33</span>]-l[<span class="number">31</span>]+l[<span class="number">14</span>]-l[<span class="number">5</span>]+l[<span class="number">32</span>]-l[<span class="number">17</span>]+l[<span class="number">40</span>]-l[<span class="number">34</span>]+l[<span class="number">20</span>]-l[<span class="number">22</span>]-l[<span class="number">16</span>]+l[<span class="number">19</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]-l[<span class="number">7</span>]+l[<span class="number">18</span>]+l[<span class="number">15</span>]+l[<span class="number">26</span>]-l[<span class="number">0</span>]-l[<span class="number">4</span>]+l[<span class="number">35</span>]==<span class="number">1036</span>&amp;&amp;l[<span class="number">28</span>]-l[<span class="number">33</span>]+l[<span class="number">2</span>]+l[<span class="number">37</span>]-l[<span class="number">12</span>]-l[<span class="number">9</span>]-l[<span class="number">39</span>]+l[<span class="number">16</span>]-l[<span class="number">32</span>]+l[<span class="number">8</span>]-l[<span class="number">36</span>]+l[<span class="number">31</span>]+l[<span class="number">10</span>]-l[<span class="number">4</span>]+l[<span class="number">21</span>]-l[<span class="number">25</span>]+l[<span class="number">18</span>]+l[<span class="number">24</span>]-l[<span class="number">0</span>]+l[<span class="number">29</span>]-l[<span class="number">26</span>]+l[<span class="number">35</span>]-l[<span class="number">22</span>]-l[<span class="number">41</span>]-l[<span class="number">6</span>]+l[<span class="number">15</span>]+l[<span class="number">19</span>]+l[<span class="number">40</span>]+l[<span class="number">7</span>]+l[<span class="number">34</span>]+l[<span class="number">17</span>]-l[<span class="number">3</span>]-l[<span class="number">13</span>]+l[<span class="number">5</span>]+l[<span class="number">23</span>]+l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">1</span>]==<span class="number">328</span>&amp;&amp;l[<span class="number">22</span>]-l[<span class="number">32</span>]+l[<span class="number">17</span>]-l[<span class="number">9</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]-l[<span class="number">34</span>]+l[<span class="number">23</span>]+l[<span class="number">36</span>]-l[<span class="number">35</span>]-l[<span class="number">38</span>]+l[<span class="number">27</span>]+l[<span class="number">4</span>]-l[<span class="number">5</span>]-l[<span class="number">41</span>]+l[<span class="number">29</span>]+l[<span class="number">33</span>]+l[<span class="number">0</span>]-l[<span class="number">37</span>]+l[<span class="number">28</span>]-l[<span class="number">40</span>]-l[<span class="number">11</span>]-l[<span class="number">12</span>]+l[<span class="number">7</span>]+l[<span class="number">1</span>]+l[<span class="number">2</span>]-l[<span class="number">26</span>]-l[<span class="number">16</span>]-l[<span class="number">8</span>]+l[<span class="number">24</span>]-l[<span class="number">25</span>]+l[<span class="number">3</span>]-l[<span class="number">6</span>]-l[<span class="number">19</span>]-l[<span class="number">39</span>]-l[<span class="number">14</span>]-l[<span class="number">31</span>]+l[<span class="number">10</span>]==-<span class="number">196</span>&amp;&amp;l[<span class="number">11</span>]+l[<span class="number">13</span>]+l[<span class="number">14</span>]-l[<span class="number">15</span>]-l[<span class="number">29</span>]-l[<span class="number">2</span>]+l[<span class="number">7</span>]+l[<span class="number">20</span>]+l[<span class="number">30</span>]-l[<span class="number">36</span>]-l[<span class="number">33</span>]-l[<span class="number">19</span>]+l[<span class="number">31</span>]+l[<span class="number">0</span>]-l[<span class="number">39</span>]-l[<span class="number">4</span>]-l[<span class="number">6</span>]+l[<span class="number">38</span>]+l[<span class="number">35</span>]-l[<span class="number">28</span>]+l[<span class="number">34</span>]-l[<span class="number">9</span>]-l[<span class="number">23</span>]-l[<span class="number">26</span>]+l[<span class="number">37</span>]-l[<span class="number">8</span>]-l[<span class="number">27</span>]+l[<span class="number">5</span>]-l[<span class="number">41</span>]+l[<span class="number">3</span>]+l[<span class="number">17</span>]+l[<span class="number">40</span>]-l[<span class="number">10</span>]+l[<span class="number">25</span>]+l[<span class="number">12</span>]-l[<span class="number">24</span>]+l[<span class="number">18</span>]+l[<span class="number">32</span>]==<span class="number">7</span>&amp;&amp;l[<span class="number">34</span>]-l[<span class="number">37</span>]-l[<span class="number">40</span>]+l[<span class="number">4</span>]-l[<span class="number">22</span>]-l[<span class="number">31</span>]-l[<span class="number">6</span>]+l[<span class="number">38</span>]+l[<span class="number">13</span>]-l[<span class="number">28</span>]+l[<span class="number">8</span>]+l[<span class="number">30</span>]-l[<span class="number">20</span>]-l[<span class="number">7</span>]-l[<span class="number">32</span>]+l[<span class="number">26</span>]+l[<span class="number">1</span>]-l[<span class="number">18</span>]+l[<span class="number">5</span>]+l[<span class="number">35</span>]-l[<span class="number">24</span>]-l[<span class="number">41</span>]+l[<span class="number">9</span>]-l[<span class="number">0</span>]-l[<span class="number">2</span>]-l[<span class="number">15</span>]-l[<span class="number">10</span>]+l[<span class="number">12</span>]-l[<span class="number">36</span>]+l[<span class="number">33</span>]-l[<span class="number">16</span>]-l[<span class="number">14</span>]-l[<span class="number">25</span>]-l[<span class="number">29</span>]-l[<span class="number">21</span>]+l[<span class="number">27</span>]+l[<span class="number">3</span>]-l[<span class="number">17</span>]==-<span class="number">945</span>&amp;&amp;l[<span class="number">12</span>]-l[<span class="number">30</span>]-l[<span class="number">8</span>]+l[<span class="number">20</span>]-l[<span class="number">2</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]-l[<span class="number">0</span>]-l[<span class="number">19</span>]-l[<span class="number">28</span>]-l[<span class="number">7</span>]-l[<span class="number">11</span>]-l[<span class="number">33</span>]+l[<span class="number">4</span>]-l[<span class="number">23</span>]+l[<span class="number">10</span>]-l[<span class="number">41</span>]+l[<span class="number">39</span>]-l[<span class="number">32</span>]+l[<span class="number">27</span>]+l[<span class="number">18</span>]+l[<span class="number">15</span>]+l[<span class="number">34</span>]+l[<span class="number">13</span>]-l[<span class="number">40</span>]+l[<span class="number">29</span>]-l[<span class="number">6</span>]+l[<span class="number">37</span>]-l[<span class="number">14</span>]-l[<span class="number">16</span>]+l[<span class="number">38</span>]-l[<span class="number">26</span>]+l[<span class="number">17</span>]+l[<span class="number">31</span>]-l[<span class="number">22</span>]-l[<span class="number">35</span>]+l[<span class="number">5</span>]-l[<span class="number">1</span>]==-<span class="number">480</span>&amp;&amp;l[<span class="number">36</span>]-l[<span class="number">11</span>]-l[<span class="number">34</span>]+l[<span class="number">8</span>]+l[<span class="number">0</span>]+l[<span class="number">15</span>]+l[<span class="number">28</span>]-l[<span class="number">39</span>]-l[<span class="number">32</span>]-l[<span class="number">2</span>]-l[<span class="number">27</span>]+l[<span class="number">22</span>]+l[<span class="number">16</span>]-l[<span class="number">30</span>]-l[<span class="number">3</span>]+l[<span class="number">31</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]+l[<span class="number">17</span>]-l[<span class="number">29</span>]-l[<span class="number">18</span>]+l[<span class="number">19</span>]-l[<span class="number">10</span>]+l[<span class="number">6</span>]-l[<span class="number">5</span>]-l[<span class="number">38</span>]-l[<span class="number">25</span>]-l[<span class="number">24</span>]+l[<span class="number">4</span>]+l[<span class="number">23</span>]+l[<span class="number">9</span>]+l[<span class="number">14</span>]+l[<span class="number">21</span>]-l[<span class="number">37</span>]+l[<span class="number">13</span>]-l[<span class="number">41</span>]-l[<span class="number">12</span>]+l[<span class="number">35</span>]==-<span class="number">213</span>&amp;&amp;l[<span class="number">19</span>]-l[<span class="number">36</span>]-l[<span class="number">12</span>]+l[<span class="number">33</span>]-l[<span class="number">27</span>]-l[<span class="number">37</span>]-l[<span class="number">25</span>]+l[<span class="number">38</span>]+l[<span class="number">16</span>]-l[<span class="number">18</span>]+l[<span class="number">22</span>]-l[<span class="number">39</span>]+l[<span class="number">13</span>]-l[<span class="number">7</span>]-l[<span class="number">31</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">10</span>]-l[<span class="number">9</span>]-l[<span class="number">2</span>]-l[<span class="number">30</span>]-l[<span class="number">11</span>]+l[<span class="number">41</span>]-l[<span class="number">4</span>]+l[<span class="number">24</span>]+l[<span class="number">34</span>]+l[<span class="number">5</span>]+l[<span class="number">17</span>]+l[<span class="number">14</span>]+l[<span class="number">6</span>]+l[<span class="number">8</span>]-l[<span class="number">21</span>]-l[<span class="number">23</span>]+l[<span class="number">32</span>]-l[<span class="number">1</span>]-l[<span class="number">29</span>]-l[<span class="number">0</span>]+l[<span class="number">3</span>]==-<span class="number">386</span>&amp;&amp;l[<span class="number">0</span>]+l[<span class="number">7</span>]-l[<span class="number">28</span>]-l[<span class="number">38</span>]+l[<span class="number">19</span>]+l[<span class="number">31</span>]-l[<span class="number">5</span>]+l[<span class="number">24</span>]-l[<span class="number">3</span>]+l[<span class="number">33</span>]-l[<span class="number">12</span>]-l[<span class="number">29</span>]+l[<span class="number">32</span>]+l[<span class="number">1</span>]-l[<span class="number">34</span>]-l[<span class="number">9</span>]-l[<span class="number">25</span>]+l[<span class="number">26</span>]-l[<span class="number">8</span>]+l[<span class="number">4</span>]-l[<span class="number">10</span>]+l[<span class="number">40</span>]-l[<span class="number">15</span>]-l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">36</span>]+l[<span class="number">14</span>]+l[<span class="number">41</span>]-l[<span class="number">35</span>]-l[<span class="number">13</span>]-l[<span class="number">17</span>]-l[<span class="number">21</span>]-l[<span class="number">18</span>]+l[<span class="number">39</span>]-l[<span class="number">2</span>]+l[<span class="number">20</span>]-l[<span class="number">23</span>]-l[<span class="number">22</span>]==-<span class="number">349</span>&amp;&amp;l[<span class="number">10</span>]+l[<span class="number">22</span>]+l[<span class="number">21</span>]-l[<span class="number">0</span>]+l[<span class="number">15</span>]-l[<span class="number">6</span>]+l[<span class="number">20</span>]-l[<span class="number">29</span>]-l[<span class="number">30</span>]-l[<span class="number">33</span>]+l[<span class="number">19</span>]+l[<span class="number">23</span>]-l[<span class="number">28</span>]+l[<span class="number">41</span>]-l[<span class="number">27</span>]-l[<span class="number">12</span>]-l[<span class="number">37</span>]-l[<span class="number">32</span>]+l[<span class="number">34</span>]-l[<span class="number">36</span>]+l[<span class="number">3</span>]+l[<span class="number">1</span>]-l[<span class="number">13</span>]+l[<span class="number">18</span>]+l[<span class="number">14</span>]+l[<span class="number">9</span>]+l[<span class="number">7</span>]-l[<span class="number">39</span>]+l[<span class="number">8</span>]+l[<span class="number">2</span>]-l[<span class="number">31</span>]-l[<span class="number">5</span>]-l[<span class="number">40</span>]+l[<span class="number">38</span>]-l[<span class="number">26</span>]-l[<span class="number">4</span>]+l[<span class="number">16</span>]-l[<span class="number">25</span>]==<span class="number">98</span>&amp;&amp;l[<span class="number">28</span>]+l[<span class="number">38</span>]+l[<span class="number">20</span>]+l[<span class="number">0</span>]-l[<span class="number">5</span>]-l[<span class="number">34</span>]-l[<span class="number">41</span>]+l[<span class="number">22</span>]-l[<span class="number">26</span>]+l[<span class="number">11</span>]+l[<span class="number">29</span>]+l[<span class="number">31</span>]-l[<span class="number">3</span>]-l[<span class="number">16</span>]+l[<span class="number">23</span>]+l[<span class="number">17</span>]-l[<span class="number">18</span>]+l[<span class="number">9</span>]-l[<span class="number">4</span>]-l[<span class="number">12</span>]-l[<span class="number">19</span>]-l[<span class="number">40</span>]-l[<span class="number">27</span>]+l[<span class="number">33</span>]+l[<span class="number">8</span>]-l[<span class="number">37</span>]+l[<span class="number">2</span>]+l[<span class="number">15</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]+l[<span class="number">10</span>]+l[<span class="number">35</span>]-l[<span class="number">1</span>]+l[<span class="number">30</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]-l[<span class="number">14</span>]-l[<span class="number">32</span>]==-<span class="number">412</span>&amp;&amp;l[<span class="number">1</span>]-l[<span class="number">24</span>]-l[<span class="number">29</span>]+l[<span class="number">39</span>]+l[<span class="number">41</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]-l[<span class="number">19</span>]+l[<span class="number">6</span>]-l[<span class="number">37</span>]-l[<span class="number">22</span>]+l[<span class="number">32</span>]+l[<span class="number">21</span>]+l[<span class="number">28</span>]+l[<span class="number">36</span>]+l[<span class="number">4</span>]-l[<span class="number">17</span>]+l[<span class="number">20</span>]-l[<span class="number">13</span>]-l[<span class="number">35</span>]-l[<span class="number">5</span>]+l[<span class="number">33</span>]-l[<span class="number">27</span>]-l[<span class="number">30</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]-l[<span class="number">18</span>]+l[<span class="number">34</span>]-l[<span class="number">3</span>]-l[<span class="number">10</span>]-l[<span class="number">16</span>]-l[<span class="number">23</span>]-l[<span class="number">38</span>]+l[<span class="number">8</span>]-l[<span class="number">14</span>]-l[<span class="number">11</span>]-l[<span class="number">7</span>]+l[<span class="number">12</span>]==-<span class="number">95</span>&amp;&amp;l[<span class="number">2</span>]-l[<span class="number">24</span>]+l[<span class="number">31</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]-l[<span class="number">6</span>]+l[<span class="number">7</span>]-l[<span class="number">1</span>]-l[<span class="number">22</span>]+l[<span class="number">8</span>]-l[<span class="number">23</span>]+l[<span class="number">40</span>]+l[<span class="number">20</span>]-l[<span class="number">38</span>]-l[<span class="number">11</span>]-l[<span class="number">14</span>]+l[<span class="number">18</span>]-l[<span class="number">36</span>]+l[<span class="number">15</span>]-l[<span class="number">4</span>]-l[<span class="number">41</span>]-l[<span class="number">12</span>]-l[<span class="number">34</span>]+l[<span class="number">32</span>]-l[<span class="number">35</span>]+l[<span class="number">17</span>]-l[<span class="number">21</span>]-l[<span class="number">10</span>]-l[<span class="number">29</span>]+l[<span class="number">39</span>]-l[<span class="number">16</span>]+l[<span class="number">27</span>]+l[<span class="number">26</span>]-l[<span class="number">3</span>]-l[<span class="number">5</span>]+l[<span class="number">13</span>]+l[<span class="number">25</span>]-l[<span class="number">28</span>]==-<span class="number">379</span>&amp;&amp;l[<span class="number">19</span>]-l[<span class="number">17</span>]+l[<span class="number">31</span>]+l[<span class="number">14</span>]+l[<span class="number">6</span>]-l[<span class="number">12</span>]+l[<span class="number">16</span>]-l[<span class="number">8</span>]+l[<span class="number">27</span>]-l[<span class="number">13</span>]+l[<span class="number">41</span>]+l[<span class="number">2</span>]-l[<span class="number">7</span>]+l[<span class="number">32</span>]+l[<span class="number">1</span>]+l[<span class="number">25</span>]-l[<span class="number">9</span>]+l[<span class="number">37</span>]+l[<span class="number">34</span>]-l[<span class="number">18</span>]-l[<span class="number">40</span>]-l[<span class="number">11</span>]-l[<span class="number">10</span>]+l[<span class="number">38</span>]+l[<span class="number">21</span>]+l[<span class="number">3</span>]-l[<span class="number">0</span>]+l[<span class="number">24</span>]+l[<span class="number">15</span>]+l[<span class="number">23</span>]-l[<span class="number">20</span>]+l[<span class="number">26</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">28</span>]-l[<span class="number">5</span>]+l[<span class="number">39</span>]+l[<span class="number">35</span>]==<span class="number">861</span>&amp;&amp;l[<span class="number">35</span>]+l[<span class="number">36</span>]-l[<span class="number">16</span>]-l[<span class="number">26</span>]-l[<span class="number">31</span>]+l[<span class="number">0</span>]+l[<span class="number">21</span>]-l[<span class="number">13</span>]+l[<span class="number">14</span>]+l[<span class="number">39</span>]+l[<span class="number">7</span>]+l[<span class="number">4</span>]+l[<span class="number">34</span>]+l[<span class="number">38</span>]+l[<span class="number">17</span>]+l[<span class="number">22</span>]+l[<span class="number">32</span>]+l[<span class="number">5</span>]+l[<span class="number">15</span>]+l[<span class="number">8</span>]-l[<span class="number">29</span>]+l[<span class="number">40</span>]+l[<span class="number">24</span>]+l[<span class="number">6</span>]+l[<span class="number">30</span>]-l[<span class="number">2</span>]+l[<span class="number">25</span>]+l[<span class="number">23</span>]+l[<span class="number">1</span>]+l[<span class="number">12</span>]+l[<span class="number">9</span>]-l[<span class="number">10</span>]-l[<span class="number">3</span>]-l[<span class="number">19</span>]+l[<span class="number">20</span>]-l[<span class="number">37</span>]-l[<span class="number">33</span>]-l[<span class="number">18</span>]==<span class="number">1169</span>&amp;&amp;l[<span class="number">13</span>]+l[<span class="number">0</span>]-l[<span class="number">25</span>]-l[<span class="number">32</span>]-l[<span class="number">21</span>]-l[<span class="number">34</span>]-l[<span class="number">14</span>]-l[<span class="number">9</span>]-l[<span class="number">8</span>]-l[<span class="number">15</span>]-l[<span class="number">16</span>]+l[<span class="number">38</span>]-l[<span class="number">35</span>]-l[<span class="number">30</span>]-l[<span class="number">40</span>]-l[<span class="number">12</span>]+l[<span class="number">3</span>]-l[<span class="number">19</span>]+l[<span class="number">4</span>]-l[<span class="number">41</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]+l[<span class="number">37</span>]+l[<span class="number">17</span>]-l[<span class="number">1</span>]+l[<span class="number">26</span>]-l[<span class="number">39</span>]-l[<span class="number">10</span>]-l[<span class="number">33</span>]+l[<span class="number">5</span>]-l[<span class="number">27</span>]-l[<span class="number">23</span>]-l[<span class="number">24</span>]-l[<span class="number">7</span>]+l[<span class="number">31</span>]-l[<span class="number">28</span>]-l[<span class="number">18</span>]+l[<span class="number">6</span>]==-<span class="number">1236</span>&amp;&amp;l[<span class="number">20</span>]+l[<span class="number">27</span>]-l[<span class="number">29</span>]-l[<span class="number">25</span>]-l[<span class="number">3</span>]+l[<span class="number">28</span>]-l[<span class="number">32</span>]-l[<span class="number">11</span>]+l[<span class="number">10</span>]+l[<span class="number">31</span>]+l[<span class="number">16</span>]+l[<span class="number">21</span>]-l[<span class="number">7</span>]+l[<span class="number">4</span>]-l[<span class="number">24</span>]-l[<span class="number">35</span>]+l[<span class="number">26</span>]+l[<span class="number">12</span>]-l[<span class="number">37</span>]+l[<span class="number">6</span>]+l[<span class="number">23</span>]+l[<span class="number">41</span>]-l[<span class="number">39</span>]-l[<span class="number">38</span>]+l[<span class="number">40</span>]-l[<span class="number">36</span>]+l[<span class="number">8</span>]-l[<span class="number">9</span>]-l[<span class="number">5</span>]-l[<span class="number">1</span>]-l[<span class="number">13</span>]-l[<span class="number">14</span>]+l[<span class="number">19</span>]+l[<span class="number">0</span>]-l[<span class="number">34</span>]-l[<span class="number">15</span>]+l[<span class="number">17</span>]+l[<span class="number">22</span>]==-<span class="number">114</span>&amp;&amp;l[<span class="number">12</span>]-l[<span class="number">28</span>]-l[<span class="number">13</span>]-l[<span class="number">23</span>]-l[<span class="number">33</span>]+l[<span class="number">18</span>]+l[<span class="number">10</span>]+l[<span class="number">11</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]+l[<span class="number">41</span>]-l[<span class="number">16</span>]+l[<span class="number">39</span>]+l[<span class="number">34</span>]+l[<span class="number">32</span>]+l[<span class="number">37</span>]-l[<span class="number">38</span>]+l[<span class="number">20</span>]+l[<span class="number">6</span>]+l[<span class="number">7</span>]+l[<span class="number">31</span>]+l[<span class="number">5</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">15</span>]-l[<span class="number">24</span>]+l[<span class="number">17</span>]-l[<span class="number">3</span>]+l[<span class="number">1</span>]-l[<span class="number">35</span>]-l[<span class="number">9</span>]+l[<span class="number">30</span>]+l[<span class="number">25</span>]-l[<span class="number">0</span>]-l[<span class="number">8</span>]-l[<span class="number">14</span>]+l[<span class="number">26</span>]+l[<span class="number">21</span>]==<span class="number">659</span>&amp;&amp;l[<span class="number">21</span>]-l[<span class="number">3</span>]+l[<span class="number">7</span>]-l[<span class="number">27</span>]+l[<span class="number">0</span>]-l[<span class="number">32</span>]-l[<span class="number">24</span>]-l[<span class="number">37</span>]+l[<span class="number">4</span>]-l[<span class="number">22</span>]+l[<span class="number">20</span>]-l[<span class="number">5</span>]-l[<span class="number">30</span>]-l[<span class="number">31</span>]-l[<span class="number">1</span>]+l[<span class="number">15</span>]+l[<span class="number">41</span>]+l[<span class="number">12</span>]+l[<span class="number">40</span>]+l[<span class="number">38</span>]-l[<span class="number">17</span>]-l[<span class="number">39</span>]+l[<span class="number">19</span>]-l[<span class="number">13</span>]+l[<span class="number">23</span>]+l[<span class="number">18</span>]-l[<span class="number">2</span>]+l[<span class="number">6</span>]-l[<span class="number">33</span>]-l[<span class="number">9</span>]+l[<span class="number">28</span>]+l[<span class="number">8</span>]-l[<span class="number">16</span>]-l[<span class="number">10</span>]-l[<span class="number">14</span>]+l[<span class="number">34</span>]+l[<span class="number">35</span>]-l[<span class="number">11</span>]==-<span class="number">430</span>&amp;&amp;l[<span class="number">11</span>]-l[<span class="number">23</span>]-l[<span class="number">9</span>]-l[<span class="number">19</span>]+l[<span class="number">17</span>]+l[<span class="number">38</span>]-l[<span class="number">36</span>]-l[<span class="number">22</span>]-l[<span class="number">10</span>]+l[<span class="number">27</span>]-l[<span class="number">14</span>]-l[<span class="number">4</span>]+l[<span class="number">5</span>]+l[<span class="number">31</span>]+l[<span class="number">2</span>]+l[<span class="number">0</span>]-l[<span class="number">16</span>]-l[<span class="number">8</span>]-l[<span class="number">28</span>]+l[<span class="number">3</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]-l[<span class="number">33</span>]+l[<span class="number">13</span>]-l[<span class="number">32</span>]-l[<span class="number">35</span>]+l[<span class="number">26</span>]-l[<span class="number">20</span>]-l[<span class="number">41</span>]-l[<span class="number">30</span>]-l[<span class="number">12</span>]-l[<span class="number">7</span>]+l[<span class="number">37</span>]-l[<span class="number">39</span>]+l[<span class="number">15</span>]+l[<span class="number">18</span>]-l[<span class="number">29</span>]-l[<span class="number">21</span>]==-<span class="number">513</span>&amp;&amp;l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">4</span>]-l[<span class="number">13</span>]-l[<span class="number">17</span>]-l[<span class="number">30</span>]+l[<span class="number">5</span>]-l[<span class="number">33</span>]-l[<span class="number">37</span>]-l[<span class="number">15</span>]-l[<span class="number">18</span>]+l[<span class="number">7</span>]+l[<span class="number">25</span>]-l[<span class="number">14</span>]+l[<span class="number">35</span>]+l[<span class="number">40</span>]+l[<span class="number">16</span>]+l[<span class="number">1</span>]+l[<span class="number">2</span>]+l[<span class="number">26</span>]-l[<span class="number">3</span>]-l[<span class="number">39</span>]-l[<span class="number">22</span>]+l[<span class="number">23</span>]-l[<span class="number">36</span>]-l[<span class="number">27</span>]-l[<span class="number">9</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]-l[<span class="number">0</span>]-l[<span class="number">31</span>]-l[<span class="number">20</span>]+l[<span class="number">12</span>]-l[<span class="number">8</span>]+l[<span class="number">29</span>]-l[<span class="number">11</span>]-l[<span class="number">34</span>]+l[<span class="number">21</span>]==-<span class="number">502</span>&amp;&amp;l[<span class="number">30</span>]-l[<span class="number">31</span>]-l[<span class="number">36</span>]+l[<span class="number">3</span>]+l[<span class="number">9</span>]-l[<span class="number">40</span>]-l[<span class="number">33</span>]+l[<span class="number">25</span>]+l[<span class="number">39</span>]-l[<span class="number">26</span>]+l[<span class="number">23</span>]-l[<span class="number">0</span>]-l[<span class="number">29</span>]-l[<span class="number">32</span>]-l[<span class="number">4</span>]+l[<span class="number">37</span>]+l[<span class="number">28</span>]+l[<span class="number">21</span>]+l[<span class="number">17</span>]+l[<span class="number">2</span>]+l[<span class="number">24</span>]+l[<span class="number">6</span>]+l[<span class="number">5</span>]+l[<span class="number">8</span>]+l[<span class="number">16</span>]+l[<span class="number">27</span>]+l[<span class="number">19</span>]+l[<span class="number">12</span>]+l[<span class="number">20</span>]+l[<span class="number">41</span>]-l[<span class="number">22</span>]+l[<span class="number">15</span>]-l[<span class="number">11</span>]+l[<span class="number">34</span>]-l[<span class="number">18</span>]-l[<span class="number">38</span>]+l[<span class="number">1</span>]-l[<span class="number">14</span>]==<span class="number">853</span>&amp;&amp;l[<span class="number">38</span>]-l[<span class="number">10</span>]+l[<span class="number">16</span>]+l[<span class="number">8</span>]+l[<span class="number">21</span>]-l[<span class="number">25</span>]+l[<span class="number">36</span>]-l[<span class="number">30</span>]+l[<span class="number">31</span>]-l[<span class="number">3</span>]+l[<span class="number">5</span>]-l[<span class="number">15</span>]+l[<span class="number">23</span>]-l[<span class="number">28</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">29</span>]+l[<span class="number">22</span>]-l[<span class="number">0</span>]-l[<span class="number">37</span>]-l[<span class="number">14</span>]-l[<span class="number">11</span>]+l[<span class="number">32</span>]+l[<span class="number">33</span>]-l[<span class="number">9</span>]+l[<span class="number">39</span>]+l[<span class="number">41</span>]-l[<span class="number">19</span>]-l[<span class="number">1</span>]+l[<span class="number">18</span>]-l[<span class="number">4</span>]-l[<span class="number">6</span>]+l[<span class="number">13</span>]+l[<span class="number">20</span>]-l[<span class="number">2</span>]-l[<span class="number">35</span>]-l[<span class="number">26</span>]+l[<span class="number">27</span>]==-<span class="number">28</span>&amp;&amp;l[<span class="number">11</span>]+l[<span class="number">18</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">14</span>]-l[<span class="number">33</span>]+l[<span class="number">7</span>]-l[<span class="number">23</span>]-l[<span class="number">25</span>]+l[<span class="number">0</span>]-l[<span class="number">6</span>]-l[<span class="number">21</span>]-l[<span class="number">16</span>]+l[<span class="number">17</span>]-l[<span class="number">19</span>]-l[<span class="number">28</span>]-l[<span class="number">38</span>]-l[<span class="number">37</span>]+l[<span class="number">9</span>]+l[<span class="number">20</span>]-l[<span class="number">8</span>]-l[<span class="number">3</span>]+l[<span class="number">22</span>]-l[<span class="number">35</span>]-l[<span class="number">10</span>]-l[<span class="number">31</span>]-l[<span class="number">2</span>]+l[<span class="number">41</span>]-l[<span class="number">1</span>]-l[<span class="number">4</span>]+l[<span class="number">24</span>]-l[<span class="number">34</span>]+l[<span class="number">39</span>]+l[<span class="number">40</span>]+l[<span class="number">32</span>]-l[<span class="number">5</span>]+l[<span class="number">36</span>]-l[<span class="number">27</span>]==-<span class="number">529</span>&amp;&amp;l[<span class="number">38</span>]+l[<span class="number">8</span>]+l[<span class="number">36</span>]+l[<span class="number">35</span>]-l[<span class="number">23</span>]-l[<span class="number">34</span>]+l[<span class="number">13</span>]-l[<span class="number">4</span>]-l[<span class="number">27</span>]-l[<span class="number">24</span>]+l[<span class="number">26</span>]+l[<span class="number">31</span>]-l[<span class="number">30</span>]-l[<span class="number">5</span>]-l[<span class="number">40</span>]+l[<span class="number">28</span>]-l[<span class="number">11</span>]-l[<span class="number">2</span>]-l[<span class="number">39</span>]+l[<span class="number">15</span>]+l[<span class="number">10</span>]-l[<span class="number">17</span>]+l[<span class="number">3</span>]+l[<span class="number">19</span>]+l[<span class="number">22</span>]+l[<span class="number">33</span>]+l[<span class="number">0</span>]+l[<span class="number">37</span>]+l[<span class="number">16</span>]-l[<span class="number">9</span>]-l[<span class="number">32</span>]+l[<span class="number">25</span>]-l[<span class="number">21</span>]-l[<span class="number">12</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]==-<span class="number">12</span>&amp;&amp;l[<span class="number">6</span>]-l[<span class="number">30</span>]-l[<span class="number">20</span>]-l[<span class="number">27</span>]-l[<span class="number">14</span>]-l[<span class="number">39</span>]+l[<span class="number">41</span>]-l[<span class="number">33</span>]-l[<span class="number">0</span>]+l[<span class="number">25</span>]-l[<span class="number">32</span>]-l[<span class="number">3</span>]+l[<span class="number">26</span>]-l[<span class="number">12</span>]+l[<span class="number">8</span>]-l[<span class="number">35</span>]-l[<span class="number">24</span>]+l[<span class="number">15</span>]+l[<span class="number">9</span>]-l[<span class="number">4</span>]+l[<span class="number">13</span>]+l[<span class="number">36</span>]+l[<span class="number">34</span>]+l[<span class="number">1</span>]-l[<span class="number">28</span>]-l[<span class="number">21</span>]+l[<span class="number">18</span>]+l[<span class="number">23</span>]+l[<span class="number">29</span>]-l[<span class="number">10</span>]-l[<span class="number">38</span>]+l[<span class="number">22</span>]+l[<span class="number">37</span>]+l[<span class="number">5</span>]+l[<span class="number">19</span>]+l[<span class="number">7</span>]+l[<span class="number">16</span>]-l[<span class="number">31</span>]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]])</span><br></pre></td></tr></table></figure>

<p>可以看到等式最后有个数字没有解出来</p>
<p>我们放到网站中解就行了</p>
<p><a target="_blank" rel="noopener" href="http://codertab.com/JsUnFuck">http://codertab.com/JsUnFuck</a></p>


<p>是个81，关于等式，我们使用z3</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">l0,l1,l2,l3,l4,l5,l6,l7,l8,l9,l10,l11,l12,l13,l14,l15,l16,l17,l18,l19,l20,l21,l22,l23,l24,l25,l26,l27,l28,l29,l30,l31,l32,l33,l34,l35,l36,l37,l38,l39,l40,l41 \</span><br><span class="line">= Ints(<span class="string">&#x27;l0 l1 l2 l3 l4 l5 l6 l7 l8 l9 l10 l11 l12 l13 l14 l15 l16 l17 l18 l19 l20 l21 l22 l23 l24 l25 l26 l27 l28 l29 l30 l31 l32 l33 l34 l35 l36 l37 l38 l39 l40 l41&#x27;</span>)</span><br><span class="line">x = Solver()</span><br><span class="line">x.add(l40+l35+l34-l0-l15-l37+l7+l6-l26+l20+l19+l8-l17-l14-l38+l1-l9+l22+l41+l3-l29-l36-l25+l5+l32-l16+l12-l24+l30+l39+l10+l2+l27+l28+l21+l33-l18+l4==<span class="number">861</span>)</span><br><span class="line">x.add(l31+l26+l11-l33+l27-l3+l12+l30+l1+l32-l16+l7+l10-l25+l38-l41-l14-l19+l29+l36-l9-l28-l6-l0-l22-l18+l20-l37+l4-l24+l34-l21-l39-l23-l8-l40+l15-l35==-<span class="number">448</span>)</span><br><span class="line">x.add(l26+l14+l15+l9+l13+l30-l11+l18+l23+l7+l3+l12+l25-l24-l39-l35-l20+l40-l8+l10-l5-l33-l31+l32+l19+l21-l6+l1+l16+l17+l29+l22-l4-l36+l41+l38+l2+l0==<span class="number">1244</span>)</span><br><span class="line">x.add(l5+l22+l15+l2-l28-l10-l3-l13-l18+l30-l9+l32+l19+l34+l23-l17+l16-l7+l24-l39+l8-l12-l40-l25+l37-l35+l11-l14+l20-l27+l4-l33-l21+l31-l6+l1+l38-l29==-<span class="number">39</span>)</span><br><span class="line">x.add(l41-l29+l23-l4+l20-l33+l35+l3-l19-l21+l11+l26-l24-l17+l37+l1+l16-l0-l13+l7+l10+l14+l22+l39-l40+l34-l38+l32+l25-l2+l15+l6+l28-l8-l5-l31-l30-l27==<span class="number">485</span>)</span><br><span class="line">x.add(l13+l19+l21-l2-l33-l0+l39+l31-l23-l41+l38-l29+l36+l24-l20-l9-l32+l37-l35+l40+l7-l26+l15-l10-l6-l16-l4-l5-l30-l14-l22-l25-l34-l17-l11-l27+l1-l28==-<span class="number">1068</span>)</span><br><span class="line">x.add(l32+l0+l9+l14+l11+l18-l13+l24-l2-l15+l19-l21+l1+l39-l8-l3+l33+l6-l5-l35-l28+l25-l41+l22-l17+l10+l40+l34+l27-l20+l23+l31-l16+l7+l12-l30+l29-l4==<span class="number">939</span>)</span><br><span class="line">x.add(l19+l11+l20-l16+l40+l25+l1-l31+l28-l23+l14-l9-l27+l35+l39-l37-l8-l22+l5-l6+l0-l32+l24+l33+l29+l38+l15-l2+l30+l7+l12-l3-l17+l34+l41-l4-l13-l26==<span class="number">413</span>)</span><br><span class="line">x.add(l22+l4-l9+l34+l35+l17+l3-l24+l38-l5-l41-l31-l0-l25+l33+l15-l1-l10+l16-l29-l12+l26-l39-l21-l18-l6-l40-l13+l8+l37+l19+l14+l32+l28-l11+l23+l36+l7==<span class="number">117</span>)</span><br><span class="line">x.add(l32+l16+l3+l11+l34-l31+l14+l25+l1-l30-l33-l40-l4-l29+l18-l27+l13-l19-l12+l23-l39-l41-l8+l22-l5-l38-l9-l37+l17-l36+l24-l21+l2-l26+l20-l7+l35-l0==-<span class="number">313</span>)</span><br><span class="line">x.add(l40-l1+l5+l7+l33+l29+l12+l38-l31+l2+l14-l35-l8-l24-l39-l9-l28+l23-l17-l22-l26+l32-l11+l4-l36+l10+l20-l18-l16+l6-l0+l3-l30+l37-l19+l21+l25-l15==-<span class="number">42</span>)</span><br><span class="line">x.add(l21+l26-l17-l25+l27-l22-l39-l23-l15-l20-l32+l12+l3-l6+l28+l31+l13-l16-l37-l30-l5+l41+l29+l36+l1+l11+l24+l18-l40+l19-l35+l2-l38+l14-l9+l4+l0-l33==<span class="number">289</span>)</span><br><span class="line">x.add(l29+l31+l32-l17-l7+l34+l2+l14+l23-l4+l3+l35-l33-l9-l20-l37+l24-l27+l36+l15-l18-l0+l12+l11-l38+l6+l22+l39-l25-l10-l19-l1+l13-l41+l30-l16+l28-l26==-<span class="number">117</span>)</span><br><span class="line">x.add(l5+l37-l39+l0-l27+l12+l41-l22+l8-l16-l38+l9+l15-l35-l29+l18+l6-l25-l28+l36+l34+l32-l14-l1+l20+l40-l19-l4-l7+l26+l30-l10+l13-l21+l2-l23-l3-l33==-<span class="number">252</span>)</span><br><span class="line">x.add(l29+l10-l41-l9+l12-l28+l11+l40-l27-l8+l32-l25-l23+l39-l1-l36-l15+l33-l20+l18+l22-l3+l6-l34-l21+l19+l26+l13-l4+l7-l37+l38-l2-l30-l0-l35+l5+l17==-<span class="number">183</span>)</span><br><span class="line">x.add(l6-l8-l20+l34-l33-l25-l4+l3+l17-l13-l15-l40+l1-l30-l14-l28-l35+l38-l22+l2+l24-l29+l5+l9+l37+l23-l18+l19-l21+l11+l36+l41-l7-l32+l10+l26-l0+l31==<span class="number">188</span>)</span><br><span class="line">x.add(l3+l6-l41+l10+l39+l37+l1+l8+l21+l24+l29+l12+l27-l38+l11+l23+l28+l33-l31+l14-l5+l32-l17+l40-l34+l20-l22-l16+l19+l2-l36-l7+l18+l15+l26-l0-l4+l35==<span class="number">1036</span>)</span><br><span class="line">x.add(l28-l33+l2+l37-l12-l9-l39+l16-l32+l8-l36+l31+l10-l4+l21-l25+l18+l24-l0+l29-l26+l35-l22-l41-l6+l15+l19+l40+l7+l34+l17-l3-l13+l5+l23+l11-l27+l1==<span class="number">328</span>)</span><br><span class="line">x.add(l22-l32+l17-l9+l20-l18-l34+l23+l36-l35-l38+l27+l4-l5-l41+l29+l33+l0-l37+l28-l40-l11-l12+l7+l1+l2-l26-l16-l8+l24-l25+l3-l6-l19-l39-l14-l31+l10==-<span class="number">196</span>)</span><br><span class="line">x.add(l11+l13+l14-l15-l29-l2+l7+l20+l30-l36-l33-l19+l31+l0-l39-l4-l6+l38+l35-l28+l34-l9-l23-l26+l37-l8-l27+l5-l41+l3+l17+l40-l10+l25+l12-l24+l18+l32==<span class="number">7</span>)</span><br><span class="line">x.add(l34-l37-l40+l4-l22-l31-l6+l38+l13-l28+l8+l30-l20-l7-l32+l26+l1-l18+l5+l35-l24-l41+l9-l0-l2-l15-l10+l12-l36+l33-l16-l14-l25-l29-l21+l27+l3-l17==-<span class="number">945</span>)</span><br><span class="line">x.add(l12-l30-l8+l20-l2-l36-l25-l0-l19-l28-l7-l11-l33+l4-l23+l10-l41+l39-l32+l27+l18+l15+l34+l13-l40+l29-l6+l37-l14-l16+l38-l26+l17+l31-l22-l35+l5-l1==-<span class="number">480</span>)</span><br><span class="line">x.add(l36-l11-l34+l8+l0+l15+l28-l39-l32-l2-l27+l22+l16-l30-l3+l31-l26+l20+l17-l29-l18+l19-l10+l6-l5-l38-l25-l24+l4+l23+l9+l14+l21-l37+l13-l41-l12+l35==-<span class="number">213</span>)</span><br><span class="line">x.add(l19-l36-l12+l33-l27-l37-l25+l38+l16-l18+l22-l39+l13-l7-l31-l26+l15-l10-l9-l2-l30-l11+l41-l4+l24+l34+l5+l17+l14+l6+l8-l21-l23+l32-l1-l29-l0+l3==-<span class="number">386</span>)</span><br><span class="line">x.add(l0+l7-l28-l38+l19+l31-l5+l24-l3+l33-l12-l29+l32+l1-l34-l9-l25+l26-l8+l4-l10+l40-l15-l11-l27+l36+l14+l41-l35-l13-l17-l21-l18+l39-l2+l20-l23-l22==-<span class="number">349</span>)</span><br><span class="line">x.add(l10+l22+l21-l0+l15-l6+l20-l29-l30-l33+l19+l23-l28+l41-l27-l12-l37-l32+l34-l36+l3+l1-l13+l18+l14+l9+l7-l39+l8+l2-l31-l5-l40+l38-l26-l4+l16-l25==<span class="number">98</span>)</span><br><span class="line">x.add(l28+l38+l20+l0-l5-l34-l41+l22-l26+l11+l29+l31-l3-l16+l23+l17-l18+l9-l4-l12-l19-l40-l27+l33+l8-l37+l2+l15-l24-l39+l10+l35-l1+l30-l36-l25-l14-l32==-<span class="number">412</span>)</span><br><span class="line">x.add(l1-l24-l29+l39+l41+l0+l9-l19+l6-l37-l22+l32+l21+l28+l36+l4-l17+l20-l13-l35-l5+l33-l27-l30+l40+l25-l18+l34-l3-l10-l16-l23-l38+l8-l14-l11-l7+l12==-<span class="number">95</span>)</span><br><span class="line">x.add(l2-l24+l31+l0+l9-l6+l7-l1-l22+l8-l23+l40+l20-l38-l11-l14+l18-l36+l15-l4-l41-l12-l34+l32-l35+l17-l21-l10-l29+l39-l16+l27+l26-l3-l5+l13+l25-l28==-<span class="number">379</span>)</span><br><span class="line">x.add(l19-l17+l31+l14+l6-l12+l16-l8+l27-l13+l41+l2-l7+l32+l1+l25-l9+l37+l34-l18-l40-l11-l10+l38+l21+l3-l0+l24+l15+l23-l20+l26+l22-l4-l28-l5+l39+l35==<span class="number">861</span>)</span><br><span class="line">x.add(l35+l36-l16-l26-l31+l0+l21-l13+l14+l39+l7+l4+l34+l38+l17+l22+l32+l5+l15+l8-l29+l40+l24+l6+l30-l2+l25+l23+l1+l12+l9-l10-l3-l19+l20-l37-l33-l18==<span class="number">1169</span>)</span><br><span class="line">x.add(l13+l0-l25-l32-l21-l34-l14-l9-l8-l15-l16+l38-l35-l30-l40-l12+l3-l19+l4-l41+l2-l36+l37+l17-l1+l26-l39-l10-l33+l5-l27-l23-l24-l7+l31-l28-l18+l6==-<span class="number">1236</span>)</span><br><span class="line">x.add(l20+l27-l29-l25-l3+l28-l32-l11+l10+l31+l16+l21-l7+l4-l24-l35+l26+l12-l37+l6+l23+l41-l39-l38+l40-l36+l8-l9-l5-l1-l13-l14+l19+l0-l34-l15+l17+l22==-<span class="number">114</span>)</span><br><span class="line">x.add(l12-l28-l13-l23-l33+l18+l10+l11+l2-l36+l41-l16+l39+l34+l32+l37-l38+l20+l6+l7+l31+l5+l22-l4-l15-l24+l17-l3+l1-l35-l9+l30+l25-l0-l8-l14+l26+l21==<span class="number">659</span>)</span><br><span class="line">x.add(l21-l3+l7-l27+l0-l32-l24-l37+l4-l22+l20-l5-l30-l31-l1+l15+l41+l12+l40+l38-l17-l39+l19-l13+l23+l18-l2+l6-l33-l9+l28+l8-l16-l10-l14+l34+l35-l11==-<span class="number">430</span>)</span><br><span class="line">x.add(l11-l23-l9-l19+l17+l38-l36-l22-l10+l27-l14-l4+l5+l31+l2+l0-l16-l8-l28+l3+l40+l25-l33+l13-l32-l35+l26-l20-l41-l30-l12-l7+l37-l39+l15+l18-l29-l21==-<span class="number">513</span>)</span><br><span class="line">x.add(l32+l19+l4-l13-l17-l30+l5-l33-l37-l15-l18+l7+l25-l14+l35+l40+l16+l1+l2+l26-l3-l39-l22+l23-l36-l27-l9+l6-l41-l0-l31-l20+l12-l8+l29-l11-l34+l21==-<span class="number">502</span>)</span><br><span class="line">x.add(l30-l31-l36+l3+l9-l40-l33+l25+l39-l26+l23-l0-l29-l32-l4+l37+l28+l21+l17+l2+l24+l6+l5+l8+l16+l27+l19+l12+l20+l41-l22+l15-l11+l34-l18-l38+l1-l14==<span class="number">853</span>)</span><br><span class="line">x.add(l38-l10+l16+l8+l21-l25+l36-l30+l31-l3+l5-l15+l23-l28+l7+l12-l29+l22-l0-l37-l14-l11+l32+l33-l9+l39+l41-l19-l1+l18-l4-l6+l13+l20-l2-l35-l26+l27==-<span class="number">28</span>)</span><br><span class="line">x.add(l11+l18-l26+l15-l14-l33+l7-l23-l25+l0-l6-l21-l16+l17-l19-l28-l38-l37+l9+l20-l8-l3+l22-l35-l10-l31-l2+l41-l1-l4+l24-l34+l39+l40+l32-l5+l36-l27==-<span class="number">529</span>)</span><br><span class="line">x.add(l38+l8+l36+l35-l23-l34+l13-l4-l27-l24+l26+l31-l30-l5-l40+l28-l11-l2-l39+l15+l10-l17+l3+l19+l22+l33+l0+l37+l16-l9-l32+l25-l21-l12+l6-l41+l20-l18==-<span class="number">12</span>)</span><br><span class="line">x.add(l6-l30-l20-l27-l14-l39+l41-l33-l0+l25-l32-l3+l26-l12+l8-l35-l24+l15+l9-l4+l13+l36+l34+l1-l28-l21+l18+l23+l29-l10-l38+l22+l37+l5+l19+l7+l16-l31==<span class="number">81</span>)</span><br><span class="line"><span class="built_in">print</span>(x.check())</span><br><span class="line"><span class="built_in">print</span>(x.model())</span><br><span class="line"></span><br><span class="line">l = [<span class="number">0</span>]*<span class="number">42</span> </span><br><span class="line">l[<span class="number">14</span>] = <span class="number">78</span></span><br><span class="line">l[<span class="number">28</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">16</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">17</span>] = <span class="number">101</span></span><br><span class="line">l[<span class="number">6</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">30</span>] = <span class="number">52</span></span><br><span class="line">l[<span class="number">36</span>] = <span class="number">84</span></span><br><span class="line">l[<span class="number">38</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">40</span>] = <span class="number">51</span></span><br><span class="line">l[<span class="number">3</span>] = <span class="number">103</span></span><br><span class="line">l[<span class="number">32</span>] = <span class="number">121</span></span><br><span class="line">l[<span class="number">11</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">9</span>] = <span class="number">110</span></span><br><span class="line">l[<span class="number">31</span>] = <span class="number">83</span></span><br><span class="line">l[<span class="number">0</span>] = <span class="number">102</span></span><br><span class="line">l[<span class="number">4</span>] = <span class="number">123</span></span><br><span class="line">l[<span class="number">1</span>] = <span class="number">108</span></span><br><span class="line">l[<span class="number">41</span>] = <span class="number">125</span></span><br><span class="line">l[<span class="number">35</span>] = <span class="number">49</span></span><br><span class="line">l[<span class="number">8</span>] = <span class="number">48</span></span><br><span class="line">l[<span class="number">19</span>] = <span class="number">85</span></span><br><span class="line">l[<span class="number">15</span>] = <span class="number">71</span></span><br><span class="line">l[<span class="number">21</span>] = <span class="number">84</span></span><br><span class="line">l[<span class="number">18</span>] = <span class="number">113</span></span><br><span class="line">l[<span class="number">23</span>] = <span class="number">48</span></span><br><span class="line">l[<span class="number">34</span>] = <span class="number">87</span></span><br><span class="line">l[<span class="number">7</span>] = <span class="number">108</span></span><br><span class="line">l[<span class="number">25</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">13</span>] = <span class="number">48</span></span><br><span class="line">l[<span class="number">33</span>] = <span class="number">95</span></span><br><span class="line">l[<span class="number">27</span>] = <span class="number">115</span></span><br><span class="line">l[<span class="number">10</span>] = <span class="number">103</span></span><br><span class="line">l[<span class="number">2</span>] = <span class="number">97</span></span><br><span class="line">l[<span class="number">37</span>] = <span class="number">104</span></span><br><span class="line">l[<span class="number">5</span>] = <span class="number">65</span></span><br><span class="line">l[<span class="number">20</span>] = <span class="number">52</span></span><br><span class="line">l[<span class="number">29</span>] = <span class="number">69</span></span><br><span class="line">l[<span class="number">12</span>] = <span class="number">49</span></span><br><span class="line">l[<span class="number">24</span>] = <span class="number">110</span></span><br><span class="line">l[<span class="number">26</span>]= <span class="number">49</span></span><br><span class="line">l[<span class="number">22</span>] = <span class="number">105</span></span><br><span class="line">l[<span class="number">39</span>] = <span class="number">122</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">chr</span>(l[i]),end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>把求出来的手动转换成数组，然后输出</p>


<p>用的是之前的方法做的，感觉不太简洁，看网上还有更好的方法</p>
<p><a target="_blank" rel="noopener" href="https://www.codetd.com/article/10613214">https://www.codetd.com/article/10613214</a></p>
<h1 id="BUUCTF–-V-amp-N2020-公开赛-CSRe"><a href="#BUUCTF–-V-amp-N2020-公开赛-CSRe" class="headerlink" title="BUUCTF–[V&amp;N2020 公开赛]CSRe"></a>BUUCTF–[V&amp;N2020 公开赛]CSRe</h1><p>这题首先是去混淆，然后是逆向.NET文件</p>


<p>exeinfo PE可以得知这是个有混淆的文件.NET文件</p>
<p>使用de4dot文件去混淆</p>


<p>然后用dnSpy逆向.net</p>


<p>str解出来后是1415</p>
<p>text解出来之后是turn</p>
<p>flag{1415turn}</p>
<h1 id="ACTF新生赛2020-SoulLike-elf暴力-x2F-pwntools"><a href="#ACTF新生赛2020-SoulLike-elf暴力-x2F-pwntools" class="headerlink" title="[ACTF新生赛2020]SoulLike (elf暴力&#x2F;pwntools)"></a>[ACTF新生赛2020]SoulLike (elf暴力&#x2F;pwntools)</h1><p>用ida打开</p>






<p>sub_83A太大了，且篇都是xor,mov,add三个指令，</p>


<p>除了最后的几个字符</p>


<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://blog.css8.cn/post/1439298.html">https://blog.css8.cn/post/1439298.html</a></p>
<p>原来是配置的问题，需要修改ida &#x2F;ctg目录下的hexrays.cfg文件中的MAX_FUNCSIZE&#x3D;64，改成1024    </p>






<p>就是将输入的flag，经过3000行的异或后，与最后的几个进行对比</p>
<p>因为最后有提示错误的位数，所以可以试着用爆破的方法……</p>
<p>这边放上大佬整理的关于pwntools的使用方法：</p>
<p><a target="_blank" rel="noopener" href="https://seamiloak.github.io/2020/10/16/pwntools%E4%BD%BF%E7%94%A8/">https://seamiloak.github.io/2020/10/16/pwntools%E4%BD%BF%E7%94%A8/</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/hanqdi_/article/details/107164199">https://blog.csdn.net/hanqdi_/article/details/107164199</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">table = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">    table.append(<span class="built_in">chr</span>(i))</span><br><span class="line"></span><br><span class="line">now = <span class="string">&quot;actf&#123;&quot;</span></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="comment"># 长度为12，跳出</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">12</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line"></span><br><span class="line">        io = process(<span class="string">&#x27;./SoulLike&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 构造flag</span></span><br><span class="line">        flag = now + i</span><br><span class="line">        flag = flag.ljust(<span class="number">17</span>,<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">        flag += <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"># success(flag)</span></span><br><span class="line">        io.sendline(flag)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#一直读到#出现为止</span></span><br><span class="line">        io.recvuntil(<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#10位之后就读两位</span></span><br><span class="line">        <span class="keyword">if</span> num &lt; <span class="number">9</span> :</span><br><span class="line"></span><br><span class="line">            <span class="comment">#recv里的1是接受的字节长度，n是数值</span></span><br><span class="line">            n = <span class="built_in">int</span>(io.recv(<span class="number">1</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            n = <span class="built_in">int</span>(io.recv(<span class="number">2</span>))</span><br><span class="line">           </span><br><span class="line">        io.close()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果n==num+1，则跳出内层循环</span></span><br><span class="line">        <span class="keyword">if</span> n == num + <span class="number">1</span>:</span><br><span class="line">            now = now + i</span><br><span class="line">            num = num + <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (num)</span><br><span class="line"><span class="built_in">print</span> (now + <span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>



<p>太强了！！</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="http://bubuko.com/infodetail-3671012.html">http://bubuko.com/infodetail-3671012.html</a></p>
<h1 id="羊城杯-2020-easyre-（base64-x2F-凯撒）"><a href="#羊城杯-2020-easyre-（base64-x2F-凯撒）" class="headerlink" title="[羊城杯 2020]easyre （base64&#x2F;凯撒）"></a>[羊城杯 2020]easyre （base64&#x2F;凯撒）</h1><p>还是很庆幸自己能独立做出来这一题的</p>




<p>第一个加密是base64加密，</p>


<p>第二个加密是base64加密后的变换，</p>




<p>第三次加密是所有字符向后+3</p>


<p>主要是第二次的加密，不知道到底是怎样转换的，</p>
<p>放到x64dbg中动调了一下</p>
<p>输入时带入了字符串</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string = abcdefghijklmnopqrstuvwxyz0123456789012</span><br></pre></td></tr></table></figure>

<p>一次加密后：</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5MTI=&quot;</span></span><br></pre></td></tr></table></figure>

<p>二次加密后：</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;R1dnd4eXowMTIYWJjZGVmZ2hpazNDU2Nzg5MTI=mtsbW5vcHFyc3&quot;</span></span><br></pre></td></tr></table></figure>

<p>当时看到加密函数之后人傻了，仔细观察发现只是固定字符段调换了位置，就写出了下面的解法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#a3--&gt;a1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode2</span>(<span class="params">decode_string</span>):</span><br><span class="line">    a3 = decode_string</span><br><span class="line">    a = a3[<span class="number">0</span>:<span class="number">13</span>]</span><br><span class="line">    b = a3[<span class="number">13</span>:<span class="number">26</span>]</span><br><span class="line">    c = a3[<span class="number">26</span>:<span class="number">39</span>]</span><br><span class="line">    d = a3[<span class="number">39</span>:<span class="number">52</span>]</span><br><span class="line"></span><br><span class="line">    a1 = b+d+a+c</span><br><span class="line">    <span class="built_in">print</span>(a1)</span><br><span class="line">    <span class="keyword">return</span> a1</span><br></pre></td></tr></table></figure>

<p>三次加密后：</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;U4gqg7hArzPWLBZMmCJYpC5ksdcQGX5Qcj8PWL=pwveZ8yfKIbf6</span></span><br></pre></td></tr></table></figure>

<p>整体还是不难的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">flag_encode_3_times = <span class="string">&quot;EmBmP5Pmn7QcPU4gLYKv5QcMmB3PWHcP5YkPq3=cT6QckkPckoRG&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#a3--&gt;a1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode2</span>(<span class="params">decode_string</span>):</span><br><span class="line">    a3 = decode_string</span><br><span class="line">    a = a3[<span class="number">0</span>:<span class="number">13</span>]</span><br><span class="line">    b = a3[<span class="number">13</span>:<span class="number">26</span>]</span><br><span class="line">    c = a3[<span class="number">26</span>:<span class="number">39</span>]</span><br><span class="line">    d = a3[<span class="number">39</span>:<span class="number">52</span>]</span><br><span class="line"><span class="comment">##    print(a)</span></span><br><span class="line"><span class="comment">##    print(b)</span></span><br><span class="line"><span class="comment">##    print(c)</span></span><br><span class="line"><span class="comment">##    print(d)</span></span><br><span class="line">    a1 = b+d+a+c</span><br><span class="line">    <span class="built_in">print</span>(a1)</span><br><span class="line">    <span class="keyword">return</span> a1</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode1</span>(<span class="params">string</span>):</span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(string)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">        m = <span class="built_in">ord</span>(i)</span><br><span class="line">        <span class="keyword">if</span> m &gt;= <span class="number">65</span> <span class="keyword">and</span> m &lt;= <span class="number">90</span>:</span><br><span class="line">            s += <span class="built_in">chr</span>((m-<span class="number">65</span>+<span class="number">23</span>)%<span class="number">26</span>+<span class="number">65</span>)      </span><br><span class="line">        <span class="keyword">elif</span> m &gt;= <span class="number">97</span> <span class="keyword">and</span> m &lt;= <span class="number">122</span>:</span><br><span class="line">            s += <span class="built_in">chr</span>((m-<span class="number">97</span>+<span class="number">23</span>)%<span class="number">26</span>+<span class="number">97</span>)      </span><br><span class="line">        <span class="keyword">elif</span> m &gt;= <span class="number">48</span> <span class="keyword">and</span> m &lt;= <span class="number">57</span>:</span><br><span class="line">            s += <span class="built_in">chr</span>((m-<span class="number">48</span>+<span class="number">7</span>)%<span class="number">10</span>+<span class="number">48</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s += i</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">decode_string = decode1(flag_encode_3_times)</span><br><span class="line"></span><br><span class="line">decode2_string = decode2(decode_string)</span><br><span class="line"></span><br><span class="line">decode3_string = base64.b64decode(decode2_string)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decode3_string)</span><br></pre></td></tr></table></figure>





<h1 id="findKey-花指令-正逆向-MD5"><a href="#findKey-花指令-正逆向-MD5" class="headerlink" title="findKey (花指令+正逆向+MD5)"></a>findKey (花指令+正逆向+MD5)</h1><p>先查个壳</p>


<p>打开运行之后：</p>


<p>发现有花指令：</p>


<p>push了两个一样的指令，需要把下面一个去掉才行，nop一次就好</p>
<p>（大佬z1r0说，下面调用了一个系统的strlen函数，在call函数前，应该会push参数到栈中，而突然跳转本来就很奇怪……）</p>


<p>最后选中&#x3D;&#x3D;所有&#x3D;&#x3D;红色的代码，按一下p键，就反汇编成功了</p>
<p>&#x3D;&#x3D;注意，选中的代码一定要包含所有的红色代码，否则会有函数不显示&#x3D;&#x3D;</p>
<p>开始分析代码：（题目是findkey，而且也没有的输入……）</p>
<p>进一下sub_40101E函数，发现关键词8003u，是熟悉的味道：md5</p>


<p>string1经过md5加密之后，与v15异或，需要等于Str的值</p>


<p>经过if判断之后，string1再与v14异或，得到flag</p>
<p>整个程序可以写成以下的伪代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Str = <span class="string">&quot;0kk`d1a`55k222k2a776jbfgd`06cjjb&quot;</span></span><br><span class="line">string1 = string1(md5加密)</span><br><span class="line"><span class="keyword">if</span> string1^v15 == Str:</span><br><span class="line">	flag = string1^v14</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Are you kidding me?&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>逆向思路：</p>
<p>–&gt;Str^v15–&gt;string1(md5加密后)</p>
<p>–&gt;md5解密还原string1</p>
<p>–&gt;string1与v14异或</p>
<p>–&gt;解出flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Str = <span class="string">&quot;0kk`d1a`55k222k2a776jbfgd`06cjjb&quot;</span></span><br><span class="line">v15 = <span class="built_in">ord</span>(<span class="string">&#x27;S&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> _<span class="built_in">str</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)^v15),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>得出string1的值为“123321”</p>


<p>v14的值：</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v14 = [<span class="number">0x57</span>,<span class="number">0x5E</span>,<span class="number">0x52</span>,<span class="number">0x54</span>,<span class="number">0x49</span>,<span class="number">0x5F</span>,<span class="number">0x1</span>,<span class="number">0x6D</span>,<span class="number">0x69</span>,<span class="number">0x46</span>,<span class="number">0x2</span>,<span class="number">0x6E</span>,<span class="number">0x5F</span>,<span class="number">0x2</span>,<span class="number">0x6C</span>,<span class="number">0x57</span>,<span class="number">0x5B</span>,<span class="number">0x54</span>,<span class="number">0x4C</span>]</span><br></pre></td></tr></table></figure>

<p>string1与v15异或：</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v14 = [<span class="number">0x57</span>,<span class="number">0x5E</span>,<span class="number">0x52</span>,<span class="number">0x54</span>,<span class="number">0x49</span>,<span class="number">0x5F</span>,<span class="number">0x1</span>,<span class="number">0x6D</span>,<span class="number">0x69</span>,<span class="number">0x46</span>,<span class="number">0x2</span>,<span class="number">0x6E</span>,<span class="number">0x5F</span>,<span class="number">0x2</span>,<span class="number">0x6C</span>,<span class="number">0x57</span>,<span class="number">0x5B</span>,<span class="number">0x54</span>,<span class="number">0x4C</span>]</span><br><span class="line">string1 = [<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;1&#x27;</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v14)):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(v14[i]^<span class="built_in">ord</span>(string1[i%<span class="number">6</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{n0_Zu0_n0_die}</p>
<h1 id="GUET-CTF2019-number-game-动调-x2F-二叉树"><a href="#GUET-CTF2019-number-game-动调-x2F-二叉树" class="headerlink" title="[GUET-CTF2019]number_game (动调&#x2F;二叉树)"></a>[GUET-CTF2019]number_game (动调&#x2F;二叉树)</h1><p>ida打开函数，是这个样子：</p>


<p>4006D6判断输入字符类型，不满足直接输出wrong</p>
<p>400758这块把我看迷糊了，很像二叉树的前序遍历</p>


<p>后面的400807也是一个打乱顺序的函数</p>








<p>用户输入字符–&gt;两个函数打乱–&gt;满足数独情况</p>
<p>满足数独的情况是</p>
<p>[0，4，2，1，4，2，1，4，3，0]</p>
<p>下午直接找了大佬z1r0来研究这一题。</p>
<p>首先我们想到的是pwndbg来动态调试这一题，当然调试出来了，但是我们带入的是值，不是下标，没有很好的解决这一题，然后我们选择了爆破，只是我们的方法不太好，也就爆破个几个小时就出来了……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">file_name = <span class="string">&#x27;./z1r0&#x27;</span></span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">r = process(file_name)</span><br><span class="line">d = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">ppp =[<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ppp:  </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> ppp:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> ppp:</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> ppp:</span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> ppp:</span><br><span class="line">                    <span class="keyword">for</span> n <span class="keyword">in</span> ppp:</span><br><span class="line">                        <span class="keyword">for</span> o <span class="keyword">in</span> ppp:</span><br><span class="line">                            <span class="keyword">for</span> p <span class="keyword">in</span> ppp:</span><br><span class="line">                                <span class="keyword">for</span> q <span class="keyword">in</span> ppp:</span><br><span class="line">                                    <span class="keyword">for</span> s <span class="keyword">in</span> ppp:</span><br><span class="line">                                        <span class="keyword">try</span>:</span><br><span class="line">                                            r = process(file_name)</span><br><span class="line">                                            d = i + j + k + l + m + n + o + p + q + s</span><br><span class="line"><span class="comment">#d = &#x27;11342400&#x27; + i + j </span></span><br><span class="line">                                            r.sendline(d)</span><br><span class="line">                                            <span class="keyword">if</span> r.recvline() == <span class="string">b&#x27;TQL!\n&#x27;</span>:</span><br><span class="line">                                                r.interactive()</span><br><span class="line">                                        <span class="keyword">except</span>:</span><br><span class="line">                                            <span class="built_in">print</span>(<span class="string">&#x27;error&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/th1r7een/articles/14532420.html">https://www.cnblogs.com/th1r7een/articles/14532420.html</a></p>
<p>这题最好还是正向来做……</p>
<p>首先是sub_400758函数构建了一颗二叉树</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">index,lenth</span>):</span><br><span class="line">	<span class="built_in">print</span>(index)</span><br><span class="line">	<span class="keyword">if</span> index &gt; lenth:</span><br><span class="line">		<span class="keyword">return</span> </span><br><span class="line">	test(<span class="number">2</span>*index+<span class="number">1</span>,lenth)</span><br><span class="line">	test(<span class="number">2</span>*(index+<span class="number">1</span>),lenth)</span><br><span class="line"></span><br><span class="line">test(<span class="number">0</span>,<span class="number">10</span>)</span><br></pre></td></tr></table></figure>





<p>中序遍历后的顺序为：[7,3,8,1,9,4,0,5,2,6]</p>




<p>flag{1134240024}</p>


<p>发现IDA还可以动调！！</p>
<p>需要查看IDA权威指南，IDA动调的话，先放一防，先刷题先……</p>
<h1 id="firmware-路由器逆向-x2F-binwalk"><a href="#firmware-路由器逆向-x2F-binwalk" class="headerlink" title="firmware (路由器逆向&#x2F;binwalk)"></a>firmware (路由器逆向&#x2F;binwalk)</h1><p>关于固件分析的文章：</p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/ics-articles/262454.html">https://www.freebuf.com/articles/ics-articles/262454.html</a></p>
<p>关于路由器逆向的文章：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/QQ1084283172/article/details/66971242">https://blog.csdn.net/QQ1084283172/article/details/66971242</a></p>
<p>通常固件文件以bin&#x2F;zip&#x2F;LZMA&#x2F;arj等文件压缩类型封装。</p>
<p>题目给了一个bin文件，</p>
<p>用linux的file命令查看一下，查看是否是二进制镜像文件</p>


<p>通常用binwalk对其进行提取，当然也可以再用binwalk查看一下bin文件的细节信息</p>


<p>用binwalk对bin文件进行提取（e–extract）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binwalk -e firmware.<span class="built_in">bin</span></span><br></pre></td></tr></table></figure>



<p>可以看到提取出了这些文件</p>
<p>我们再通过hexdump或者file确认一下，是否是squashsf文件系统，其地址00包含squashsf的头部特征(hsqs)</p>






<p>squashsf后缀文件需要进一步解压，从而获得固件的根文件</p>
<p>可能是binwalk没有安装完全，导致squashfs文件系统损坏</p>


<p>binwalk安装传送门：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/QQ1084283172/article/details/65441110">https://blog.csdn.net/QQ1084283172/article/details/65441110</a></p>
<p>摸索了很久，发现firmware-mod-kit可以成功解压squashfs文件系统，</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/sjt670994562/article/details/98071249">https://blog.csdn.net/sjt670994562/article/details/98071249</a></p>
<p>这边放上github的firmware-mod-kit的链接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/mirror/firmware-mod-kit</span><br></pre></td></tr></table></figure>

<p>炸了……搞了很久还是报错kali和ubuntu都试过了……</p>


<p>再放一放……</p>
<p>–更新–</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install firmware-mod-kit</span><br></pre></td></tr></table></figure>

<p>直接用apt安装即可（感谢大佬z1r0的指导！！）默认路径在opt下，在binwalk提取bin文件后的目录下输入下面的指令就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/opt/firmware-mod-kit/trunk/unsquashfs_all.sh ./<span class="number">120200.</span>squashfs  </span><br></pre></td></tr></table></figure>



<p>进入squashfs-root目录下的tmp文件夹</p>


<p>file一下，elf文件，ARM类型，但是无法执行</p>


<p>发现有upx壳</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upx -d backdoor  </span><br></pre></td></tr></table></figure>

<p>脱壳之后放在ida里面反汇编</p>







<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo.byethost51.com:<span class="number">36667</span></span><br></pre></td></tr></table></figure>

<p>​    flag{33a422c45d551ac6e4756f59812a954b}</p>
<h1 id="WMCTF2020-easy-re-perl特性"><a href="#WMCTF2020-easy-re-perl特性" class="headerlink" title="[WMCTF2020]easy_re (perl特性)"></a>[WMCTF2020]easy_re (perl特性)</h1>

<p>查壳后发现没壳，用x64dbg打开</p>


<p>搜索script，并添加断点</p>


<p>向下F8，flag就出来了</p>


<p>WMCTF{I_WAnt_dynam1c_F1ag}</p>
<p>据说是因为perl语言解压call有字符串script，</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/Palmer9/article/details/107727922">https://blog.csdn.net/Palmer9/article/details/107727922</a></p>
<h1 id="crackMe-od动调"><a href="#crackMe-od动调" class="headerlink" title="crackMe (od动调)"></a>crackMe (od动调)</h1>

<p>用ida32打开后</p>


<p>最外层是一个死循环，要想跳出死循环，需要满足后面的if嵌套，</p>
<p>可以发现if嵌套上面的sub_401090是用来给byte_416050赋值的，还把welcomebeijing这个用户名作为了参数传递到了其中</p>




<p>接着跟进sub_401830，说了一大串之后，v17作为二参进入了sub_401470</p>




<p>要使得v14，也就是sub_40147中的a3等于43924,需要满足a2满足所有的if条件，也就是a2&#x3D;”dbappsec”，即v17&#x3D;”dbappsec”，猜测v17是输入的flag经过变换后对比的值</p>




<p>返回sub_401830函数，关于v17的值的代码块也就只有这边了</p>




<p>接下来，我们需要动调，把与byte_416050异或的v16数组求出来</p>




<p>通过明显的地方，可以推算出ida和x32dbg的地址差</p>








<p>光标确定到某一参数，按住tab键可以查看其汇编代码，在伪代码窗口的定义部分可以看到这些参数关于ebp的偏移</p>
<p>加上偏移量就能快速定位到需要执行的函数了</p>


<p>在ida中定位while大循环，然后再dbg中定位，在循环开始和xor处打断点，多按几次F9,记录一下edx低位的值</p>






<p>正向：</p>
<p>user输入–&gt;byte_406050–&gt;byte_406050^v16[v5-1]–&gt;v17</p>
<p>逆向：</p>
<p>v17–&gt;byte_406050^v17–&gt;v16[v5-1]</p>
<p>byte_406050数组，是user传入之后经过一系列变换生成的，我们需要动调的就是byte_406050的值，然后在与已知的v17异或，就是v16的值了，也就是题目要求的flag</p>
<p>我动调之后的结果是[0x7e,0x98,0xc9,0x95,0x10,0x6d,0xf3,0x67]</p>
<p>先放一放……</p>
<p>—-更新—-</p>


<p>在xor的上下有两个反调试指令，所以应该把je改成jmp,动调就行了</p>


<p>调试结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v16 = [<span class="number">0x2a</span>,<span class="number">0xd7</span>,<span class="number">0x92</span>,<span class="number">0xe9</span>,<span class="number">0x53</span>,<span class="number">0xe2</span>,<span class="number">0xc4</span>,<span class="number">0xcd</span>]</span><br></pre></td></tr></table></figure>

<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v16 = [<span class="number">0x2a</span>,<span class="number">0xd7</span>,<span class="number">0x92</span>,<span class="number">0xe9</span>,<span class="number">0x53</span>,<span class="number">0xe2</span>,<span class="number">0xc4</span>,<span class="number">0xcd</span>]</span><br><span class="line">v17 = <span class="string">&quot;dbappsec&quot;</span></span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    flag.append(<span class="built_in">hex</span>(v16[i]^<span class="built_in">ord</span>(v17[i])).replace(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;&quot;</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(i,end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>关于反调试的可以看看雪大神的这篇文章：</p>
<p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-225740.htm">https://bbs.pediy.com/thread-225740.htm</a></p>
<p>参考文章：</p>
<p><a target="_blank" rel="noopener" href="https://www.songbingjia.com/nginx/show-209658.html">https://www.songbingjia.com/nginx/show-209658.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pppyyyzzz/p/12546844.html">https://www.cnblogs.com/pppyyyzzz/p/12546844.html</a></p>
<h1 id="特殊的base64-base64换表"><a href="#特殊的base64-base64换表" class="headerlink" title="特殊的base64 (base64换表)"></a>特殊的base64 (base64换表)</h1>

<p>经典的base64换表，“mTy……”是换表之后的加密的字符串，字符串搜索之后可以看到换的base64表。</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">string = <span class="string">&quot;mTyqm7wjODkrNLcWl0eqO8K8gc1BPk1GNLgUpI==&quot;</span></span><br><span class="line"></span><br><span class="line">new_base = <span class="string">&quot;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0987654321/+&quot;</span></span><br><span class="line"></span><br><span class="line">base = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(new_base))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(base))</span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(string.translate(<span class="built_in">str</span>.maketrans(new_base,base)))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>





<h1 id="网鼎杯-2020-青龙组-singal-vm题-x2F-ponce插件"><a href="#网鼎杯-2020-青龙组-singal-vm题-x2F-ponce插件" class="headerlink" title="[网鼎杯 2020 青龙组]singal (vm题&#x2F;ponce插件)"></a>[网鼎杯 2020 青龙组]singal (vm题&#x2F;ponce插件)</h1><p>传送门：<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1176826-1-1.html">https://www.52pojie.cn/thread-1176826-1-1.html</a></p>
<p>查壳，发现没有壳</p>


<p>这个qmemcpy的意思是把unk_403040的456个字符复制到v4中</p>


<p>这个题就是首先是需要去摸清楚指令的调用顺序</p>
<p>进行观察，可以发现，v4 与 a1[v10 + 1]比较 是判断条件，a1是输入的opcode, 而v4来自v5，v5由flag进行运算得到:<br>flag—&gt;v5—-&gt;v4<br>所以我们要得到v4,然后推v5，再得到flag</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> vmcode[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x10</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x21</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x24</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x25</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x36</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x25</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x41</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x34</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x32</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x72</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x33</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x18</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xA7</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>,</span><br><span class="line">  <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x28</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x84</span>, <span class="number">0xFF</span>,</span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>,</span><br><span class="line">  <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x1E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x7A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> * a = (<span class="type">int</span> *)vmcode;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">vm_operad</span><span class="params">(<span class="type">int</span> *opcode, <span class="type">int</span> len_114)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">char</span> order[<span class="number">114</span>] = &#123;&#125;;        <span class="comment">//顺序         即i</span></span><br><span class="line">        <span class="type">char</span> flag[<span class="number">100</span>]; <span class="comment">// [esp+13h] [ebp-E5h]</span></span><br><span class="line">        <span class="type">char</span> v4[<span class="number">100</span>]; <span class="comment">// [esp+77h] [ebp-81h]</span></span><br><span class="line">        <span class="type">char</span> v5; <span class="comment">// [esp+DBh] [ebp-1Dh]</span></span><br><span class="line">        <span class="type">int</span> j; <span class="comment">// [esp+DCh] [ebp-1Ch]</span></span><br><span class="line">        <span class="type">int</span> m; <span class="comment">// [esp+E0h] [ebp-18h]</span></span><br><span class="line">        <span class="type">int</span> k; <span class="comment">// [esp+E4h] [ebp-14h]</span></span><br><span class="line">        <span class="type">int</span> n; <span class="comment">// [esp+E8h] [ebp-10h]</span></span><br><span class="line">        <span class="type">int</span> i; <span class="comment">// [esp+ECh] [ebp-Ch]</span></span><br><span class="line">        <span class="type">int</span> s = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">        i = <span class="number">0</span>;</span><br><span class="line">        n = <span class="number">0</span>;</span><br><span class="line">        k = <span class="number">0</span>;</span><br><span class="line">        m = <span class="number">0</span>;</span><br><span class="line">        j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">if</span> (i &gt;= len_114)                         <span class="comment">// 成功的地方</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">switch</span> (opcode[i])</span><br><span class="line">                &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                        v4[m] = v5;</span><br><span class="line">                        ++i;</span><br><span class="line">                        ++m;</span><br><span class="line">                        ++n;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                        v5 = opcode[i + <span class="number">1</span>] + flag[n];</span><br><span class="line">                        i += <span class="number">2</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                        v5 = flag[n] - opcode[i + <span class="number">1</span>];</span><br><span class="line">                        i += <span class="number">2</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                        v5 = opcode[i + <span class="number">1</span>] ^ flag[n];</span><br><span class="line">                        i += <span class="number">2</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                        v5 = opcode[i + <span class="number">1</span>] * flag[n];</span><br><span class="line">                        i += <span class="number">2</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">                        ++i;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">                        v4[k] = opcode[i + <span class="number">1</span>];                        <span class="comment">// 打印关键数据V4</span></span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;%#X, &quot;</span>, v4[k]);                </span><br><span class="line">                        ++k;</span><br><span class="line">                        i += <span class="number">2</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                        flag[j] = v5;</span><br><span class="line">                        ++i;</span><br><span class="line">                        ++j;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">                        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, flag);                                <span class="comment">// 输入flag                //长度是15</span></span><br><span class="line">                        ++i;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">                        v5 = flag[n] - <span class="number">1</span>;</span><br><span class="line">                        ++i;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">                        v5 = flag[n] + <span class="number">1</span>;</span><br><span class="line">                        ++i;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                order[s++] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n执行顺序是: &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> ss = <span class="number">0</span>; ss &lt; <span class="built_in">strlen</span>(order); ss++) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d, &quot;</span>, order[ss]);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">decode</span><span class="params">(<span class="type">int</span> * opcode, <span class="type">int</span> len_114)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">int</span> i;</span><br><span class="line">        <span class="comment">//获取flag 的关键数据</span></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> v4[] = &#123; <span class="number">0X22</span>, <span class="number">0X3F</span>, <span class="number">0X34</span>, <span class="number">0X32</span>, <span class="number">0X72</span>, <span class="number">0X33</span>, <span class="number">0X18</span>, <span class="number">0XFFFFFFA7</span>, <span class="number">0X31</span>, <span class="number">0XFFFFFFF1</span>, <span class="number">0X28</span>, <span class="number">0XFFFFFF84</span>, <span class="number">0XFFFFFFC1</span>, <span class="number">0X1E</span>, <span class="number">0X7A</span> &#125;;</span><br><span class="line">        <span class="comment">//执行opcode 的索引，即执行顺序</span></span><br><span class="line">        <span class="type">char</span> order[<span class="number">100</span>] = &#123; <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">35</span>, <span class="number">36</span>, <span class="number">38</span>, <span class="number">39</span>, <span class="number">41</span>, <span class="number">42</span>, <span class="number">44</span>, <span class="number">45</span>, <span class="number">46</span>, <span class="number">47</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">57</span>, <span class="number">58</span>, <span class="number">60</span>, <span class="number">61</span>, <span class="number">63</span>, <span class="number">64</span>, <span class="number">66</span>, <span class="number">67</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">72</span>, <span class="number">73</span>, <span class="number">75</span>, <span class="number">76</span>, <span class="number">78</span>, <span class="number">79</span>, <span class="number">81</span>, <span class="number">82</span>, <span class="number">83</span>, <span class="number">84</span>, <span class="number">86</span>, <span class="number">88</span>, <span class="number">90</span>, <span class="number">92</span>, <span class="number">94</span>, <span class="number">96</span>, <span class="number">98</span>, <span class="number">100</span>, <span class="number">102</span>, <span class="number">104</span>, <span class="number">106</span>, <span class="number">108</span>, <span class="number">110</span>, <span class="number">112</span>, <span class="number">114</span> &#125;;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> flag[<span class="number">100</span>] = &#123;&#125;;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">15</span>;</span><br><span class="line">        <span class="type">int</span> n = <span class="number">15</span>;</span><br><span class="line">        <span class="type">int</span> j = <span class="number">15</span>;</span><br><span class="line">        <span class="type">int</span> v5;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = <span class="built_in">strlen</span>(order) - <span class="number">1</span>; k &gt;= <span class="number">0</span> ; k--)</span><br><span class="line">        &#123;</span><br><span class="line">                i = order[k];</span><br><span class="line">                <span class="keyword">switch</span> (opcode[i])                                <span class="comment">// 倒序执行</span></span><br><span class="line">                &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                        --m;</span><br><span class="line">                        --n;</span><br><span class="line">                        v5 = v4[m];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                        flag[n] = v5 - <span class="type">char</span>(opcode[i + <span class="number">1</span>]) ;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                    flag[n] = v5 + <span class="type">char</span>(opcode[i + <span class="number">1</span>]);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                        flag[n] = (v5 ^ opcode[i + <span class="number">1</span>]) &amp; <span class="number">0XFF</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                        flag[n] = v5 / opcode[i + <span class="number">1</span>];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                        v5 = flag[--j];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">                        flag[n] = v5 + <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">                        flag[n] = v5 - <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, flag);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;        </span><br><span class="line">        vm_operad(a, <span class="number">114</span>);</span><br><span class="line">        decode(a, <span class="number">114</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>通过case7对比的数组v4来求出v5，即执行的顺序,然后通过v5来求出flag反向推出flag，执行顺序由后往前。</p>
<p>学到一招，可以把多行的数据转换成数组</p>




<p><a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1187493-1-1.html">https://www.52pojie.cn/thread-1187493-1-1.html</a></p>
<p>很好奇还有关于ida插件ponce的使用来解决这一道题</p>
<p>–待更新–</p>
<h1 id="GWCTF-2019-xxor-（xor-plus）"><a href="#GWCTF-2019-xxor-（xor-plus）" class="headerlink" title="[GWCTF 2019]xxor （xor plus）"></a>[GWCTF 2019]xxor （xor plus）</h1><p>当初发现这个题目不是一般的难，就跳过了，这次正好来总结一下。</p>
<p>下载后发现是个linux文件，先放linux运行一下：</p>


<p>放到ida里面看一下</p>


<p>首先是循环输入六次，然后进入一个循环，然后sub_400686这个函数一看就是加密函数了，一参是我们输入的值，二参是一个固定数组。</p>


<p>2 dup(2) ,就是2出现两次的意思，上次个maze题也出现过</p>
<p>那这样二参我们就知道了：{2,2,3,4}</p>
<p>注意一下第二个循环，j循环了三次</p>


<p>后面的的sub_400770则是比较函数了</p>


<p>我们跟进：</p>


<p>我这边正好熟悉一下z3的用法：</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a0,a1,a2,a3,a4,a5 = Ints(<span class="string">&#x27;a0 a1 a2 a3 a4 a5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">x = Solver()</span><br><span class="line"></span><br><span class="line">x.add(a2 - a3 == <span class="number">2225223423</span>)</span><br><span class="line">x.add(a3 + a4 == <span class="number">4201428739</span>)</span><br><span class="line">x.add(a2 - a4 == <span class="number">1121399208</span>)</span><br><span class="line">x.add(a0 == <span class="number">3746099070</span>)</span><br><span class="line">x.add(a5 == <span class="number">2230518816</span>)</span><br><span class="line">x.add(a1 == <span class="number">550153460</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x.check())</span><br><span class="line"><span class="built_in">print</span>(x.model())</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> lis[] = &#123;<span class="number">3746099070</span>, <span class="number">550153460</span>,<span class="number">3774025685</span>,<span class="number">1548802262</span>,<span class="number">2652626477</span>,<span class="number">2230518816</span>&#125;;</span><br></pre></td></tr></table></figure>

<p>也就是六个数字，循环三次，两两计算</p>
<p>v5初始等于0，那逆向就是0x40*1166789954 &#x3D; 74674557056，原来每次递增，那么最后就递减</p>
<p>别的如果是加，那么就都减去，次序再调换一下</p>
<p>（貌似python对位移运算不够友善，以后做这种计算的题目还是用c吧）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a[] = &#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> lis[] = &#123;<span class="number">3746099070</span>, <span class="number">550153460</span>,<span class="number">3774025685</span>,<span class="number">1548802262</span>,<span class="number">2652626477</span>,<span class="number">2230518816</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">function</span><span class="params">(<span class="type">unsigned</span>* x)</span>&#123;</span><br><span class="line">    <span class="type">unsigned</span>  v3 = *x;</span><br><span class="line">    <span class="type">unsigned</span>  v4 = *(x + <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> v5 = <span class="number">74674557056</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">63</span> ;i++)&#123;</span><br><span class="line">        v4 -= (v3 + v5 + <span class="number">20</span>) ^ ((v3 &lt;&lt; <span class="number">6</span>) + a[<span class="number">2</span>]) ^ ((v3 &gt;&gt; <span class="number">9</span>) + a[<span class="number">3</span>]) ^ <span class="number">0x10</span>;</span><br><span class="line">        v3 -= (v4 + v5 + <span class="number">11</span>) ^ ((v4 &lt;&lt; <span class="number">6</span>) + a[<span class="number">0</span>]) ^ ((v4 &gt;&gt; <span class="number">9</span>) + a[<span class="number">1</span>]) ^ <span class="number">0x20</span>;</span><br><span class="line">        v5 -= <span class="number">1166789954</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    *x = v3;</span><br><span class="line">    *(x+<span class="number">1</span>) = v4;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span> ;i += <span class="number">2</span>)&#123;</span><br><span class="line">        function(lis+i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">6</span> ;i ++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c%c%c&quot;</span>,(lis[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>,(lis[i] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>,lis[i] &amp; <span class="number">0xff</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>令我疑惑的是，为什么会有下面的操作？</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">6</span> ;i ++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c%c%c&quot;</span>,(lis[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>,(lis[i] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>,lis[i] &amp; <span class="number">0xff</span>);</span><br></pre></td></tr></table></figure>

<p>思考了一下，发现不加后面的&amp;0xff结果也一样</p>








<h1 id="WUSTCTF2020-level4（二叉树遍历）"><a href="#WUSTCTF2020-level4（二叉树遍历）" class="headerlink" title="[WUSTCTF2020]level4（二叉树遍历）"></a>[WUSTCTF2020]level4（二叉树遍历）</h1><p>先放linux里面运行了一下</p>


<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2f</span>0t02T&#123;hcsiI_SwA__r7Ee&#125;</span><br><span class="line"><span class="number">20f</span>0Th&#123;<span class="number">2</span>tsIS_icArE&#125;e7__w</span><br><span class="line"> <span class="comment">//type3(&amp;x[22]);   No way!</span></span><br></pre></td></tr></table></figure>





<p>ida打开</p>


<p>只能理解为顺序错了，两串字符串的内容是一致的。</p>


<p>两个函数都是递归函数，Type1函数putchar（）在中间，Type2函数putchar（）在后面，而且上面的提示语句（Data Structure）已经告诉我们是关于数据结构的东西。我们便可以想到是树的前中后遍历，那么Type1就是中序遍历,Type2函数就是后序遍历，我们需要的就是Type3就是前序遍历，开始手动绘制……</p>


<p>wctf2020{This_IS_A_7reE}</p>
<h1 id="ACTF新生赛2020-Universe-final-answer-z3计算"><a href="#ACTF新生赛2020-Universe-final-answer-z3计算" class="headerlink" title="[ACTF新生赛2020]Universe_final_answer (z3计算)"></a>[ACTF新生赛2020]Universe_final_answer (z3计算)</h1>

<p>查个壳，然后用ida64打开</p>


<p>跟进这个sub_860函数，就能看到一堆的方程</p>


<p>在网上学习了一下python中z3的基本用法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">a,s,d = Ints(<span class="string">&#x27;a s d&#x27;</span>)</span><br><span class="line">x = Solver()</span><br><span class="line">x.add(a-d == <span class="number">18</span>)</span><br><span class="line">x.add(a+s == <span class="number">12</span>)</span><br><span class="line">x.add(s-d == <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">x.check()</span><br><span class="line">x.model()</span><br><span class="line"><span class="built_in">print</span>(x.model())</span><br></pre></td></tr></table></figure>

<p>下面开始着手编写对应脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">v1,v2,v3,v4,v5,v6,v7,v8,v9,v11 = Ints(<span class="string">&#x27;v1 v2 v3 v4 v5 v6 v7 v8 v9 v11&#x27;</span>)</span><br><span class="line">x = Solver()</span><br><span class="line">x.add(-<span class="number">85</span> * v9 + <span class="number">58</span> * v8 + <span class="number">97</span> * v6 + v7 + -<span class="number">45</span> * v5 + <span class="number">84</span> * v4 + <span class="number">95</span> * v2 - <span class="number">20</span> * v1 + <span class="number">12</span> * v3 == <span class="number">12613</span>)</span><br><span class="line">x.add(<span class="number">30</span> * v11 + -<span class="number">70</span> * v9 + -<span class="number">122</span> * v6 + -<span class="number">81</span> * v7 + -<span class="number">66</span> * v5 + -<span class="number">115</span> * v4 + -<span class="number">41</span> * v3 + -<span class="number">86</span> * v1 - <span class="number">15</span> * v2 - <span class="number">30</span> * v8 == -<span class="number">54400</span>)</span><br><span class="line">x.add(-<span class="number">103</span> * v11 + <span class="number">120</span> * v8 + <span class="number">108</span> * v7 + <span class="number">48</span> * v4 + -<span class="number">89</span> * v3 + <span class="number">78</span> * v1 - <span class="number">41</span> * v2 + <span class="number">31</span> * v5 - v6 * <span class="number">64</span> - <span class="number">120</span> * v9 == -<span class="number">10283</span>)</span><br><span class="line">x.add(<span class="number">71</span> * v6 + v7 * <span class="number">128</span> + <span class="number">99</span> * v5 + -<span class="number">111</span> * v3 + <span class="number">85</span> * v1 + <span class="number">79</span> * v2 - <span class="number">30</span> * v4 - <span class="number">119</span> * v8 + <span class="number">48</span> * v9 - <span class="number">16</span> * v11 == <span class="number">22855</span>)</span><br><span class="line">x.add( <span class="number">5</span> * v11 + <span class="number">23</span> * v9 + <span class="number">122</span> * v8 + -<span class="number">19</span> * v6 + <span class="number">99</span> * v7 + -<span class="number">117</span> * v5 + -<span class="number">69</span> * v3 + <span class="number">22</span> * v1 - <span class="number">98</span> * v2 + <span class="number">10</span> * v4 == -<span class="number">2944</span>)</span><br><span class="line">x.add(-<span class="number">54</span> * v11 + -<span class="number">23</span> * v8 + -<span class="number">82</span> * v3 + -<span class="number">85</span> * v2 + <span class="number">124</span> * v1 - <span class="number">11</span> * v4 - <span class="number">8</span> * v5 - <span class="number">60</span> * v7 + <span class="number">95</span> * v6 + <span class="number">100</span> * v9 == -<span class="number">2222</span>)</span><br><span class="line">x.add(-<span class="number">83</span> * v11 + -<span class="number">111</span> * v7 + -<span class="number">57</span> * v2 + <span class="number">41</span> * v1 + <span class="number">73</span> * v3 - <span class="number">18</span> * v4 + <span class="number">26</span> * v5 + <span class="number">16</span> * v6 + <span class="number">77</span> * v8 - <span class="number">63</span> * v9 == -<span class="number">13258</span>)</span><br><span class="line">x.add(<span class="number">81</span> * v11 + -<span class="number">48</span> * v9 + <span class="number">66</span> * v8 + -<span class="number">104</span> * v6 + -<span class="number">121</span> * v7 + <span class="number">95</span> * v5 + <span class="number">85</span> * v4 + <span class="number">60</span> * v3 + -<span class="number">85</span> * v2 + <span class="number">80</span> * v1 == -<span class="number">1559</span>)</span><br><span class="line">x.add(<span class="number">101</span> * v11 + -<span class="number">85</span> * v9 + <span class="number">7</span> * v6 + <span class="number">117</span> * v7 + -<span class="number">83</span> * v5 + -<span class="number">101</span> * v4 + <span class="number">90</span> * v3 + -<span class="number">28</span> * v1 + <span class="number">18</span> * v2 - v8 == <span class="number">6308</span>)</span><br><span class="line">x.add(<span class="number">99</span> * v11 + -<span class="number">28</span> * v9 + <span class="number">5</span> * v8 + <span class="number">93</span> * v6 + -<span class="number">18</span> * v7 + -<span class="number">127</span> * v5 + <span class="number">6</span> * v4 + -<span class="number">9</span> * v3 + -<span class="number">93</span> * v1 + <span class="number">58</span> * v2 == -<span class="number">1697</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x.check())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x.model())</span><br></pre></td></tr></table></figure>

<p>解出来之后，还需要转化一下，且注意顺序，v2是a1[0]，v6与v5的次序是对调的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[v1 = <span class="number">48</span>,</span><br><span class="line"> v6 = <span class="number">95</span>,</span><br><span class="line"> v2 = <span class="number">70</span>,</span><br><span class="line"> v4 = <span class="number">82</span>,</span><br><span class="line"> v11 = <span class="number">64</span>,</span><br><span class="line"> v3 = <span class="number">117</span>,</span><br><span class="line"> v5 = <span class="number">84</span>,</span><br><span class="line"> v7 = <span class="number">121</span>,</span><br><span class="line"> v9 = <span class="number">119</span>,</span><br><span class="line"> v8 = <span class="number">55</span>]</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lis = [ <span class="number">70</span>,<span class="number">48</span>,<span class="number">117</span>,<span class="number">82</span>,<span class="number">84</span>,<span class="number">121</span>,<span class="number">95</span>,<span class="number">55</span>,<span class="number">119</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lis:</span><br><span class="line">    flag+=<span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>F0uRTy_7w@</p>


<p>所以说sub_860的值出来了，进入一个sub_C50()函数判断，我们只需要用Linux虚拟机运行一下，将我们求得的字符串带入输入到其中，使得条件成立，flag就出来了。</p>


<p>flag{F0uRTy_7w@_42}</p>
<h1 id="UTCTF2020-basic-re-水题"><a href="#UTCTF2020-basic-re-水题" class="headerlink" title="[UTCTF2020]basic-re (水题)"></a>[UTCTF2020]basic-re (水题)</h1>

<p>用ida64打开看看</p>


<p>flag{str1ngs_1s_y0ur_fr13nd}</p>
<h1 id="Zer0pts2020-easy-strcmp-binascii-函数变址"><a href="#Zer0pts2020-easy-strcmp-binascii-函数变址" class="headerlink" title="[Zer0pts2020]easy strcmp (binascii+函数变址)"></a>[Zer0pts2020]easy strcmp (binascii+函数变址)</h1>

<p>查壳后用ida64打开</p>
<p>这题貌似没有我想的那么简单</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall main(<span class="built_in">int</span> a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1 &gt; <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !strcmp(a2[<span class="number">1</span>], <span class="string">&quot;zer0pts&#123;********CENSORED********&#125;&quot;</span>) )</span><br><span class="line">      puts(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      puts(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;Usage: %s &lt;FLAG&gt;\n&quot;</span>, *a2);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这边的mian函数只是一个比较的函数</p>


<p>参考资料：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mayfly-nymph/p/13154909.html">https://www.cnblogs.com/Mayfly-nymph/p/13154909.html</a></p>
<p>但是人没写怎么查找到加密输入符号的函数</p>
<p>这边放上z1r0的解析:</p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/people/xu-xu-xuxu-94">https://www.zhihu.com/people/xu-xu-xuxu-94</a></p>


<p>在机智聪明，成熟老练的z1r0的指导下，我逐渐摸清楚为两个函数是如何变幻的，并且还学到了很多东西，我总结一下：</p>
<p>在sub_795这个函数中，可以看到：</p>
<p>qword_201090这个全局变量（在.bss表中，所以是全局变量）保存的是strcmp的地址</p>


<p>off_201028&#x3D;sub_6EA是什么意思？我们跟进一下</p>


<p>首先理解一下offset是什么意思：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/deniece1/article/details/102934346">https://blog.csdn.net/deniece1/article/details/102934346</a></p>


<p>offset为属性操作符，表示应该把其后面的符号地址的值，不是内容作为操作数，所以off_201028应该存放的是strcmp的地址</p>
<p>所以，off_201028 &#x3D; sub_6EA，相当于把sub_6EA的地址赋值给了strcmp！！！再推理一下，全局变量qword_201090保存的是strcmp的地址，所以如果要执行strcmp函数，我们需要用qword_201090来实现。</p>
<p>据z1r0所说：.plt段存放的一般是puts&#x2F;printf函数，.bss存放的是全局变量，init放置的是程序初始化的代码块，.text存放代码段。</p>


<p>因此，在main函数中的strcmp函数，其实调用的是sub_6EA这个函数</p>
<p>我们跟进sub_6EA这个函数：</p>


<p>第一个for循环是用来测定输入字符串的长度，v4除以8再+1，相当于组数。然后第二个for循环，每组减去qword_201060这个数组，我们跟进</p>


<p>程序后面的qword_201090，我们推理过了，就相当于于是strcmp，用来于外面的”zer0pts{<strong><strong><strong><strong>CENSORED</strong></strong></strong></strong>}”相比较</p>
<p>所以我们应该是加上qword_201060的值才对，上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">string = <span class="string">&quot;********CENSORED********&quot;</span></span><br><span class="line">qword_201060 = [<span class="number">0x410A4335494A0942</span>, <span class="number">0x0B0EF2F50BE619F0</span>, <span class="number">0x4F0A3A064A35282B</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):  </span><br><span class="line">    <span class="comment">#这边就是把string均分成长度为8的三段</span></span><br><span class="line">    z = string[i * <span class="number">8</span> : (i + <span class="number">1</span>) * <span class="number">8</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#这个函数就是把每一段字符串都转换为十六进制ascii码</span></span><br><span class="line">    x = binascii.b2a_hex(z.encode(<span class="string">&#x27;ascii&#x27;</span>)[::-<span class="number">1</span>])  </span><br><span class="line">    </span><br><span class="line">    <span class="comment">#逆向操作，加上qword_201060中对应的值</span></span><br><span class="line">    y = binascii.a2b_hex(<span class="built_in">hex</span>(<span class="built_in">int</span>(x, <span class="number">16</span>) + qword_201060[i])[<span class="number">2</span>:])[::-<span class="number">1</span>]   </span><br><span class="line">    flag += y</span><br><span class="line"><span class="built_in">print</span>(flag + <span class="string">b&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>binascii.b2a_hex()函数运行之后的结果为b’4445524f534e4543’，为byte类型的字符串，所以需要转换一下，hex(x,16)</p>


<p>奇怪啊，为什么要把每一段字符串逆一下？([::-1])</p>
<p>如果说这个是因为ida的小段存储机制，所以要逆一下，那后面求完之后的y为什么要逆一下？奇怪？？</p>
<p>b’flag{l3ts_m4k3_4_DETOUR_t0d4y}’</p>
<h1 id="FlareOn3-Challenge1-base64换表"><a href="#FlareOn3-Challenge1-base64换表" class="headerlink" title="[FlareOn3]Challenge1 (base64换表)"></a>[FlareOn3]Challenge1 (base64换表)</h1><p>先查个壳，再用ida32打开</p>




<p>输入的字符串经过sub_401260函数的转换，变成了str2，然后与str1进行比较</p>


<p>可以看到这边是很熟悉的base64算法，我们点进去byte_413000看看</p>


<p>一个很经典的base64换标操作，下面是代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">string = <span class="string">&quot;x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q&quot;</span></span><br><span class="line"></span><br><span class="line">new_base = <span class="string">&#x27;ZYXABCDEFGHIJKLMNOPQRSTUVWzy\</span></span><br><span class="line"><span class="string">xabcdefghijklmnopqrstuvw0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line">base = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(string.translate(<span class="built_in">str</span>.maketrans(new_base,base)))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{<a href="mailto:&#115;&#x68;&#x30;&#x30;&#116;&#x69;&#110;&#103;&#95;&#x70;&#x68;&#x69;&#115;&#x68;&#95;&#x69;&#110;&#95;&#x61;&#95;&#98;&#x61;&#114;&#x72;&#101;&#108;&#64;&#102;&#x6c;&#x61;&#x72;&#101;&#45;&#x6f;&#x6e;&#x2e;&#99;&#111;&#109;">&#115;&#x68;&#x30;&#x30;&#116;&#x69;&#110;&#103;&#95;&#x70;&#x68;&#x69;&#115;&#x68;&#95;&#x69;&#110;&#95;&#x61;&#95;&#98;&#x61;&#114;&#x72;&#101;&#108;&#64;&#102;&#x6c;&#x61;&#x72;&#101;&#45;&#x6f;&#x6e;&#x2e;&#99;&#111;&#109;</a>}</p>
<h1 id="ACTF新生赛2020-Oruga（迷宫plus）"><a href="#ACTF新生赛2020-Oruga（迷宫plus）" class="headerlink" title="[ACTF新生赛2020]Oruga（迷宫plus）"></a>[ACTF新生赛2020]Oruga（迷宫plus）</h1><p>oruga是什么文件？不管了，先插个壳看看</p>




<p>用ida64打开看看</p>


<p>前面五个字符告诉我们了，继续跟进sub_78A看看</p>


<p>再到byte_201020看看</p>


<p>到这就傻了，琢磨了半天……</p>
<p><a target="_blank" rel="noopener" href="https://www.cxybb.com/article/weixin_43876357/107525490">https://www.cxybb.com/article/weixin_43876357/107525490</a></p>
<p>原来是迷宫啊，但是这个迷宫怎么用上面的查看的……</p>


<p>原来下面的这个意思是代表这4个0x00的意思，那这样就能把ida中的这一组数据转换成列表了，这边我搬运的大佬z1r0的代码</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mz = [<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x23</span>, <span class="number">0x23</span>, <span class="number">0x23</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4C</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4C</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x50</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4C</span>, <span class="number">0x4C</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x50</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x50</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x45</span>, <span class="number">0x45</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x45</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x45</span>, <span class="number">0x45</span>,<span class="number">54</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x49</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x45</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x54</span>, <span class="number">0x00</span>, <span class="number">0x49</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x45</span>, <span class="number">0x00</span>,<span class="number">0x00</span>, <span class="number">0x54</span>, <span class="number">0x00</span>, <span class="number">0x49</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x21</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x45</span>, <span class="number">0x45</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span> <span class="keyword">and</span> j == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;V&#x27;</span>, end = <span class="string">&#x27;  &#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> mz[<span class="number">16</span> * i + j] == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>, end = <span class="string">&#x27;  &#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> mz[<span class="number">16</span> * i + j] == <span class="number">0x21</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;X&#x27;</span>, end= <span class="string">&#x27;  &#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;O&#x27;</span>, end=<span class="string">&#x27;  &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>

<p>还有三个问题我没有解决：</p>
<ol>
<li>地图大小如何确定</li>
<li>游戏规则如何建立（碰到障碍物才能停下再继续操作）</li>
<li>障碍物如何显示？</li>
</ol>


<p>16*16 &#x3D; 256，所以可以确定地图的大小</p>
<p>第二层while循环中就限制了移动的范围，一是在地图的边缘，而是碰到障碍物</p>


<p>而障碍物貌似就是第二层循环中的后面的限制条件，可以把实体化，打印出来……</p>


<p>flag{MEWEMEWJMEWJM} 吧</p>
<h1 id="BJDCTF2020-BJD-hamburger-competition（unity逆向-sha1-mod5）"><a href="#BJDCTF2020-BJD-hamburger-competition（unity逆向-sha1-mod5）" class="headerlink" title="[BJDCTF2020]BJD hamburger competition（unity逆向+sha1+mod5）"></a>[BJDCTF2020]BJD hamburger competition（unity逆向+sha1+mod5）</h1><p>我惊了……</p>


<p>查个壳子看看，没有壳，用ida64打开，貌似查壳+ida不是正确的打开方式</p>


<p>看看z1r0的博客（下面的这句话才是最装逼的，哈哈哈），用到的是dnSPY这个软件：</p>


<p>‘<a target="_blank" rel="noopener" href="https://www.zhihu.com/people/xu-xu-xuxu-94">https://www.zhihu.com/people/xu-xu-xuxu-94</a></p>


<p>成功下载，并打开</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_47158947/article/details/107818896">https://blog.csdn.net/weixin_47158947/article/details/107818896</a></p>


<p>主要看第二点，反编译这个Assembly-CSharp.dll这个文件，直接修改unity的C#源代码</p>


<p>然后放到dnspy中……</p>


<p>顺利找到一个BJDCTF的字眼</p>
<p>踩坑了，我都不知道哈希函数基本是不可逆的</p>
<p>看z1r0的博客才知道文中的Sha1只是判断第一个字符，我们通过这个获得了密文，接着将1001这个密文进行MOD5加密</p>




<p>可以看到，哈希值是下面这个，（我看z1r0的博客，会有两个值……）</p>


<p>不管了，继续看</p>


<p>作者的意图是获取mod5加密的前20个字符</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&#x27;b8c37e33defde51cf91e1e03e51657da&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;flag&#123;&#x27;</span>+string[<span class="number">0</span>:<span class="number">20</span>].upper()+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{B8C37E33DEFDE51CF91E}</p>
<h1 id="WUSTCTF2020-Cr0ssfun-水题"><a href="#WUSTCTF2020-Cr0ssfun-水题" class="headerlink" title="[WUSTCTF2020]Cr0ssfun(水题)"></a>[WUSTCTF2020]Cr0ssfun(水题)</h1>

<p>先查个壳，用ida64打开</p>


<p>可以看到v4是我们输入的flag,check函数是比较函数，我们跟进</p>


<p>继续跟进……</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __fastcall iven_1s_educated(_BYTE *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> *a1 == <span class="number">119</span> &amp;&amp; a1[<span class="number">6</span>] == <span class="number">50</span> &amp;&amp; a1[<span class="number">22</span>] == <span class="number">115</span> &amp;&amp; a1[<span class="number">31</span>] == <span class="number">110</span> &amp;&amp; a1[<span class="number">12</span>] == <span class="number">95</span> &amp;&amp; (unsigned <span class="built_in">int</span>)iven_1s_brave(a1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>继续跟进……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __fastcall iven_1s_brave(_BYTE *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> a1[<span class="number">15</span>] == <span class="number">100</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">8</span>] == <span class="number">123</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">18</span>] == <span class="number">51</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">28</span>] == <span class="number">95</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">21</span>] == <span class="number">114</span></span><br><span class="line">      &amp;&amp; (unsigned <span class="built_in">int</span>)iven_1s_great(a1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __fastcall iven_1s_great(_BYTE *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> a1[<span class="number">2</span>] == <span class="number">116</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">9</span>] == <span class="number">99</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">32</span>] == <span class="number">125</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">19</span>] == <span class="number">118</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">5</span>] == <span class="number">48</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">14</span>] == <span class="number">110</span></span><br><span class="line">      &amp;&amp; (unsigned <span class="built_in">int</span>)iven_and_grace(a1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __fastcall iven_and_grace(_BYTE *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> a1[<span class="number">4</span>] == <span class="number">50</span> &amp;&amp; a1[<span class="number">17</span>] == <span class="number">114</span> &amp;&amp; a1[<span class="number">29</span>] == <span class="number">102</span> &amp;&amp; a1[<span class="number">17</span>] == <span class="number">114</span> &amp;&amp; a1[<span class="number">24</span>] == <span class="number">95</span> &amp;&amp; (unsigned <span class="built_in">int</span>)finally_fun(a1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这iven也太自恋了吧……下面是代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">a1 = [<span class="number">0</span>]*<span class="number">40</span></span><br><span class="line"></span><br><span class="line">a1[<span class="number">10</span>] = <span class="number">112</span></span><br><span class="line">a1[<span class="number">13</span>] = <span class="number">64</span></span><br><span class="line">a1[<span class="number">3</span>] = <span class="number">102</span></span><br><span class="line">a1[<span class="number">26</span>] = <span class="number">114</span></span><br><span class="line">a1[<span class="number">20</span>] = <span class="number">101</span></span><br><span class="line">a1[<span class="number">7</span>] = <span class="number">48</span></span><br><span class="line">a1[<span class="number">16</span>] = <span class="number">95</span></span><br><span class="line">a1[<span class="number">11</span>] = <span class="number">112</span></span><br><span class="line">a1[<span class="number">23</span>] = <span class="number">101</span></span><br><span class="line">a1[<span class="number">30</span>] = <span class="number">117</span></span><br><span class="line">a1[<span class="number">0</span>] = <span class="number">119</span></span><br><span class="line">a1[<span class="number">6</span>] = <span class="number">50</span></span><br><span class="line">a1[<span class="number">22</span>] = <span class="number">115</span></span><br><span class="line">a1[<span class="number">31</span>] = <span class="number">110</span></span><br><span class="line">a1[<span class="number">12</span>] = <span class="number">95</span></span><br><span class="line">a1[<span class="number">15</span>] = <span class="number">100</span></span><br><span class="line">a1[<span class="number">8</span>] = <span class="number">123</span></span><br><span class="line">a1[<span class="number">18</span>] = <span class="number">51</span></span><br><span class="line">a1[<span class="number">28</span>] = <span class="number">95</span></span><br><span class="line">a1[<span class="number">21</span>] = <span class="number">114</span></span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">116</span></span><br><span class="line">a1[<span class="number">9</span>] = <span class="number">99</span></span><br><span class="line">a1[<span class="number">32</span>] = <span class="number">125</span></span><br><span class="line">a1[<span class="number">19</span>] = <span class="number">118</span></span><br><span class="line">a1[<span class="number">5</span>] = <span class="number">48</span></span><br><span class="line">a1[<span class="number">14</span>] = <span class="number">110</span></span><br><span class="line">a1[<span class="number">4</span>] = <span class="number">50</span></span><br><span class="line">a1[<span class="number">17</span>] = <span class="number">114</span></span><br><span class="line">a1[<span class="number">29</span>] = <span class="number">102</span></span><br><span class="line">a1[<span class="number">17</span>] = <span class="number">114</span></span><br><span class="line">a1[<span class="number">24</span>] = <span class="number">95</span></span><br><span class="line">a1[<span class="number">1</span>] = <span class="number">99</span></span><br><span class="line">a1[<span class="number">25</span>] = <span class="number">64</span></span><br><span class="line">a1[<span class="number">27</span>] = <span class="number">101</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a1:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>wctf2020{cpp_@nd_r3verse_@re_fun}</p>
<h1 id="FlareOn6-Overlong-od动调"><a href="#FlareOn6-Overlong-od动调" class="headerlink" title="[FlareOn6]Overlong(od动调)"></a>[FlareOn6]Overlong(od动调)</h1>

<p>差壳，啥意思？要用ide试试？</p>


<p>我也没看出来个啥，运行了一下，到时候上ida直接查找这句话。</p>


<p>打开ida32查看，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __stdcall start(<span class="built_in">int</span> a1, <span class="built_in">int</span> a2, <span class="built_in">int</span> a3, <span class="built_in">int</span> a4)</span><br><span class="line">&#123;</span><br><span class="line">  CHAR Text[<span class="number">128</span>]; // [esp+0h] [ebp-84h] BYREF</span><br><span class="line">  <span class="built_in">int</span> v6; // [esp+80h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  v6 = sub_401160(Text, &amp;unk_402008, <span class="number">28</span>);</span><br><span class="line">  Text[v6] = <span class="number">0</span>;</span><br><span class="line">  MessageBoxA(<span class="number">0</span>, Text, Caption, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>unk_402008,中有很多数字，但最后弹出的框中，只有28个数字……</p>
<img src="BUU-reverse/image-20220201095845756.png" alt="image-20220201095845756" style="zoom:80%;" />

<p>写了很多代码之后，解不出来……</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/P_Black_K/article/details/122342264">https://blog.csdn.net/P_Black_K/article/details/122342264</a></p>
<p>原来是要去用od去动调这个28啊……</p>


<p>我用的是吾爱破解的od,打开后可以看到push 0x1c,而这个数字正好是28,我们做的就是去修改这个0x1c。</p>












<p>出来了！第一次用od动调程序！！</p>
<p>flag{<a href="mailto:&#x49;&#x5f;&#97;&#95;&#x4d;&#x5f;&#x74;&#95;&#x68;&#95;&#101;&#95;&#x65;&#95;&#110;&#x5f;&#67;&#x5f;&#111;&#95;&#x44;&#95;&#x69;&#95;&#x6e;&#x5f;&#103;&#x40;&#102;&#108;&#97;&#x72;&#x65;&#45;&#x6f;&#110;&#46;&#99;&#111;&#x6d;">&#x49;&#x5f;&#97;&#95;&#x4d;&#x5f;&#x74;&#95;&#x68;&#95;&#101;&#95;&#x65;&#95;&#110;&#x5f;&#67;&#x5f;&#111;&#95;&#x44;&#95;&#x69;&#95;&#x6e;&#x5f;&#103;&#x40;&#102;&#108;&#97;&#x72;&#x65;&#45;&#x6f;&#110;&#46;&#99;&#111;&#x6d;</a>}</p>
<h1 id="GWCTF-2019-xxor-xor-plus"><a href="#GWCTF-2019-xxor-xor-plus" class="headerlink" title="[GWCTF 2019]xxor (xor plus++)"></a>[GWCTF 2019]xxor (xor plus++)</h1>

<p>先查个壳，用IDA64打开</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// positive sp value has been detected, the output may be wrong!</span><br><span class="line">void __fastcall __noreturn start(__int64 a1, __int64 a2, void (*a3)(void))</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; // rax</span><br><span class="line">  <span class="built_in">int</span> v4; // esi</span><br><span class="line">  __int64 v5; // [rsp-8h] [rbp-8h] BYREF</span><br><span class="line">  char *retaddr; // [rsp+0h] [rbp+0h] BYREF</span><br><span class="line"></span><br><span class="line">  v4 = v5;</span><br><span class="line">  v5 = v3;</span><br><span class="line">  __libc_start_main((<span class="built_in">int</span> (__fastcall *)(<span class="built_in">int</span>, char **, char **))main, v4, &amp;retaddr, init, fini, a3, &amp;v5);</span><br><span class="line">  __halt();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们跟进main</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall main(<span class="built_in">int</span> a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+8h] [rbp-68h]</span><br><span class="line">  <span class="built_in">int</span> j; // [rsp+Ch] [rbp-64h]</span><br><span class="line">  __int64 v6[<span class="number">6</span>]; // [rsp+10h] [rbp-60h] BYREF</span><br><span class="line">  __int64 v7[<span class="number">6</span>]; // [rsp+40h] [rbp-30h] BYREF</span><br><span class="line"></span><br><span class="line">  v7[<span class="number">5</span>] = __readfsqword(0x28u);</span><br><span class="line">  puts(<span class="string">&quot;Let us play a game?&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;you have six chances to input&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;Come on!&quot;</span>);</span><br><span class="line">  memset(v6, <span class="number">0</span>, <span class="number">40</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">5</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;%s&quot;</span>, <span class="string">&quot;input: &quot;</span>);</span><br><span class="line">    a2 = (char **)((char *)v6 + <span class="number">4</span> * i);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%d&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  memset(v7, <span class="number">0</span>, <span class="number">40</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">2</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    dword_601078 = v6[j];</span><br><span class="line">    dword_60107C = HIDWORD(v6[j]);</span><br><span class="line">    a2 = (char **)dword_601060;</span><br><span class="line">    sub_400686((unsigned <span class="built_in">int</span> *)&amp;dword_601078, dword_601060);// 加密函数</span><br><span class="line">    LODWORD(v7[j]) = dword_601078;</span><br><span class="line">    HIDWORD(v7[j]) = dword_60107C;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( (unsigned <span class="built_in">int</span>)sub_400770(v7, a2) != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;NO NO NO~ &quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  puts(<span class="string">&quot;Congratulation!\n&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;You seccess half\n&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;Do not forget to change input to hex and combine~\n&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;ByeBye&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输入六次，</p>
<p>先是循环三次，可以看出sub_400686是一个加密的函数</p>
<p>而sub_400770是一个对比的函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall sub_400770(_DWORD *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1[<span class="number">2</span>] - a1[<span class="number">3</span>] == 2225223423LL</span><br><span class="line">    &amp;&amp; a1[<span class="number">3</span>] + a1[<span class="number">4</span>] == 4201428739LL</span><br><span class="line">    &amp;&amp; a1[<span class="number">2</span>] - a1[<span class="number">4</span>] == 1121399208LL</span><br><span class="line">    &amp;&amp; *a1 == <span class="number">3746099070</span></span><br><span class="line">    &amp;&amp; a1[<span class="number">5</span>] == <span class="number">2230518816</span></span><br><span class="line">    &amp;&amp; a1[<span class="number">1</span>] == <span class="number">550153460</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;good!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> 1LL;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> 0LL;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加密之后的v7数组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v7 = [<span class="number">3746099070</span>,<span class="number">550153460</span>,<span class="number">3774025685</span>,<span class="number">1548802262</span>,<span class="number">2652626477</span>,<span class="number">2230518816</span>]</span><br></pre></td></tr></table></figure>



<p>这边可以看到，dword_601060数组为[2,2,3,4]</p>
<p>然后看看加密算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall sub_400686(unsigned <span class="built_in">int</span> *a1, _DWORD *a2)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; // rax</span><br><span class="line">  unsigned <span class="built_in">int</span> v3; // [rsp+1Ch] [rbp-24h]</span><br><span class="line">  unsigned <span class="built_in">int</span> v4; // [rsp+20h] [rbp-20h]</span><br><span class="line">  <span class="built_in">int</span> v5; // [rsp+24h] [rbp-1Ch]</span><br><span class="line">  unsigned <span class="built_in">int</span> i; // [rsp+28h] [rbp-18h]</span><br><span class="line"></span><br><span class="line">  v3 = *a1;</span><br><span class="line">  v4 = a1[<span class="number">1</span>];</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">63</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 += <span class="number">1166789954</span>;</span><br><span class="line">    v3 += (v4 + v5 + <span class="number">11</span>) ^ ((v4 &lt;&lt; <span class="number">6</span>) + *a2) ^ ((v4 &gt;&gt; <span class="number">9</span>) + a2[<span class="number">1</span>]) ^ <span class="number">0x20</span>;</span><br><span class="line">    v4 += (v3 + v5 + <span class="number">20</span>) ^ ((v3 &lt;&lt; <span class="number">6</span>) + a2[<span class="number">2</span>]) ^ ((v3 &gt;&gt; <span class="number">9</span>) + a2[<span class="number">3</span>]) ^ <span class="number">0x10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *a1 = v3;</span><br><span class="line">  result = v4;</span><br><span class="line">  a1[<span class="number">1</span>] = v4;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>好！到这边就没了，炸了！</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/HardDebugger/article/details/108625220">https://blog.csdn.net/HardDebugger/article/details/108625220</a></p>
<p><a target="_blank" rel="noopener" href="https://www.programminghunter.com/article/3800202454/">https://www.programminghunter.com/article/3800202454/</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">v6=[<span class="number">3746099070</span>,<span class="number">550153460</span>,<span class="number">3774025685</span>,<span class="number">1548802262</span>,<span class="number">2652626477</span>,<span class="number">2230518816</span>]</span><br><span class="line">unk=[<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">5</span>,<span class="number">2</span>):</span><br><span class="line">    v5=(c_int(<span class="number">1166789954</span>*<span class="number">0x40</span>))</span><br><span class="line">    v3 = c_uint(v6[i])</span><br><span class="line">    v4 = c_uint(v6[i+<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x40</span>):</span><br><span class="line">        v4.value -= ((v3.value+v5.value+<span class="number">20</span>)^((v3.value&lt;&lt;<span class="number">6</span>)+unk[<span class="number">2</span>])^((v3.value&gt;&gt;<span class="number">9</span>)+unk[<span class="number">3</span>])^<span class="number">0x10</span>)</span><br><span class="line">        v3.value -= ((v4.value+v5.value+<span class="number">11</span>)^((v4.value&lt;&lt;<span class="number">6</span>)+unk[<span class="number">0</span>])^((v4.value&gt;&gt;<span class="number">9</span>)+unk[<span class="number">1</span>])^<span class="number">0x20</span>)</span><br><span class="line">        v5.value = (v5.value - <span class="number">1166789954</span>)</span><br><span class="line">    v6[i] =v3.value</span><br><span class="line">    v6[i+<span class="number">1</span>] = v4.value</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(v6[k]).decode(),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>分析一下这个代码：</p>
<p>ctypes是python的外部函数库，提供与C兼容的数据类型，并允许调用DLL或共享库中的函数（我暂时不需要了解这个）</p>


<p>我们这边就探讨这个c_uint 这是个无符号数，对数组中的类型进行限制，限制为无符号数，最后还需要进行long_to_bytes的转换？？太强了，先放这边搁着，先下一题看看</p>
<h1 id="MRCTF2020-Xor"><a href="#MRCTF2020-Xor" class="headerlink" title="[MRCTF2020]Xor"></a>[MRCTF2020]Xor</h1><p>没有壳子，直接用ida32打开。</p>
<p>啥情况？</p>


<p>我就先用跳转，跳转到401095这个地址</p>


<p>进入sub_401020之后，我按了一下tab，貌似就可以反汇编了，我返回主函数看一下，成功反汇编！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned <span class="built_in">int</span> i; // eax</span><br><span class="line"></span><br><span class="line">  sub_401020((<span class="built_in">int</span>)<span class="string">&quot;Give Me Your Flag String:\n&quot;</span>);</span><br><span class="line">  sub_401050(<span class="string">&quot;%s&quot;</span>, byte_4212C0);</span><br><span class="line">  <span class="keyword">if</span> ( strlen(byte_4212C0) != <span class="number">27</span> )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_6:</span><br><span class="line">    sub_401020((<span class="built_in">int</span>)<span class="string">&quot;Wrong!\n&quot;</span>);</span><br><span class="line">    sub_404B7E(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    _loaddll(<span class="number">0</span>);</span><br><span class="line">    __debugbreak();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">0x1B</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ((unsigned __int8)i ^ (unsigned __int8)byte_4212C0[i]) != byte_41EA08[i] )</span><br><span class="line">      goto LABEL_6;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_401020((<span class="built_in">int</span>)<span class="string">&quot;Right!\n&quot;</span>);</span><br><span class="line">  sub_404B7E(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>byte_4212C0来存放字符串，然后在后面的for语句中，与i异或之后，与byte_41EA08比较，如下所示，我们开始编写代码</p>






<p>奇怪了，暴力和正常的异或都没用啊，这肯定是错的……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&#x27;SAWB~FXZ:J:`tQJ&quot;N@ bpdd&#125;8g&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(string))</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        k = j</span><br><span class="line">        <span class="keyword">if</span> j^i == <span class="built_in">ord</span>(string[i]):</span><br><span class="line">            flag+=<span class="built_in">chr</span>(k)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>发现了暗门</p>


<p>那是什么暗门，这个这个函数包含了我们刚刚看过的主函数</p>
<p>算了，看看吧……</p>
<p>麻了，原来串个字符的前面有个M，没注意到，脚本编写没有问题的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&#x27;MSAWB~FXZ:J:`tQJ&quot;N@ bpdd&#125;8g&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(string))</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        k = j</span><br><span class="line">        <span class="keyword">if</span> j^i == <span class="built_in">ord</span>(string[i]):</span><br><span class="line">            flag+=<span class="built_in">chr</span>(k)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>27<br>MRCTF{@_R3@1ly_E2_R3verse!}</p>
<h1 id="MRCTF2020-hello-world-go"><a href="#MRCTF2020-hello-world-go" class="headerlink" title="[MRCTF2020]hello_world_go"></a>[MRCTF2020]hello_world_go</h1>

<p>没看到壳子，用ida64打开</p>




<p>？？？</p>
<p>下一题</p>
<h1 id="WUSTCTF2020-level3-base64换表"><a href="#WUSTCTF2020-level3-base64换表" class="headerlink" title="[WUSTCTF2020]level3(base64换表)"></a>[WUSTCTF2020]level3(base64换表)</h1>

<p>用64位的IDA打开</p>
<p>一个base64有问题的题目</p>


<p>这个是</p>
<p><strong></strong></p>
<p>本程序里面的，我特地找了之前做过的reverse_3，纯正的base64题目，中的码表，用来做了个对比</p>


<p>这边是少了个&#x3D;号，base62倒是可以解出来，结果却都是数字</p>


<p>像我之前做过的一个换码表的题目了，我正好反过来看一看</p>
<p>[ACTF新生赛2020]usualCrypt这道题</p>
<p>刚刚试了一下，换表的话，长度相等才行……新表的明显短了，这怎样才好？？</p>


<p>我懂了，题目中的表的次序换了</p>


<p>在table上按x，果真有引用这个的函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__int64 O_OLookAtYou()</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; // rax</span><br><span class="line">  char v1; // [rsp+1h] [rbp-5h]</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+2h] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = base64_table[i];</span><br><span class="line">    base64_table[i] = base64_table[<span class="number">19</span> - i];</span><br><span class="line">    result = <span class="number">19</span> - i;</span><br><span class="line">    base64_table[result] = v1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这就简单了，换表之后，就能解码了，下面就是代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">string = <span class="string">&#x27;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==&#x27;</span></span><br><span class="line"></span><br><span class="line">base = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;</span></span><br><span class="line"></span><br><span class="line">newbase =  <span class="built_in">list</span>(<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">9</span>):</span><br><span class="line">    newbase[i] , newbase[<span class="number">19</span>-i] = newbase[<span class="number">19</span>-i] , newbase[i]</span><br><span class="line"></span><br><span class="line">newbase = <span class="string">&#x27;&#x27;</span>.join(newbase)</span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(string.translate(<span class="built_in">str</span>.maketrans(newbase,base)))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>b’wctf2020{Base64_is_the_start_of_reverse}’</p>
<h1 id="FlareOn4-IgniteMe"><a href="#FlareOn4-IgniteMe" class="headerlink" title="[FlareOn4]IgniteMe()"></a>[FlareOn4]IgniteMe()</h1><p>先查个壳，发现没有壳，用32位IDA打开</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">void __noreturn start()</span><br><span class="line">&#123;</span><br><span class="line">  DWORD NumberOfBytesWritten; // [esp+0h] [ebp-4h] BYREF</span><br><span class="line"></span><br><span class="line">  NumberOfBytesWritten = <span class="number">0</span>;</span><br><span class="line">  hFile = GetStdHandle(<span class="number">0xFFFFFFF6</span>);</span><br><span class="line">  dword_403074 = GetStdHandle(<span class="number">0xFFFFFFF5</span>);</span><br><span class="line">  WriteFile(dword_403074, aG1v3M3T3hFl4g, 19u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  sub_4010F0();</span><br><span class="line">  <span class="keyword">if</span> ( sub_401050() )</span><br><span class="line">    WriteFile(dword_403074, aG00dJ0b, 10u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    WriteFile(dword_403074, aN0tT00H0tRWe7r, 36u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  ExitProcess(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一眼看出if语句是用来判断的，我们跟进这个sub_401050()函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> sub_401050()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> v1; // [esp+0h] [ebp-Ch]</span><br><span class="line">  <span class="built_in">int</span> i; // [esp+4h] [ebp-8h]</span><br><span class="line">  unsigned <span class="built_in">int</span> j; // [esp+4h] [ebp-8h]</span><br><span class="line">  char v4; // [esp+Bh] [ebp-1h]</span><br><span class="line"></span><br><span class="line">  v1 = my_return_i(my_arr);</span><br><span class="line">  v4 = my_rol();</span><br><span class="line">  <span class="keyword">for</span> ( i = v1 - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    my_flag[i] = v4 ^ my_arr[i];</span><br><span class="line">    v4 = my_arr[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">39</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( my_flag[j] != model[j] )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>判断数组我命名成为model，转换后的数组我命名成my_flag,而中间的转换数组，我命名成为my_arr</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> sub_4010F0()</span><br><span class="line">&#123;</span><br><span class="line">  unsigned <span class="built_in">int</span> v0; // eax</span><br><span class="line">  char Buffer[<span class="number">260</span>]; // [esp+0h] [ebp-<span class="number">1</span>10h] BYREF</span><br><span class="line">  DWORD NumberOfBytesRead; // [esp+104h] [ebp-Ch] BYREF</span><br><span class="line">  unsigned <span class="built_in">int</span> i; // [esp+108h] [ebp-8h]</span><br><span class="line">  char v5; // [esp+10Fh] [ebp-1h]</span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">260</span>; ++i )</span><br><span class="line">    Buffer[i] = <span class="number">0</span>;</span><br><span class="line">  ReadFile(hFile, Buffer, 260u, &amp;NumberOfBytesRead, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = my_return_i(Buffer);</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= v0 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v5 = Buffer[i];</span><br><span class="line">    <span class="keyword">if</span> ( v5 != <span class="string">&#x27;\n&#x27;</span> &amp;&amp; v5 != <span class="string">&#x27;\r&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v5 )</span><br><span class="line">        my_arr[i] = v5;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>发现在判断函数的上面的sub_4010F0()函数，已经开辟了my_arr数组了，</p>
<p>可以推理出my_arr里面的元素都是0，总数没细看，再回到判断函数。</p>
<p>v4 &#x3D;的这个函数，我给它命名为my_rol,我属实没看懂这个是什么意思</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__int16 sub_401000()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> __ROL4__(<span class="number">2147942400</span>, <span class="number">4</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我假设就是向左移动一位的意思，为1,073,971,200</p>
<p>那也就是v4 &#x3D; 1,073,971,200,i &#x3D; v1 - 1,那么这个v1我猜是40</p>
<p>看了人家的脚本之后，v4&#x3D;4??</p>
<p>这是我没想到的，差别大了……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">model = [<span class="number">0x0D</span>,<span class="number">0x26</span>,<span class="number">0x49</span>,<span class="number">0x45</span>,<span class="number">0x2A</span>,<span class="number">0x17</span>,<span class="number">0x78</span>,<span class="number">0x44</span>,<span class="number">0x2B</span>,<span class="number">0x6C</span>,<span class="number">0x5D</span>,<span class="number">0x5E</span>,<span class="number">0x45</span>,<span class="number">0x12</span>,<span class="number">0x2F</span>,<span class="number">0x17</span>,</span><br><span class="line"><span class="number">0x2B</span>,<span class="number">0x44</span>,<span class="number">0x6F</span>,<span class="number">0x6E</span>,<span class="number">0x56</span>,<span class="number">0x09</span>,<span class="number">0x5F</span>,<span class="number">0x45</span>,<span class="number">0x47</span>,<span class="number">0x73</span>,<span class="number">0x26</span>,<span class="number">0x0A</span>,<span class="number">0x0D</span>,<span class="number">0x13</span>,<span class="number">0x17</span>,<span class="number">0x48</span>,</span><br><span class="line"><span class="number">0x42</span>,<span class="number">0x01</span>,<span class="number">0x40</span>,<span class="number">0x4D</span>,<span class="number">0x0C</span>,<span class="number">0x02</span>,<span class="number">0x69</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(model)</span><br><span class="line"></span><br><span class="line">v4 = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">my_flag = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    my_flag.append(model[i]^v4)</span><br><span class="line">    v4 = my_flag[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> my_flag:</span><br><span class="line">    flag += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(flag[::-<span class="number">1</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="mailto:&#82;&#x5f;&#121;&#48;&#x75;&#x5f;&#x48;&#48;&#x74;&#x5f;&#51;&#x6e;&#48;&#x75;&#103;&#72;&#x5f;&#116;&#x30;&#x5f;&#x31;&#103;&#x6e;&#49;&#x74;&#51;&#x40;&#102;&#x6c;&#x61;&#x72;&#x65;&#x2d;&#x6f;&#110;&#46;&#x63;&#x6f;&#x6d;">&#82;&#x5f;&#121;&#48;&#x75;&#x5f;&#x48;&#48;&#x74;&#x5f;&#51;&#x6e;&#48;&#x75;&#103;&#72;&#x5f;&#116;&#x30;&#x5f;&#x31;&#103;&#x6e;&#49;&#x74;&#51;&#x40;&#102;&#x6c;&#x61;&#x72;&#x65;&#x2d;&#x6f;&#110;&#46;&#x63;&#x6f;&#x6d;</a></p>
<p>网上还有一个爆破版本，不想动脑子了，球球了,我用python实现一下。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Palmer9/article/details/105253318">https://blog.csdn.net/Palmer9/article/details/105253318</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">model = [<span class="number">0x0D</span>,<span class="number">0x26</span>,<span class="number">0x49</span>,<span class="number">0x45</span>,<span class="number">0x2A</span>,<span class="number">0x17</span>,<span class="number">0x78</span>,<span class="number">0x44</span>,<span class="number">0x2B</span>,<span class="number">0x6C</span>,<span class="number">0x5D</span>,<span class="number">0x5E</span>,<span class="number">0x45</span>,<span class="number">0x12</span>,<span class="number">0x2F</span>,<span class="number">0x17</span>,</span><br><span class="line"><span class="number">0x2B</span>,<span class="number">0x44</span>,<span class="number">0x6F</span>,<span class="number">0x6E</span>,<span class="number">0x56</span>,<span class="number">0x09</span>,<span class="number">0x5F</span>,<span class="number">0x45</span>,<span class="number">0x47</span>,<span class="number">0x73</span>,<span class="number">0x26</span>,<span class="number">0x0A</span>,<span class="number">0x0D</span>,<span class="number">0x13</span>,<span class="number">0x17</span>,<span class="number">0x48</span>,</span><br><span class="line"><span class="number">0x42</span>,<span class="number">0x01</span>,<span class="number">0x40</span>,<span class="number">0x4D</span>,<span class="number">0x0C</span>,<span class="number">0x02</span>,<span class="number">0x69</span>]</span><br><span class="line"></span><br><span class="line">v4 = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">40</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        k = j</span><br><span class="line">        j ^= v4</span><br><span class="line">        <span class="keyword">if</span> j == model[i]:</span><br><span class="line">            flag[i] = k</span><br><span class="line">            v4 = k</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>2.9日补充：</p>
<p>最近比赛挺多，压力都很大，特地过来复习一下od动调：</p>
<p>关于od调试常用的快捷键：</p>
<p><a target="_blank" rel="noopener" href="https://mambainveins.gitee.io/2020/09/02/2020-09-02-GDB_common_instructions/">https://mambainveins.gitee.io/2020/09/02/2020-09-02-GDB_common_instructions/</a></p>
<p>F7步进，也就是遇到一个函数会进去，就是步入call的意思。</p>
<p>F8步过，也就是遇到一个函数，执行完之后，不会进入call.</p>
<p>F9,直接执行</p>


<p>我们需要做的就是动态调试v4的值，v4在sub_401050这个函数中</p>


<p>然后值等于sub_401000()函数的返回值</p>


<p>首先我们是搜索字符串，定位提示性语句</p>


<p>F8一直步过，到输入字符串的位置停下</p>


<p>我们随便输入一串字符串，回车就能一直运行</p>


<p>现在到达401050这个位置，我们F7步进</p>


<p>然后F7一直步过</p>


<p>到401000下面，我们就能看到v4的值了</p>


<p>al &#x3D; 4</p>
<h1 id="Youngter-drive-windows多线程-index逆向"><a href="#Youngter-drive-windows多线程-index逆向" class="headerlink" title="Youngter-drive(windows多线程+index逆向)"></a>Youngter-drive(windows多线程+index逆向)</h1><p>Exeinfo:</p>


<p>有壳，咱们脱壳先，对比一下，没有了貌似</p>


<p>继续，咱们用IDA32打开</p>


<p>下一步</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main_0(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  HANDLE Thread; // [esp+D0h] [ebp-14h]</span><br><span class="line">  HANDLE hObject; // [esp+DCh] [ebp-8h]</span><br><span class="line"></span><br><span class="line">  ((void (*)(void))sub_4110FF)();</span><br><span class="line">  ::hObject = CreateMutexW(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  j_strcpy(Destination, &amp;Source);</span><br><span class="line">  hObject = CreateThread(<span class="number">0</span>, <span class="number">0</span>, StartAddress, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  Thread = CreateThread(<span class="number">0</span>, <span class="number">0</span>, sub_41119F, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  CloseHandle(hObject);</span><br><span class="line">  CloseHandle(Thread);</span><br><span class="line">  <span class="keyword">while</span> ( dword_418008 != -<span class="number">1</span> )</span><br><span class="line">    ;</span><br><span class="line">  sub_411190();</span><br><span class="line">  CloseHandle(::hObject);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先是sub_4110FF()函数，我们跟进</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((void (*)(void))sub_4110FF)();</span><br></pre></td></tr></table></figure>



<p>输入语句，将输出的flag给Source，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">::hObject = CreateMutexW(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">::hObject = CreateMutexW(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>CreateMutexW函数，创建或者打开一个命名或未命名的互斥对象</p>
<img src="BUU-reverse/image-20220129134815205.png" alt="image-20220129134815205" style="zoom:80%;" />

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">j_strcpy(Destination, Source);</span><br></pre></td></tr></table></figure>

<p>将source赋值给destination</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hObject = CreateThread(<span class="number">0</span>, <span class="number">0</span>, StartAddress, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">Thread = CreateThread(<span class="number">0</span>, <span class="number">0</span>, sub_41119F, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">CloseHandle(hObject);</span><br><span class="line">CloseHandle(Thread);</span><br></pre></td></tr></table></figure>

<p>创建线程 CreateThread(0, 0, StartAddress, 0, 0, 0)，通常起始地址是程序代码中定义的函数名称</p>


<p>后面的CloseHandle真实关闭前面线程对象的句柄</p>


<p>我们跟进StartAddress</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">void __stdcall __noreturn StartAddress_0(<span class="built_in">int</span> a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    WaitForSingleObject(hObject, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">    <span class="keyword">if</span> ( dword_418008 &gt; -<span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_41112C(Source, dword_418008);</span><br><span class="line">      --dword_418008;</span><br><span class="line">      Sleep(0x64u);</span><br><span class="line">    &#125;</span><br><span class="line">    ReleaseMutex(hObject);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这边的sleep(0x64u)要当心，这个函数对字符串的加密是隔一个字符加密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// 已检测到正的sp值, 输出可能错误!     </span><br><span class="line">char *__cdecl sub_411940(<span class="built_in">int</span> a1, <span class="built_in">int</span> a2)</span><br><span class="line">&#123;</span><br><span class="line">  char *result; // eax</span><br><span class="line">  char v3; // [esp+D3h] [ebp-5h]</span><br><span class="line"></span><br><span class="line">  v3 = *(a2 + a1);</span><br><span class="line">  <span class="keyword">if</span> ( (v3 &lt; <span class="string">&#x27;a&#x27;</span> || v3 &gt; <span class="string">&#x27;z&#x27;</span>) &amp;&amp; (v3 &lt; <span class="string">&#x27;A&#x27;</span> || v3 &gt; <span class="string">&#x27;Z&#x27;</span>) )</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt; <span class="string">&#x27;a&#x27;</span> || v3 &gt; <span class="string">&#x27;z&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = off_418000[<span class="number">0</span>];</span><br><span class="line">    *(a2 + a1) = off_418000[<span class="number">0</span>][*(a2 + a1) - <span class="number">38</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = off_418000[<span class="number">0</span>];</span><br><span class="line">    *(a2 + a1) = off_418000[<span class="number">0</span>][*(a2 + a1) - <span class="number">96</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mayfly-nymph/p/12573658.html">https://www.cnblogs.com/Mayfly-nymph/p/12573658.html</a></p>
<p>第二个线程执行的函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">void __stdcall __noreturn sub_411B10(<span class="built_in">int</span> a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    WaitForSingleObject(hObject, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">    <span class="keyword">if</span> ( dword_418008 &gt; -<span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      Sleep(0x64u);</span><br><span class="line">      --dword_418008;</span><br><span class="line">    &#125;</span><br><span class="line">    ReleaseMutex(hObject);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>有两个线程，别人博客上面，还得确认哪一个线程先执行，说是第二个先执行</p>
<p>也就是偶数不变，奇数会变。</p>
<p>下面是代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line">secret = <span class="string">&quot;TOiZiZtOrYaToUwPnToBsOaOapsyS&quot;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">model = <span class="string">&quot;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret)):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        flag += secret[i]</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span>(secret[i].isupper()):</span><br><span class="line">        flag += <span class="built_in">chr</span>(model.find(secret[i]) + <span class="number">96</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(model.find(secret[i]) + <span class="number">38</span>)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;flag&#123;&#x27;</span>+flag+<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>不用看了，我甚至连线程的工作原理都不知道，先去看看python的多线程机制</p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-multithreading.html">https://www.runoob.com/python/python-multithreading.html</a></p>
<p>创建线程类，生成线程对象，将需要运行的函数放入run（）这个方法中，而且每运行一次都需要获得锁，来保证线程的同步性，在运行完成之后需要释放锁，还可以把线程放入线程列表中，使其具有优先级，使其可以交替执行</p>
<p>现在可以理解了。。</p>
<p>flag{ThisisthreadofwindowshahaIsES}</p>
<p>z1r0的博客上说，最后差了一位，确实</p>


<p>传入的参数a2,是29，而我们要求的flag为30位</p>
<p>该爆破是就爆破：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;ThisisthreadofwindowshahaIsES&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="built_in">print</span>(flag+<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)+i))</span><br></pre></td></tr></table></figure>

<p>flag{ThisisthreadofwindowshahaIsESE}</p>
<h1 id="WUSTCTF2020-level2（upx脱壳）"><a href="#WUSTCTF2020-level2（upx脱壳）" class="headerlink" title="[WUSTCTF2020]level2（upx脱壳）"></a>[WUSTCTF2020]level2（upx脱壳）</h1>

<p>查壳后发现有壳，upx工具走起</p>
<p>打开之后，没看到正确的主函数</p>
<p>在string窗口中，找到了，试试呗</p>




<p>好家伙，还真是</p>
<p>flag{Just_upx_-d}</p>
<p>去看看z1r0的博客吧，z1r0老师傅专程详解了汇编代码，我得好好看看</p>






<h1 id="相册（apk病毒-base64）"><a href="#相册（apk病毒-base64）" class="headerlink" title="相册（apk病毒+base64）"></a>相册（apk病毒+base64）</h1>

<p>有意思……</p>
<p>看了一段时间就麻了</p>
<p>看看z1r0的博客中，用的是导航中的搜索文本功能，搜索的是email</p>


<p>然后直接跟进sendMailjavamail</p>


<p>这个软件的操作和ida一样啊，x键就能看到引用的地方，跟进之后</p>


<p>跟进后面的的MAILSERVER</p>


<p>嗯，base64加密……</p>
<p>然后是解压apk,找到.so文件，我都不知道so文件是干嘛的</p>


<p>百度了一下，so文件对于linux系统来说，就像dll文件相对于windows系统一样，一般来讲，so文件称为共享库</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wangquan1992/article/details/113770115">https://blog.csdn.net/wangquan1992/article/details/113770115</a></p>
<p>我搞了半天也不知道so文件怎么打开</p>


<p>什么叫strings看一下，哈哈哈</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">string = <span class="string">&#x27;MTgyMTg0NjUxMjVAMTYzLmNvbQ==&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(string)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p><a href="mailto:&#49;&#x38;&#50;&#x31;&#56;&#52;&#x36;&#x35;&#49;&#50;&#53;&#64;&#49;&#x36;&#x33;&#46;&#x63;&#x6f;&#109;">&#49;&#x38;&#50;&#x31;&#56;&#52;&#x36;&#x35;&#49;&#50;&#53;&#64;&#49;&#x36;&#x33;&#46;&#x63;&#x6f;&#109;</a></p>
<p>我的心态是这样的：</p>




<h1 id="HDCTF2019-Maze-easy-迷宫"><a href="#HDCTF2019-Maze-easy-迷宫" class="headerlink" title="[HDCTF2019]Maze (easy 迷宫)"></a>[HDCTF2019]Maze (easy 迷宫)</h1>

<p>有壳，万能脱壳FFI，没有壳了应该</p>
<p>maze是迷宫的意思，之前做过一个迷宫的题目，被虐了</p>
<p>上来啥也别干，直接查看strings窗口</p>




<p>找到了！</p>
<p>用python 算了一下是70个字符，我猜是7*10</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">maze = <span class="string">&quot;*******+********* ******    ****   ******* **F******    **************&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(maze))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="built_in">print</span>(maze[i*<span class="number">10</span>+j],end = <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>





<p>这边是输入14个字符，看我上面的图案，还真是</p>
<p>接下来就是寻找规则了</p>
<p>22333233224441？</p>
<p>ssaaasaassdddw?</p>
<p>好家伙，第二个就对了，笑死了</p>
<p>flag{ssaaasaassdddw}</p>
<h1 id="WUSTCTF2020-level1"><a href="#WUSTCTF2020-level1" class="headerlink" title="[WUSTCTF2020]level1"></a>[WUSTCTF2020]level1</h1><p>先查壳</p>


<p>没有壳,然后放到ida64中打开</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+4h] [rbp-2Ch]</span><br><span class="line">  FILE *stream; // [rsp+8h] [rbp-28h]</span><br><span class="line">  char ptr[<span class="number">24</span>]; // [rsp+10h] [rbp-20h] BYREF</span><br><span class="line">  unsigned __int64 v7; // [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(0x28u);</span><br><span class="line">  stream = fopen(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  fread(ptr, 1uLL, 0x14uLL, stream);</span><br><span class="line">  fclose(stream);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">1</span>; i &lt;= <span class="number">19</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (i &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      printf(<span class="string">&quot;%ld\n&quot;</span>, (unsigned <span class="built_in">int</span>)(ptr[i] &lt;&lt; i));</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      printf(<span class="string">&quot;%ld\n&quot;</span>, (unsigned <span class="built_in">int</span>)(i * ptr[i]));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很清晰，output文本文件是输出之后的文件</p>
<p>直接上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">lists = [<span class="number">198</span>,<span class="number">232</span>,<span class="number">816</span>,<span class="number">200</span>,<span class="number">1536</span>,<span class="number">300</span>,<span class="number">6144</span>,<span class="number">984</span>,<span class="number">51200</span>,<span class="number">570</span>,<span class="number">92160</span>,\</span><br><span class="line"><span class="number">1200</span>,<span class="number">565248</span>,<span class="number">756</span>,<span class="number">1474560</span>,<span class="number">800</span>,<span class="number">6291456</span>,<span class="number">1782</span>,<span class="number">65536000</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(lists)</span><br><span class="line">lists2 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">    <span class="keyword">if</span> ((i+<span class="number">1</span>) &amp; <span class="number">1</span>) :</span><br><span class="line">        n = <span class="built_in">int</span>(lists[i] &gt;&gt; (i+<span class="number">1</span>))</span><br><span class="line">        lists2.append(n)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        n = <span class="built_in">int</span>(lists[i] // (i+<span class="number">1</span>))</span><br><span class="line">        lists2.append(n)</span><br><span class="line"><span class="built_in">print</span>(lists2)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lists2)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(lists2[i]),end = <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>需要注意的是</p>
<ol>
<li>i&amp;1 &#x3D;&#x3D; 1代表是奇数，i&amp;1&#x3D;&#x3D;0代表是偶数，</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>[<span class="number">0</span>]		没有输出</span><br><span class="line"><span class="built_in">str</span>[<span class="number">1</span>]		&lt;&lt; <span class="number">1</span></span><br><span class="line"><span class="built_in">str</span>[<span class="number">2</span>]		* <span class="number">2</span></span><br><span class="line"><span class="built_in">str</span>[<span class="number">3</span>]		&lt;&lt; <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>而对于我们output文件，我们看到的第一个数字198其实是在第二个，所以，可以理解为什么是 int(lists[i] &gt;&gt; (i+1))</p>
<ol start="2">
<li>i &amp; 1 &#x3D;&#x3D; 0 代表i是偶数                i &amp; 1 &#x3D;&#x3D; 1代表i是奇数</li>
</ol>
<p>最终结果：ctf2020{d9-dE6-20c}</p>
<h1 id="MRCTF2020-Transform-index-逆向"><a href="#MRCTF2020-Transform-index-逆向" class="headerlink" title="[MRCTF2020]Transform(index 逆向)"></a>[MRCTF2020]Transform(index 逆向)</h1>

<p>首先是查壳，没有壳，我们用ida64打开</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char Str[<span class="number">104</span>]; // [rsp+20h] [rbp-70h] BYREF</span><br><span class="line">  <span class="built_in">int</span> j; // [rsp+88h] [rbp-8h]</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+8Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  sub_402230(argc, argv, envp);</span><br><span class="line">  sub_40E640(<span class="string">&quot;Give me your code:\n&quot;</span>);</span><br><span class="line">  sub_40E5F0(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">  <span class="keyword">if</span> ( strlen(Str) != <span class="number">33</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_40E640(<span class="string">&quot;Wrong!\n&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">32</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    byte_414040[i] = Str[dword_40F040[i]];</span><br><span class="line">    byte_414040[i] ^= LOBYTE(dword_40F040[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">32</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( byte_40F0E0[j] != byte_414040[j] )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_40E640(<span class="string">&quot;Wrong!\n&quot;</span>);</span><br><span class="line">      system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">      exit(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_40E640(<span class="string">&quot;Right!Good Job!\n&quot;</span>);</span><br><span class="line">  sub_40E640(<span class="string">&quot;Here is your flag: %s\n&quot;</span>, Str);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，第一个for循环是把输入的字符放到了str中，str[dword_40F040[i]]把值给了byte_414040，byte_414040再与dword_40F040[i]进行异或</p>
<p>下面的for 循环是将dword_40F040[i]与byte_40F0E0做比较</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mayfly-nymph/p/12806027.html">https://www.cnblogs.com/Mayfly-nymph/p/12806027.html</a></p>
<p>总体来说</p>
<p>就是将输入的flag使用dword数组作为索引，打乱顺序</p>
<p>再将打乱后的flag数组，与dword数组异或，得到byte</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">dword = [<span class="number">0x9</span>, <span class="number">0x0A</span>, <span class="number">0x0F</span>, <span class="number">0x17</span>, <span class="number">0x7</span>, <span class="number">0x18</span>, <span class="number">0x0C</span>, <span class="number">0x6</span>, <span class="number">0x1</span>, <span class="number">0x10</span>,\</span><br><span class="line">     <span class="number">0x3</span>, <span class="number">0x11</span>, <span class="number">0x20</span>,<span class="number">0x1D</span>, <span class="number">0x0B</span>, <span class="number">0x1E</span>, <span class="number">0x1B</span>, <span class="number">0x16</span>, <span class="number">4</span>, <span class="number">0x0D</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, \</span><br><span class="line">         <span class="number">0x15</span>, <span class="number">0x2</span>, <span class="number">0x19</span>, <span class="number">0x5</span>, <span class="number">0x1F</span>, <span class="number">0x8</span>, <span class="number">0x12</span>, <span class="number">0x1A</span>, <span class="number">0x1C</span>, <span class="number">0x0E</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">byte = [ <span class="number">0x67</span>, <span class="number">0x79</span>, <span class="number">0x7B</span>, <span class="number">0x7F</span>, <span class="number">0x75</span>, <span class="number">0x2B</span>,\</span><br><span class="line"><span class="number">0x3C</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x79</span>, <span class="number">0x57</span>, <span class="number">0x5E</span>, <span class="number">0x5D</span>, <span class="number">0x42</span>,\</span><br><span class="line">     <span class="number">0x7B</span>, <span class="number">0x2D</span>, <span class="number">0x2A</span>, <span class="number">0x66</span>, <span class="number">0x42</span>, <span class="number">0x7E</span>, <span class="number">0x4C</span>, <span class="number">0x57</span>,\</span><br><span class="line">    <span class="number">0x79</span>, <span class="number">0x41</span>, <span class="number">0x6B</span>, <span class="number">0x7E</span>, <span class="number">0x65</span>, <span class="number">0x3C</span>, <span class="number">0x5C</span>, <span class="number">0x45</span>,\</span><br><span class="line">         <span class="number">0x6F</span>, <span class="number">0x62</span>, <span class="number">0x4D</span>]</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">33</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dword)):</span><br><span class="line">    byte[i] ^= dword[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dword)):</span><br><span class="line">    flag[dword[i]] = byte[i]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> flag])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{Tr4nsp0sltiON_Clph3r_1s_3z}</p>
<p>原来关于index转换的题目还能这么做，创建一个全为0的flag列表，然后正序的推理……</p>
<h1 id="ACTF新生赛2020-usualCrypt"><a href="#ACTF新生赛2020-usualCrypt" class="headerlink" title="[ACTF新生赛2020]usualCrypt"></a>[ACTF新生赛2020]usualCrypt</h1>

<p>查个壳，没有壳，用IDA32打开</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v5[<span class="number">3</span>]; <span class="comment">// [esp+8h] [ebp-74h] BYREF</span></span><br><span class="line">  __int16 v6; <span class="comment">// [esp+14h] [ebp-68h]</span></span><br><span class="line">  <span class="type">char</span> v7; <span class="comment">// [esp+16h] [ebp-66h]</span></span><br><span class="line">  <span class="type">char</span> v8[<span class="number">100</span>]; <span class="comment">// [esp+18h] [ebp-64h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_403CF8((<span class="type">int</span>)&amp;unk_40E140);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, v8);</span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, <span class="keyword">sizeof</span>(v5));</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  sub_401080(v8, <span class="built_in">strlen</span>(v8), v5);	<span class="comment">//加密函数</span></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)v5 + v3) == byte_40E0E4[v3] ) <span class="comment">//匹配函数</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v3 &gt; <span class="built_in">strlen</span>((<span class="type">const</span> <span class="type">char</span> *)v5) )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_6;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_403CF8((<span class="type">int</span>)aError);</span><br><span class="line">LABEL_6:</span><br><span class="line">  <span class="keyword">if</span> ( v3 - <span class="number">1</span> == <span class="built_in">strlen</span>(byte_40E0E4) )</span><br><span class="line">    <span class="keyword">return</span> sub_403CF8((<span class="type">int</span>)aAreYouHappyYes);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> sub_403CF8((<span class="type">int</span>)aAreYouHappyNo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析一下：</p>
<p>首先是输入将flag放入v8数组中，然后进入了sub_401080这个函数，猜测应该是加密函数，我们继续跟进。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_401080</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// esi</span></span><br><span class="line">  _BYTE *v12; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// [esp+18h] [ebp+8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  sub_401000();</span><br><span class="line">  v5 = a2 % <span class="number">3</span>;</span><br><span class="line">  v6 = a1;</span><br><span class="line">  v7 = a2 - a2 % <span class="number">3</span>;</span><br><span class="line">  v15 = a2 % <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v7 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      LOBYTE(v5) = *(a1 + v3);</span><br><span class="line">      v3 += <span class="number">3</span>;</span><br><span class="line">      v8 = v4 + <span class="number">1</span>;</span><br><span class="line">      *(v8 + a3 - <span class="number">1</span>) = base[(v5 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">      *(++v8 + a3 - <span class="number">1</span>) = base[<span class="number">16</span> * (*(a1 + v3 - <span class="number">3</span>) &amp; <span class="number">3</span>) + ((*(a1 + v3 - <span class="number">2</span>) &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xF</span>)];</span><br><span class="line">      *(++v8 + a3 - <span class="number">1</span>) = base[<span class="number">4</span> * (*(a1 + v3 - <span class="number">2</span>) &amp; <span class="number">0xF</span>) + ((*(a1 + v3 - <span class="number">1</span>) &gt;&gt; <span class="number">6</span>) &amp; <span class="number">3</span>)];</span><br><span class="line">      v5 = *(a1 + v3 - <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">      v4 = v8 + <span class="number">1</span>;</span><br><span class="line">      *(v4 + a3 - <span class="number">1</span>) = base[v5];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v3 &lt; v7 );</span><br><span class="line">    v5 = v15;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    LOBYTE(v7) = *(v3 + a1);</span><br><span class="line">    v9 = v4 + <span class="number">1</span>;</span><br><span class="line">    *(v9 + a3 - <span class="number">1</span>) = base[(v7 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v10 = v9 + <span class="number">1</span>;</span><br><span class="line">    *(v10 + a3 - <span class="number">1</span>) = base[<span class="number">16</span> * (*(v3 + a1) &amp; <span class="number">3</span>)];</span><br><span class="line">    *(v10 + a3) = <span class="number">61</span>;</span><br><span class="line">LABEL_8:</span><br><span class="line">    v13 = v10 + <span class="number">1</span>;</span><br><span class="line">    *(v13 + a3) = <span class="number">61</span>;</span><br><span class="line">    v4 = v13 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_9;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 = v4 + <span class="number">1</span>;</span><br><span class="line">    *(v11 + a3 - <span class="number">1</span>) = base[(*(v3 + a1) &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v12 = (v3 + a1 + <span class="number">1</span>);</span><br><span class="line">    LOBYTE(v6) = *v12;</span><br><span class="line">    v10 = v11 + <span class="number">1</span>;</span><br><span class="line">    *(v10 + a3 - <span class="number">1</span>) = base[<span class="number">16</span> * (*(v3 + a1) &amp; <span class="number">3</span>) + ((v6 &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xF</span>)];</span><br><span class="line">    *(v10 + a3) = base[<span class="number">4</span> * (*v12 &amp; <span class="number">0xF</span>)];</span><br><span class="line">    <span class="keyword">goto</span> LABEL_8;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_9:</span><br><span class="line">  *(v4 + a3) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> sub_401030(a3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一开始是一个sub_401000函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_401000</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v1; <span class="comment">// cl</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( result = <span class="number">6</span>; result &lt; <span class="number">15</span>; ++result )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = byte_40E0AA[result];</span><br><span class="line">    byte_40E0AA[result] = base[result];</span><br><span class="line">    base[result] = v1; <span class="comment">//怎么这么熟悉，C语言里的替换？？</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个函数的意思是将base表中的</p>
<p>我们进入这个byte_40E0AA查看，貌似不是普通的base64加密函数</p>


<p>我们已知：</p>
<p>base:ABCDEFGHIJ</p>
<p>byte_40E0AA：KLMNOPQRS…………</p>


<p>查看跳出sub_401000，查看后面代码，可以看出是base64加密</p>
<p>我们再继续往后看</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> sub_401030(a3);</span><br></pre></td></tr></table></figure>

<p>最后有一个sub_401030函数，我们继续跟进</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_401030</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v2; <span class="comment">// al</span></span><br><span class="line"></span><br><span class="line">  v1 = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(a1) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v2 = a1[HIDWORD(v1)];</span><br><span class="line">      <span class="keyword">if</span> ( v2 &lt; <span class="string">&#x27;a&#x27;</span> || v2 &gt; <span class="string">&#x27;z&#x27;</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v2 &lt; <span class="string">&#x27;A&#x27;</span> || v2 &gt; <span class="string">&#x27;Z&#x27;</span> )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_9;</span><br><span class="line">        LOBYTE(v1) = v2 + <span class="number">32</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        LOBYTE(v1) = v2 - <span class="number">32</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      a1[HIDWORD(v1)] = v1;</span><br><span class="line">LABEL_9:</span><br><span class="line">      LODWORD(v1) = <span class="number">0</span>;</span><br><span class="line">      ++HIDWORD(v1);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( HIDWORD(v1) &lt; <span class="built_in">strlen</span>(a1) );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看出这个函数的意思就是把加密后的结果大小写字母转换，</p>
<p>看最后的比较函数，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">while</span> ( *(v5 + v3) == byte_40E0E4[v3] )       // 匹配函数</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v3 &gt; strlen(v5) )</span><br><span class="line">      goto LABEL_6;</span><br><span class="line">  &#125;</span><br><span class="line">  my_print(aError);</span><br><span class="line">LABEL_6:</span><br><span class="line">  <span class="keyword">if</span> ( v3 - <span class="number">1</span> == strlen(byte_40E0E4) )</span><br><span class="line">    <span class="keyword">return</span> my_print(aAreYouHappyYes);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> my_print(aAreYouHappyNo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这么多应该都是比较函数，我是这么理解的:</p>
<p>如果v5这个字符串与byte_40E0E4这个字符串相等，则会一直执行while循环对比，直到v3&#x3D;strlen(v5)+1，然后进入LABEL_6比较，相等则v3-1&#x3D;strlen(v5)，就输出正确的提示信息；</p>
<p>如果v5与这个字符串有一个不相等，则直接会退出while循环，这时</p>
<p>然后跟进byte_40E0E4，这个时候长度一定不相等，就输出错误的提示信息。</p>


<p>最后与加密之后对比的字符串为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&quot;</span></span><br></pre></td></tr></table></figure>

<p>有个疑问哈，这个z和后面的是分离的，所以怎么分辨那些块是那个字符串，还是可以共用？？如果是aMxh3……字符串这他对应的内容是多少，是和string一致，还是比string少一个z……</p>


<p>在询问大佬z1r0之后，得知，A 键可以使字符串连接起来</p>


<p>所以，base64对应的字符串：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br></pre></td></tr></table></figure>

<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/yhfgs/article/details/117449856?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.pc_relevant_default&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=3">https://blog.csdn.net/yhfgs/article/details/117449856?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.pc_relevant_default&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=3</a></p>
<p>我们理一下，</p>
<ol>
<li>先把这个string大小写先转换</li>
<li>修改base64转换表</li>
<li>加密结果通过转换表得到正常加密的结果</li>
<li>base64解密</li>
</ol>
<p>上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># 好家伙，这转换大小写也太舒服了</span></span><br><span class="line">string = <span class="string">&#x27;zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&#x27;</span>.swapcase()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 换表</span></span><br><span class="line">base = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line">lis = <span class="built_in">list</span>(base)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>,<span class="number">15</span>):</span><br><span class="line">    lis[<span class="number">10</span>+i],lis[i] = lis[i],lis[<span class="number">10</span>+i]</span><br><span class="line"></span><br><span class="line">new_base = <span class="string">&#x27;&#x27;</span>.join(lis)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># base64换表解密</span></span><br><span class="line"><span class="comment"># 牛啊，还能换表解密？？</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">flag += <span class="built_in">str</span>(base64.b64decode(string.translate(<span class="built_in">str</span>.maketrans(new_base,base))))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{bAse64_h2s_a_Surprise}</p>
<h1 id="2019红帽杯-easyRE（-fini）"><a href="#2019红帽杯-easyRE（-fini）" class="headerlink" title="[2019红帽杯]easyRE（.fini）"></a>[2019红帽杯]easyRE（.fini）</h1><p>查壳之后没有壳，直接用ida64打开，我一般是直接按Tab键看伪代码的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">__int64 sub_4009C6()</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; // rax</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+Ch] [rbp-114h]</span><br><span class="line">  __int64 v2; // [rsp+10h] [rbp-<span class="number">1</span>10h]</span><br><span class="line">  __int64 v3; // [rsp+18h] [rbp-108h]</span><br><span class="line">  __int64 v4; // [rsp+20h] [rbp-100h]</span><br><span class="line">  __int64 v5; // [rsp+28h] [rbp-F8h]</span><br><span class="line">  __int64 v6; // [rsp+30h] [rbp-F0h]</span><br><span class="line">  __int64 v7; // [rsp+38h] [rbp-E8h]</span><br><span class="line">  __int64 v8; // [rsp+40h] [rbp-E0h]</span><br><span class="line">  __int64 v9; // [rsp+48h] [rbp-D8h]</span><br><span class="line">  __int64 v10; // [rsp+50h] [rbp-D0h]</span><br><span class="line">  __int64 v11; // [rsp+58h] [rbp-C8h]</span><br><span class="line">  char v12[<span class="number">13</span>]; // [rsp+60h] [rbp-C0h] BYREF</span><br><span class="line">  char v13[<span class="number">4</span>]; // [rsp+6Dh] [rbp-B3h] BYREF</span><br><span class="line">  char v14[<span class="number">19</span>]; // [rsp+71h] [rbp-AFh] BYREF</span><br><span class="line">  char v15[<span class="number">32</span>]; // [rsp+90h] [rbp-90h] BYREF</span><br><span class="line">  <span class="built_in">int</span> v16; // [rsp+B0h] [rbp-70h]</span><br><span class="line">  char v17; // [rsp+B4h] [rbp-6Ch]</span><br><span class="line">  char v18[<span class="number">72</span>]; // [rsp+C0h] [rbp-60h] BYREF</span><br><span class="line">  unsigned __int64 v19; // [rsp+108h] [rbp-18h]</span><br><span class="line"></span><br><span class="line">  v19 = __readfsqword(0x28u);</span><br><span class="line">  qmemcpy(v12, <span class="string">&quot;Iodl&gt;Qnb(ocy&quot;</span>, <span class="number">12</span>);</span><br><span class="line">  v12[<span class="number">12</span>] = <span class="number">127</span>;</span><br><span class="line">  qmemcpy(v13, <span class="string">&quot;y.i&quot;</span>, <span class="number">3</span>);</span><br><span class="line">  v13[<span class="number">3</span>] = <span class="number">127</span>;</span><br><span class="line">  qmemcpy(v14, <span class="string">&quot;d`3w&#125;wek9&#123;iy=~yL@EC&quot;</span>, sizeof(v14));</span><br><span class="line">  memset(v15, <span class="number">0</span>, sizeof(v15));</span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">  v17 = <span class="number">0</span>;</span><br><span class="line">  sub_4406E0(<span class="number">0</span>, v15, 37LL);</span><br><span class="line">  v17 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( sub_424BA0(v15) == <span class="number">36</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; sub_424BA0(v15); ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (v15[i] ^ i) != v12[i] )</span><br><span class="line">      &#123;</span><br><span class="line">        result = 4294967294LL;</span><br><span class="line">        goto LABEL_13;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_410CC0(<span class="string">&quot;continue!&quot;</span>);</span><br><span class="line">    memset(v18, <span class="number">0</span>, <span class="number">65</span>);</span><br><span class="line">    sub_4406E0(<span class="number">0</span>, v18, 64LL);</span><br><span class="line">    v18[<span class="number">39</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( sub_424BA0(v18) == <span class="string">&#x27;\&#x27;&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = my_base64(v18);</span><br><span class="line">      v3 = my_base64(v2);</span><br><span class="line">      v4 = my_base64(v3);</span><br><span class="line">      v5 = my_base64(v4);</span><br><span class="line">      v6 = my_base64(v5);</span><br><span class="line">      v7 = my_base64(v6);</span><br><span class="line">      v8 = my_base64(v7);</span><br><span class="line">      v9 = my_base64(v8);</span><br><span class="line">      v10 = my_base64(v9);</span><br><span class="line">      v11 = my_base64(v10);</span><br><span class="line">      <span class="keyword">if</span> ( !sub_400360(v11, off_6CC090) )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_410CC0(<span class="string">&quot;You found me!!!&quot;</span>);</span><br><span class="line">        sub_410CC0(<span class="string">&quot;bye bye~&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      result = 0LL;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = 4294967293LL;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = 0xFFFFFFFFLL;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(0x28u) != v19 )</span><br><span class="line">    sub_444020();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>当我发现这个sub_400E44是base64之后，n键改个名字：my_base64</p>
<p>上面有一堆混淆人的伪代码，咱们直接看重点就行，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">memset(v18, <span class="number">0</span>, <span class="number">65</span>);</span><br></pre></td></tr></table></figure>

<p>为v18初始化</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_4406E0(<span class="number">0</span>, v18, 64LL);</span><br></pre></td></tr></table></figure>

<p>结合上下文可以知道这个sub_44065E0是赋值给v18的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( sub_424BA0(v18) == <span class="string">&#x27;\&#x27;&#x27;</span> )</span><br><span class="line">&#123;</span><br><span class="line">  v2 = my_base64(v18);</span><br><span class="line">  v3 = my_base64(v2);</span><br><span class="line">  v4 = my_base64(v3);</span><br><span class="line">  v5 = my_base64(v4);</span><br><span class="line">  v6 = my_base64(v5);</span><br><span class="line">  v7 = my_base64(v6);</span><br><span class="line">  v8 = my_base64(v7);</span><br><span class="line">  v9 = my_base64(v8);</span><br><span class="line">  v10 = my_base64(v9);</span><br><span class="line">  v11 = my_base64(v10);</span><br><span class="line">  <span class="keyword">if</span> ( !sub_400360(v11, off_6CC090) )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_410CC0(<span class="string">&quot;You found me!!!&quot;</span>);</span><br><span class="line">    sub_410CC0(<span class="string">&quot;bye bye~&quot;</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>然后就是将v18base64加密十次，与off_6cc090比较，我们直接把off_6cc090反向解密10次就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&#x27;Vm0wd2VHUXhTWGhpUm1SWVYwZDRWVll3Wkc5WFJsbDNXa1pPVlUxV2NIcFhhMk0xVmpKS1\</span></span><br><span class="line"><span class="string">NHVkdXbFpOYmtKVVZtcEtTMUl5VGtsaVJtUk9ZV3hhZVZadGVHdFRNVTVYVW01T2FGSnRVbGhhVjNoaF\</span></span><br><span class="line"><span class="string">ZWWmtWMXBFVWxSTmJFcElWbTAxVDJGV1NuTlhia0pXWWxob1dGUnJXbXRXTVZaeVdrWm9hVlpyV1hwV1\</span></span><br><span class="line"><span class="string">IzaGhXVmRHVjFOdVVsWmlhMHBZV1ZSR1lWZEdVbFZTYlhSWFRWWndNRlZ0TVc5VWJGcFZWbXR3VjJKSF\</span></span><br><span class="line"><span class="string">VYZFdha1pXWlZaT2NtRkhhRk5pVjJoWVYxZDBhMVV3TlhOalJscFlZbGhTY1ZsclduZGxiR1J5VmxSR1\</span></span><br><span class="line"><span class="string">ZXSlZjRWhaTUZKaFZqSktWVkZZYUZkV1JWcFlWV3BHYTFkWFRrZFRiV3hvVFVoQ1dsWXhaRFJpTWtsM1\</span></span><br><span class="line"><span class="string">RVaG9hbEpYYUhOVmJUVkRZekZhY1ZKcmRGTk5Wa3A2VjJ0U1ExWlhTbFpqUldoYVRVWndkbFpxUmtwbG\</span></span><br><span class="line"><span class="string">JVWklZVVprYUdFeGNHOVhXSEJIWkRGS2RGSnJhR2hTYXpWdlZGVm9RMlJzV25STldHUlZUVlpXTlZadE\</span></span><br><span class="line"><span class="string">5VOVdiVXBJVld4c1dtSllUWGhXTUZwell6RmFkRkpzVWxOaVNFSktWa1phVTFFeFduUlRhMlJxVWxad1\</span></span><br><span class="line"><span class="string">YxWnRlRXRXTVZaSFVsUnNVVlZVTURrPQ==&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#十次base64解密之后：?????</span></span><br><span class="line">string_2 = <span class="string">&#x27;https://bbs.pediy.com/thread-254172.htm&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(string)</span><br></pre></td></tr></table></figure>

<p>炸了，给我跳出一个网址。在查看z1r0的博客后，有些不理解的地方，不知道他关于真正flag函数是怎么找到的，在询问z1r0之后，z1r0贴心地给了我提示，我总结一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">v10 = my_base64(v9);</span><br><span class="line">v11 = my_base64(v10);</span><br><span class="line"><span class="keyword">if</span> ( !sub_400360(v11, off_6CC090) )</span><br><span class="line">&#123;</span><br><span class="line">sub_410CC0(<span class="string">&quot;You found me!!!&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>这个off_6cc090就是我们上面要比对的字符串，我们跟进之后：</p>


<p>我们可以先对off_6CC090这个字符串按x,就会弹出下面的框框，可以看到</p>
<ol>
<li>引用这个字符串所在的函数(也就是上面10个base64加密的坑人的那个……)</li>
<li>引用类型r，</li>
<li>文本（应该是汇编指令）</li>
</ol>




<p>（看来我得好好的去看看IDA权威指南了，一脸蒙蔽……）</p>
<p>然后看颜色就可以知道，下面的byte_6CC0A0，处在同一个段中，我们跟进，然后切换伪代码视图：</p>


<p>我们继续按x,然后就可以看到引用了,我们继续跟进：</p>


<p>地址为.fini_array:00000000006CBEE8</p>


<p>进程终止代码的一部分。程序正常退出时，系统将安排执行这边的代码！！！</p>
<p>所以这个函数很重要的！！！我们直接点击 sub_400D35这个函数跟进，然后按下tab:</p>


<p>出来了！！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (v1 ^ byte_6CC0A0[<span class="number">0</span>]) == <span class="string">&#x27;f&#x27;</span> &amp;&amp; (HIBYTE(v4) ^ byte_6CC0A3) == <span class="string">&#x27;g&#x27;</span> )</span><br></pre></td></tr></table></figure>

<p>瞧瞧这第20行的地方，一个f，一个g，很有希望！！</p>
<p>看上面一行，v4&#x3D;v1,那就很好理解了：</p>


<p>直接把大佬的原话搬出来：</p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/people/xu-xu-xuxu-94">https://www.zhihu.com/people/xu-xu-xuxu-94</a></p>
<p>后面我看不懂z1r0博客中exp的十六进制数从哪里来的，我就去寻找资料</p>
<p><a target="_blank" rel="noopener" href="https://www.i4k.xyz/article/Palmer9/103940709">https://www.i4k.xyz/article/Palmer9/103940709</a></p>


<p>说找到这串不随机的数，怎么找的，我就用IDA跳转地址的功能，G就可以了</p>


<p>手动输入了一下，发现还真有</p>


<p>用刚学的知识分析一下:</p>
<p>r代表读取交叉引用，说明sub_400D35函数引用了这串字符，我怎么没看到……</p>




<p>跟进去发现，就是这个byte_6CC0A0……(百度一下眼瞎怎么治)</p>
<p>直接上z1r0的代码，不解释了，看懂就行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">v4 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">str1 = <span class="string">&#x27;flag&#x27;</span></span><br><span class="line"></span><br><span class="line">key1 = [<span class="number">0x40</span>,<span class="number">0x35</span>,<span class="number">0x20</span>,<span class="number">0x56</span>,<span class="number">0x5D</span>,<span class="number">0x18</span>,<span class="number">0x22</span>,<span class="number">0x45</span>,<span class="number">0x17</span>,<span class="number">0x2F</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x62</span>,<span class="number">0x3C</span>,<span class="number">0x27</span>,<span class="number">0x54</span>,<span class="number">0x48</span>,<span class="number">0x6C</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x72</span>,<span class="number">0x3C</span>,<span class="number">0x32</span>,<span class="number">0x45</span>,<span class="number">0x5B</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    v4 += <span class="built_in">chr</span>(key1[i] ^ <span class="built_in">ord</span>(str1[i]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(v4)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(key1[i] ^ <span class="built_in">ord</span>(v4[i % <span class="number">4</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>看这个代码就清晰多了，key里面的是那些特殊字符的16进制形式，我们需要求出v4,使得v4的前四位能与key中的前四位进行异或操作时，等于flag，所以我们进行了key1[i]与ord(str1[i])的异或操作，将其还原回来，嗯，可以理解……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v4 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">str1 = <span class="string">&#x27;flag&#x27;</span></span><br><span class="line"></span><br><span class="line">key1 = [<span class="number">0x40</span>,<span class="number">0x35</span>,<span class="number">0x20</span>,<span class="number">0x56</span>,<span class="number">0x5D</span>,<span class="number">0x18</span>,<span class="number">0x22</span>,<span class="number">0x45</span>,<span class="number">0x17</span>,<span class="number">0x2F</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x62</span>,<span class="number">0x3C</span>,<span class="number">0x27</span>,<span class="number">0x54</span>,<span class="number">0x48</span>,<span class="number">0x6C</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x72</span>,<span class="number">0x3C</span>,<span class="number">0x32</span>,<span class="number">0x45</span>,<span class="number">0x5B</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    v4 += <span class="built_in">chr</span>(key1[i] ^ <span class="built_in">ord</span>(str1[i]))</span><br></pre></td></tr></table></figure>

<p>然后就是让key1中的每个字符，与v4[i%4]进行异或操作，为什么要求余4？因为v4一共就四位。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(key1[i] ^ <span class="built_in">ord</span>(v4[i % <span class="number">4</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{Act1ve_Defen5e_Test}</p>
<p>这也真“easy”，真不错……</p>
<h1 id="GUET-CTF2019-re-暴力-次序"><a href="#GUET-CTF2019-re-暴力-次序" class="headerlink" title="[GUET-CTF2019]re (暴力+次序)"></a>[GUET-CTF2019]re (暴力+次序)</h1>

<p>先查壳，发现有upx壳子，然后我们用upx脱个壳</p>


<p>然后放到IDA 64里面查看</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall sub_400E28(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> v6; // edx</span><br><span class="line">  <span class="built_in">int</span> v7; // ecx</span><br><span class="line">  <span class="built_in">int</span> v8; // er8</span><br><span class="line">  <span class="built_in">int</span> v9; // er9</span><br><span class="line">  __int64 result; // rax</span><br><span class="line">  __int64 v11[<span class="number">5</span>]; // [rsp+0h] [rbp-30h] BYREF</span><br><span class="line">  unsigned __int64 v12; // [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(0x28u);</span><br><span class="line">  memset(&amp;v11[<span class="number">1</span>], <span class="number">0</span>, <span class="number">24</span>);</span><br><span class="line">  sub_40F950((__int64)<span class="string">&quot;input your flag:&quot;</span>, a2, a3, a4, a5, a6);</span><br><span class="line">  sub_40FA80((unsigned <span class="built_in">int</span>)<span class="string">&quot;%s&quot;</span>, (unsigned <span class="built_in">int</span>)v11, v6, v7, v8, v9, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( sub_4009AE((char *)v11) )</span><br><span class="line">    sub_410350((__int64)<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    sub_410350((__int64)<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">  result = 0LL;</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(0x28u) != v12 )</span><br><span class="line">    sub_443550();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不要慌张，我们直接看correct的上一行，根据我的推测，从键盘输入的字符应该是放到了v11中，我们直接看sub_4009AE这个函数</p>


<p>我们需要求的就是a1这个数组了</p>
<p>然后我们直接上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">lists1 = [<span class="number">1629056</span>,<span class="number">6771600</span>,<span class="number">3682944</span>,<span class="number">10431000</span>,<span class="number">3977328</span>, <span class="number">5138336</span>,<span class="number">7532250</span>,\</span><br><span class="line">          <span class="number">5551632</span>,<span class="number">3409728</span>,<span class="number">13013670</span>,<span class="number">6088797</span>,<span class="number">7884663</span>,<span class="number">8944053</span>,<span class="number">5198490</span>,\</span><br><span class="line">          <span class="number">4544518</span>,<span class="number">3645600</span>,<span class="number">10115280</span>,<span class="number">9667504</span>,<span class="number">5364450</span>,<span class="number">13464540</span>, <span class="number">5488432</span>,\</span><br><span class="line">          <span class="number">14479500</span>,<span class="number">6451830</span>,<span class="number">6252576</span>,<span class="number">7763364</span>,<span class="number">7327320</span>,<span class="number">8741520</span>,<span class="number">8871876</span>,\</span><br><span class="line">          <span class="number">4086720</span>,<span class="number">9374400</span>,<span class="number">5759124</span>]</span><br><span class="line"></span><br><span class="line">lists2 = [<span class="number">166163712</span>,<span class="number">731332800</span> ,<span class="number">357245568</span>,<span class="number">1074393000</span>,<span class="number">489211344</span>,<span class="number">518971936</span>,\</span><br><span class="line">          <span class="number">406741500</span>,<span class="number">294236496</span>,<span class="number">177305856</span>,<span class="number">650683500</span>,<span class="number">298351053</span>,<span class="number">386348487</span>,\</span><br><span class="line">          <span class="number">438258597</span>,<span class="number">249527520</span>,<span class="number">445362764</span>,<span class="number">174988800</span>,<span class="number">981182160</span>,<span class="number">493042704</span>,\</span><br><span class="line">          <span class="number">257493600</span>,<span class="number">767478780</span>,<span class="number">312840624</span>,<span class="number">1404511500</span>,<span class="number">316139670</span>,<span class="number">619005024</span>,\</span><br><span class="line">          <span class="number">372641472</span>,<span class="number">373693320</span>,<span class="number">498266640</span>,<span class="number">452465676</span>,<span class="number">208422720</span>,<span class="number">515592000</span>,\</span><br><span class="line">          <span class="number">719890500</span>]</span><br><span class="line"></span><br><span class="line">lists = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lists1)):</span><br><span class="line"></span><br><span class="line">    lists.append(<span class="built_in">chr</span>(<span class="built_in">int</span>(lists2[i]/lists1[i])))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lists:</span><br><span class="line">    <span class="built_in">print</span>(i,end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>flag{e65421110b0a3099a1c039337}，提交之后竟然错了。。。</p>
<p>知错就改，z1r0中的博客说a[6]不存在，z1r0然后用暴力枚举，把a[6]给爆破出来了，上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">lists1 = [<span class="number">1629056</span>,<span class="number">6771600</span>,<span class="number">3682944</span>,<span class="number">10431000</span>,<span class="number">3977328</span>, <span class="number">5138336</span>,<span class="number">7532250</span>,\</span><br><span class="line">          <span class="number">5551632</span>,<span class="number">3409728</span>,<span class="number">13013670</span>,<span class="number">6088797</span>,<span class="number">7884663</span>,<span class="number">8944053</span>,<span class="number">5198490</span>,\</span><br><span class="line">          <span class="number">4544518</span>,<span class="number">3645600</span>,<span class="number">10115280</span>,<span class="number">9667504</span>,<span class="number">5364450</span>,<span class="number">13464540</span>, <span class="number">5488432</span>,\</span><br><span class="line">          <span class="number">14479500</span>,<span class="number">6451830</span>,<span class="number">6252576</span>,<span class="number">7763364</span>,<span class="number">7327320</span>,<span class="number">8741520</span>,<span class="number">8871876</span>,\</span><br><span class="line">          <span class="number">4086720</span>,<span class="number">9374400</span>,<span class="number">5759124</span>]</span><br><span class="line"></span><br><span class="line">lists2 = [<span class="number">166163712</span>,<span class="number">731332800</span> ,<span class="number">357245568</span>,<span class="number">1074393000</span>,<span class="number">489211344</span>,<span class="number">518971936</span>,\</span><br><span class="line">          <span class="number">406741500</span>,<span class="number">294236496</span>,<span class="number">177305856</span>,<span class="number">650683500</span>,<span class="number">298351053</span>,<span class="number">386348487</span>,\</span><br><span class="line">          <span class="number">438258597</span>,<span class="number">249527520</span>,<span class="number">445362764</span>,<span class="number">174988800</span>,<span class="number">981182160</span>,<span class="number">493042704</span>,\</span><br><span class="line">          <span class="number">257493600</span>,<span class="number">767478780</span>,<span class="number">312840624</span>,<span class="number">1404511500</span>,<span class="number">316139670</span>,<span class="number">619005024</span>,\</span><br><span class="line">          <span class="number">372641472</span>,<span class="number">373693320</span>,<span class="number">498266640</span>,<span class="number">452465676</span>,<span class="number">208422720</span>,<span class="number">515592000</span>,\</span><br><span class="line">          <span class="number">719890500</span>]</span><br><span class="line"></span><br><span class="line">lists = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lists1)):</span><br><span class="line"></span><br><span class="line">    lists.append(<span class="built_in">chr</span>(<span class="built_in">int</span>(lists2[i]/lists1[i])))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span>.join(lists)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="built_in">print</span>(flag[<span class="number">0</span>:<span class="number">6</span>]+<span class="built_in">chr</span>(<span class="number">48</span>+i)+flag[<span class="number">6</span>:<span class="built_in">len</span>(flag)])</span><br></pre></td></tr></table></figure>

<p>奇怪啊，z1r0说，结果为第二个，为什么还是错的？？</p>
<p>返回ADI中，我看到了：</p>
还得注意次序！！

<p>flag{e165421110ba03099a1c039337}</p>
<h1 id="SUCTF-2019-SignIn（rsa-plus）"><a href="#SUCTF-2019-SignIn（rsa-plus）" class="headerlink" title="[SUCTF 2019] SignIn（rsa plus）"></a>[SUCTF 2019] SignIn（rsa plus）</h1><p>RSA绝对是当今应用最为广泛的公钥加密算法</p>
<p>这是我第二次碰到rsa算法了，这次不能放过它了</p>
<p>这里我参考了b站油管rsa的介绍</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV14y4y1272w?from=search&amp;seid=6444314376553406414&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV14y4y1272w?from=search&amp;seid=6444314376553406414&amp;spm_id_from=333.337.0.0</a></p>
<p>看看z1r0的博客，发现一篇文章也说的很好</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/dbs1215/article/details/48953589">https://blog.csdn.net/dbs1215/article/details/48953589</a></p>
<ol>
<li>什么是rsa?</li>
</ol>
<p>rsa是一种加密和解密使用不同密码的方式，因此公钥密码通常车给非对称密码</p>
<ol start="2">
<li>rsa加密</li>
</ol>
<p>密文＝明文^E mod N</p>
<p>常说的公钥为E和N的组合，我们就用（E，N）来表示公钥</p>
<ol start="3">
<li>rsa解密</li>
</ol>
<p>明文＝密文^D mod N</p>
<p>对密文进行D次方后除以N的余数就是明文，这就是RSA解密过程，知道D和N就能进行</p>
<ol start="4">
<li>一般题目的解题方法</li>
</ol>
<p>一般的题目中会给出我们E和N，这两个是属于公钥，我们可以先把N放到因式分解工具找出P和Q，然后通过rsatool求出d——需要把N,E,Q,P都放到rsatool中并且调试对应的配置，最后是脚本的编写，具体我会放在后面</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">因式分解工具：http:<span class="comment">//www.factordb.com/index.php</span></span><br></pre></td></tr></table></figure>

<p>先查看题目，记得是没有壳的</p>


<p>记住rsa的特性，一个非常长的数字N，还有一个很短的数字E</p>
<p>分析一下题目，v8用来接受输入的字符，然后v8,v9进入了一个sub_96A的函数,我们跟进查看</p>


<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> byte_202010[<span class="number">16</span>] = &#123;<span class="number">0x30</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x66</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> <span class="title function_">sub_96A</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1, <span class="type">char</span> *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">size_t</span> result;</span><br><span class="line">    <span class="type">int</span> v3 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>;; i += <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        result = <span class="built_in">strlen</span>(a1);</span><br><span class="line">        result = <span class="built_in">strlen</span>(a1);</span><br><span class="line">        <span class="keyword">if</span> (v3 &gt;= result)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        a2[i] = byte_202010[a1[v3] &gt;&gt; <span class="number">4</span>];</span><br><span class="line">        a2[i + <span class="number">1</span>] = byte_202010[a1[v3++] &amp; <span class="number">0xF</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> v8[<span class="number">20</span>];</span><br><span class="line">    <span class="type">char</span> v9[<span class="number">101</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, v8);</span><br><span class="line">    sub_96A(v8, v9);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, v9);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//C语言，16进制位0x,和python一致</span></span><br><span class="line"><span class="comment">//vscode 学到一招：选择区域的全部替换</span></span><br><span class="line"><span class="comment">//size_t为无符号整数类型</span></span><br><span class="line"><span class="comment">//字符数组的形式参数，用char * a</span></span><br><span class="line"><span class="comment">//字符数组的输出，直接用%s就行了</span></span><br><span class="line"><span class="comment">//仔细观察发现，z1r0写的main函数还有int argc,和char ** argv,过来学习一下https://blog.csdn.net/LYJ_viviani/article/details/51873961</span></span><br><span class="line"><span class="comment">//指针没有学好，不知道怎么传参</span></span><br><span class="line"><span class="comment">//字符数组貌似不能直接赋值，需要用scanf</span></span><br></pre></td></tr></table></figure>

<p>以上参考z1r0的代码，该函数的功能是将v8的字符串转换为16进制放入v9,然后就是下面的两个函数，__gmpz_init_set_str和__gmpz_powm</p>


<p>是GNU的高精度算法？？</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">__gmpz_init_set_str(v7, <span class="string">&quot;ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35&quot;</span>, <span class="number">16LL</span>);</span><br><span class="line">__gmpz_init_set_str(v6, v9, <span class="number">16LL</span>);</span><br><span class="line"></span><br><span class="line">__gmpz_init_set_str(v4, <span class="string">&quot;103461035900816914121390101299049044413950405173712170434161686539878160984549&quot;</span>, <span class="number">10LL</span>);</span><br><span class="line"></span><br><span class="line">__gmpz_init_set_str(v5, <span class="string">&quot;65537&quot;</span>, <span class="number">10LL</span>);</span><br><span class="line">__gmpz_powm(v6, v6, v5, v4);</span><br><span class="line"><span class="keyword">if</span> ( __gmpz_cmp(v6, v7) )</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;GG!&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;TTTTTTTTTTql!&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>将ad939ff59~~这个字符串以16进制写入v7</p>
<p>将1034~~这个数字以10进制写入v4</p>
<p>将65537这个字符串以10进制写入v5</p>
<p>__gmpz_pown(v6,v6,v5,v4)，意思是计算v6的v5次方，并对v4取模，写入v6，现在我终于看明白了，v6相当于明文，v5相当于E，v4相当于N，</p>
<p>rsa的加密算法：明文^E%N</p>
<p>__gmpz_cmp是一个比较函数，看名字就知道了</p>
<p>rsa加密之后与ad939ff59~~这个函数作比较</p>
<p>我们先用因式分解工具来算出P和Q</p>


<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">P：<span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">Q：<span class="number">366669102002966856876605669837014229419</span></span><br></pre></td></tr></table></figure>

<p>然后用rsatool求出d</p>


<p>记住要先选择number base，即进制，然后再输入数据。</p>
<p>D &#x3D; 91646299298871237857836940212608056141193465208586711901499120163393577626813</p>
<p>上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">N = <span class="number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></span><br><span class="line">E = <span class="number">65537</span></span><br><span class="line">p = <span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">q = <span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">D = <span class="number">91646299298871237857836940212608056141193465208586711901499120163393577626813</span></span><br><span class="line">C = <span class="number">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span></span><br><span class="line"></span><br><span class="line">M = gmpy2.powmod(C, D, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(M)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_60553183/article/details/122084511">https://blog.csdn.net/weixin_60553183/article/details/122084511</a></p>
<p>我得理一下，gmpy2是干嘛的。</p>
<p>下面是关于gmpy2的常见函数的使用</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43790779/article/details/108473984">https://blog.csdn.net/weixin_43790779/article/details/108473984</a></p>
<p>powmod是求大整数x的y次幂m取余，</p>
<p>b‘suctf{Pwn_@_hundred_years}’</p>
<h1 id="xor-异或"><a href="#xor-异或" class="headerlink" title="xor (异或)"></a>xor (异或)</h1><p>首先用exeinfoPE判断一下</p>


<p>是64位的，没有加壳，然后用IDA 64位打开，找到main函数</p>


<p>然后就是分析主函数，输入v6,让v6和global作比较，由题目得知，如果如数v6的长度没有33，则直接跳转到LABLE_12的位置，输出Failed</p>
<p>然后就是分析伪代码</p>


<p>下面是脚本的编写：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">lists = [<span class="string">&#x27;f&#x27;</span>,<span class="number">0x0A</span>,<span class="string">&#x27;k&#x27;</span>,<span class="number">0x0C</span>,<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;O&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;@&#x27;</span>,<span class="number">0x11</span>,\</span><br><span class="line">         <span class="string">&#x27;x&#x27;</span>,<span class="number">0x0D</span>,<span class="string">&#x27;Z&#x27;</span>,<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="number">0x11</span>,<span class="string">&#x27;p&#x27;</span>,<span class="number">0x19</span>,<span class="string">&#x27;F&#x27;</span>,<span class="number">0x1F</span>,\</span><br><span class="line">         <span class="string">&#x27;v&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="number">0x0E</span>,<span class="string">&#x27;g&#x27;</span>,<span class="number">6</span>,<span class="string">&#x27;h&#x27;</span>,<span class="number">0x0F</span>,<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;O&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(lists)):</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">isinstance</span>(lists[i],<span class="built_in">int</span>)):</span><br><span class="line">        lists[i] = <span class="built_in">chr</span>(lists[i])</span><br><span class="line"></span><br><span class="line">string = <span class="string">&#x27;&#x27;</span>.join(lists)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;f&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(lists)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(lists[i]) ^ <span class="built_in">ord</span>(lists[i-<span class="number">1</span>]))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(lists))</span><br></pre></td></tr></table></figure>

<ol>
<li><p>将伪代码中的单个字符保持不动，连起来的字符分开，十六进制的在前面填上0x进制符号，并删除后面的h，然后放入列表lists</p>
</li>
<li><p>将列表中的int类型转换位char类型，用isinstance( x, type)方法来比较</p>
</li>
<li><p>将列表中的元素转换为字符串，如果这时输出，那么十六进制的那一块将转换为空格</p>
<img src="BUU-reverse/image-20220119001858906.png" alt="image-20220119001858906" style="zoom:50%;" />
</li>
<li><p>然后将字符串的字符一次进行异或运算，最终输出得到flag</p>
</li>
</ol>
<h1 id="hello-word（apk逆向）"><a href="#hello-word（apk逆向）" class="headerlink" title="hello word（apk逆向）"></a>hello word（apk逆向）</h1><p>写在后面的话:</p>
<p>apk反汇编推荐用jadx-gui和GDAE</p>
<p>–正文–</p>
<p>参考资料：<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/29370382">https://www.zhihu.com/question/29370382</a></p>
<ol>
<li>使用apktool</li>
</ol>
<p>cmd+D，打开dos，找到apk的目录，然后键入</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apktool d 名字.apk</span><br></pre></td></tr></table></figure>

<p>即可。</p>


<p>解出以上资源</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CD			进入</span><br><span class="line">CD ../		进入上一层目录</span><br></pre></td></tr></table></figure>

<p>但是我们需要的是.dex文件，所以此时应该再运行</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apktool d -s -f 名字.apk</span><br></pre></td></tr></table></figure>

<p>-s    不反编译dex文件，而是将其保留</p>
<p>-f    如果目标文件夹存在，则删除后重新反编译</p>
<p>d    反编译apk文件</p>




<p>将修改完的apk重新打包</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apktool b 目录名 -o newtest.apk</span><br></pre></td></tr></table></figure>

<p>-b        build</p>
<p>-o    新的文件名</p>
<ol start="2">
<li>使用dex2jar工具</li>
</ol>
<p>参考链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/dbe579f6cc84">https://www.jianshu.com/p/dbe579f6cc84</a></p>
<p>将apktool反汇编所得文件的classes.dex复制到dex2jar.bat所在目录</p>
<p>我的存放地址是：C:\Users\Lenovo\Desktop\dex2jar-2.0</p>
<p>然后在命令行中键入</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d2j-dex2jar classes.dex</span><br></pre></td></tr></table></figure>



<p>生成了一个class-dex2jar.jar文件，就是反编译后的java源码文件</p>




<ol start="3">
<li>使用jd-gui.exe运行生成的反编译的Java源码</li>
</ol>
<p>然后用jd-gui.exe运行生成的class-dex2jar.jar文件，就可以看到源码了</p>
<img src="BUU-reverse/image-20220119120445359.png" alt="image-20220119120445359" style="zoom:50%;" />



<h1 id="reverse-3-base64"><a href="#reverse-3-base64" class="headerlink" title="reverse_3 (base64)"></a>reverse_3 (base64)</h1>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(Dest, Str2, v6) )</span><br></pre></td></tr></table></figure>

<p>strncmp()函数，str2与Dest作比较，最多比较前v6个字符串长度</p>
<p>结果为0，则两个字符串相等</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">strncpy</span>(Dest, v5, <span class="number">40u</span>);</span><br></pre></td></tr></table></figure>

<p>strncpy()函数，v5复制到Dest字符数组中，长度为40u</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(str,<span class="string">&#x27;$&#x27;</span>,<span class="number">7</span>)</span><br></pre></td></tr></table></figure>

<p>memset()函数，将符号‘$’复制到str字符数组中，长度为7</p>
<p>根据大佬写的知乎，发现这个是base64的编码，好家伙，python两行搞完。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">str1 = <span class="string">&quot;e3nifIH9b_C@n@dH&quot;</span></span><br><span class="line">lists = [i <span class="keyword">for</span> i <span class="keyword">in</span> str1]</span><br><span class="line"></span><br><span class="line">str2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lists)):</span><br><span class="line">    lists[i] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(lists[i])-i)</span><br><span class="line">    str2 += lists[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(str2)</span><br><span class="line">str3 = base64.b64decode(str2)</span><br><span class="line"><span class="built_in">print</span>(str3)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="Simple-Rev-ADI小端存储"><a href="#Simple-Rev-ADI小端存储" class="headerlink" title="Simple_Rev (ADI小端存储)"></a>Simple_Rev (ADI小端存储)</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_47158947/article/details/107461010?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1.pc_relevant_default&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1.pc_relevant_default&utm_relevant_index=1">参考链接</a></p>
<p>今天吃了个大亏</p>
<p>ADA里面的字符存储是小端存储</p>
<p>小端存储就是低地址存放到底位上，高地址存放到高位上。</p>
<p>以下是小端存储模式下的0x123456的存储，明显看到次序是颠倒的</p>




<p>所以，遇到这种直接把字符需要小心，先转换一下次序再说</p>
<p>首先我们测一下这个exe文件是否有壳</p>


<p>说句实话，我看不出来，貌似有一个压缩壳，然后是需要64位的Ada使用</p>
<p>打开之后看一下伪代码</p>


<p>主要是进Decry()函数看一下，进去之后就是新世界</p>


<p>这边就是主要算法了</p>


<p>这种的意思是字母大写转换为小写，key由大写转换为小写</p>
<p>通过循环上面的得知，</p>
<p>key &#x3D; ‘adsfkndcls’                        text &#x3D; ‘killshadow’</p>
<p>看一下算法主题，就是一个while()循环，输入字符，如果碰到换行符直接退出。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&#x27;adsfkndcls&#x27;</span></span><br><span class="line">text = <span class="string">&#x27;killshadow&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#flag长度</span></span><br><span class="line">n = <span class="built_in">len</span>(text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#ASCII码一共128个，依次循环</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line"></span><br><span class="line">        <span class="comment">#不是字符，直接下一次循环</span></span><br><span class="line">        <span class="keyword">if</span> j &lt; <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">or</span> j &gt; <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>) \</span><br><span class="line">           <span class="keyword">or</span> (j &lt; <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">and</span> j &gt; <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)):</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#枚举</span></span><br><span class="line">        <span class="keyword">if</span> (j - <span class="number">39</span> - <span class="built_in">ord</span>(key[n % <span class="number">10</span>]) +<span class="number">97</span>) %<span class="number">26</span> +<span class="number">97</span> \</span><br><span class="line">           == <span class="built_in">ord</span>(text[i]):</span><br><span class="line"></span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>就是要把题目给理解透彻了才行</p>
<p>题目的意思是如果不是字母（大写小写皆可），就直接退出，如果是字母，就执行下面的转换，转换的里面还挺复杂的，所以直接就暴力枚举。</p>
<p>判断是不是字母还有点小绕</p>
<h1 id="GXYCTF2019-luck-guy-ADI小端存储"><a href="#GXYCTF2019-luck-guy-ADI小端存储" class="headerlink" title="[GXYCTF2019]luck_guy (ADI小端存储)"></a>[GXYCTF2019]luck_guy (ADI小端存储)</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">f1 = <span class="string">&quot;GXY&#123;do_not_&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#小端，所以逆一下</span></span><br><span class="line">f2 = <span class="string">&#x27;fo`guci&#x27;</span>[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">lists = [i <span class="keyword">for</span> i <span class="keyword">in</span> f2]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> j%<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        lists[j] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(lists[j]) -<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        lists[j] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(lists[j]) -<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">string = <span class="string">&#x27;&#x27;</span>.join(lists)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f1+string)</span><br></pre></td></tr></table></figure>

<p>memset参考文档<a target="_blank" rel="noopener" href="http://c.biancheng.net/view/231.html">http://c.biancheng.net/view/231.html</a></p>
<p>memset()是初始化内存的万能函数，初始化之后，再向内存空间中存放需要的值，一般来说使用“0”初始化内存单元，通常给数组或结构体进行初始化，其实相当于结束标志‘\0’,最后面的参数是长度，一般专业一点会写sizeof(XX)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> f1[] = <span class="string">&quot;GXY&#123;do_not_&quot;</span>;</span><br><span class="line">	<span class="type">char</span> f2[] = <span class="string">&quot;hate_me&#125;&quot;</span>;</span><br><span class="line">	<span class="type">char</span> flag[<span class="number">20</span>];</span><br><span class="line">	<span class="built_in">memset</span>(flag,<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,flag);</span><br><span class="line">	<span class="built_in">strcat</span>(flag,f1);</span><br><span class="line">	<span class="built_in">strcat</span>(flag,f2);</span><br><span class="line">	<span class="built_in">puts</span>(flag);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以基础很重要啊！！！</p>
<p>首先我们来分析一下题目，</p>




<p>进入patch_me函数</p>




<p>再进入get_flag函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">v7 = __readfsqword(<span class="number">40u</span>);</span><br><span class="line"> v0 = time(<span class="number">0LL</span>);</span><br><span class="line"> srand(v0);</span><br><span class="line"> <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line"> &#123;</span><br><span class="line">   <span class="keyword">switch</span> ( rand() % <span class="number">200</span> )</span><br><span class="line">   &#123;</span><br><span class="line">     <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">       <span class="built_in">puts</span>(<span class="string">&quot;OK, it&#x27;s flag:&quot;</span>);</span><br><span class="line">       <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">40uLL</span>);</span><br><span class="line">       <span class="built_in">strcat</span>((<span class="type">char</span> *)&amp;s, f1);</span><br><span class="line">       <span class="built_in">strcat</span>((<span class="type">char</span> *)&amp;s, &amp;f2);</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, &amp;s);</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">&quot;Solar not like you&quot;</span>);</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">&quot;Solar want a girlfriend&quot;</span>);</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">       v6 = <span class="number">0</span>;</span><br><span class="line">       s = <span class="string">&#x27;fo`guci&#x27;</span>;</span><br><span class="line">       <span class="built_in">strcat</span>(&amp;f2, (<span class="type">const</span> <span class="type">char</span> *)&amp;s);</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">       <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">7</span>; ++j )</span><br><span class="line">       &#123;</span><br><span class="line">         <span class="keyword">if</span> ( j % <span class="number">2</span> == <span class="number">1</span> )</span><br><span class="line">           char_1 = *(&amp;f2 + j) - <span class="number">2</span>;</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">           char_1 = *(&amp;f2 + j) - <span class="number">1</span>;</span><br><span class="line">         *(&amp;f2 + j) = char_1;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     <span class="keyword">default</span>:</span><br><span class="line">       <span class="built_in">puts</span>(<span class="string">&quot;emmm,you can&#x27;t find flag 23333&quot;</span>);</span><br><span class="line">       <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>

<p>产生一个随机数，并进入switch结构，我们可以看出，按照4、5、1的顺序，就能求出flag，记得要注意ADI的小端优先</p>
<p>代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;GXY&#123;do_not_&#x27;</span></span><br><span class="line">f2 = [<span class="number">0x7F</span>, <span class="number">0x66</span>, <span class="number">0x6F</span>, <span class="number">0x60</span>, <span class="number">0x67</span>, <span class="number">0x75</span>, <span class="number">0x63</span>, <span class="number">0x69</span>][::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f2)</span><br><span class="line"></span><br><span class="line">ss = <span class="string">&#x27;&#x27;</span></span><br><span class="line">final = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        s = <span class="built_in">chr</span>(f2[i] - <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s = <span class="built_in">chr</span>(f2[i] - <span class="number">1</span>)</span><br><span class="line">    flag += s</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{do_not_hate_me}</p>
<h1 id="刮开有奖-ASCII排序-base64"><a href="#刮开有奖-ASCII排序-base64" class="headerlink" title="刮开有奖 (ASCII排序+base64)"></a>刮开有奖 (ASCII排序+base64)</h1>

<p>首先查壳，分析一下是32位的程序，没有壳，所以用ida32打开</p>


<p>DialogFunc是一个函数，咱们跟进去</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="built_in">strlen</span>(String) == <span class="number">8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      str1[<span class="number">0</span>] = <span class="string">&#x27;Z&#x27;</span>;</span><br><span class="line">      str1[<span class="number">1</span>] = <span class="string">&#x27;J&#x27;</span>;</span><br><span class="line">      str2 = <span class="string">&#x27;S&#x27;</span>;</span><br><span class="line">      str3 = <span class="string">&#x27;E&#x27;</span>;</span><br><span class="line">      str4 = <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">      str5 = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">      str6 = <span class="string">&#x27;N&#x27;</span>;</span><br><span class="line">      str7 = <span class="string">&#x27;H&#x27;</span>;</span><br><span class="line">      str8 = <span class="string">&#x27;3&#x27;</span>;</span><br><span class="line">      str9 = <span class="string">&#x27;n&#x27;</span>;</span><br><span class="line">      str10 = <span class="string">&#x27;g&#x27;</span>;</span><br><span class="line">      my_results(str1, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">      <span class="built_in">memset</span>(v18, <span class="number">0</span>, <span class="number">0xFFFF</span>u);</span><br><span class="line">      v18[<span class="number">0</span>] = String[<span class="number">5</span>];</span><br><span class="line">      v18[<span class="number">2</span>] = String[<span class="number">7</span>];</span><br><span class="line">      v18[<span class="number">1</span>] = String[<span class="number">6</span>];</span><br><span class="line">      v4 = base_64(v18, <span class="built_in">strlen</span>(v18));</span><br><span class="line">      <span class="built_in">memset</span>(v18, <span class="number">0</span>, <span class="number">0xFFFF</span>u);</span><br><span class="line">      v18[<span class="number">1</span>] = String[<span class="number">3</span>];</span><br><span class="line">      v18[<span class="number">0</span>] = String[<span class="number">2</span>];</span><br><span class="line">      v18[<span class="number">2</span>] = String[<span class="number">4</span>];</span><br><span class="line">      v5 = base_64(v18, <span class="built_in">strlen</span>(v18));</span><br><span class="line">      <span class="keyword">if</span> ( String[<span class="number">0</span>] == str1[<span class="number">0</span>] + <span class="number">34</span></span><br><span class="line">        &amp;&amp; String[<span class="number">1</span>] == str4</span><br><span class="line">        &amp;&amp; <span class="number">4</span> * String[<span class="number">2</span>] - <span class="number">141</span> == <span class="number">3</span> * str2</span><br><span class="line">        &amp;&amp; String[<span class="number">3</span>] / <span class="number">4</span> == <span class="number">2</span> * (str7 / <span class="number">9</span>)</span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(v4, <span class="string">&quot;ak1w&quot;</span>)</span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(v5, <span class="string">&quot;V1Ax&quot;</span>) )</span><br><span class="line">      &#123;</span><br><span class="line">        MessageBoxA(hDlg, <span class="string">&quot;U g3t 1T!&quot;</span>, <span class="string">&quot;@_@&quot;</span>, <span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>查看定义的字符的汇编代码</p>


<p>可以发现其实就是一连串的连续空间，就是一个字符数组</p>


<p>然后进入一个函数，看参数，第二个是0，第三个是10,既然看不懂，就直接把它改一改，放到vscode里面运行一下，因为我们知道它的参数了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">my_results</span> <span class="params">(<span class="type">char</span> arr[], <span class="type">int</span> a, <span class="type">int</span> b)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// edx</span></span><br><span class="line"></span><br><span class="line">  result = b;</span><br><span class="line">  <span class="keyword">for</span> ( i = a; i &lt;= b; a = i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = i;</span><br><span class="line">    v6 = arr[i];</span><br><span class="line">    <span class="keyword">if</span> ( a &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt; arr[result] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          ++i;</span><br><span class="line">          arr[v5] = arr[result];</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">while</span> ( arr[i] &lt;= v6 )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( ++i &gt;= result )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v5 = i;</span><br><span class="line">          arr[result] = arr[i];</span><br><span class="line">        &#125;</span><br><span class="line">        --result;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( i &lt; result );</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">    arr[result] = v6;</span><br><span class="line">    my_results(arr, a, i - <span class="number">1</span>);</span><br><span class="line">    result = b;</span><br><span class="line">    ++i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">char</span> arr[<span class="number">20</span>] = &#123;<span class="number">90</span>,<span class="number">74</span>,<span class="number">83</span>,<span class="number">69</span>,<span class="number">67</span>,<span class="number">97</span>,<span class="number">78</span>,<span class="number">72</span>,<span class="number">51</span>,<span class="number">110</span>,<span class="number">103</span>&#125;;</span><br><span class="line">    <span class="built_in">puts</span>(arr);</span><br><span class="line">    my_results(arr, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">puts</span>(arr);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不怎么接触c语言，昨天才知道，*（a+i）其实相当于数组a[i],a是基准地址，i是偏移量，后面我就知道了，这个函数的形参的第一个其实就是字符数组，之前定义的。</p>


<p>运行完成后，其实就是对定义的字符进行了排序，有ASCII从小到大排序</p>


<p>再看这边，String就是我们输入的数字</p>
<p>用v18这个数组来存储，然后把v18放置在函数中，第二个参数是长度</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">v2 = a2 / <span class="number">3</span>;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 % <span class="number">3</span> &gt; <span class="number">0</span> )</span><br><span class="line">    ++v2;</span><br><span class="line">  v4 = <span class="number">4</span> * v2 + <span class="number">1</span>;</span><br><span class="line">  v5 = <span class="built_in">malloc</span>(v4);</span><br><span class="line">  v6 = v5;</span><br><span class="line">  v15 = v5;</span><br><span class="line">  <span class="keyword">if</span> ( !v5 )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, v4);</span><br><span class="line">  v7 = a2;</span><br><span class="line">  v8 = v6;</span><br><span class="line">  v16 = v6;</span><br><span class="line">  <span class="keyword">if</span> ( a2 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = <span class="number">0</span>;</span><br><span class="line">      v10 = <span class="number">0</span>;</span><br><span class="line">      v18 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v3 &gt;= v7 )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        ++v10;</span><br><span class="line">        v9 = *(v3 + a1) | (v9 &lt;&lt; <span class="number">8</span>);</span><br><span class="line">        ++v3;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v10 &lt; <span class="number">3</span> );</span><br><span class="line">      v11 = v9 &lt;&lt; (<span class="number">8</span> * (<span class="number">3</span> - v10));</span><br><span class="line">      v12 = <span class="number">0</span>;</span><br><span class="line">      v17 = v3;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">18</span>; i &gt; <span class="number">-6</span>; i -= <span class="number">6</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v10 &gt;= v12 )</span><br><span class="line">        &#123;</span><br><span class="line">          *(&amp;v18 + v12) = (v11 &gt;&gt; i) &amp; <span class="number">0x3F</span>;</span><br><span class="line">          v8 = v16;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          *(&amp;v18 + v12) = <span class="number">64</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        *v8++ = byte_407830[*(&amp;v18 + v12++)];</span><br><span class="line">        v16 = v8;</span><br><span class="line">      &#125;</span><br><span class="line">      v3 = v17;</span><br><span class="line">      <span class="keyword">if</span> ( v17 &gt;= a2 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v7 = a2;</span><br><span class="line">    &#125;</span><br><span class="line">    v6 = v15;</span><br><span class="line">  &#125;</span><br><span class="line">  result = v6;</span><br><span class="line">  *v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用z1r0的话就是盲猜是base64解码</p>


<p>这边会有移动，是base64的最明显的特征，把这个函数取名为base_64，后面还有一个base64的编码</p>


<p>这边就很简单了，注意，str1[0]的值是排序完成之后的值</p>
<p>ZJSECaNH3ng</p>
<p>3CEHJNSZagn</p>
<p>str1[0] &#x3D; 3, string[0] &#x3D; U                    </p>
<p>str4 &#x3D; J, string[1] &#x3D; J</p>
<p>string [3] &#x3D; P</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&#x27;Z&#x27;</span></span><br><span class="line">b = <span class="string">&#x27;Z&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(a)+<span class="number">34</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">ord</span>(b)/<span class="number">9</span>*<span class="number">8</span>)))</span><br></pre></td></tr></table></figure>

<p>最后结合起来string，即flag{UJWP1jMp}</p>
<h1 id="BJDCTF2020-JustRE-（水题）"><a href="#BJDCTF2020-JustRE-（水题）" class="headerlink" title="[BJDCTF2020]JustRE （水题）"></a>[BJDCTF2020]JustRE （水题）</h1>

<p>既然程序看不懂，就找找字符列表中，有没有能看懂的，发现最后有个可疑字符</p>
<p>咱们点进去</p>


<p>内存中的数字直接按住tab是不能显示伪代码的,得点击函数才行</p>


<p>然后就是读一下程序</p>
<p>我认为上面的19999是鼠标点击的次数，点击这么多次后，然后就会弹出flag</p>
<p>sprintf函数，共有三个参数，第二个是格式，第一个是需要赋值的字符串，后面两个是被格式化的变量，所以flag{1999902069a45792d233ac}</p>
<h1 id="简单注册器-apk逆向"><a href="#简单注册器-apk逆向" class="headerlink" title="简单注册器(apk逆向)"></a>简单注册器(apk逆向)</h1><p>写在后面的话:</p>
<p>apk反汇编推荐用jadx-gui或GDAE</p>
<p>首先用apkide打开apk文件</p>
<ol>
<li><p>打开apkIDE,然后把apk文件拖到右边（不是直接将apk拖入apkIDE）</p>
</li>
<li><p>等它自动转换后，找到输出目录</p>
</li>
</ol>
<p>直接复制到地址栏跳转，找到MainActivity.class文件</p>


<ol start="3">
<li>最后将这个文件用jd-gui打开</li>
</ol>


<p>so easy</p>
<p>然后就是阅读程序</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.flag;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">null</span> <span class="keyword">implements</span> <span class="title class_">View</span>.OnClickListener &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View paramView)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> editview.getText().toString();</span><br><span class="line">    <span class="keyword">if</span> (str.length() != <span class="number">32</span> || str.charAt(<span class="number">31</span>) != <span class="string">&#x27;a&#x27;</span> || str.charAt(<span class="number">1</span>) != <span class="string">&#x27;b&#x27;</span> || str.charAt(<span class="number">0</span>) + str.charAt(<span class="number">2</span>) - <span class="number">48</span> != <span class="number">56</span>)</span><br><span class="line">      i = <span class="number">0</span>; </span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="type">char</span>[] arrayOfChar = <span class="string">&quot;dd2940c04462b4dd7c450528835cca15&quot;</span>.toCharArray();</span><br><span class="line">      arrayOfChar[<span class="number">2</span>] = (<span class="type">char</span>)(arrayOfChar[<span class="number">2</span>] + arrayOfChar[<span class="number">3</span>] - <span class="number">50</span>);</span><br><span class="line">      arrayOfChar[<span class="number">4</span>] = (<span class="type">char</span>)(arrayOfChar[<span class="number">2</span>] + arrayOfChar[<span class="number">5</span>] - <span class="number">48</span>);</span><br><span class="line">      arrayOfChar[<span class="number">30</span>] = (<span class="type">char</span>)(arrayOfChar[<span class="number">31</span>] + arrayOfChar[<span class="number">9</span>] - <span class="number">48</span>);</span><br><span class="line">      arrayOfChar[<span class="number">14</span>] = (<span class="type">char</span>)(arrayOfChar[<span class="number">27</span>] + arrayOfChar[<span class="number">28</span>] - <span class="number">97</span>);</span><br><span class="line">      <span class="keyword">for</span> (i = <span class="number">0</span>;; i++) &#123;</span><br><span class="line">        String str1;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= <span class="number">16</span>) &#123;</span><br><span class="line">          str1 = String.valueOf(arrayOfChar);</span><br><span class="line">          textview.setText(<span class="string">&quot;flag&#123;&quot;</span> + str1 + <span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> str1[<span class="number">31</span> - i];</span><br><span class="line">        str1[<span class="number">31</span> - i] = str1[i];</span><br><span class="line">        str1[i] = str2;</span><br><span class="line">      &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    textview.setText(<span class="string">&quot;);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p>字符数组转换一下，然后再反向一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;dd2940c04462b4dd7c450528835cca15&quot;</span></span><br><span class="line"></span><br><span class="line">lists = [i <span class="keyword">for</span> i <span class="keyword">in</span>  string]</span><br><span class="line"></span><br><span class="line">lists[<span class="number">2</span>] = <span class="built_in">chr</span>((<span class="built_in">ord</span>(lists[<span class="number">2</span>]) + <span class="built_in">ord</span>(lists[<span class="number">3</span>]) - <span class="number">50</span>))</span><br><span class="line">lists[<span class="number">4</span>] = <span class="built_in">chr</span>((<span class="built_in">ord</span>(lists[<span class="number">2</span>]) + <span class="built_in">ord</span>(lists[<span class="number">5</span>]) - <span class="number">48</span>))</span><br><span class="line">lists[<span class="number">30</span>] = <span class="built_in">chr</span>((<span class="built_in">ord</span>(lists[<span class="number">31</span>]) + <span class="built_in">ord</span>(lists[<span class="number">9</span>]) - <span class="number">48</span>))</span><br><span class="line">lists[<span class="number">14</span>] = <span class="built_in">chr</span>((<span class="built_in">ord</span>(lists[<span class="number">27</span>]) + <span class="built_in">ord</span>(lists[<span class="number">28</span>]) - <span class="number">97</span>))</span><br><span class="line"></span><br><span class="line">string = <span class="string">&#x27;&#x27;</span>.join(lists)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(string[::-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<p>flag{“59acc538825054c7de4b26440c0999dd”}</p>
<h1 id="findit-apk逆向"><a href="#findit-apk逆向" class="headerlink" title="findit(apk逆向)"></a>findit(apk逆向)</h1><p>写在后面的话:</p>
<p>apk反汇编推荐用jadx-gui或GDAE</p>
<p>–正文–</p>
<p>好家伙，做一个安卓题目就新换一个工具，这次用的是安卓杀手，</p>
<img src="BUU-reverse/image-20220123180649811.png" alt="image-20220123180649811" style="zoom:80%;" />

<p>z1r0的博客里说，{ 的ascii码是123，十六进制是0x7b,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">texts = [<span class="number">0x70</span>,<span class="number">0x76</span>,<span class="number">0x6b</span>,<span class="number">0x71</span>,<span class="number">0x7b</span>,<span class="number">0x6d</span>,<span class="number">0x31</span>,<span class="number">0x36</span>,<span class="number">0x34</span>,<span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x35</span>,\</span><br><span class="line"><span class="number">0x32</span>,<span class="number">0x36</span>,<span class="number">0x32</span>,<span class="number">0x30</span>,<span class="number">0x33</span>,<span class="number">0x33</span>,<span class="number">0x6c</span>,<span class="number">0x34</span>,<span class="number">0x6d</span>,<span class="number">0x34</span>,<span class="number">0x39</span>,<span class="number">0x6c</span>,<span class="number">0x6e</span>,<span class="number">0x70</span>,<span class="number">0x37</span>,\</span><br><span class="line"><span class="number">0x70</span>,<span class="number">0x39</span>,<span class="number">0x6d</span>,<span class="number">0x6e</span>,<span class="number">0x6b</span>,<span class="number">0x32</span>,<span class="number">0x38</span>,<span class="number">0x6b</span>,<span class="number">0x37</span>,<span class="number">0x35</span>,<span class="number">0x7d</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> texts:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>pvkq{m164675262033l4m49lnp7p9mnk28k75}</p>
<p>说实话结果很像了，</p>
<p>然后就是凯撒加密，偏移量为10，解密之后就是：</p>
<p>flag{c164675262033b4c49bdf7f9cda28a75}</p>
<h1 id="pyre-的逆推"><a href="#pyre-的逆推" class="headerlink" title="pyre(%的逆推)"></a>pyre(%的逆推)</h1><p>在线反汇编pyr</p>
<p>然后分析一下代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;Welcome to Re World!&#x27;</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;Your input1 is your flag~&#x27;</span></span><br><span class="line">l = <span class="built_in">len</span>(input1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    num = ((input1[i] + i) % <span class="number">128</span> + <span class="number">128</span>) % <span class="number">128</span></span><br><span class="line">    code += num</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l - <span class="number">1</span>):</span><br><span class="line">    code[i] = code[i] ^ code[i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> code</span><br><span class="line">code = [</span><br><span class="line">    <span class="string">&#x27;\x1f&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x12&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x1d&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;(&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x06&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x14&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;,&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x1b&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;?&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;o&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;:&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;%&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x13&#x27;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最后输出的code已经给出了</p>
<p>首先是异或一下，从最后一个元素开始</p>
<p>for i in range(l-2,-1,-1),倒数第二个元素和最后一个元素异或，以此类推</p>
<p>然后就是关于%~~公式的逆向了</p>


<p>关于z1r0的分析，就是以上这样，反过来就是(input[i] - i)%128</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">code = [</span><br><span class="line">    <span class="string">&#x27;\x1f&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x12&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x1d&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;(&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x06&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x14&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;,&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x1b&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;?&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;o&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;:&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;%&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x13&#x27;</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">l = <span class="built_in">len</span>(code)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">2</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    code[i] = code[i] ^ code[i-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(code)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    flag = <span class="built_in">chr</span>((<span class="built_in">ord</span>(code[i]) - i) % <span class="number">128</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(code)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="ACTF新生赛2020-easyre-index的推导"><a href="#ACTF新生赛2020-easyre-index的推导" class="headerlink" title="[ACTF新生赛2020]easyre(index的推导)"></a>[ACTF新生赛2020]easyre(index的推导)</h1><p>参考链接：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mayfly-nymph/p/12664201.html">https://www.cnblogs.com/Mayfly-nymph/p/12664201.html</a></p>
<p>先是查壳，然后万能脱壳工具脱一下，然后放到ADI中看看</p>
<p>好家伙，7.5版本和7.0版本是打开是不一样的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="built_in">int</span> __cdecl main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line"> <span class="number">2</span> &#123;</span><br><span class="line"> <span class="number">3</span>   char v4; // [esp+12h] [ebp-2Eh]</span><br><span class="line"> <span class="number">4</span>   char v5; // [esp+13h] [ebp-2Dh]</span><br><span class="line"> <span class="number">5</span>   char v6; // [esp+14h] [ebp-2Ch]</span><br><span class="line"> <span class="number">6</span>   char v7; // [esp+15h] [ebp-2Bh]</span><br><span class="line"> <span class="number">7</span>   char v8; // [esp+16h] [ebp-2Ah]</span><br><span class="line"> <span class="number">8</span>   char v9; // [esp+17h] [ebp-29h]</span><br><span class="line"> <span class="number">9</span>   char v10; // [esp+18h] [ebp-28h]</span><br><span class="line"><span class="number">10</span>   char v11; // [esp+19h] [ebp-27h]</span><br><span class="line"><span class="number">11</span>   char v12; // [esp+1Ah] [ebp-26h]</span><br><span class="line"><span class="number">12</span>   char v13; // [esp+1Bh] [ebp-25h]</span><br><span class="line"><span class="number">13</span>   char v14; // [esp+1Ch] [ebp-24h]</span><br><span class="line"><span class="number">14</span>   char v15; // [esp+1Dh] [ebp-23h]</span><br><span class="line"><span class="number">15</span>   <span class="built_in">int</span> v16; // [esp+1Eh] [ebp-22h]</span><br><span class="line"><span class="number">16</span>   <span class="built_in">int</span> v17; // [esp+22h] [ebp-1Eh]</span><br><span class="line"><span class="number">17</span>   <span class="built_in">int</span> v18; // [esp+26h] [ebp-1Ah]</span><br><span class="line"><span class="number">18</span>   __int16 v19; // [esp+2Ah] [ebp-16h]</span><br><span class="line"><span class="number">19</span>   char v20; // [esp+2Ch] [ebp-14h]</span><br><span class="line"><span class="number">20</span>   char v21; // [esp+2Dh] [ebp-13h]</span><br><span class="line"><span class="number">21</span>   char v22; // [esp+2Eh] [ebp-12h]</span><br><span class="line"><span class="number">22</span>   <span class="built_in">int</span> v23; // [esp+2Fh] [ebp-11h]</span><br><span class="line"><span class="number">23</span>   <span class="built_in">int</span> v24; // [esp+33h] [ebp-Dh]</span><br><span class="line"><span class="number">24</span>   <span class="built_in">int</span> v25; // [esp+37h] [ebp-9h]</span><br><span class="line"><span class="number">25</span>   char v26; // [esp+3Bh] [ebp-5h]</span><br><span class="line"><span class="number">26</span>   <span class="built_in">int</span> i; // [esp+3Ch] [ebp-4h]</span><br><span class="line"><span class="number">27</span> </span><br><span class="line"><span class="number">28</span>   __main();</span><br><span class="line"><span class="number">29</span>   v4 = <span class="number">42</span>;</span><br><span class="line"><span class="number">30</span>   v5 = <span class="number">70</span>;</span><br><span class="line"><span class="number">31</span>   v6 = <span class="number">39</span>;</span><br><span class="line"><span class="number">32</span>   v7 = <span class="number">34</span>;</span><br><span class="line"><span class="number">33</span>   v8 = <span class="number">78</span>;</span><br><span class="line"><span class="number">34</span>   v9 = <span class="number">44</span>;</span><br><span class="line"><span class="number">35</span>   v10 = <span class="number">34</span>;</span><br><span class="line"><span class="number">36</span>   v11 = <span class="number">40</span>;</span><br><span class="line"><span class="number">37</span>   v12 = <span class="number">73</span>;</span><br><span class="line"><span class="number">38</span>   v13 = <span class="number">63</span>;</span><br><span class="line"><span class="number">39</span>   v14 = <span class="number">43</span>;</span><br><span class="line"><span class="number">40</span>   v15 = <span class="number">64</span>;</span><br><span class="line"><span class="number">41</span>   printf(<span class="string">&quot;Please input:&quot;</span>);</span><br><span class="line"><span class="number">42</span>   scanf(<span class="string">&quot;%s&quot;</span>, &amp;v19);</span><br><span class="line"><span class="number">43</span>   <span class="keyword">if</span> ( (_BYTE)v19 != <span class="number">65</span> || HIBYTE(v19) != <span class="number">67</span> || v20 != <span class="number">84</span> || v21 != <span class="number">70</span> || v22 != <span class="number">123</span> || v26 != <span class="number">125</span> )</span><br><span class="line"><span class="number">44</span>     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">45</span>   v16 = v23;</span><br><span class="line"><span class="number">46</span>   v17 = v24;</span><br><span class="line"><span class="number">47</span>   v18 = v25;</span><br><span class="line"><span class="number">48</span>   <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">11</span>; ++i )</span><br><span class="line"><span class="number">49</span>   &#123;</span><br><span class="line"><span class="number">50</span>     <span class="keyword">if</span> ( *(&amp;v4 + i) != _data_ start__[*((char *)&amp;v16 + i) - <span class="number">1</span>] )</span><br><span class="line"><span class="number">51</span>       <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">52</span>   &#125;</span><br><span class="line"><span class="number">53</span>   printf(<span class="string">&quot;You are correct!&quot;</span>);</span><br><span class="line"><span class="number">54</span>   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">55</span> &#125;</span><br></pre></td></tr></table></figure>

<p>这多清晰。。。</p>
<p>感谢z1r0的指导！</p>


<p>所以第50行相当于，v4[i] ！&#x3D; byte_402000[v16[i] - 1]</p>


<p>以下是python脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&#x27;~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(\&#x27;&amp;%$# !&quot;&#x27;</span> <span class="comment">#&#x27;一定要加\</span></span><br><span class="line"></span><br><span class="line">encrypt = [<span class="number">42</span>,<span class="number">70</span>,<span class="number">39</span>,<span class="number">34</span>,<span class="number">78</span>,<span class="number">44</span>,<span class="number">34</span>,<span class="number">40</span>,<span class="number">73</span>,<span class="number">63</span>,<span class="number">43</span>,<span class="number">64</span>]</span><br><span class="line"></span><br><span class="line">x = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encrypt)):</span><br><span class="line"></span><br><span class="line">    m = key.find(<span class="built_in">chr</span>(encrypt[i]))+<span class="number">1</span></span><br><span class="line">    x.append(<span class="built_in">chr</span>(m))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">    <span class="built_in">print</span>(x[i],end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>仔细想了一下，用公式推一下就好理解了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">v4[i] == key [v16[i] - <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">key.find(v4[i]) == v16[i] - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">v16[i] == key.find(v4[i]) +<span class="number">1</span></span><br></pre></td></tr></table></figure>



<p>v16这个数组就相当于是flag,我们需要做的就是逆着推一下。</p>
<p>flag{U9X_1S_W6@T?}</p>
<h1 id="rsa-非对称解密"><a href="#rsa-非对称解密" class="headerlink" title="rsa (非对称解密)"></a>rsa (非对称解密)</h1><p>非常6+1的重要！！</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ao52426055/article/details/110221943">https://blog.csdn.net/ao52426055/article/details/110221943</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/kevin66654/article/details/54087647">https://blog.csdn.net/kevin66654/article/details/54087647</a></p>
<p>首先直接把两个文件的后缀改成.txt的</p>


<p>可以看到pub是个公钥解析，我们放到随便一个RSA公钥分解的网站中分解，解除模数和指数</p>
<table>
<thead>
<tr>
<th>key长度：</th>
<th>256</th>
</tr>
</thead>
<tbody><tr>
<td>模数N：</td>
<td>8693448229604811919066606200349480058890565601720302561721665405 8378322103517</td>
</tr>
<tr>
<td>指数e：</td>
<td>65537 (0x10001)</td>
</tr>
</tbody></table>
<p>然后分解N</p>
<p><a target="_blank" rel="noopener" href="http://factordb.com/index.php?query=8693448229604811919066606200349480058890565601720302561721665405%208378322103517">http://factordb.com/index.php?query=8693448229604811919066606200349480058890565601720302561721665405%208378322103517</a></p>
<p>P：285960468890451637935629440372639283459</p>
<p>q:   304008741604601924494328155975272418463</p>
<p>得知p、q、r、e之后，直接用rsatool2解出d</p>
<p>81176168860169991027846870170527607562179635470395365333547868786951080991441</p>
<img src="BUU-reverse/image-20220125224708543.png" alt="image-20220125224708543" style="zoom:80%;" />

<p>算出来之后</p>
<p>通过这五个值，e、n、p、q、d来计算最后的值</p>
<p>记得要安装一下rsa库</p>
<p>dos直接键入： pip3 install rsa</p>
<p>上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">n= <span class="number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span></span><br><span class="line">p= <span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">q= <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line">d= <span class="number">81176168860169991027846870170527607562179635470395365333547868786951080991441</span></span><br><span class="line"></span><br><span class="line">key = rsa.PrivateKey(n,e,d,q,p)         <span class="comment">#在pkcs标准中,pkcs#1规定,私钥包含(n,e,d,p,q)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;E:\\A_Oasis\\逆向工程文件\\Reverse题目\\rsa\\output\\flagenc.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:  <span class="comment">#以二进制读模式，读取密文</span></span><br><span class="line">    f = f.read()</span><br><span class="line">    <span class="built_in">print</span>(rsa.decrypt(f,key))           <span class="comment"># f:公钥加密结果  key:私钥</span></span><br></pre></td></tr></table></figure>

<p>b’flag{decrypt_256}\n’</p>
<h1 id="ACTF新生赛2020-rome-ASCII暴力破解"><a href="#ACTF新生赛2020-rome-ASCII暴力破解" class="headerlink" title="[ACTF新生赛2020]rome(ASCII暴力破解)"></a>[ACTF新生赛2020]rome(ASCII暴力破解)</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> func()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> result; // eax</span><br><span class="line">  <span class="built_in">int</span> v1[<span class="number">4</span>]; // [esp+14h] [ebp-44h]</span><br><span class="line">  unsigned __int8 v2; // [esp+24h] [ebp-34h] BYREF</span><br><span class="line">  unsigned __int8 v3; // [esp+25h] [ebp-33h]</span><br><span class="line">  unsigned __int8 v4; // [esp+26h] [ebp-32h]</span><br><span class="line">  unsigned __int8 v5; // [esp+27h] [ebp-31h]</span><br><span class="line">  unsigned __int8 v6; // [esp+28h] [ebp-30h]</span><br><span class="line">  <span class="built_in">int</span> v7; // [esp+29h] [ebp-2Fh]</span><br><span class="line">  <span class="built_in">int</span> v8; // [esp+2Dh] [ebp-2Bh]</span><br><span class="line">  <span class="built_in">int</span> v9; // [esp+31h] [ebp-27h]</span><br><span class="line">  <span class="built_in">int</span> v10; // [esp+35h] [ebp-23h]</span><br><span class="line">  unsigned __int8 v11; // [esp+39h] [ebp-1Fh]</span><br><span class="line">  char v12[<span class="number">29</span>]; // [esp+3Bh] [ebp-1Dh] BYREF</span><br><span class="line"></span><br><span class="line">  strcpy(v12, <span class="string">&quot;Qsw3sj_lz4_Ujw@l&quot;</span>);</span><br><span class="line">  printf(<span class="string">&quot;Please input:&quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%s&quot;</span>, &amp;v2);</span><br><span class="line">  result = v2;</span><br><span class="line">  <span class="keyword">if</span> ( v2 == <span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = v3;</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="string">&#x27;C&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      result = v4;</span><br><span class="line">      <span class="keyword">if</span> ( v4 == <span class="string">&#x27;T&#x27;</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        result = v5;</span><br><span class="line">        <span class="keyword">if</span> ( v5 == <span class="string">&#x27;F&#x27;</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          result = v6;</span><br><span class="line">          <span class="keyword">if</span> ( v6 == <span class="string">&#x27;&#123;&#x27;</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            result = v11;</span><br><span class="line">            <span class="keyword">if</span> ( v11 == <span class="string">&#x27;&#125;&#x27;</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              v1[<span class="number">0</span>] = v7;</span><br><span class="line">              v1[<span class="number">1</span>] = v8;</span><br><span class="line">              v1[<span class="number">2</span>] = v9;</span><br><span class="line">              v1[<span class="number">3</span>] = v10;</span><br><span class="line">              *&amp;v12[<span class="number">17</span>] = <span class="number">0</span>;</span><br><span class="line">              <span class="keyword">while</span> ( *&amp;v12[<span class="number">17</span>] &lt;= <span class="number">15</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">if</span> ( *(v1 + *&amp;v12[<span class="number">17</span>]) &gt; <span class="number">64</span> &amp;&amp; *(v1 + *&amp;v12[<span class="number">17</span>]) &lt;= <span class="number">90</span> )</span><br><span class="line">                  *(v1 + *&amp;v12[<span class="number">17</span>]) = (*(v1 + *&amp;v12[<span class="number">17</span>]) - <span class="number">51</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">                <span class="keyword">if</span> ( *(v1 + *&amp;v12[<span class="number">17</span>]) &gt; <span class="number">96</span> &amp;&amp; *(v1 + *&amp;v12[<span class="number">17</span>]) &lt;= <span class="number">122</span> )</span><br><span class="line">                  *(v1 + *&amp;v12[<span class="number">17</span>]) = (*(v1 + *&amp;v12[<span class="number">17</span>]) - <span class="number">79</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">                ++*&amp;v12[<span class="number">17</span>];</span><br><span class="line">              &#125;</span><br><span class="line">              *&amp;v12[<span class="number">17</span>] = <span class="number">0</span>;</span><br><span class="line">              <span class="keyword">while</span> ( *&amp;v12[<span class="number">17</span>] &lt;= <span class="number">15</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                result = v12[*&amp;v12[<span class="number">17</span>]];</span><br><span class="line">                <span class="keyword">if</span> ( *(v1 + *&amp;v12[<span class="number">17</span>]) != result )</span><br><span class="line">                  <span class="keyword">return</span> result;</span><br><span class="line">                ++*&amp;v12[<span class="number">17</span>];</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">return</span> printf(<span class="string">&quot;You are correct!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在检查没有壳之后，直接IDA打开，然后进入这个函数，其实就是输入一段字符之后，进行一系列的转换，根据z1r0的知乎得知，可以运用暴力破解（太棒了）！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&#x27;Qsw3sj_lz4_Ujw@l&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(string)):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line"></span><br><span class="line">        k = j</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> j &gt; <span class="number">64</span> <span class="keyword">and</span> j &lt;= <span class="number">90</span>:</span><br><span class="line">            j = (j - <span class="number">51</span>) % <span class="number">26</span> + <span class="number">65</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">if</span> j &gt; <span class="number">96</span> <span class="keyword">and</span> j &lt;= <span class="number">122</span>:</span><br><span class="line">            j = (j - <span class="number">79</span>) % <span class="number">26</span> + <span class="number">97</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> j == <span class="built_in">ord</span>(string[i]):</span><br><span class="line"></span><br><span class="line">            flag += <span class="built_in">chr</span>(k)</span><br><span class="line">            </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>字符已经给出</p>
<p>循环这个这个字符串，用变量k来保存j的值，j来循环ASCII码，如果j经过转换之后，与对应的string相等，那就是flag了。</p>
<h1 id="CrackRTF1-散列算法-Win32API-文件头"><a href="#CrackRTF1-散列算法-Win32API-文件头" class="headerlink" title="CrackRTF1 (散列算法+Win32API+文件头)"></a>CrackRTF1 (散列算法+Win32API+文件头)</h1><p>这题对于我这种re新手，确实属于难度的天花板了……</p>
<p>首先是查壳，发现没有壳。</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main_0(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  DWORD v3; // eax</span><br><span class="line">  DWORD v4; // eax</span><br><span class="line">  char Str[<span class="number">260</span>]; // [esp+4Ch] [ebp-<span class="number">3</span>10h] BYREF</span><br><span class="line">  <span class="built_in">int</span> v7; // [esp+150h] [ebp-20Ch]</span><br><span class="line">  char String1[<span class="number">260</span>]; // [esp+154h] [ebp-208h] BYREF</span><br><span class="line">  char Destination[<span class="number">260</span>]; // [esp+258h] [ebp-104h] BYREF</span><br><span class="line"></span><br><span class="line">  memset(Destination, <span class="number">0</span>, sizeof(Destination));</span><br><span class="line">  memset(String1, <span class="number">0</span>, sizeof(String1));</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  printf(<span class="string">&quot;pls input the first passwd(1): &quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%s&quot;</span>, Destination);</span><br><span class="line">  <span class="keyword">if</span> ( strlen(Destination) != <span class="number">6</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;Must be 6 characters!\n&quot;</span>);</span><br><span class="line">    ExitProcess(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v7 = atoi(Destination);</span><br><span class="line">  <span class="keyword">if</span> ( v7 &lt; <span class="number">100000</span> )</span><br><span class="line">    ExitProcess(<span class="number">0</span>);</span><br><span class="line">  strcat(Destination, <span class="string">&quot;@DBApp&quot;</span>);</span><br><span class="line">  v3 = strlen(Destination);</span><br><span class="line">  sub_40100A((BYTE *)Destination, v3, String1);</span><br><span class="line">  <span class="keyword">if</span> ( !_strcmpi(String1, <span class="string">&quot;6E32D0943418C2C33385BC35A1470250DD8923A9&quot;</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;continue...\n\n&quot;</span>);</span><br><span class="line">    printf(<span class="string">&quot;pls input the first passwd(2): &quot;</span>);</span><br><span class="line">    memset(Str, <span class="number">0</span>, sizeof(Str));</span><br><span class="line">    scanf(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">    <span class="keyword">if</span> ( strlen(Str) != <span class="number">6</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      printf(<span class="string">&quot;Must be 6 characters!\n&quot;</span>);</span><br><span class="line">      ExitProcess(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    strcat(Str, Destination);</span><br><span class="line">    memset(String1, <span class="number">0</span>, sizeof(String1));</span><br><span class="line">    v4 = strlen(Str);</span><br><span class="line">    sub_401019((BYTE *)Str, v4, String1);</span><br><span class="line">    <span class="keyword">if</span> ( !_strcmpi(<span class="string">&quot;27019e688a4e62a649fd99cadaafdb4e&quot;</span>, String1) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(unsigned __int8)sub_40100F(Str) )</span><br><span class="line">      &#123;</span><br><span class="line">        printf(<span class="string">&quot;Error!!\n&quot;</span>);</span><br><span class="line">        ExitProcess(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      printf(<span class="string">&quot;bye ~~\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>又触碰盲区了，再参考一下大佬z1r0的博客：</p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/people/xu-xu-xuxu-94">https://www.zhihu.com/people/xu-xu-xuxu-94</a></p>
<p>这边先是输入第一个password,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scanf(<span class="string">&quot;%s&quot;</span>, Destination);</span><br></pre></td></tr></table></figure>

<p>然后就要当心了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v7 = atoi(Destination);</span><br></pre></td></tr></table></figure>

<p>根据z1r0所说，atoi在pawnh中很常见，用于将字符串转换为整形</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v7 &lt; <span class="number">100000</span> )</span><br></pre></td></tr></table></figure>

<p>所以我们确定了第一个password的位数是6位，并且不小于100000</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strcat(Destination, <span class="string">&quot;@DBApp&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>然后是与“@DBApp”连接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strcat(Destination, <span class="string">&quot;@DBApp&quot;</span>);</span><br></pre></td></tr></table></figure>





<p>进入了一个奇奇怪怪的函数，不要害怕</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( CryptCreateHash(phProv, 0x8004u, <span class="number">0</span>, <span class="number">0</span>, &amp;phHash) )</span><br></pre></td></tr></table></figure>





<p>直接进大本营干这个函数，第二个参数是属于加密的类型，跟进去看</p>


<p>发现，08004是sha1哈希算法，就把main函数的里面的改成sha1(改名很重要)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sha1(Destination, v3, String1);</span><br></pre></td></tr></table></figure>

<p>v3是长度，String1就是加密之后的数值了，然后与”6E32D0943418C2C33385BC35A1470250DD8923A9”作比较，python里面需要小写才行</p>
<p>然后就是编写算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment">#大写转小写</span></span><br><span class="line">string = <span class="string">&quot;6E32D0943418C2C33385BC35A1470250DD8923A9&quot;</span>.lower()</span><br><span class="line"></span><br><span class="line">a = <span class="string">&#x27;@DBApp&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>,<span class="number">999999</span>):</span><br><span class="line"></span><br><span class="line">    data = <span class="built_in">str</span>(i) + a</span><br><span class="line"></span><br><span class="line">    sha1 = hashlib.sha1(data.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"></span><br><span class="line">    flags = sha1.hexdigest()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> flags == string:</span><br><span class="line">        <span class="built_in">print</span>(data)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;done&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>解出来之后就是123321@DBApp</p>
<p>在往下看，输入第二个密码，既然知道是第二个密码了，就提前把str改成second_password</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">printf(<span class="string">&quot;pls input the first passwd(2): &quot;</span>);</span><br><span class="line">memset(second_password, <span class="number">0</span>, sizeof(Str));</span><br><span class="line">scanf(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line"><span class="keyword">if</span> ( strlen(Str) != <span class="number">6</span> )</span><br></pre></td></tr></table></figure>

<p>长度也是6位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strcat(second_password, Destination);</span><br></pre></td></tr></table></figure>

<p>把第一个密码的值加到第二个密码后面</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_401019(second_password, v4, String1);</span><br></pre></td></tr></table></figure>



<p>又进入了一个奇奇怪怪的函数，和上面一个差不多，加密之后与”27019e688a4e62a649fd99cadaafdb4e”进行比较</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( CryptCreateHash(phProv, 0x8003u, <span class="number">0</span>, <span class="number">0</span>, &amp;phHash) )</span><br></pre></td></tr></table></figure>

<p>这边的编码参数是0x8003，这个是MD5的哈希算法，看似可以直接暴力，但是，题目中并没有像第一个password一样，告诉我们类型以及范围，如果要暴力，就需要把ASCII全部循环一遍，所以还是想想别的办法。</p>






<p>发现这边还有函数，参数还是第二个密码</p>


<p>进去直接好家伙，一堆win32的API，在官网上面找找到底是什么意思。</p>
<p>官方API链接：<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/api/">https://docs.microsoft.com/en-us/windows/win32/api/</a></p>
<p>先是FindResourceA 函数，粗略的看一遍之后，说的第一个参数是啥啥句柄，第二个参数是资源名称，第三个是资源类型，返回的是指定信息块的句柄</p>
<img src="BUU-reverse/image-20220125181458404.png" alt="image-20220125181458404" style="zoom:80%;" />

<p>再看SizeofResource,返回值为资源中的字节数</p>
<img src="BUU-reverse/image-20220125200409894.png" alt="image-20220125200409894" style="zoom:80%;" />



<p>同样的，LoadResource，没见过，最好都看看</p>
<img src="BUU-reverse/image-20220126133723911.png" alt="image-20220126133723911" style="zoom:80%;" />

<p>返回值为资源关联的数据的句柄。</p>
<p>再看LockResource</p>


<p>返回值为指向资源第一个字节的指针</p>
<p>createFileA,用来创建，或者打开文件</p>




<p>最重要的来了，关于WriteFileA的</p>




<p>还有它的形参：</p>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_401005(lpString, lpBuffer, nNumberOfBytesToWrite);</span><br></pre></td></tr></table></figure>

<p>这个函数把我们的总password放入第一个形参，lpBuffer是一个指针，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">v5 = lstrlenA(lpString);</span><br><span class="line"> <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line"> &#123;</span><br><span class="line">   result = i;</span><br><span class="line">   <span class="keyword">if</span> ( i &gt;= a3 )</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">   *(i + a2) ^= lpString[i % v5];</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> result;</span><br></pre></td></tr></table></figure>

<p>现在就是这关键的地方了</p>
<p>a2也就是我们的lpBuffer,经过异或之后，成为我们需要生成文件，即rtf的头，才能传入下面WriteFile中，根据z1r0的博客所说，rtf的头一般为{\rtf1\ansi，</p>
<p>而AAA这个文件我们可以用Resource Hacker打开，只要查看开头6个就行了</p>
<p>然后就是匹配算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rtf = <span class="string">&#x27;&#123;\\rtf1&#x27;</span></span><br><span class="line"></span><br><span class="line">AAA = [<span class="number">0x05</span>,<span class="number">0x7D</span>,<span class="number">0x41</span>,<span class="number">0x15</span>,<span class="number">0x26</span>,<span class="number">0x01</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(rtf)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(rtf[i]) ^ AAA[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>结果为：~!3a@0</p>
<p>程序的意思是输入第二个密码之后，生成一个rtf文件,最后输出的rtf中，就是最终的答案</p>
<img src="BUU-reverse/image-20220125215455097.png" alt="image-20220125215455097" style="zoom:150%;" />

<p>如你所见，flag{N0_M0re_Free_Bugs}</p>
<h1 id="login-JS逆向-x2F-凯撒"><a href="#login-JS逆向-x2F-凯撒" class="headerlink" title="login (JS逆向&#x2F;凯撒)"></a>login (JS逆向&#x2F;凯撒)</h1><p>第一次做网页的逆向题目，有点激动，F12进入源代码查看</p>






<p>哪里不会搜哪里，返回一个element对象？？</p>




<p>好吧，只是键入最基本的按钮值而已</p>




<p>主要是下面的rotFlag</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;prompt&quot;</span>).<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> flag = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;flag&quot;</span>).<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> rotFlag = flag.<span class="title function_">replace</span>(<span class="regexp">/[a-zA-Z]/g</span>, <span class="keyword">function</span>(<span class="params">c</span>)&#123;<span class="keyword">return</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>((c &lt;= <span class="string">&quot;Z&quot;</span> ? <span class="number">90</span> : <span class="number">122</span>) &gt;= (c = c.<span class="title function_">charCodeAt</span>(<span class="number">0</span>) + <span class="number">13</span>) ? c : c - <span class="number">26</span>);&#125;);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (<span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span> == rotFlag) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">alert</span>(<span class="string">&quot;Correct flag!&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">alert</span>(<span class="string">&quot;Incorrect flag, rot again&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>







<p>charCodeAt(),返回第一个位置的Unicode编码，</p>




<p>再看看replace()方法，如果找到第一个参数的字符串，就被第二个参数替换</p>




<p>fromCharCode()相当于python里面的chr()</p>




<p>参考链接：<a target="_blank" rel="noopener" href="https://www.zhihu.com/people/xu-xu-xuxu-94">https://www.zhihu.com/people/xu-xu-xuxu-94</a></p>
<p>后面不太懂了，根据z1r0的知乎中写到，flag.replace(&#x2F;[a-zA-Z]&#x2F;g，function(c){XXX})，是让flag中的a-z,A-Z字符，被后面的function(c)所替换。</p>
<p>后面的算法就是rot13算法了：</p>








<p>flag{<a href="mailto:&#x43;&#x6c;&#105;&#101;&#110;&#116;&#x53;&#105;&#100;&#x65;&#x4c;&#x6f;&#103;&#x69;&#110;&#115;&#65;&#114;&#101;&#69;&#97;&#115;&#x79;&#64;&#x66;&#x6c;&#x61;&#x72;&#x65;&#x2d;&#111;&#110;&#x2e;&#99;&#x6f;&#x6d;">&#x43;&#x6c;&#105;&#101;&#110;&#116;&#x53;&#105;&#100;&#x65;&#x4c;&#x6f;&#103;&#x69;&#110;&#115;&#65;&#114;&#101;&#69;&#97;&#115;&#x79;&#64;&#x66;&#x6c;&#x61;&#x72;&#x65;&#x2d;&#111;&#110;&#x2e;&#99;&#x6f;&#x6d;</a>}</p>
<p>我还看了半天……</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/BUU-reverse/">BUU-reverse</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2022/01/22/test/readme/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">test for my first blog</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/ke1os.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">ke1os</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">10</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#HDCTF-MFC-Win%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81-DES%E5%8A%A0%E5%AF%86"><span class="toc-number">1.</span> <span class="toc-text">[HDCTF] MFC (Win消息发送+DES加密)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CISCN2018-2ex-base64%E6%8D%A2%E8%A1%A8"><span class="toc-number">2.</span> <span class="toc-text">[CISCN2018]2ex (base64换表)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-crackMe-SM4-base64%E9%AD%94%E6%94%B9-hook"><span class="toc-number">3.</span> <span class="toc-text">[安洵杯 2019]crackMe (SM4+base64魔改+hook)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-level4-idc-or-%E7%AE%97%E6%B3%95"><span class="toc-number">4.</span> <span class="toc-text">[WUSTCTF2020]level4 (idc or 算法)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A"><span class="toc-number">4.1.</span> <span class="toc-text">方法一：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A"><span class="toc-number">4.2.</span> <span class="toc-text">方法二：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%89%EF%BC%9A"><span class="toc-number">4.3.</span> <span class="toc-text">方法三：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CFI-CTF-2018-IntroToPE-NET%E9%80%86%E5%90%91"><span class="toc-number">5.</span> <span class="toc-text">[CFI-CTF 2018]IntroToPE (.NET逆向)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GXYCTF2019-simple-CPP-z3-%E5%8F%8D%E8%B0%83%E8%AF%95-%E5%8A%A8%E8%B0%83"><span class="toc-number">6.</span> <span class="toc-text">[GXYCTF2019]simple CPP (z3+反调试+动调)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FlareOn1-Bob-Doge-%EF%BC%88-net%E9%80%86%E5%90%91-dnspy%E9%80%86%E5%90%91%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">[FlareOn1]Bob Doge （.net逆向+dnspy逆向）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SWPU2019-ReverseMe-%EF%BC%88od%E5%8A%A8%E8%B0%83plus%EF%BC%89"><span class="toc-number">8.</span> <span class="toc-text">[SWPU2019]ReverseMe （od动调plus）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SCTF2019-babyre-%E8%8A%B1%E6%8C%87%E4%BB%A4-%E4%B8%89%E7%BB%B4%E8%BF%B7%E5%AE%AB-%E6%9A%97%E8%97%8Fbase64-%EF%BC%9F%EF%BC%9F%EF%BC%9F"><span class="toc-number">9.</span> <span class="toc-text">[SCTF2019]babyre (花指令+三维迷宫+暗藏base64+？？？)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Ecquation-js-fuck%E5%8A%A0%E5%AF%86-z3"><span class="toc-number">10.</span> <span class="toc-text">Ecquation (js fuck加密+z3)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BUUCTF%E2%80%93-V-amp-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B-CSRe"><span class="toc-number">11.</span> <span class="toc-text">BUUCTF–[V&amp;N2020 公开赛]CSRe</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-SoulLike-elf%E6%9A%B4%E5%8A%9B-x2F-pwntools"><span class="toc-number">12.</span> <span class="toc-text">[ACTF新生赛2020]SoulLike (elf暴力&#x2F;pwntools)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-easyre-%EF%BC%88base64-x2F-%E5%87%AF%E6%92%92%EF%BC%89"><span class="toc-number">13.</span> <span class="toc-text">[羊城杯 2020]easyre （base64&#x2F;凯撒）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#findKey-%E8%8A%B1%E6%8C%87%E4%BB%A4-%E6%AD%A3%E9%80%86%E5%90%91-MD5"><span class="toc-number">14.</span> <span class="toc-text">findKey (花指令+正逆向+MD5)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GUET-CTF2019-number-game-%E5%8A%A8%E8%B0%83-x2F-%E4%BA%8C%E5%8F%89%E6%A0%91"><span class="toc-number">15.</span> <span class="toc-text">[GUET-CTF2019]number_game (动调&#x2F;二叉树)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#firmware-%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91-x2F-binwalk"><span class="toc-number">16.</span> <span class="toc-text">firmware (路由器逆向&#x2F;binwalk)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WMCTF2020-easy-re-perl%E7%89%B9%E6%80%A7"><span class="toc-number">17.</span> <span class="toc-text">[WMCTF2020]easy_re (perl特性)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crackMe-od%E5%8A%A8%E8%B0%83"><span class="toc-number">18.</span> <span class="toc-text">crackMe (od动调)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E7%9A%84base64-base64%E6%8D%A2%E8%A1%A8"><span class="toc-number">19.</span> <span class="toc-text">特殊的base64 (base64换表)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-singal-vm%E9%A2%98-x2F-ponce%E6%8F%92%E4%BB%B6"><span class="toc-number">20.</span> <span class="toc-text">[网鼎杯 2020 青龙组]singal (vm题&#x2F;ponce插件)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GWCTF-2019-xxor-%EF%BC%88xor-plus%EF%BC%89"><span class="toc-number">21.</span> <span class="toc-text">[GWCTF 2019]xxor （xor plus）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-level4%EF%BC%88%E4%BA%8C%E5%8F%89%E6%A0%91%E9%81%8D%E5%8E%86%EF%BC%89"><span class="toc-number">22.</span> <span class="toc-text">[WUSTCTF2020]level4（二叉树遍历）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-Universe-final-answer-z3%E8%AE%A1%E7%AE%97"><span class="toc-number">23.</span> <span class="toc-text">[ACTF新生赛2020]Universe_final_answer (z3计算)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#UTCTF2020-basic-re-%E6%B0%B4%E9%A2%98"><span class="toc-number">24.</span> <span class="toc-text">[UTCTF2020]basic-re (水题)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Zer0pts2020-easy-strcmp-binascii-%E5%87%BD%E6%95%B0%E5%8F%98%E5%9D%80"><span class="toc-number">25.</span> <span class="toc-text">[Zer0pts2020]easy strcmp (binascii+函数变址)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FlareOn3-Challenge1-base64%E6%8D%A2%E8%A1%A8"><span class="toc-number">26.</span> <span class="toc-text">[FlareOn3]Challenge1 (base64换表)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-Oruga%EF%BC%88%E8%BF%B7%E5%AE%ABplus%EF%BC%89"><span class="toc-number">27.</span> <span class="toc-text">[ACTF新生赛2020]Oruga（迷宫plus）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BJDCTF2020-BJD-hamburger-competition%EF%BC%88unity%E9%80%86%E5%90%91-sha1-mod5%EF%BC%89"><span class="toc-number">28.</span> <span class="toc-text">[BJDCTF2020]BJD hamburger competition（unity逆向+sha1+mod5）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-Cr0ssfun-%E6%B0%B4%E9%A2%98"><span class="toc-number">29.</span> <span class="toc-text">[WUSTCTF2020]Cr0ssfun(水题)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FlareOn6-Overlong-od%E5%8A%A8%E8%B0%83"><span class="toc-number">30.</span> <span class="toc-text">[FlareOn6]Overlong(od动调)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GWCTF-2019-xxor-xor-plus"><span class="toc-number">31.</span> <span class="toc-text">[GWCTF 2019]xxor (xor plus++)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MRCTF2020-Xor"><span class="toc-number">32.</span> <span class="toc-text">[MRCTF2020]Xor</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MRCTF2020-hello-world-go"><span class="toc-number">33.</span> <span class="toc-text">[MRCTF2020]hello_world_go</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-level3-base64%E6%8D%A2%E8%A1%A8"><span class="toc-number">34.</span> <span class="toc-text">[WUSTCTF2020]level3(base64换表)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FlareOn4-IgniteMe"><span class="toc-number">35.</span> <span class="toc-text">[FlareOn4]IgniteMe()</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Youngter-drive-windows%E5%A4%9A%E7%BA%BF%E7%A8%8B-index%E9%80%86%E5%90%91"><span class="toc-number">36.</span> <span class="toc-text">Youngter-drive(windows多线程+index逆向)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-level2%EF%BC%88upx%E8%84%B1%E5%A3%B3%EF%BC%89"><span class="toc-number">37.</span> <span class="toc-text">[WUSTCTF2020]level2（upx脱壳）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%B8%E5%86%8C%EF%BC%88apk%E7%97%85%E6%AF%92-base64%EF%BC%89"><span class="toc-number">38.</span> <span class="toc-text">相册（apk病毒+base64）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HDCTF2019-Maze-easy-%E8%BF%B7%E5%AE%AB"><span class="toc-number">39.</span> <span class="toc-text">[HDCTF2019]Maze (easy 迷宫)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-level1"><span class="toc-number">40.</span> <span class="toc-text">[WUSTCTF2020]level1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MRCTF2020-Transform-index-%E9%80%86%E5%90%91"><span class="toc-number">41.</span> <span class="toc-text">[MRCTF2020]Transform(index 逆向)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-usualCrypt"><span class="toc-number">42.</span> <span class="toc-text">[ACTF新生赛2020]usualCrypt</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-easyRE%EF%BC%88-fini%EF%BC%89"><span class="toc-number">43.</span> <span class="toc-text">[2019红帽杯]easyRE（.fini）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GUET-CTF2019-re-%E6%9A%B4%E5%8A%9B-%E6%AC%A1%E5%BA%8F"><span class="toc-number">44.</span> <span class="toc-text">[GUET-CTF2019]re (暴力+次序)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SUCTF-2019-SignIn%EF%BC%88rsa-plus%EF%BC%89"><span class="toc-number">45.</span> <span class="toc-text">[SUCTF 2019] SignIn（rsa plus）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#xor-%E5%BC%82%E6%88%96"><span class="toc-number">46.</span> <span class="toc-text">xor (异或)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hello-word%EF%BC%88apk%E9%80%86%E5%90%91%EF%BC%89"><span class="toc-number">47.</span> <span class="toc-text">hello word（apk逆向）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#reverse-3-base64"><span class="toc-number">48.</span> <span class="toc-text">reverse_3 (base64)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Simple-Rev-ADI%E5%B0%8F%E7%AB%AF%E5%AD%98%E5%82%A8"><span class="toc-number">49.</span> <span class="toc-text">Simple_Rev (ADI小端存储)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GXYCTF2019-luck-guy-ADI%E5%B0%8F%E7%AB%AF%E5%AD%98%E5%82%A8"><span class="toc-number">50.</span> <span class="toc-text">[GXYCTF2019]luck_guy (ADI小端存储)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96-ASCII%E6%8E%92%E5%BA%8F-base64"><span class="toc-number">51.</span> <span class="toc-text">刮开有奖 (ASCII排序+base64)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BJDCTF2020-JustRE-%EF%BC%88%E6%B0%B4%E9%A2%98%EF%BC%89"><span class="toc-number">52.</span> <span class="toc-text">[BJDCTF2020]JustRE （水题）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%B3%A8%E5%86%8C%E5%99%A8-apk%E9%80%86%E5%90%91"><span class="toc-number">53.</span> <span class="toc-text">简单注册器(apk逆向)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#findit-apk%E9%80%86%E5%90%91"><span class="toc-number">54.</span> <span class="toc-text">findit(apk逆向)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pyre-%E7%9A%84%E9%80%86%E6%8E%A8"><span class="toc-number">55.</span> <span class="toc-text">pyre(%的逆推)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-easyre-index%E7%9A%84%E6%8E%A8%E5%AF%BC"><span class="toc-number">56.</span> <span class="toc-text">[ACTF新生赛2020]easyre(index的推导)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#rsa-%E9%9D%9E%E5%AF%B9%E7%A7%B0%E8%A7%A3%E5%AF%86"><span class="toc-number">57.</span> <span class="toc-text">rsa (非对称解密)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-rome-ASCII%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">58.</span> <span class="toc-text">[ACTF新生赛2020]rome(ASCII暴力破解)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CrackRTF1-%E6%95%A3%E5%88%97%E7%AE%97%E6%B3%95-Win32API-%E6%96%87%E4%BB%B6%E5%A4%B4"><span class="toc-number">59.</span> <span class="toc-text">CrackRTF1 (散列算法+Win32API+文件头)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#login-JS%E9%80%86%E5%90%91-x2F-%E5%87%AF%E6%92%92"><span class="toc-number">60.</span> <span class="toc-text">login (JS逆向&#x2F;凯撒)</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/03/01/%E7%AE%97%E6%B3%95/leetcode-%E6%AF%8F%E6%97%A5%E7%BB%83%E4%B9%A0/" title="leetcode_每日练习"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="leetcode_每日练习"/></a><div class="content"><a class="title" href="/2022/03/01/%E7%AE%97%E6%B3%95/leetcode-%E6%AF%8F%E6%97%A5%E7%BB%83%E4%B9%A0/" title="leetcode_每日练习">leetcode_每日练习</a><time datetime="2022-03-01T14:39:32.000Z" title="Created 2022-03-01 22:39:32">2022-03-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/01/BUU_crypto/BUU-crypto/" title="BUU-crypto"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUU-crypto"/></a><div class="content"><a class="title" href="/2022/03/01/BUU_crypto/BUU-crypto/" title="BUU-crypto">BUU-crypto</a><time datetime="2022-03-01T01:40:45.000Z" title="Created 2022-03-01 09:40:45">2022-03-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/21/ctfshow/ctfshow-web/" title="ctfshow-web"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ctfshow-web"/></a><div class="content"><a class="title" href="/2022/02/21/ctfshow/ctfshow-web/" title="ctfshow-web">ctfshow-web</a><time datetime="2022-02-21T09:31:29.000Z" title="Created 2022-02-21 17:31:29">2022-02-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/20/AttackWithDefense/AWD/" title="AWD"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AWD"/></a><div class="content"><a class="title" href="/2022/02/20/AttackWithDefense/AWD/" title="AWD">AWD</a><time datetime="2022-02-20T13:50:14.000Z" title="Created 2022-02-20 21:50:14">2022-02-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/16/CTF/2022-DefCamp-CTF/" title="2022_DefCamp_CTF"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022_DefCamp_CTF"/></a><div class="content"><a class="title" href="/2022/02/16/CTF/2022-DefCamp-CTF/" title="2022_DefCamp_CTF">2022_DefCamp_CTF</a><time datetime="2022-02-16T12:09:46.000Z" title="Created 2022-02-16 20:09:46">2022-02-16</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By ke1os</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>