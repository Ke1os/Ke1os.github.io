<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="ke1os"><title>2020_CISCN · ke1os' blog</title><meta name="description" content="复现一下2020CISCN


reversez3ida64打开之后，查看主函数


跟进byte_404020，以为就是前43个数据呢，后来构建z3的时候发现不对


动调了一下，发现最后对比的v47数组元素是2byte，word类型




上脚本
12345678910111213141516"><meta name="keywords" content="Blog,博客,Hexo"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="shortcut icon" type="image/x-icon" href="/images/ke1os.png"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/insight.css"><link rel="stylesheet" href="/css/search.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="/js/jquery.js"></script><meta name="generator" content="Hexo 6.1.0"></head><body><div class="page-top animated fadeInDown"><div class="nav"><li> <a href="/">Home</a></li><li> <a href="/archives">Archives</a></li><li> <a href="/tags">Tags</a></li></div><div class="information"><div class="nav_right_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li><li><a class="fa fa-search" onclick="openWindow();"></a></li></div><div class="avatar"><img src="/images/ke1os.png"></div></div></div><div class="sidebar animated fadeInDown"><div class="sidebar-top"><div class="logo-title"><div class="title"><img src="/images/ke1os.png" style="width:220px;" alt="favicon"><h3 title=""><a href="/">ke1os' blog</a></h3><div class="description"><p>“每一个不曾起舞的日子,都是对生命的辜负。”</p></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="https://github.com/ke1os"><i class="fa fa-github"></i></a></li><li><a href="mailto:3131697620@qq.com"><i class="fa fa-envelope"></i></a></li><li><a target="_blank" rel="noopener" href="http://sighttp.qq.com/authd?IDKEY=3131697620"><i class="fa fa-qq"></i></a></li></ul></div></div><div class="footer"><div class="p"> <span> 全站CC-BY-SA-3.0 </span><i class="fa fa-star"></i><span> ke1os</span></div><div class="by_farbox"><span>Powered by </span><a href="https://hexo.io/zh-cn/" target="_blank">Hexo </a><span> & </span><span>Anatolo </span></div><div class="beian"></div></div></div><div class="main"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>2020_CISCN</a></h3></div><div class="post-content"><p><p>复现一下2020CISCN</p>
<span id="more"></span>

<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="z3"><a href="#z3" class="headerlink" title="z3"></a>z3</h2><p>ida64打开之后，查看主函数</p>
<img src="/2022/04/08/CTF/2020-CISCN/image-20220408100133925.png" class="" title="image-20220408100133925">

<p>跟进byte_404020，以为就是前43个数据呢，后来构建z3的时候发现不对</p>
<img src="/2022/04/08/CTF/2020-CISCN/image-20220408100247776.png" class="" title="image-20220408100247776">

<p>动调了一下，发现最后对比的v47数组元素是2byte，word类型</p>
<img src="/2022/04/08/CTF/2020-CISCN/image-20220408100500172.png" class="" title="image-20220408100500172">

<img src="/2022/04/08/CTF/2020-CISCN/image-20220408093301513.png" class="" title="image-20220408093301513">

<p>上脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># lis ==\</span></span><br><span class="line"><span class="comment"># [\</span></span><br><span class="line"><span class="comment">#   0x17, 0x4F, 0x00, 0x00, 0xF6, 0x9C, 0x00, 0x00, 0xDB, 0x8D, \</span></span><br><span class="line"><span class="comment">#   0x00, 0x00, 0xA6, 0x8E, 0x00, 0x00, 0x29, 0x69, 0x00, 0x00, \</span></span><br><span class="line"><span class="comment">#   0x11, 0x99, 0x00, 0x00, 0xA2, 0x40, 0x00, 0x00, 0x3E, 0x2F, \</span></span><br><span class="line"><span class="comment">#   0x00, 0x00, 0xB6, 0x62, 0x00, 0x00, 0x82, 0x4B, 0x00, 0x00, \</span></span><br><span class="line"><span class="comment">#   0x6C, 0x48, 0x00, 0x00, 0x02, 0x40, 0x00, 0x00, 0xD7, 0x52, \</span></span><br><span class="line"><span class="comment">#   0x00, 0x00, 0xEF, 0x2D, 0x00, 0x00, 0xDC, 0x28, 0x00, 0x00, \</span></span><br><span class="line"><span class="comment">#   0x0D, 0x64, 0x00, 0x00, 0x8F, 0x52, 0x00, 0x00, 0x3B, 0x61, \</span></span><br><span class="line"><span class="comment">#   0x00, 0x00, 0x81, 0x47, 0x00, 0x00, 0x17, 0x6B, 0x00, 0x00, \</span></span><br><span class="line"><span class="comment">#   0x37, 0x32, 0x00, 0x00, 0x93, 0x2A, 0x00, 0x00, 0x5F, 0x61, \</span></span><br><span class="line"><span class="comment">#   0x00, 0x00, 0xBE, 0x50, 0x00, 0x00, 0x8E, 0x59, 0x00, 0x00, \</span></span><br><span class="line"><span class="comment">#   0x56, 0x46, 0x00, 0x00, 0x31, 0x5B, 0x00, 0x00, 0x3A, 0x31, \</span></span><br><span class="line"><span class="comment">#   0x00, 0x00, 0x10, 0x30, 0x00, 0x00, 0xFE, 0x67, 0x00, 0x00, \</span></span><br><span class="line"><span class="comment">#   0x5F, 0x4D, 0x00, 0x00, 0xDB, 0x58, 0x00, 0x00, 0x99, 0x37, \</span></span><br><span class="line"><span class="comment">#   0x00, 0x00, 0xA0, 0x60, 0x00, 0x00, 0x50, 0x27, 0x00, 0x00, \</span></span><br><span class="line"><span class="comment">#   0x59, 0x37, 0x00, 0x00, 0x53, 0x89, 0x00, 0x00, 0x22, 0x71, \</span></span><br><span class="line"><span class="comment">#   0x00, 0x00, 0xF9, 0x81, 0x00, 0x00, 0x24, 0x55, 0x00, 0x00, \</span></span><br><span class="line"><span class="comment">#   0x71, 0x89, 0x00, 0x00, 0x1D, 0x3A\</span></span><br><span class="line"><span class="comment"># ]</span></span><br><span class="line"><span class="comment">#lis = [23, 79, 0, 0, 246, 156, 0, 0, 219, 141, 0, 0, 166, 142, 0, 0, 41, 105, 0, 0, 17, 153, 0, 0, 162, 64, 0, 0, 62, 47, 0, 0, 182, 98, 0, 0, 130, 75, 0, 0, 108, 72, 0]</span></span><br><span class="line">lis = [<span class="number">0x4f17</span>,<span class="number">0x9cf6</span>,<span class="number">0x8ddb</span>,<span class="number">0x8ea6</span>,<span class="number">0x6929</span>,<span class="number">0x9911</span>,<span class="number">0x40a2</span>,<span class="number">0x2f3e</span>,<span class="number">0x62b6</span>,<span class="number">0x4b82</span>,<span class="number">0x486c</span>,<span class="number">0x4002</span>,<span class="number">0x52d7</span>,<span class="number">0x2def</span>,<span class="number">0x28dc</span>,<span class="number">0x640d</span>,<span class="number">0x528f</span>,<span class="number">0x613b</span>,<span class="number">0x4781</span>,<span class="number">0x6b17</span>,<span class="number">0x3237</span>,<span class="number">0x2a93</span>,<span class="number">0x615f</span>,<span class="number">0x50be</span>,<span class="number">0x598e</span>,<span class="number">0x4656</span>,<span class="number">0x5b31</span>,<span class="number">0x313a</span>,<span class="number">0x3010</span>,<span class="number">0x67fe</span>,<span class="number">0x4d5f</span>,<span class="number">0x58db</span>,<span class="number">0x3799</span>,<span class="number">0x60a0</span>,<span class="number">0x2750</span>,<span class="number">0x3759</span>,<span class="number">0x8953</span>,<span class="number">0x7122</span>,<span class="number">0x81f9</span>,<span class="number">0x5524</span>,<span class="number">0x8971</span>,<span class="number">0x3a1d</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(lis[:<span class="number">43</span>])</span><br><span class="line">v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16,v17,v18,v19,v20,v21,v22,v23,v24,v25,v26,v27,v28,v29,v30,v31,v32,v33,v34,v35,v36,v37,v38,v39,v40,v41,v42,v43,v44,v45,v46\</span><br><span class="line">= Ints(<span class="string">&quot;v5 v6 v7 v8 v9 v10 v11 v12 v13 v14 v15 v16 v17 v18 v19 v20 v21 v22 v23 v24 v25 v26 v27 v28 v29 v30 v31 v32 v33 v34 v35 v36 v37 v38 v39 v40 v41 v42 v43 v44 v45 v46&quot;</span>)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(<span class="number">34</span> * v8 + <span class="number">12</span> * v5 + <span class="number">53</span> * v6 + <span class="number">6</span> * v7 + <span class="number">58</span> * v9 + <span class="number">36</span> * v10 + v11 == lis[<span class="number">0</span>])</span><br><span class="line">s.add(<span class="number">27</span> * v9 + <span class="number">73</span> * v8 + <span class="number">12</span> * v7 + <span class="number">83</span> * v5 + <span class="number">85</span> * v6 + <span class="number">96</span> * v10 + <span class="number">52</span> * v11 == lis[<span class="number">1</span>])</span><br><span class="line">s.add(<span class="number">24</span> * v7 + <span class="number">78</span> * v5 + <span class="number">53</span> * v6 + <span class="number">36</span> * v8 + <span class="number">86</span> * v9 + <span class="number">25</span> * v10 + <span class="number">46</span> * v11 == lis[<span class="number">2</span>])</span><br><span class="line">s.add(<span class="number">78</span> * v6 + <span class="number">39</span> * v5 + <span class="number">52</span> * v7 + <span class="number">9</span> * v8 + <span class="number">62</span> * v9 + <span class="number">37</span> * v10 + <span class="number">84</span> * v11 == lis[<span class="number">3</span>])</span><br><span class="line">s.add(<span class="number">48</span> * v9 + <span class="number">14</span> * v7 + <span class="number">23</span> * v5 + <span class="number">6</span> * v6 + <span class="number">74</span> * v8 + <span class="number">12</span> * v10 + <span class="number">83</span> * v11 == lis[<span class="number">4</span>])</span><br><span class="line">s.add(<span class="number">15</span> * v10 + <span class="number">48</span> * v9 + <span class="number">92</span> * v7 + <span class="number">85</span> * v6 + <span class="number">27</span> * v5 + <span class="number">42</span> * v8 + <span class="number">72</span> * v11 == lis[<span class="number">5</span>])</span><br><span class="line">s.add(<span class="number">26</span> * v10 + <span class="number">67</span> * v8 + <span class="number">6</span> * v6 + <span class="number">4</span> * v5 + <span class="number">3</span> * v7 + <span class="number">68</span> * v11 == lis[<span class="number">6</span>])</span><br><span class="line">s.add(<span class="number">34</span> * v15 + <span class="number">12</span> * v12 + <span class="number">53</span> * v13 + <span class="number">6</span> * v14 + <span class="number">58</span> * v16 + <span class="number">36</span> * v17 + v18 == lis[<span class="number">7</span>])</span><br><span class="line">s.add(<span class="number">27</span> * v16 + <span class="number">73</span> * v15 + <span class="number">12</span> * v14 + <span class="number">83</span> * v12 + <span class="number">85</span> * v13 + <span class="number">96</span> * v17 + <span class="number">52</span> * v18 == lis[<span class="number">8</span>])</span><br><span class="line">s.add(<span class="number">24</span> * v14 + <span class="number">78</span> * v12 + <span class="number">53</span> * v13 + <span class="number">36</span> * v15 + <span class="number">86</span> * v16 + <span class="number">25</span> * v17 + <span class="number">46</span> * v18 == lis[<span class="number">9</span>])</span><br><span class="line">s.add(<span class="number">78</span> * v13 + <span class="number">39</span> * v12 + <span class="number">52</span> * v14 + <span class="number">9</span> * v15 + <span class="number">62</span> * v16 + <span class="number">37</span> * v17 + <span class="number">84</span> * v18 == lis[<span class="number">10</span>])</span><br><span class="line">s.add(<span class="number">48</span> * v16 + <span class="number">14</span> * v14 + <span class="number">23</span> * v12 + <span class="number">6</span> * v13 + <span class="number">74</span> * v15 + <span class="number">12</span> * v17 + <span class="number">83</span> * v18 == lis[<span class="number">11</span>])</span><br><span class="line">s.add(<span class="number">15</span> * v17 + <span class="number">48</span> * v16 + <span class="number">92</span> * v14 + <span class="number">85</span> * v13 + <span class="number">27</span> * v12 + <span class="number">42</span> * v15 + <span class="number">72</span> * v18 == lis[<span class="number">12</span>])</span><br><span class="line">s.add(<span class="number">26</span> * v17 + <span class="number">67</span> * v15 + <span class="number">6</span> * v13 + <span class="number">4</span> * v12 + <span class="number">3</span> * v14 + <span class="number">68</span> * v18 == lis[<span class="number">13</span>])</span><br><span class="line">s.add(<span class="number">34</span> * v22 + <span class="number">12</span> * v19 + <span class="number">53</span> * v20 + <span class="number">6</span> * v21 + <span class="number">58</span> * v23 + <span class="number">36</span> * v24 + v25 == lis[<span class="number">14</span>])</span><br><span class="line">s.add(<span class="number">27</span> * v23 + <span class="number">73</span> * v22 + <span class="number">12</span> * v21 + <span class="number">83</span> * v19 + <span class="number">85</span> * v20 + <span class="number">96</span> * v24 + <span class="number">52</span> * v25 == lis[<span class="number">15</span>])</span><br><span class="line">s.add(<span class="number">24</span> * v21 + <span class="number">78</span> * v19 + <span class="number">53</span> * v20 + <span class="number">36</span> * v22 + <span class="number">86</span> * v23 + <span class="number">25</span> * v24 + <span class="number">46</span> * v25 == lis[<span class="number">16</span>])</span><br><span class="line">s.add(<span class="number">78</span> * v20 + <span class="number">39</span> * v19 + <span class="number">52</span> * v21 + <span class="number">9</span> * v22 + <span class="number">62</span> * v23 + <span class="number">37</span> * v24 + <span class="number">84</span> * v25 == lis[<span class="number">17</span>])</span><br><span class="line">s.add(<span class="number">48</span> * v23 + <span class="number">14</span> * v21 + <span class="number">23</span> * v19 + <span class="number">6</span> * v20 + <span class="number">74</span> * v22 + <span class="number">12</span> * v24 + <span class="number">83</span> * v25 == lis[<span class="number">18</span>])</span><br><span class="line">s.add(<span class="number">15</span> * v24 + <span class="number">48</span> * v23 + <span class="number">92</span> * v21 + <span class="number">85</span> * v20 + <span class="number">27</span> * v19 + <span class="number">42</span> * v22 + <span class="number">72</span> * v25 == lis[<span class="number">19</span>])</span><br><span class="line">s.add(<span class="number">26</span> * v24 + <span class="number">67</span> * v22 + <span class="number">6</span> * v20 + <span class="number">4</span> * v19 + <span class="number">3</span> * v21 + <span class="number">68</span> * v25 == lis[<span class="number">20</span>])</span><br><span class="line">s.add(<span class="number">34</span> * v29 + <span class="number">12</span> * v26 + <span class="number">53</span> * v27 + <span class="number">6</span> * v28 + <span class="number">58</span> * v30 + <span class="number">36</span> * v31 + v32 == lis[<span class="number">21</span>])</span><br><span class="line">s.add(<span class="number">27</span> * v30 + <span class="number">73</span> * v29 + <span class="number">12</span> * v28 + <span class="number">83</span> * v26 + <span class="number">85</span> * v27 + <span class="number">96</span> * v31 + <span class="number">52</span> * v32 == lis[<span class="number">22</span>])</span><br><span class="line">s.add(<span class="number">24</span> * v28 + <span class="number">78</span> * v26 + <span class="number">53</span> * v27 + <span class="number">36</span> * v29 + <span class="number">86</span> * v30 + <span class="number">25</span> * v31 + <span class="number">46</span> * v32 == lis[<span class="number">23</span>])</span><br><span class="line">s.add(<span class="number">78</span> * v27 + <span class="number">39</span> * v26 + <span class="number">52</span> * v28 + <span class="number">9</span> * v29 + <span class="number">62</span> * v30 + <span class="number">37</span> * v31 + <span class="number">84</span> * v32 == lis[<span class="number">24</span>])</span><br><span class="line">s.add(<span class="number">48</span> * v30 + <span class="number">14</span> * v28 + <span class="number">23</span> * v26 + <span class="number">6</span> * v27 + <span class="number">74</span> * v29 + <span class="number">12</span> * v31 + <span class="number">83</span> * v32 == lis[<span class="number">25</span>])</span><br><span class="line">s.add(<span class="number">15</span> * v31 + <span class="number">48</span> * v30 + <span class="number">92</span> * v28 + <span class="number">85</span> * v27 + <span class="number">27</span> * v26 + <span class="number">42</span> * v29 + <span class="number">72</span> * v32 == lis[<span class="number">26</span>])</span><br><span class="line">s.add(<span class="number">26</span> * v31 + <span class="number">67</span> * v29 + <span class="number">6</span> * v27 + <span class="number">4</span> * v26 + <span class="number">3</span> * v28 + <span class="number">68</span> * v32 == lis[<span class="number">27</span>])</span><br><span class="line">s.add(<span class="number">34</span> * v36 + <span class="number">12</span> * v33 + <span class="number">53</span> * v34 + <span class="number">6</span> * v35 + <span class="number">58</span> * v37 + <span class="number">36</span> * v38 + v39 == lis[<span class="number">28</span>])</span><br><span class="line">s.add(<span class="number">27</span> * v37 + <span class="number">73</span> * v36 + <span class="number">12</span> * v35 + <span class="number">83</span> * v33 + <span class="number">85</span> * v34 + <span class="number">96</span> * v38 + <span class="number">52</span> * v39 == lis[<span class="number">29</span>])</span><br><span class="line">s.add(<span class="number">24</span> * v35 + <span class="number">78</span> * v33 + <span class="number">53</span> * v34 + <span class="number">36</span> * v36 + <span class="number">86</span> * v37 + <span class="number">25</span> * v38 + <span class="number">46</span> * v39 == lis[<span class="number">30</span>])</span><br><span class="line">s.add(<span class="number">78</span> * v34 + <span class="number">39</span> * v33 + <span class="number">52</span> * v35 + <span class="number">9</span> * v36 + <span class="number">62</span> * v37 + <span class="number">37</span> * v38 + <span class="number">84</span> * v39 == lis[<span class="number">31</span>])</span><br><span class="line">s.add(<span class="number">48</span> * v37 + <span class="number">14</span> * v35 + <span class="number">23</span> * v33 + <span class="number">6</span> * v34 + <span class="number">74</span> * v36 + <span class="number">12</span> * v38 + <span class="number">83</span> * v39 == lis[<span class="number">32</span>])</span><br><span class="line">s.add(<span class="number">15</span> * v38 + <span class="number">48</span> * v37 + <span class="number">92</span> * v35 + <span class="number">85</span> * v34 + <span class="number">27</span> * v33 + <span class="number">42</span> * v36 + <span class="number">72</span> * v39 == lis[<span class="number">33</span>])</span><br><span class="line">s.add(<span class="number">26</span> * v38 + <span class="number">67</span> * v36 + <span class="number">6</span> * v34 + <span class="number">4</span> * v33 + <span class="number">3</span> * v35 + <span class="number">68</span> * v39 == lis[<span class="number">34</span>])</span><br><span class="line">s.add(<span class="number">34</span> * v43 + <span class="number">12</span> * v40 + <span class="number">53</span> * v41 + <span class="number">6</span> * v42 + <span class="number">58</span> * v44 + <span class="number">36</span> * v45 + v46 == lis[<span class="number">35</span>])</span><br><span class="line">s.add(<span class="number">27</span> * v44 + <span class="number">73</span> * v43 + <span class="number">12</span> * v42 + <span class="number">83</span> * v40 + <span class="number">85</span> * v41 + <span class="number">96</span> * v45 + <span class="number">52</span> * v46 == lis[<span class="number">36</span>])</span><br><span class="line">s.add(<span class="number">24</span> * v42 + <span class="number">78</span> * v40 + <span class="number">53</span> * v41 + <span class="number">36</span> * v43 + <span class="number">86</span> * v44 + <span class="number">25</span> * v45 + <span class="number">46</span> * v46 == lis[<span class="number">37</span>])</span><br><span class="line">s.add(<span class="number">78</span> * v41 + <span class="number">39</span> * v40 + <span class="number">52</span> * v42 + <span class="number">9</span> * v43 + <span class="number">62</span> * v44 + <span class="number">37</span> * v45 + <span class="number">84</span> * v46 == lis[<span class="number">38</span>])</span><br><span class="line">s.add(<span class="number">48</span> * v44 + <span class="number">14</span> * v42 + <span class="number">23</span> * v40 + <span class="number">6</span> * v41 + <span class="number">74</span> * v43 + <span class="number">12</span> * v45 + <span class="number">83</span> * v46 == lis[<span class="number">39</span>])</span><br><span class="line">s.add(<span class="number">15</span> * v45 + <span class="number">48</span> * v44 + <span class="number">92</span> * v42 + <span class="number">85</span> * v41 + <span class="number">27</span> * v40 + <span class="number">42</span> * v43 + <span class="number">72</span> * v46 == lis[<span class="number">40</span>])</span><br><span class="line">s.add(<span class="number">26</span> * v45 + <span class="number">67</span> * v43 + <span class="number">6</span> * v41 + <span class="number">4</span> * v40 + <span class="number">3</span> * v42 + <span class="number">68</span> * v46 == lis[<span class="number">41</span>])</span><br><span class="line">s.check()</span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">arr = [<span class="number">102</span>,<span class="number">108</span>,<span class="number">97</span>,<span class="number">103</span>,<span class="number">123</span>,<span class="number">55</span>,<span class="number">101</span>,<span class="number">49</span>,<span class="number">55</span>,<span class="number">49</span>,<span class="number">100</span>,<span class="number">52</span>,<span class="number">51</span>,<span class="number">45</span>,<span class="number">54</span>,<span class="number">51</span>,<span class="number">98</span>,<span class="number">57</span>,<span class="number">45</span>,<span class="number">52</span>,<span class="number">101</span>,<span class="number">49</span>,<span class="number">56</span>,<span class="number">45</span>,<span class="number">57</span>,<span class="number">57</span>,<span class="number">48</span>,<span class="number">101</span>,<span class="number">45</span>,<span class="number">54</span>,<span class="number">101</span>,<span class="number">49</span>,<span class="number">52</span>,<span class="number">99</span>,<span class="number">50</span>,<span class="number">97</span>,<span class="number">102</span>,<span class="number">101</span>,<span class="number">54</span>,<span class="number">52</span>,<span class="number">56</span>,<span class="number">125</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> arr:</span><br><span class="line">	flag += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;7e171d43-63b9-4e18-990e-6e14c2afe648&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="hyperthreading"><a href="#hyperthreading" class="headerlink" title="hyperthreading"></a>hyperthreading</h2><p>用ida打开查看，可以可以看到最后的加密函数，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [esp+0h] [ebp-14h]</span></span><br><span class="line">  HANDLE Handles[<span class="number">2</span>]; <span class="comment">// [esp+8h] [ebp-Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_401020(<span class="string">&quot;plz input your flag:&quot;</span>, v5);</span><br><span class="line">  sub_401050(<span class="string">&quot;%42s&quot;</span>, (<span class="type">char</span>)byte_40336C);</span><br><span class="line">  Handles[<span class="number">0</span>] = CreateThread(<span class="number">0</span>, <span class="number">0</span>, StartAddress, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  Handles[<span class="number">1</span>] = CreateThread(<span class="number">0</span>, <span class="number">0</span>, loc_401200, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  CreateThread(<span class="number">0</span>, <span class="number">0</span>, sub_401240, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  WaitForMultipleObjects(<span class="number">2u</span>, Handles, <span class="number">1</span>, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">42</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( byte_40336C[i] != byte_402150[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_401020(<span class="string">&quot;error&quot;</span>, (<span class="type">char</span>)Handles[<span class="number">0</span>]);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_401020(<span class="string">&quot;win&quot;</span>, (<span class="type">char</span>)Handles[<span class="number">0</span>]);</span><br><span class="line">  getchar();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一共创建了三个线程，第一个线程的函数就是加密函数了，本人目前水平只能做到这样的修复了。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __userpurge __noreturn <span class="title function_">StartAddress</span><span class="params">(_BYTE *a2@&lt;edi&gt;, LPVOID lpThreadParameter)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> *v2; <span class="comment">// ebp</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+4h] [ebp-14h]</span></span><br><span class="line">  DWORD v5; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line">  HANDLE Thread; <span class="comment">// [esp+10h] [ebp-8h]</span></span><br><span class="line">  <span class="type">int</span> savedregs; <span class="comment">// [esp+18h] [ebp+0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v2 = &amp;savedregs;</span><br><span class="line">  Thread = CreateThread(<span class="number">0</span>, <span class="number">0</span>, hHandle, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  v5 = WaitForSingleObject(hHandle, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">  *(v5 - <span class="number">57</span>) = __ROR1__(*(v5 - <span class="number">57</span>), <span class="number">69</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    LOBYTE(v3) = v3 - *a2;</span><br><span class="line">    v2 = (v2 - <span class="number">1</span>);</span><br><span class="line">    byte_40336C[*(v2 - <span class="number">1</span>)] = (byte_40336C[*(v2 - <span class="number">1</span>)] &lt;&lt; <span class="number">6</span>) ^ (byte_40336C[v3] &gt;&gt; <span class="number">2</span>);</span><br><span class="line">    byte_40336C[*(v2 - <span class="number">1</span>)] ^= <span class="number">0x23</span>u;</span><br><span class="line">    Sleep(<span class="number">6u</span>);</span><br><span class="line">    v4 += NtCurrentPeb()-&gt;BeingDebugged + <span class="number">9</span>;</span><br><span class="line">    *(v4 - <span class="number">117</span>) = __ROR1__(*(v4 - <span class="number">117</span>), <span class="number">77</span>);</span><br><span class="line">    byte_40336C[*(v2 - <span class="number">1</span>)] = byte_40336C[v3] + <span class="number">0x23</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>查看第二个线程中的函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DWORD __thiscall <span class="title function_">sub_401200</span><span class="params">(<span class="type">char</span> *this, LPVOID lpThreadParameter)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">PEB</span> *<span class="title">v2</span>;</span> <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// bl</span></span><br><span class="line"></span><br><span class="line">  v2 = NtCurrentPeb();</span><br><span class="line">  HIBYTE(v2-&gt;Ldr) = __ROR1__(HIBYTE(v2-&gt;Ldr), <span class="number">182</span>);</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">100</span> * (*(this - <span class="number">1240466363</span>) + (_BYTE)this);</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    byte_40336C[v3++] += v4;</span><br><span class="line">  <span class="keyword">while</span> ( v3 &lt; <span class="number">42</span> );</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第三个线程中的函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __stdcall __noreturn <span class="title function_">sub_401240</span><span class="params">(LPVOID lpThreadParameter)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v1; <span class="comment">// [esp+0h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> ( !IsDebuggerPresent() )</span><br><span class="line">    ;</span><br><span class="line">  sub_401020(<span class="string">&quot;debug!\n&quot;</span>, v1);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<img src="/2022/04/08/CTF/2020-CISCN/image-20220409230733626.png" class="" title="image-20220409230733626">

<p>后面跟着一个函数WaitForMultipleObjects函数，中间存放的函数是一二线程：</p>
<img src="/2022/04/08/CTF/2020-CISCN/image-20220410083820207.png" class="" title="image-20220410083820207">

<p>贴上<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41252520/article/details/108170062">大佬的讲解</a></p>
<img src="/2022/04/08/CTF/2020-CISCN/image-20220410084135000.png" class="" title="image-20220410084135000">

<p>网上关于这题的wp挺少，据我统计共有两种做法。</p>
<h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>一种是直接读汇编，或者修补程序，把加密函数逆出来。加密函数逻辑大概就是这个样子。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(((((<span class="built_in">input</span>[i]&gt;&gt;<span class="number">2</span>)^(<span class="built_in">input</span>[i]&lt;&lt;<span class="number">6</span>))&amp;<span class="number">0xff</span>)^<span class="number">0x23</span>)+<span class="number">0x23</span>)&amp;<span class="number">0xff</span></span><br></pre></td></tr></table></figure>

<p>最后把对比数组提取出来：</p>
<img src="/2022/04/08/CTF/2020-CISCN/image-20220410085703660.png" class="" title="image-20220410085703660">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line">ans=[<span class="number">0xDD</span>,<span class="number">0x5B</span>,<span class="number">0x9E</span>,<span class="number">0x1D</span>,<span class="number">0x20</span>,<span class="number">0x9E</span>,<span class="number">0x90</span>,<span class="number">0x91</span>,<span class="number">0x90</span>,<span class="number">0x90</span>,<span class="number">0x91</span>,<span class="number">0x92</span>,<span class="number">0xDE</span>,<span class="number">0x8B</span>,<span class="number">0x11</span>,<span class="number">0xD1</span>,<span class="number">0x1E</span>,<span class="number">0x9E</span>,<span class="number">0x8B</span>,<span class="number">0x51</span>,<span class="number">0x11</span>,<span class="number">0x50</span>,<span class="number">0x51</span>,<span class="number">0x8B</span>,<span class="number">0x9E</span>,<span class="number">0x5D</span>,<span class="number">0x5D</span>,<span class="number">0x11</span>,<span class="number">0x8B</span>,<span class="number">0x90</span>,<span class="number">0x12</span>,<span class="number">0x91</span>,<span class="number">0x50</span>,<span class="number">0x12</span>,<span class="number">0xD2</span>,<span class="number">0x91</span>,<span class="number">0x92</span>,<span class="number">0x1E</span>,<span class="number">0x9E</span>,<span class="number">0x90</span>,<span class="number">0xD2</span>,<span class="number">0x9F</span>]</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ans)):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> string.printable:</span><br><span class="line">        <span class="keyword">if</span> (((((<span class="built_in">ord</span>(c)&gt;&gt;<span class="number">2</span>)^(<span class="built_in">ord</span>(c)&lt;&lt;<span class="number">6</span>))&amp;<span class="number">0xff</span>)^<span class="number">0x23</span>)+<span class="number">0x23</span>)&amp;<span class="number">0xff</span>==ans[i]:</span><br><span class="line">            flag+=c</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span> (flag)</span><br></pre></td></tr></table></figure>

<p>不得不说，这段爆破代码实在太强了，又学到了……</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41252520/article/details/108170062">代码来源</a></p>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>读懂程序的逻辑，巧妙绕过第三个线程的isdebugged函数</p>
<p>用od动调，输入字符串之后，动调到WaitForMultipleObjects的时候，程序会自动卡在这个位置上，因为前面判断了程序处于调试模式，所以线程会一直占用，出不来。我们只需要手动暂停调试的程序，等待上面线程没有占用资源之后，再继续执行，之后就会绕过WaitForMultipleObjects函数了。从而到达关键判断处了</p>
<img src="/2022/04/08/CTF/2020-CISCN/image-20220410090637435.png" class="" title="image-20220410090637435">

<p>因为加密方式未知，这种做法有赌的成分……</p>
<p>这题是简单的异或之类的字符加密，每个字符加密结果固定，所以可以统计每个常见字符对应的加密结果，然后通过对比数组，来推断出flag.</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43859686/article/details/108158712">详细看这里</a></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 小明经过研究，发现RSA加密算法可以推广，也就是它的模不仅仅是只能为两个素数的乘积，只要是2个以上不同的素数相乘都可以。</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">50142032499469550407421604706771611415193641755639270667473328045908799316205905505167271138079522738272643811917325451177986948493659090203974349370248583120022500722759239305447823602875823849366662503027591858371125301505134216095903796534740686834236150999</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">45005399504992587510006608300548120810512973768886391125598523343330913326304417790989607300367232977960116381108873363343598357102136548218343380795022179607741940866191404186680657699739176842869814452906110393321567314747096161480003824583613027819960172221</span></span><br></pre></td></tr></table></figure>

<p>分解出了三个大素数？？</p>
<img src="/2022/04/08/CTF/2020-CISCN/image-20220410093149558.png" class="" title="image-20220410093149558">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">50142032499469550407421604706771611415193641755639270667473328045908799316205905505167271138079522738272643811917325451177986948493659090203974349370248583120022500722759239305447823602875823849366662503027591858371125301505134216095903796534740686834236150999</span></span><br><span class="line">p1 = <span class="number">368751654879714877087975516875168751974879716873087714877516875971487715687516888458327</span></span><br><span class="line">p2 = <span class="number">368751654879714877087975516875168751974879716873087714877516875971487715687518277898523</span></span><br><span class="line">p3 = <span class="number">368751654879714877087975516875168751974879716873087714877516875971487715687518438089619</span></span><br><span class="line">c = <span class="number">45005399504992587510006608300548120810512973768886391125598523343330913326304417790989607300367232977960116381108873363343598357102136548218343380795022179607741940866191404186680657699739176842869814452906110393321567314747096161480003824583613027819960172221</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = gmpy2.invert(e,(p1-<span class="number">1</span>)*(p2-<span class="number">1</span>)*(p3-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h2 id="bd-（rsa-wiener-attack）"><a href="#bd-（rsa-wiener-attack）" class="headerlink" title="bd （rsa-wiener-attack）"></a>bd （rsa-wiener-attack）</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">N = p * q</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    d = getRandomNBitInteger(<span class="number">200</span>)</span><br><span class="line">    <span class="keyword">if</span> GCD(d, phi) == <span class="number">1</span>:</span><br><span class="line">        e = inverse(d, phi)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c, e, N, sep=<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 37625098109081701774571613785279343908814425141123915351527903477451570893536663171806089364574293449414561630485312247061686191366669404389142347972565020570877175992098033759403318443705791866939363061966538210758611679849037990315161035649389943256526167843576617469134413191950908582922902210791377220066</span></span><br><span class="line"><span class="comment"># 46867417013414476511855705167486515292101865210840925173161828985833867821644239088991107524584028941183216735115986313719966458608881689802377181633111389920813814350964315420422257050287517851213109465823444767895817372377616723406116946259672358254060231210263961445286931270444042869857616609048537240249</span></span><br><span class="line"><span class="comment"># 86966590627372918010571457840724456774194080910694231109811773050866217415975647358784246153710824794652840306389428729923771431340699346354646708396564203957270393882105042714920060055401541794748437242707186192941546185666953574082803056612193004258064074902605834799171191314001030749992715155125694272289</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这题给出的e很大，d是随机生成的，位数为200bit，且满足与phi互质的条件，我目前只能知道的条件为ed &#x3D; 1 MOD phi</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43299030/article/details/110411873">–正解–</a></p>
<p>这题使用的方式是rsa-wiener-attack，有关连分数攻击方法</p>
<p>使用的脚本<a target="_blank" rel="noopener" href="https://github.com/pablocelayes/rsa-wiener-attack">https://github.com/pablocelayes/rsa-wiener-attack</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> ContinuedFractions, Arithmetic</span><br><span class="line">c=<span class="number">37625098109081701774571613785279343908814425141123915351527903477451570893536663171806089364574293449414561630485312247061686191366669404389142347972565020570877175992098033759403318443705791866939363061966538210758611679849037990315161035649389943256526167843576617469134413191950908582922902210791377220066</span></span><br><span class="line">e=<span class="number">46867417013414476511855705167486515292101865210840925173161828985833867821644239088991107524584028941183216735115986313719966458608881689802377181633111389920813814350964315420422257050287517851213109465823444767895817372377616723406116946259672358254060231210263961445286931270444042869857616609048537240249</span></span><br><span class="line">n=<span class="number">86966590627372918010571457840724456774194080910694231109811773050866217415975647358784246153710824794652840306389428729923771431340699346354646708396564203957270393882105042714920060055401541794748437242707186192941546185666953574082803056612193004258064074902605834799171191314001030749992715155125694272289</span></span><br><span class="line"><span class="comment"># firstly git clone https://github.com/pablocelayes/rsa-wiener-attack.git !</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wiener_hack</span>(<span class="params">e, n</span>):</span><br><span class="line">    frac = ContinuedFractions.rational_to_contfrac(e, n)</span><br><span class="line">    convergents = ContinuedFractions.convergents_from_contfrac(frac)</span><br><span class="line">    <span class="keyword">for</span> (k, d) <span class="keyword">in</span> convergents:</span><br><span class="line">        <span class="keyword">if</span> k != <span class="number">0</span> <span class="keyword">and</span> (e * d - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">            phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">            s = n - phi + <span class="number">1</span></span><br><span class="line">            discr = s * s - <span class="number">4</span> * n</span><br><span class="line">            <span class="keyword">if</span> (discr &gt;= <span class="number">0</span>):</span><br><span class="line">                t = Arithmetic.is_perfect_square(discr)</span><br><span class="line">                <span class="keyword">if</span> t != -<span class="number">1</span> <span class="keyword">and</span> (s + t) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Hacked!&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">d = wiener_hack(e, n)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">flag=long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这边仅限于了解rsa-wiener-attack攻击的使用</p>
</p></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2022-04-08</span><i class="fa fa-tag"></i><a class="tag" href="/tags/CTF复现/" title="CTF复现">CTF复现 </a><span class="leancloud_visitors"></span><span>About 2030 words, 6 min 46 sec  read</span></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="" onclick="javascript:join_favorite()" ref="sidebar"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,http://ke1os.top/2022/04/08/CTF/2020-CISCN/,ke1os' blog,2020_CISCN,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2022/04/18/CTF/2022DCTF/" title="2022DCTF">Previous</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2022/03/31/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-pwn/" title="攻防世界_pwn新手练习区">Next</a></li></ul></div><script src="/js/visitors.js"></script></div></div></div></div><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/add-bookmark.js"></script><script>(function(window){var INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)",},CONTENT_URL:"/content.json",};window.INSIGHT_CONFIG=INSIGHT_CONFIG})(window);</script><script src="/js/insight.js" defer></script><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"><input class="searchbox-input ins-search-input" type="text" placeholder="Search..."><span class="searchbox-close"><a class="fa fa-times-circle" onclick="closeWindow();"></a></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"><p>Seraching...</p></div></div></div></div></body></html>