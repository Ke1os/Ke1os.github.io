<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>rsa合集 | ke1os' blog</title><meta name="keywords" content="rsa"><meta name="author" content="ke1os"><meta name="copyright" content="ke1os"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="基础知识数论知识在这边简单阐述rsa需要用到的数论知识：  互质关系，两个正整数除了1以外没有其他公因子，就称这两个数为互质关系（coprime）  欧拉函数:任意给定正整数n，计算小于等于n正整数中，与n构成互质关系的个数  欧拉定理:   也就是说，a的φ(n)次方被n除的余数为1。或者说，a的φ(n)次方减去1，可以被n整除。比如，3和7互质，而7的欧拉函数φ(7)等于6，所以3的6次方">
<meta property="og:type" content="article">
<meta property="og:title" content="rsa合集">
<meta property="og:url" content="http://ke1os.top/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/index.html">
<meta property="og:site_name" content="ke1os&#39; blog">
<meta property="og:description" content="基础知识数论知识在这边简单阐述rsa需要用到的数论知识：  互质关系，两个正整数除了1以外没有其他公因子，就称这两个数为互质关系（coprime）  欧拉函数:任意给定正整数n，计算小于等于n正整数中，与n构成互质关系的个数  欧拉定理:   也就是说，a的φ(n)次方被n除的余数为1。或者说，a的φ(n)次方减去1，可以被n整除。比如，3和7互质，而7的欧拉函数φ(7)等于6，所以3的6次方">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2022-03-22T13:01:37.000Z">
<meta property="article:modified_time" content="2022-04-11T14:05:42.654Z">
<meta property="article:author" content="ke1os">
<meta property="article:tag" content="rsa">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/img/ke1os.jpg"><link rel="canonical" href="http://ke1os.top/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'rsa合集',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-04-11 22:05:42'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/ke1os.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">20</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">11</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">ke1os' blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">rsa合集</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-03-22T13:01:37.000Z" title="Created 2022-03-22 21:01:37">2022-03-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-04-11T14:05:42.654Z" title="Updated 2022-04-11 22:05:42">2022-04-11</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="rsa合集"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><span id="more"></span>

<h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><h2 id="数论知识"><a href="#数论知识" class="headerlink" title="数论知识"></a>数论知识</h2><p>在这边简单阐述rsa需要用到的数论知识：</p>
<ol>
<li><p>互质关系，两个正整数除了1以外没有其他公因子，就称这两个数为互质关系（coprime）</p>
</li>
<li><p>欧拉函数:任意给定正整数n，计算小于等于n正整数中，与n构成互质关系的个数</p>
</li>
<li><p>欧拉定理:</p>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220323064101370.png" class="" title="image-20220323064101370"></li>
</ol>
<p>也就是说，a的φ(n)次方被n除的余数为1。或者说，a的φ(n)次方减去1，可以被n整除。比如，3和7互质，而7的欧拉函数φ(7)等于6，所以3的6次方（729）减去1，可以被7整除（728&#x2F;7&#x3D;104）。</p>
<p>关于欧拉函数的结论很多，可以去别的地方查找，但是这边只介绍两个</p>
<p>（1） 如果n是质数，则 φ(n)&#x3D;n-1</p>
<p>（2） 如果n可以分解成两个互质的整数之积：</p>
<p>n &#x3D; p1 * p2    &#x3D;&#x3D;&gt;    φ(n) &#x3D; φ(p1p2) &#x3D; φ(p1)φ(p2)</p>
<ol start="4">
<li><p>模反元素：如果两个正整数a和n互质，那么一定可以找到整数b，使得ab-1被n整除</p>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220323064512860.png" class="" title="image-20220323064512860">

<p>比如，3和11互质，那么3的模反元素就是4，因为 (3 × 4)-1 可以被11整除。显然，模反元素不止一个， 4加减11的整数倍都是3的模反元素 {…,-18,-7,4,15,26,…}，即如果b是a的模反元素，则 b+kn 都是a的模反元素。</p>
</li>
<li><p>欧拉定理可以用来证明模范元素必然存在</p>
</li>
</ol>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220323064643095.png" class="" title="image-20220323064643095">

<h2 id="rsa加密算法"><a href="#rsa加密算法" class="headerlink" title="rsa加密算法"></a>rsa加密算法</h2><ol>
<li><p>随机选择两个不相等的质数p和q</p>
</li>
<li><p>计算p和q的乘积n</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">n = p * q</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>计算n的欧拉函数φ(n)</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">φ(n) =  (p-<span class="number">1</span>) (q-<span class="number">1</span>) </span><br><span class="line"></span><br><span class="line">推算：φ(n) =  φ(p*q) = φ(p1)φ(p2) = (p-<span class="number">1</span>) (q-<span class="number">1</span>) </span><br></pre></td></tr></table></figure>

<ol start="4">
<li><p>随机选择一个整数e，条件：（1&lt;e&lt;φ(n)）,且e和φ(n)互质</p>
</li>
<li><p>计算e对于φ(n)的模反元素d</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ed ≡ <span class="number">1</span> (mod φ(n))</span><br><span class="line"></span><br><span class="line">ed - <span class="number">1</span> = kφ(n)</span><br><span class="line"></span><br><span class="line">ex + φ(n)y = <span class="number">1</span>，也就是求左边二元一次方程的解</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>将n和e扩展成公钥（n，e），n和d封装成私钥（n，d）</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">假设n = <span class="number">3233</span>，e = <span class="number">17</span>，d = <span class="number">2753</span></span><br><span class="line"></span><br><span class="line">公钥：（<span class="number">3233</span>，<span class="number">17</span>）	私钥（<span class="number">3233</span>，<span class="number">2753</span>）</span><br></pre></td></tr></table></figure>

<ol start="7">
<li><p>rsa算法的可靠性</p>
<p>一共出现了6个数字：p&#x2F;q&#x2F;φ(n)&#x2F;e&#x2F;d，公钥用到了两个，其余四个整数都是不公开的，其中最关键的是d，一旦d泄，就等于私钥泄露</p>
<p>结论：如果n可以被因数分解，d就可以被算出，也就意味这私钥被破解。除了暴力破解，还没有发现别的有效方法，目前被破解的最长RSA密钥就是768位。</p>
</li>
<li><p>加密与解密</p>
<p>（1） 加密需要公钥（n,e），假设m就是要加密的值，比如ascii码值或者Unicode值(m必须为整数，且小于n)，那么加密后的值为c</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m ** e ≡ c (mod n)</span><br></pre></td></tr></table></figure>

<p>爱丽丝的例子，爱丽丝的公钥为(3233,17)</p>
<p>假设鲍勃要加密的值是65，通过下面的计算，2790就是鲍勃发送的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">65</span> ** <span class="number">17</span> ≡ <span class="number">2790</span> (mod <span class="number">3233</span>)</span><br></pre></td></tr></table></figure>

<p>（2） 解密需要私钥（n,d），下面的等式一定成立</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c ** d ≡ m (mod n)</span><br></pre></td></tr></table></figure>

<p>还是爱丽丝的例子，爱丽丝就用自己的私钥(3233,2735)进行解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2790</span> ** <span class="number">2753</span> ≡ <span class="number">65</span> (mod <span class="number">3233</span>)</span><br></pre></td></tr></table></figure>

<p>因此，爱丽丝就知道鲍勃加密前的密文就是65</p>
<p>当然还有关于上述公示的证明，可以参考阮老师的博客：</p>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html">http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html</a></p>
<p><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html">http://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html</a></p>
<h2 id="yafu的使用"><a href="#yafu的使用" class="headerlink" title="yafu的使用"></a>yafu的使用</h2><p>最常用的方法是在命令行中直接使用factor()函数分解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yafu-x64 factor(n)</span><br></pre></td></tr></table></figure>

<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220325215925152.png" class="" title="image-20220325215925152">

<p>当然，命令行可能不支持太长的n</p>
<p>新建一个pcat.txt，注意最后一定得换行，运行命令</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yafu-x64 “factor(@)” -batchfile pcat.txt</span><br></pre></td></tr></table></figure>

<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220325220435567.png" class="" title="image-20220325220435567">

<h2 id="中国剩余定理"><a href="#中国剩余定理" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h2><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86">资料参考</a></p>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220410160238006.png" class="" title="image-20220410160238006">

<p>我来举个简单的例子来理解一下CRT的代码实现。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="comment">#ai是余数，mi是除数，且除数mi互质</span></span><br><span class="line">a1,m1 = <span class="number">1</span>,<span class="number">3</span> <span class="comment"># x % 3 == 1 </span></span><br><span class="line">a2,m2 = <span class="number">3</span>,<span class="number">5</span> <span class="comment"># x % 5 == 3 </span></span><br><span class="line">a3,m3 = <span class="number">2</span>,<span class="number">7</span> <span class="comment"># x % 7 == 2 </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># M为除数的乘积，即M = ∏ mi</span></span><br><span class="line">M = m1 * m2 * m3</span><br><span class="line"></span><br><span class="line"><span class="comment"># Mi是除了自身的除数的乘积</span></span><br><span class="line">M1 = M // m1 <span class="comment"># M1 = 35</span></span><br><span class="line">M2 = M // m2 <span class="comment"># M2 = 21</span></span><br><span class="line">M3 = M // m3 <span class="comment"># M3 = 15</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ti就是Mi关于mi的模逆</span></span><br><span class="line">t1 = gmpy2.invert(M1,m1) <span class="comment"># t1 = 2  35*2 % 3 == 1</span></span><br><span class="line">t2 = gmpy2.invert(M2,m2) <span class="comment"># t2 = 1</span></span><br><span class="line">t3 = gmpy2.invert(M3,m3) <span class="comment"># t3 = 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># x是ai*ti*Mi项的和</span></span><br><span class="line">x = a1 * t1 * M1 + a2 * t2 * M2 + a3 * t3 * M3</span><br><span class="line">s = x%M</span><br><span class="line"><span class="built_in">print</span>(s) <span class="comment"># 163 % 105 = 58</span></span><br></pre></td></tr></table></figure>

<p>结果不唯一，x + kM都可以是结果</p>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220410163921530.png" class="" title="image-20220410163921530">

<p>所以如果是求最小值，可以x%M</p>
<p>上面的代码简化一下，就可以变成下面的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CRT</span>(<span class="params">aList, mList</span>):</span><br><span class="line">    M = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> mList:</span><br><span class="line">        M = M * i   <span class="comment">#计算M = ∏ mi</span></span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mList)):</span><br><span class="line">        Mi = M // mList[i]   <span class="comment">#计算Mi</span></span><br><span class="line">        ti = gmpy2.invert(Mi, mList[i]) <span class="comment">#计算Mi的逆元</span></span><br><span class="line">        x += aList[i] * Mi * ti <span class="comment">#构造x各项</span></span><br><span class="line">    x = x % M</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">aList = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>]</span><br><span class="line">mList = [<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>]</span><br><span class="line"><span class="built_in">print</span>(CRT(aList,mList))</span><br></pre></td></tr></table></figure>

<h3 id="例题：蓝桥杯2022年python-B组试题B：寻找整数"><a href="#例题：蓝桥杯2022年python-B组试题B：寻找整数" class="headerlink" title="例题：蓝桥杯2022年python B组试题B：寻找整数"></a>例题：蓝桥杯2022年python B组试题B：寻找整数</h3><img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220410155944351.png" class="" title="image-20220410155944351">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CRT</span>(<span class="params">aList, mList</span>):</span><br><span class="line">    M = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> mList:</span><br><span class="line">        M = M * i   <span class="comment">#计算M = ∏ mi</span></span><br><span class="line">    <span class="comment">#print(M)</span></span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mList)):</span><br><span class="line">        Mi = M // mList[i]   <span class="comment">#计算Mi</span></span><br><span class="line">        Mi_inverse = gmpy2.invert(Mi, mList[i]) <span class="comment">#计算Mi的逆元</span></span><br><span class="line">        x += aList[i] * Mi * Mi_inverse <span class="comment">#构造x各项</span></span><br><span class="line">    x = x % M</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nList = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">47</span>]</span><br><span class="line">cList = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">0</span>, <span class="number">10</span>,<span class="number">0</span>, <span class="number">18</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">27</span>,<span class="number">22</span>,<span class="number">1</span>, <span class="number">11</span>,<span class="number">5</span>]</span><br><span class="line"><span class="built_in">print</span>(CRT(cList,nList))</span><br><span class="line"><span class="comment"># 2022040920220409</span></span><br></pre></td></tr></table></figure>

<h1 id="各种题型"><a href="#各种题型" class="headerlink" title="各种题型"></a>各种题型</h1><h2 id="基础解法"><a href="#基础解法" class="headerlink" title="基础解法"></a>基础解法</h2><h3 id="rsarsa-（基础解法）"><a href="#rsarsa-（基础解法）" class="headerlink" title="rsarsa （基础解法）"></a>rsarsa （基础解法）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Math <span class="keyword">is</span> cool! Use the RSA algorithm to decode the secret message, c, p, q, <span class="keyword">and</span> e are parameters <span class="keyword">for</span> the RSA algorithm.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p =  <span class="number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span></span><br><span class="line">q =  <span class="number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span></span><br><span class="line">e =  <span class="number">65537</span></span><br><span class="line">c =  <span class="number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span></span><br><span class="line"></span><br><span class="line">Use RSA to find the secret message</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span></span><br><span class="line">q = <span class="number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span></span><br><span class="line">n = p * q</span><br><span class="line">d = gmpy2.invert(e, (q-<span class="number">1</span>)*(p-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>

<ol>
<li>首先我们需要求出d，这样就使得rsa私钥被泄露</li>
</ol>
<p>介绍一个函数gmpy2.invert()函数，专门用来求模反的函数，需要求出的d就是e关于φ(n)的模反</p>
<p>n &#x3D; p1 * p2    &#x3D;&#x3D;&gt;    φ(n) &#x3D; φ(pq) &#x3D; φ(p)φ(q) &#x3D; (p - 1)(q - 1)</p>
<p>ed ≡ 1 (mod φ(n))</p>
<ol start="2">
<li>求出flag，也就是密文，c是明文（被加密之后的），需要求出求得d之后，计算</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c ** d ≡ m (mod n)</span><br></pre></td></tr></table></figure>

<p>转换成代码，m &#x3D; pow(c,d,n)</p>
<h3 id="RSAROOL-在线分解"><a href="#RSAROOL-在线分解" class="headerlink" title="RSAROOL (在线分解)"></a>RSAROOL (在线分解)</h3><p>题目给出公钥{n,e}，因式<a target="_blank" rel="noopener" href="http://www.factordb.com/">分解求p和q</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">18443</span></span><br><span class="line">q = <span class="number">49891</span></span><br></pre></td></tr></table></figure>

<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220323085343219.png" class="" title="image-20220323085343219">

<p>当然，<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39321542/article/details/89287248">因式分解python代码</a>爆破也行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># 对一个数进行因式分解</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorization</span>(<span class="params">num</span>):</span><br><span class="line">    factor = []</span><br><span class="line">    <span class="keyword">while</span> num &gt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num - <span class="number">1</span>):</span><br><span class="line">            k = i + <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> num % k == <span class="number">0</span>:</span><br><span class="line">                factor.append(k)</span><br><span class="line">                num = <span class="built_in">int</span>(num / k)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> factor</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">st = time.perf_counter()</span><br><span class="line"><span class="built_in">print</span>(factorization(<span class="number">920139713</span>))</span><br><span class="line">et = time.perf_counter()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;用时:&quot;</span>, et - st)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [18443, 49891]</span></span><br></pre></td></tr></table></figure>

<p>完整代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">920139713</span></span><br><span class="line">e = <span class="number">19</span></span><br><span class="line">p = <span class="number">18443</span></span><br><span class="line">q = <span class="number">49891</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取数据，需要修改一下文本文档中的值</span></span><br><span class="line"><span class="comment"># lis = []</span></span><br><span class="line"><span class="comment"># with open(&quot;data.txt&quot;,&quot;r&quot;) as f:</span></span><br><span class="line"><span class="comment"># 	lines = f.readlines()</span></span><br><span class="line"><span class="comment"># 	for line in lines:</span></span><br><span class="line"><span class="comment"># 		lis.append(int(line.strip()))</span></span><br><span class="line"></span><br><span class="line">lis = [<span class="number">704796792</span>, <span class="number">752211152</span>, <span class="number">274704164</span>, <span class="number">18414022</span>, <span class="number">368270835</span>, <span class="number">483295235</span>, <span class="number">263072905</span>, <span class="number">459788476</span>, <span class="number">483295235</span>, <span class="number">459788476</span>, <span class="number">663551792</span>, <span class="number">475206804</span>, <span class="number">459788476</span>, <span class="number">428313374</span>, <span class="number">475206804</span>, <span class="number">459788476</span>, <span class="number">425392137</span>, <span class="number">704796792</span>, <span class="number">458265677</span>, <span class="number">341524652</span>, <span class="number">483295235</span>, <span class="number">534149509</span>, <span class="number">425392137</span>, <span class="number">428313374</span>, <span class="number">425392137</span>, <span class="number">341524652</span>, <span class="number">458265677</span>, <span class="number">263072905</span>, <span class="number">483295235</span>, <span class="number">828509797</span>, <span class="number">341524652</span>, <span class="number">425392137</span>, <span class="number">475206804</span>, <span class="number">428313374</span>, <span class="number">483295235</span>, <span class="number">475206804</span>, <span class="number">459788476</span>, <span class="number">306220148</span>]</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lis:</span><br><span class="line">	d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">	flag.append(<span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">pow</span>(i,d,n)))) <span class="comment"># pow计算完成之后需要转成int</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(flag))</span><br><span class="line"><span class="comment"># flag&#123;13212je2ue28fy71w8u87y31r78eu1e2&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="RSA-基础解法"><a href="#RSA-基础解法" class="headerlink" title="RSA (基础解法)"></a>RSA (基础解法)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在一次RSA密钥对生成中，假设p=<span class="number">473398607161</span>，q=<span class="number">4511491</span>，e=<span class="number">17</span></span><br><span class="line">求解出d作为flag提交</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p=<span class="number">473398607161</span></span><br><span class="line">q=<span class="number">4511491</span></span><br><span class="line">e=<span class="number">17</span></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="comment"># flag&#123;125631357777427553&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="ACTF新生赛2020-crypto-rsa0-zip伪加密"><a href="#ACTF新生赛2020-crypto-rsa0-zip伪加密" class="headerlink" title="[ACTF新生赛2020]crypto-rsa0 (zip伪加密)"></a>[ACTF新生赛2020]crypto-rsa0 (zip伪加密)</h3><h4 id="misc-zip伪加密"><a href="#misc-zip伪加密" class="headerlink" title="misc zip伪加密"></a>misc zip伪加密</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/0yst3r-2046/p/11890498.html">参考链接</a>：</p>
<p>zip格式共有三个数据区：压缩源文件数据区&#x2F;压缩源文件目录区&#x2F;压缩源文件目录结束标志</p>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220325163519337.png" class="" title="image-20220325163519337">

<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220325163613358.png" class="" title="image-20220325163613358">

<p>第一区的第三个字节和第二区的第四个字节都显示是否加密的信息.修改两个区域的加密信息，数字是奇数时为加密，数字为偶数时，则不加密。我们修改09 00 改成08 00 </p>
<p>winhex打开查看</p>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220325163340199.png" class="" title="image-20220325163340199">

<p>修改后：</p>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220325170843313.png" class="" title="image-20220325170843313">



<p>在来看这道题，放在winhex中打开，修改一下</p>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220325173216134.png" class="" title="image-20220325173216134">

<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220325173309030.png" class="" title="image-20220325173309030">

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">9018588066434206377240277162476739271386240173088676526295315163990968347022922841299128274551482926490908399237153883494964743436193853978459947060210411</span></span><br><span class="line"><span class="number">7547005673877738257835729760037765213340036696350766324229143613179932145122130685778504062410137043635958208805698698169847293520149572605026492751740223</span></span><br><span class="line"><span class="number">50996206925961019415256003394743594106061473865032792073035954925875056079762626648452348856255575840166640519334862690063949316515750256545937498213476286637455803452890781264446030732369871044870359838568618176586206041055000297981733272816089806014400846392307742065559331874972274844992047849472203390350</span></span><br></pre></td></tr></table></figure>

<p>给了上述的三串数字，猜测是p&#x2F;q&#x2F;n，上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">9018588066434206377240277162476739271386240173088676526295315163990968347022922841299128274551482926490908399237153883494964743436193853978459947060210411</span></span><br><span class="line">q = <span class="number">7547005673877738257835729760037765213340036696350766324229143613179932145122130685778504062410137043635958208805698698169847293520149572605026492751740223</span></span><br><span class="line">c = <span class="number">50996206925961019415256003394743594106061473865032792073035954925875056079762626648452348856255575840166640519334862690063949316515750256545937498213476286637455803452890781264446030732369871044870359838568618176586206041055000297981733272816089806014400846392307742065559331874972274844992047849472203390350</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(number.long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h3 id="GUET-CTF2019-BabyRSA-（z3）"><a href="#GUET-CTF2019-BabyRSA-（z3）" class="headerlink" title="[GUET-CTF2019]BabyRSA （z3）"></a>[GUET-CTF2019]BabyRSA （z3）</h3><p>题目给出了(p+1)(q+1)，我们用z3来解就行</p>
<p>上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">0xe6b1bee47bd63f615c7d0a43c529d219</span></span><br><span class="line">d = <span class="number">0x2dde7fbaed477f6d62838d55b0d0964868cf6efb2c282a5f13e6008ce7317a24cb57aec49ef0d738919f47cdcd9677cd52ac2293ec5938aa198f962678b5cd0da344453f521a69b2ac03647cdd8339f4e38cec452d54e60698833d67f9315c02ddaa4c79ebaa902c605d7bda32ce970541b2d9a17d62b52df813b2fb0c5ab1a5</span></span><br><span class="line">c = <span class="number">0x50ae00623211ba6089ddfae21e204ab616f6c9d294e913550af3d66e85d0c0693ed53ed55c46d8cca1d7c2ad44839030df26b70f22a8567171a759b76fe5f07b3c5a6ec89117ed0a36c0950956b9cde880c575737f779143f921d745ac3bb0e379c05d9a3cc6bf0bea8aa91e4d5e752c7eb46b2e023edbc07d24a7c460a34a9a</span></span><br><span class="line"></span><br><span class="line">p,q  = Ints(<span class="string">&#x27;p q&#x27;</span>)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(p + q == <span class="number">0x1232fecb92adead91613e7d9ae5e36fe6bb765317d6ed38ad890b4073539a6231a6620584cea5730b5af83a3e80cf30141282c97be4400e33307573af6b25e2ea</span>)</span><br><span class="line">s.add((p+<span class="number">1</span>)*(q+<span class="number">1</span>) == <span class="number">0x5248becef1d925d45705a7302700d6a0ffe5877fddf9451a9c1181c4d82365806085fd86fbaab08b6fc66a967b2566d743c626547203b34ea3fdb1bc06dd3bb765fd8b919e3bd2cb15bc175c9498f9d9a0e216c2dde64d81255fa4c05a1ee619fc1fc505285a239e7bc655ec6605d9693078b800ee80931a7a0c84f33c851740</span>)</span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br><span class="line">q = <span class="number">7021910101974335245794950722131367118195509913680915814438898999848788125908122655583911434165700354149914056221915541094395668546921268189522005629523759</span></span><br><span class="line">p = <span class="number">8228801334907462855397256098699556584084854642543205682719705217859576250443629616812386484797164506834582095674143447181804355696220642775619711451990971</span></span><br><span class="line">n = p*q</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># flag&#123;cc7490e-78ab-11e9-b422-8ba97e5da1fd&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="HDCTF2019-bbbbbbrsa-爆破e"><a href="#HDCTF2019-bbbbbbrsa-爆破e" class="headerlink" title="[HDCTF2019]bbbbbbrsa (爆破e)"></a>[HDCTF2019]bbbbbbrsa (爆破e)</h3><p>题目给出了n和q，base64解码一下c，e的范围不是很大，所以直接暴力循环e就可以</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">37421829509887796274897162249367329400988647145613325367337968063341372726061</span></span><br><span class="line">p = <span class="number">177077389675257695042507998165006460849</span></span><br><span class="line">q = n // p</span><br><span class="line">c = <span class="built_in">bytes</span>(<span class="string">&quot;==gMzYDNzIjMxUTNyIzNzIjMyYTM4MDM0gTMwEjNzgTM2UTN4cjNwIjN2QzM5ADMwIDNyMTO4UzM2cTM5kDN2MTOyUTO5YDM0czM3MjM&quot;</span>[::-<span class="number">1</span>],<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">c = <span class="built_in">int</span>(<span class="built_in">str</span>(base64.b64decode(c),<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50000</span>,<span class="number">70000</span>):</span><br><span class="line">	<span class="keyword">if</span> gmpy2.gcd(e,phi) != <span class="number">1</span>:</span><br><span class="line">		<span class="keyword">continue</span></span><br><span class="line">	d = gmpy2.invert(e,phi)</span><br><span class="line">	m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">	flag = <span class="built_in">str</span>(long_to_bytes(m))</span><br><span class="line">	<span class="built_in">print</span>(e,flag)</span><br><span class="line">	<span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> flag <span class="keyword">or</span> <span class="string">&quot;CTF&quot;</span> <span class="keyword">in</span> flag <span class="keyword">or</span> <span class="string">&quot;ctf&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line"> <span class="comment">#flag&#123;rs4_1s_s1mpl3!#&#125;</span></span><br></pre></td></tr></table></figure>

<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220411155034939.png" class="" title="image-20220411155034939">



<h3 id="RSA-公钥解析1"><a href="#RSA-公钥解析1" class="headerlink" title="RSA (公钥解析1)"></a>RSA (公钥解析1)</h3><p>题目给出了一个key后缀文件和一个enc后缀的文件</p>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220323201709159.png" class="" title="image-20220323201709159">



<p>需要进行<a target="_blank" rel="noopener" href="http://www.hiencode.com/pub_asys.html">公钥解析</a>：</p>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220323201920309.png" class="" title="image-20220323201920309">

<p>上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">q = <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># with open(&quot;flag.enc&quot;,&quot;rb&quot;) as f:</span></span><br><span class="line"><span class="comment"># 	s = f.read().strip()</span></span><br><span class="line"><span class="comment"># 	print(number.bytes_to_long(s))</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">29666689760194689065394649908301285751747553295673979512822807815563732622178</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(q-<span class="number">1</span>)*(p-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">m = gmpy2.powmod(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(number.long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h3 id="AFCTF2018-可怜的RSA-公钥解析2-PKCS1-OAEP"><a href="#AFCTF2018-可怜的RSA-公钥解析2-PKCS1-OAEP" class="headerlink" title="[AFCTF2018]可怜的RSA (公钥解析2 + PKCS1_OAEP)"></a>[AFCTF2018]可怜的RSA (公钥解析2 + PKCS1_OAEP)</h3><p>我们也可以使用Crypto.PublicKey.RSA包中的函数来导入给出的public.key文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;public.key&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	pub = RSA.importKey(f.read())</span><br><span class="line">	n = pub.n</span><br><span class="line">	e = pub.e </span><br><span class="line"><span class="built_in">print</span>(n,<span class="string">&quot;\n&quot;</span>,e)</span><br><span class="line"><span class="comment"># n = 79832181757332818552764610761349592984614744432279135328398999801627880283610900361281249973175805069916210179560506497075132524902086881120372213626641879468491936860976686933630869673826972619938321951599146744807653301076026577949579618331502776303983485566046485431039541708467141408260220098592761245010678592347501894176269580510459729633673468068467144199744563731826362102608811033400887813754780282628099443490170016087838606998017490456601315802448567772411623826281747245660954245413781519794295336197555688543537992197142258053220453757666537840276416475602759374950715283890232230741542737319569819793988431443 </span></span><br><span class="line"><span class="comment"># e = 65537</span></span><br></pre></td></tr></table></figure>

<p>分解n,当然可以使用在线网站</p>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220411112407854.png" class="" title="image-20220411112407854">



<p>然后是从flag.ence中读取c，一开始我使用的是平常的m &#x3D; pow(c,d,n)，会出错。</p>
<p>–正解–</p>
<p>打包密钥之后，使用PKCS1_OAEP填充模式来解</p>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220411121804682.png" class="" title="image-20220411121804682">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;public.key&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	pub = RSA.importKey(f.read())</span><br><span class="line">	n = pub.n</span><br><span class="line">	e = pub.e </span><br><span class="line"></span><br><span class="line">q = <span class="number">25478326064937419292200172136399497719081842914528228316455906211693118321971399936004729134841162974144246271486439695786036588117424611881955950996219646807378822278285638261582099108339438949573034101215141156156408742843820048066830863814362379885720395082318462850002901605689761876319151147352730090957556940842144299887394678743607766937828094478336401159449035878306853716216548374273462386508307367713112073004011383418967894930554067582453248981022011922883374442736848045920676341361871231787163441467533076890081721882179369168787287724769642665399992556052144845878600126283968890273067575342061776244939</span></span><br><span class="line">p = <span class="number">3133337</span></span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">key = RSA.importKey(key_info.exportKey())</span><br><span class="line">key = PKCS1_OAEP.new(key)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	c = b64decode(f.read())</span><br><span class="line"></span><br><span class="line">flag = key.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># afctf&#123;R54_|5_$0_B0rin9&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="dp泄露"><a href="#dp泄露" class="headerlink" title="dp泄露"></a>dp泄露</h2><h3 id="RSA2-dp泄露"><a href="#RSA2-dp泄露" class="headerlink" title="RSA2  (dp泄露)"></a>RSA2  (dp泄露)</h3><p>题目给了个dp，也不知道是啥，继续因式分解，求p和q</p>
<p>其中解出来的密文m需要用Crypto.Util.number的库中long_to_bytes()函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line">p = <span class="number">13468634736343473907717969603434376212206335187555458742257940406618189481177835992217885676243155145465521141546915941147336786447889325606555333350540003</span></span><br><span class="line">q = <span class="number">18432009829596386103558375461387837845170621179295293289126504231317130550979989727125205467379713835047300158256398009229511746203459540859429194971855371</span></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>–更新–</p>
<p>查看 前方是否可导？大佬的<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44110537/article/details/106761238">博客</a>之后才发现，dp是用来帮助n来分解p和q的，也就是可以通过dp求得p</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">已知：</span><br><span class="line">ed ≡ <span class="number">1</span> (mod (p-<span class="number">1</span>)(q-<span class="number">1</span>))</span><br><span class="line"><span class="comment"># d 是e关于φ(n)的模逆，所以ed = 1 mod (p-1)(q-1)</span></span><br><span class="line"><span class="comment"># ed = k(p-1)(q-1) +1</span></span><br><span class="line"></span><br><span class="line">dp = d%(p-<span class="number">1</span>)</span><br><span class="line"><span class="comment"># d = k1*(p-1) + dp</span></span><br><span class="line"><span class="comment"># ed = ek1(p-1) + edp</span></span><br><span class="line"></span><br><span class="line">所以：</span><br><span class="line">k2(p-<span class="number">1</span>)(q-<span class="number">1</span>) + ek1(p-<span class="number">1</span>) + e*dp = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">两边对p-<span class="number">1</span>求余：</span><br><span class="line">e*dp % (p-<span class="number">1</span>) = <span class="number">1</span>  </span><br><span class="line"></span><br><span class="line">所以：</span><br><span class="line">e * dp = k(p-<span class="number">1</span>) +<span class="number">1</span> </span><br><span class="line"><span class="comment"># p = (e * dp - 1 / k) + 1</span></span><br><span class="line"></span><br><span class="line">k = (e * dp - <span class="number">1</span>)/(p - <span class="number">1</span>)</span><br><span class="line">  = e(dp/p-<span class="number">1</span>) - <span class="number">1</span>/(p-<span class="number">1</span>)</span><br><span class="line"><span class="comment">#所以 k &lt; e</span></span><br></pre></td></tr></table></figure>

<p>直接引用大佬的原话：</p>
<p>“由dp&#x3D;d%(p-1)我们可以知道dp&lt;p-1,因此我们很容易得到k的上限要小于e，因此只需要遍历range(1,e) ,若n整除p,即可得到p,从而结束循环。”</p>
<p>我们已知e和dp，我们需要遍历循环k，使得k能被（e*dp - 1）整除，若当前k值满足条件，则 p &#x3D; k + 1</p>
<p>引用大佬代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  gmpy2</span><br><span class="line"><span class="keyword">import</span>  rsa</span><br><span class="line"><span class="keyword">import</span>  binascii</span><br><span class="line"><span class="comment"># from Crypto.Util.number import *</span></span><br><span class="line">p=<span class="number">0</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line">dp=<span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line">n=<span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">temp=dp*e</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e) :</span><br><span class="line">    <span class="keyword">if</span> (temp-<span class="number">1</span>)%i==<span class="number">0</span>:</span><br><span class="line">        <span class="comment"># i+1 就是 p的值</span></span><br><span class="line">        x=(temp-<span class="number">1</span>)//i+<span class="number">1</span></span><br><span class="line">        y=n%x</span><br><span class="line">        <span class="keyword">if</span> y==<span class="number">0</span>:</span><br><span class="line">            p=x</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x27;//&#x27;代表向下取整,&#x27;/&#x27;得到的是浮点数</span></span><br><span class="line">q=n//p</span><br><span class="line">d=gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">key=rsa.PrivateKey(n,e,d,p,q)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="comment">#unhexlify()的作用是返回16进制数对应的字符串</span></span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment">#print(long_to_bytes(m))</span></span><br></pre></td></tr></table></figure>



<h2 id="共模攻击"><a href="#共模攻击" class="headerlink" title="共模攻击"></a>共模攻击</h2><p>1ABlades的<a target="_blank" rel="noopener" href="https://1ablades.github.io/2017/08/09/RSA%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/">这篇文章</a>讲的非常详细</p>
<p>假设有一条信息m，使用公钥加密信息（使用了相同的模数n):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c1 = m ** e1 mod n</span><br><span class="line">c2 = m ** e2 mod n</span><br></pre></td></tr></table></figure>

<p>就可以用密钥d1，d2来求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">m = c1 ** d1 mod n</span><br><span class="line">m = c2 ** d2 mod n</span><br></pre></td></tr></table></figure>

<p>因为e1,e2互质，即</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcd(e1,e2)=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>根据扩展欧几里得算法（如果gcd(a, b) &#x3D; c，则存在x, y，使得c &#x3D; ax + by。）</p>
<p>则有</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e1*s1 + e2*s2 = <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>于是我们就能得到以下的公式：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c1 ** s1 * c2 ** s2= m</span><br></pre></td></tr></table></figure>

<p>推算过程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(c1 ** s1 * c2 ** s2) mod n = ((m ** e1 mod n) ** s1 * (m ** e2 mod n) ** s2) mod n</span><br><span class="line">(c1 ** s1 * c2 ** s2) mod n = (m ** (e1 ** s1 + e2 ** s2)) mod n</span><br><span class="line">(c1 ** s1 * c2 ** s2) mod n = (m ** (<span class="number">1</span>)) mod n</span><br><span class="line"> c1 ** s1 * c2 ** s2= m</span><br></pre></td></tr></table></figure>

<p>并且可以知道s1&#x2F;s2皆为整数，且一正一负</p>
<h3 id="RSA3-共模攻击"><a href="#RSA3-共模攻击" class="headerlink" title="RSA3 (共模攻击)"></a>RSA3 (共模攻击)</h3><p>题目中给出了两个e和两个c,一个n</p>
<p>了解原理之后，直接上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"></span><br><span class="line"><span class="comment">#扩展欧几里得算法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exgcd</span>(<span class="params">m, n, x, y</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        x = <span class="number">1</span></span><br><span class="line">        y = <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> (m, x, y)</span><br><span class="line">    a1 = b = <span class="number">1</span></span><br><span class="line">    a = b1 = <span class="number">0</span></span><br><span class="line">    c = m</span><br><span class="line">    d = n</span><br><span class="line">    q = <span class="built_in">int</span>(c / d)</span><br><span class="line">    r = c % d</span><br><span class="line">    <span class="keyword">while</span> r:</span><br><span class="line">        c = d</span><br><span class="line">        d = r</span><br><span class="line">        t = a1</span><br><span class="line">        a1 = a</span><br><span class="line">        a = t - q * a</span><br><span class="line">        t = b1</span><br><span class="line">        b1 = b</span><br><span class="line">        b = t - q * b</span><br><span class="line">        q = <span class="built_in">int</span>(c / d)</span><br><span class="line">        r = c % d</span><br><span class="line">    x = a</span><br><span class="line">    y = b</span><br><span class="line">    <span class="keyword">return</span> (d, x, y)</span><br><span class="line"></span><br><span class="line">c1=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">c2=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">e1=<span class="number">11187289</span></span><br><span class="line">e2=<span class="number">9647291</span></span><br><span class="line">n=<span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">ans=exgcd(e1,e2,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">s1=ans[<span class="number">1</span>]</span><br><span class="line">s2=ans[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#powmod()函数,分数取模也可以直接算</span></span><br><span class="line">m=(gmpy2.powmod(c1,s1,n)*gmpy2.powmod(c2,s2,n))%n</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(number.long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44110537/article/details/106770992">参考链接</a></p>
<h3 id="RSA-amp-what-共模攻击-base64隐写"><a href="#RSA-amp-what-共模攻击-base64隐写" class="headerlink" title="RSA &amp; what (共模攻击+base64隐写)"></a>RSA &amp; what (共模攻击+base64隐写)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment">#扩展欧几里得算法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exgcd</span>(<span class="params">m, n, x, y</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        x = <span class="number">1</span></span><br><span class="line">        y = <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> (m, x, y)</span><br><span class="line">    a1 = b = <span class="number">1</span></span><br><span class="line">    a = b1 = <span class="number">0</span></span><br><span class="line">    c = m</span><br><span class="line">    d = n</span><br><span class="line">    q = <span class="built_in">int</span>(c / d)</span><br><span class="line">    r = c % d</span><br><span class="line">    <span class="keyword">while</span> r:</span><br><span class="line">        c = d</span><br><span class="line">        d = r</span><br><span class="line">        t = a1</span><br><span class="line">        a1 = a</span><br><span class="line">        a = t - q * a</span><br><span class="line">        t = b1</span><br><span class="line">        b1 = b</span><br><span class="line">        b = t - q * b</span><br><span class="line">        q = <span class="built_in">int</span>(c / d)</span><br><span class="line">        r = c % d</span><br><span class="line">    x = a</span><br><span class="line">    y = b</span><br><span class="line">    <span class="keyword">return</span> (d, x, y)</span><br><span class="line"></span><br><span class="line">n=<span class="number">785095419718268286866508214304816985447077293766819398728046411166917810820484759314291028976498223661229395009474063173705162627037610993539617751905443039278227583504604808251931083818909467613277587874545761074364427549966555519371913859875313577282243053150056274667798049694695703660313532933165449312949725581708965417273055582216295994587600975970124811496270080896977076946000102701030260990598181466447208054713391526313700681341093922240317428173599031624125155188216489476825606191521182034969120343287691181300399683515414809262700457525876691808180257730351707673660380698973884642306898810000633684878715402823143549139850732982897459698089649561190746850698130299458080255582312696873149210028240898137822888492559957665067936573356367589784593119016624072433872744537432005911668494455733330689385141214653091888017782049043434862620306783436169856564175929871100669913438980899219579329897753233450934770193915434791427728636586218049874617231705308003720066269312729135764175698611068808404054125581540114956463603240222497919384691718744014002554201602395969312999994159599536026359879060218056496345745457493919771337601177449899066579857630036350871090452649830775029695488575574985078428560054253180863725364147</span></span><br><span class="line">e1 = <span class="number">1697</span></span><br><span class="line">e2 = <span class="number">599</span></span><br><span class="line">c1_1 = <span class="number">412629526163150748619328091306742267675740578011800062477174189782151273970783531227579758540364970485350157944321579108232221072397135934034064481497887079641131808838242743811511451355024436983050572020925065644355566434625618133203024215941534926113892937988520918939061441606915556516246057349589921494351383160036280826024605351878408056180907759973804117263002554923041750587548819746346813966673034182913325507826219961923932100526305289894965216608254252188398580139545189681875824089456195044984585824938384521905334289906422454152976834867304693292466676355760173232407753256256317546190171995276258924613533179898467683358934751999655196790168438343198229183747091108262988777659858609744709324571850262293294975336628234767258858873839342596887193772615000676401522431518310648303975593582965021189182246986957349253156736526071639973844039068996404290548474640668851856078201093335425412842295604919065487301340901573809617549185106072798799159726375235125260509158832996701927878713084753334549129580912412168594170659605421750204835970231909591063407612779337478065175988365401590396247576709343727196106058477166945670117868989025903023998142850338956985816131805349549059377047477131270847579095628384569645636821650</span></span><br><span class="line">c1_2 = <span class="number">494644347943710545224678831941589086572700792465459558770782213550069709458568349686998660541810166872034041584767487150140111151788221460027897193248273461607411027815984883969396220626358625041781558277804930212654296704055890683796941327712758797770820006623289146990000114915293539639766846910274034245607746230740851938158390562286057002223177609606376329007676845450142537930798148258428701466415483232670659815791064681384406494388237742330786225557303988025468036820082959712050733095860546860468575857084616069132051094882919253745234762029759124776348047587755897123575123506976140900565238840752841856713613368250071926171873213897914794115466890719123299469964019450899291410760762179836946570945555295288184698184555018368687708432612286248476073758067175481771199066581572870175460016017100414479346437034291784837132240891321931601494414908927713208448927221095745802380014441841139882391378410438764884597938773868771896252329517440068673532468372840830510218585255432000690265226016573313570977945083879214961394087065558376158826938257664840570952233832852869328785568175434516247720356520242602299510374317488182738732700078879665745909603766482100138001417023680647717824323143388857817595766172152883484274718248</span></span><br><span class="line">c1_3 = <span class="number">152942283599728307168144137370127212672611894072038732126041098102628831053000986759260271210671922070555948023688596575415822984026159010574404359474670428678518262175033880513984372909748992727828381694416776740981021730545374002974037896534944567124543272737618380646771071804878796585983783360553761828325817820260204820004421979881871027255562690952334900616675606524933557440263648233514757200263521499508373975003431306847453046714027687108396945719803444444954079308404947126216395526551292104722047878178373207886033071857277857997932255251315982837892164421298202073945919187779856785892717251746704537315003771369737854896595170485152591013676942418134278534037654467840633528916812275267230155352077736583130992587670941654695382287023971261529987384520843829695778029311786431227409189019205818351911572757145556993606643464336196802350204616056286497246016800105003143046120608673496196758720552776772796609670537056331996894322779267635281472481559819839042424017171718303214059720568484939239370144038161541354254182769979771948759413102933987773401644506930205164891773826513161783736386604783484446345744957119469799231796368324927570694496679453313927562345656690240414624431304646248599226046524702364131095964335</span></span><br><span class="line">c1_4 = <span class="number">79717988936247951265489157583697956031893477858854186991051529161879478488281744062318600470906120960002282886511477294555606503083169449335174864424180701080203993329996226566203834693869525797695969610065991941396723959032680019082506816443041598300477625793433080664346470586416385854692124426348587211026568667694805849554780794033764714016521711467557284846737236374990121316809833819996821592832639024026411520407330206281265390130763948165694574512140518775603040182029818771866749548761938870605590174330887949847420877829240131490902432602005681085180807294176837646062568094875766945890382971790015490163385088144673549085079635083262975154206269679142412897438231719704933258660779310737302680265445437771977749959110744959368586293082016067927548564967400845992380076107522755566531760628823374519718763740378295585535591752887339222947397184116326706799921515431185636740825707782742373783475781052674257292910213843986132987466810027275052416774693363446184518901899202502828670309452622347532932678874990809930682575738653876289384151496807194146308614368821006660626870989784697045160231069428458961107751207771093777394616856305293335603892178327520756554333365975114235981173451368131680404850832773147333013716920</span></span><br><span class="line">c1_5 = <span class="number">123111353650401158556639983459870663057297871992927053886971224773529636525110628183715748795987525113177540092814119928708272290370336537110381023134637759740716140969662183269370676630325583385284994943164692397459103195434968057377474610500216801375394703781249039351368816958227409657934091741509357152328382960684515093945552479461382281913961956745154260686029997827565075768703774895750561575155143606297116391666385705899138085693913246313778033627210312268959737394553510894720099165193981333775907531107232556909478156441457899797515694348816961762796703443502856101079430585547997496001098926600499728389113862894833789669213630332988693669889340482430613291490613803204484751470676686041002772556117213612152322606737150858116122936539131795111263513114569794532805886643087299918196635113037777138666914296986040549274559835214505300618256105508764026461518876579387159881983544667258537064954616097750399839661065797883103731694314852301848272092388637114950059216922969842082648527035538090054093890365647676119748995243416337805666557501345234056968476142608491830438065401219751688687373709390057521910942736632126729711606256158399963682990881473178216060827021373776598901281958527655543318413664277921492723185984</span></span><br><span class="line">c1_6 = <span class="number">36869806815936046911848195817405817350259890871483063184373728397968909458432625046025376290214729914038387534731762237978339011724858818860181178811639468996206294711495853807311240013786226884265118119546377272154555615363105236192878292703331473547623021744317034819416624562896226194523639793573028006666236271812390759036235867495803255905843636447252225413871038762657801345647584493917576263471587347202664391908570140389126903204602391093990827188675090199750617303773574821926387194478875191828814971296674530519321530805302667925998711835019806761133078403281404889374663875077339168901297819436499920958268483684335998301056068380228873524800383911402490807139268964095165069610454677558808756444381542173782815227920906224931028457073652453777424387873533280455944646592996920617956675786286711447540353883400282402551158169958389450168079568459656526911857835375748015814860506707921852997096156275804955989964215077733621769938075413007804223217091604613132253046399456747595300404564172224333936405545921819654435437072133387523533568472443532200069133022979195685683508297337961701169394794966256415112246587706103819620428258245999539040721929317130088874161577093962579487428358736401687123174207198251449851429295</span></span><br><span class="line"></span><br><span class="line">c2_1 = <span class="number">592169079372093727306100216011395857825646323934289480976073629037543922902098120901138454462177159996376654176248238979132528728327590301098966139983157980612320563496546128644967731000716697705104079039156276714872147463350811303393260622707024952543509891692246246277965823414460326811240048060543656588688604452353899779068825120910282167004715339763187734797180326976132213325054697165320479166356562518029805927741656605174809726397565772271562066078076105491745903986597877400370206718954975288721072048333678609055008135809089304229015364348490924974097403734627265297637171818849461766523691595241613878709865506436588268999163342945070495338153600520537498539457396582804692959296612715752573140296135784933206146091436617979599749774330699946637591406356289409716084034451049094715202196203486088368791744107629271647320273259836915312794297246589501008666299165717722507702866033454215783240025504356157664454861755286285777763585177751796252655008206383024707883077513745863312079349790275094080707502392866946325796914450602264462588722052297430827681750827349094323968337670311272933785838850649376115667223821665435911506351891489985627506615492005617098615432522564204152887767244129985681083657783356557756654335186</span></span><br><span class="line">c2_2 = <span class="number">373940646416832740878733255707567753033716583448402000789202767511920210382830343955553654111486728333980557319799362514960627879016797491389812007768832730979916230647641872759001906846747977631675704310179448857128160385701185892914523053669366534408863734305635222625590986006420486092550427301086984563126480814987024980594613542978310129247678826691418335300577577527951623696426435497835228167084738007750914270251001921329521479047662848650808989996085600197309361410863238526802127877523767262921515150984998560136647154865791163316503073285223966216441025637452229043510097323724381056976302288136843260163922706692913035222445496716008888946581535004546355744211680390731257309941902587303353139951102244865270295414474488798335404630458489706639805186573874814586736746232358849677477533671968344154242963289415569487579895910660999043578737461300406937828924818002658292769882181668784501439254131996848948120781562158861495883827848139425862249576454689133681009549361314460818658995959098228995702202268649635363105549975932395335076521137604288520082040121286614922986554652700056148966514178935952363036963217619879899671383604638416567950421350546204434902113156720006282720889591288850271076074941927715678306057176</span></span><br><span class="line">c2_3 = <span class="number">527630926460622936571385649841758214453416849039412401087443444317101857090904711485538107058823056085840539073345920792871368232355475394571098380596835468509997340505604333730547799560998822989747473780307779717715522787724471724766494090783971030594671013168209717686720448579582618378459567979027822271918653169622428153856198907810040224340270362413432495029672123261375400927159831537760709974778708160583252613784358234858583174544777979242887938827573604837766801998381379999076416444683891078093889686055482709838668356120916040352123019019255084513769603803814947774554028717814638951416291274696771515474086351482107953150253616922787262398450376249126999644026382478413080973933173079111305142716133389111399235545279259017424722601848670061556859163943895466553927946412523750166582734005733378328468250568944945912238495877929717101722314678120172228493787964904072583905721074766711732215815561012960394537195757832959268603775112932862105945720853959285187521763557915356428113876893276879775603217718981852114599706699524551973934242045743122744146361596971245034059345915315495232135483464496114770357536576200511490922413208178149869347802988786513451486411409887164516065062084917556120712465074206435831498113605</span></span><br><span class="line">c2_4 = <span class="number">8786437178698940322877889807009957616777351844979869726962356553244050911283984280960665761649310895230455072977431415102053987735969326553978994853162483051544656873294555116009995592043183070208706258164840540599577072097104139505857517663273929851202628854185356185647194933800084230503413037858893307713037149307477830536758283681093517617820169181420796105338681582230788318108428132051793761014952837330456262272828627355701464740578197966332613127307037255647286823496355917642353327912440019621838870388091824748629637425759125214639885130163183752378908729773517053259212525494555880921052679512582051516604297098204363525081039382358483926727008679327719083138865969291911863630382097160230960738043575559330264018212774424527719153248563876760067931499029384228993253862501939337758514377472011933279273181144830381169849387893799390755052093069179605579485710343655570028592595882436632426527654452895431758715126580164902410286422637215098476316042367916779431052267545769495994723721129943616294879642305545894912914632980455031755879087401575310699765408473606166727137934224515998416625122213056208800095077933103150699272650116151674702438463062734472714004926103668378506804002740045547964716693536349447660850580</span></span><br><span class="line">c2_5 = <span class="number">205314962204511500352858372254132533167549960825498949618514841570703199264867431580754674275990554478140637041427842111391746883257447120035947621456863890934062044010795443059281736346976175772415034838334682726635263432655537852942177334888025283748611576171534251461847349566505628290587224150869640386437623371249743165260396675220683302142805646368906930575140628610003919131999295855501215111393294818218799982703289304596989070475000081175510085432290264502023736899104746316830742226946395027029820825791831870857382647221322734605026210073093918331247494307555600335550942340526536281372036612138713881098866303169425501998978400008829873080965592009371176208668290074288903681417933657472279670688597862835627506340169978450918788539270346340385928840299573889292189531738082166408734046381423516467694328971385421907314814283489322619386570046183556572383980777277173349209330683424343658179781015072259378576130442222984963071166207642585589822061597282467850868050737957726423713761694231879497037175627546427449730638216214828463003483408928375620315193290871300316930139260521382533279767663839278693750409419493280753368451508802658272220767624766390639285308433607255253282702383762149755935518922075584637512494819</span></span><br><span class="line">c2_6 = <span class="number">271453634732502613378948161256470991260052778799128789839624515809143527363206813219580098196957510291648493698144497567392065251244844074992734669490296293997386198359280316655904691639367482203210051809125904410431506925238374843856343243276508280641059690938930957474434518308646618959004216831130099873532714372402117796666560677624822509159287675432413016478948594640872091688482149004426363946048517480052906306290126242866034249478040406351940088231081456109195799442996799641647167552689564613346415247906852055588498305665928450828756152103096629274760601528737639415361467941349982213641454967962723875032638267311935042334584913897338553953961877439389588793074211502597238465542889335363559052368180212013206172712561221352833891640659020253527584706465205486408990762759230842192028381048563437724528409174790022752557512795782713125166158329880702730769957185428522011430144840232256419113631679343171680631630775266488738173707357123139368825087043785842169049943237537188129367275730984789479909103397937113837824575137021012333461552176687570010445744268373840742899299977372834041925102853718964831225250407279578465008537542659673685686242773379131904890865110699190451534445434533919127658976874721029586168106207</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c1=<span class="number">412629526163150748619328091306742267675740578011800062477174189782151273970783531227579758540364970485350157944321579108232221072397135934034064481497887079641131808838242743811511451355024436983050572020925065644355566434625618133203024215941534926113892937988520918939061441606915556516246057349589921494351383160036280826024605351878408056180907759973804117263002554923041750587548819746346813966673034182913325507826219961923932100526305289894965216608254252188398580139545189681875824089456195044984585824938384521905334289906422454152976834867304693292466676355760173232407753256256317546190171995276258924613533179898467683358934751999655196790168438343198229183747091108262988777659858609744709324571850262293294975336628234767258858873839342596887193772615000676401522431518310648303975593582965021189182246986957349253156736526071639973844039068996404290548474640668851856078201093335425412842295604919065487301340901573809617549185106072798799159726375235125260509158832996701927878713084753334549129580912412168594170659605421750204835970231909591063407612779337478065175988365401590396247576709343727196106058477166945670117868989025903023998142850338956985816131805349549059377047477131270847579095628384569645636821650</span></span><br><span class="line">c2=<span class="number">592169079372093727306100216011395857825646323934289480976073629037543922902098120901138454462177159996376654176248238979132528728327590301098966139983157980612320563496546128644967731000716697705104079039156276714872147463350811303393260622707024952543509891692246246277965823414460326811240048060543656588688604452353899779068825120910282167004715339763187734797180326976132213325054697165320479166356562518029805927741656605174809726397565772271562066078076105491745903986597877400370206718954975288721072048333678609055008135809089304229015364348490924974097403734627265297637171818849461766523691595241613878709865506436588268999163342945070495338153600520537498539457396582804692959296612715752573140296135784933206146091436617979599749774330699946637591406356289409716084034451049094715202196203486088368791744107629271647320273259836915312794297246589501008666299165717722507702866033454215783240025504356157664454861755286285777763585177751796252655008206383024707883077513745863312079349790275094080707502392866946325796914450602264462588722052297430827681750827349094323968337670311272933785838850649376115667223821665435911506351891489985627506615492005617098615432522564204152887767244129985681083657783356557756654335186</span></span><br><span class="line">e1=<span class="number">1697</span></span><br><span class="line">e2=<span class="number">599</span></span><br><span class="line"></span><br><span class="line">ans=exgcd(e1,e2,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">s1=ans[<span class="number">1</span>]</span><br><span class="line">s2=ans[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">c1 = [c1_1,c1_2,c1_3,c1_4,c1_5,c1_6]</span><br><span class="line">c2 = [c2_1,c2_2,c2_3,c2_4,c2_5,c2_6]</span><br><span class="line"></span><br><span class="line"><span class="comment">#powmod()函数,分数取模也可以直接算</span></span><br><span class="line">bases = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c1)):</span><br><span class="line">    m = (gmpy2.powmod(c1[i],s1,n)*gmpy2.powmod(c2[i],s2,n)) % n</span><br><span class="line">    bases += <span class="built_in">str</span>(long_to_bytes(m),<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(flag.replace(&quot;\n&quot;,&quot;&#x27;,&#x27;&quot;))</span></span><br><span class="line">bases = [<span class="string">&#x27;VEhJUz==&#x27;</span>,<span class="string">&#x27;RkxBR3==&#x27;</span>,<span class="string">&#x27;SVN=&#x27;</span>,<span class="string">&#x27;SElEREVOLo==&#x27;</span>,<span class="string">&#x27;Q0FO&#x27;</span>,<span class="string">&#x27;WU9V&#x27;</span>,<span class="string">&#x27;RklORM==&#x27;</span>,<span class="string">&#x27;SVT=&#x27;</span>,<span class="string">&#x27;T1VUP4==&#x27;</span>,<span class="string">&#x27;RE8=&#x27;</span>,<span class="string">&#x27;WU9V&#x27;</span>,<span class="string">&#x27;S05PV9==&#x27;</span>,<span class="string">&#x27;QkFTRTY0P5==&#x27;</span>,<span class="string">&#x27;WW91bmdD&#x27;</span>,<span class="string">&#x27;VEhJTku=&#x27;</span>,<span class="string">&#x27;WU9V&#x27;</span>,<span class="string">&#x27;QVJF&#x27;</span>,<span class="string">&#x27;Tk9U&#x27;</span>,<span class="string">&#x27;VEhBVE==&#x27;</span>,<span class="string">&#x27;RkFNSUxJQVI=&#x27;</span>,<span class="string">&#x27;V0lUSO==&#x27;</span>,<span class="string">&#x27;QkFTRTY0Lh==&#x27;</span>,<span class="string">&#x27;QmFzZTY0&#x27;</span>,<span class="string">&#x27;aXO=&#x27;</span>,<span class="string">&#x27;YW==&#x27;</span>,<span class="string">&#x27;Z3JvdXA=&#x27;</span>,<span class="string">&#x27;b2b=&#x27;</span>,<span class="string">&#x27;c2ltaWxhcn==&#x27;</span>,<span class="string">&#x27;YmluYXJ5LXRvLXRleHR=&#x27;</span>,<span class="string">&#x27;ZW5jb2Rpbme=&#x27;</span>,<span class="string">&#x27;c2NoZW1lc0==&#x27;</span>,<span class="string">&#x27;dGhhdD==&#x27;</span>,<span class="string">&#x27;cmVwcmVzZW50&#x27;</span>,<span class="string">&#x27;YmluYXJ5&#x27;</span>,<span class="string">&#x27;ZGF0YW==&#x27;</span>,<span class="string">&#x27;aW5=&#x27;</span>,<span class="string">&#x27;YW6=&#x27;</span>,<span class="string">&#x27;QVNDSUl=&#x27;</span>,<span class="string">&#x27;c3RyaW5n&#x27;</span>,<span class="string">&#x27;Zm9ybWF0&#x27;</span>,<span class="string">&#x27;Ynk=&#x27;</span>,<span class="string">&#x27;dHJhbnNsYXRpbmd=&#x27;</span>,<span class="string">&#x27;aXS=&#x27;</span>,<span class="string">&#x27;aW50b1==&#x27;</span>,<span class="string">&#x27;YT==&#x27;</span>,<span class="string">&#x27;cmFkaXgtNjQ=&#x27;</span>,<span class="string">&#x27;cmVwcmVzZW50YXRpb24u&#x27;</span>,<span class="string">&#x27;VGhl&#x27;</span>,<span class="string">&#x27;dGVybc==&#x27;</span>,<span class="string">&#x27;QmFzZTY0&#x27;</span>,<span class="string">&#x27;b3JpZ2luYXRlc8==&#x27;</span>,<span class="string">&#x27;ZnJvbd==&#x27;</span>,<span class="string">&#x27;YY==&#x27;</span>,<span class="string">&#x27;c3BlY2lmaWN=&#x27;</span>,<span class="string">&#x27;TUlNRT==&#x27;</span>,<span class="string">&#x27;Y29udGVudI==&#x27;</span>,<span class="string">&#x27;dHJhbnNmZXI=&#x27;</span>,<span class="string">&#x27;ZW5jb2Rpbmcu&#x27;</span>,<span class="string">&#x27;VGhl&#x27;</span>,<span class="string">&#x27;cGFydGljdWxhct==&#x27;</span>,<span class="string">&#x27;c2V0&#x27;</span>,<span class="string">&#x27;b2b=&#x27;</span>,<span class="string">&#x27;NjR=&#x27;</span>,<span class="string">&#x27;Y2hhcmFjdGVyc5==&#x27;</span>,<span class="string">&#x27;Y2hvc2Vu&#x27;</span>,<span class="string">&#x27;dG+=&#x27;</span>,<span class="string">&#x27;cmVwcmVzZW50&#x27;</span>,<span class="string">&#x27;dGhl&#x27;</span>,<span class="string">&#x27;NjQ=&#x27;</span>,<span class="string">&#x27;cGxhY2UtdmFsdWVz&#x27;</span>,<span class="string">&#x27;Zm9y&#x27;</span>,<span class="string">&#x27;dGhl&#x27;</span>,<span class="string">&#x27;YmFzZd==&#x27;</span>,<span class="string">&#x27;dmFyaWVz&#x27;</span>,<span class="string">&#x27;YmV0d2Vlbt==&#x27;</span>,<span class="string">&#x27;aW1wbGVtZW50YXRpb25zLp==&#x27;</span>,<span class="string">&#x27;VGhl&#x27;</span>,<span class="string">&#x27;Z2VuZXJhbI==&#x27;</span>,<span class="string">&#x27;c3RyYXRlZ3n=&#x27;</span>,<span class="string">&#x27;aXO=&#x27;</span>,<span class="string">&#x27;dG9=&#x27;</span>,<span class="string">&#x27;Y2hvb3Nl&#x27;</span>,<span class="string">&#x27;NjR=&#x27;</span>,<span class="string">&#x27;Y2hhcmFjdGVyc5==&#x27;</span>,<span class="string">&#x27;dGhhdA==&#x27;</span>,<span class="string">&#x27;YXJl&#x27;</span>,<span class="string">&#x27;Ym90aN==&#x27;</span>,<span class="string">&#x27;bWVtYmVyc5==&#x27;</span>,<span class="string">&#x27;b2a=&#x27;</span>,<span class="string">&#x27;YS==&#x27;</span>,<span class="string">&#x27;c3Vic2V0&#x27;</span>,<span class="string">&#x27;Y29tbW9u&#x27;</span>,<span class="string">&#x27;dG8=&#x27;</span>,<span class="string">&#x27;bW9zdM==&#x27;</span>,<span class="string">&#x27;ZW5jb2RpbmdzLA==&#x27;</span>,<span class="string">&#x27;YW5k&#x27;</span>,<span class="string">&#x27;YWxzb8==&#x27;</span>,<span class="string">&#x27;cHJpbnRhYmxlLg==&#x27;</span>,<span class="string">&#x27;VGhpc9==&#x27;</span>,<span class="string">&#x27;Y29tYmluYXRpb25=&#x27;</span>,<span class="string">&#x27;bGVhdmVz&#x27;</span>,<span class="string">&#x27;dGhl&#x27;</span>,<span class="string">&#x27;ZGF0YW==&#x27;</span>,<span class="string">&#x27;dW5saWtlbHk=&#x27;</span>,<span class="string">&#x27;dG/=&#x27;</span>,<span class="string">&#x27;YmV=&#x27;</span>,<span class="string">&#x27;bW9kaWZpZWS=&#x27;</span>,<span class="string">&#x27;aW5=&#x27;</span>,<span class="string">&#x27;dHJhbnNpdE==&#x27;</span>,<span class="string">&#x27;dGhyb3VnaN==&#x27;</span>,<span class="string">&#x27;aW5mb3JtYXRpb26=&#x27;</span>,<span class="string">&#x27;c3lzdGVtcyw=&#x27;</span>,<span class="string">&#x27;c3VjaN==&#x27;</span>,<span class="string">&#x27;YXM=&#x27;</span>,<span class="string">&#x27;RS1tYWlsLD==&#x27;</span>,<span class="string">&#x27;dGhhdA==&#x27;</span>,<span class="string">&#x27;d2VyZQ==&#x27;</span>,<span class="string">&#x27;dHJhZGl0aW9uYWxseQ==&#x27;</span>,<span class="string">&#x27;bm90&#x27;</span>,<span class="string">&#x27;OC1iaXQ=&#x27;</span>,<span class="string">&#x27;Y2xlYW4uWzFd&#x27;</span>,<span class="string">&#x27;Rm9y&#x27;</span>,<span class="string">&#x27;ZXhhbXBsZSw=&#x27;</span>,<span class="string">&#x27;TUlNRSdz&#x27;</span>,<span class="string">&#x27;QmFzZTY0&#x27;</span>,<span class="string">&#x27;aW1wbGVtZW50YXRpb24=&#x27;</span>,<span class="string">&#x27;dXNlcw==&#x27;</span>,<span class="string">&#x27;QahDWiw=&#x27;</span>,<span class="string">&#x27;YahDeiw=&#x27;</span>,<span class="string">&#x27;YW5k&#x27;</span>,<span class="string">&#x27;MKhDOQ==&#x27;</span>,<span class="string">&#x27;Zm9y&#x27;</span>,<span class="string">&#x27;dGhl&#x27;</span>,<span class="string">&#x27;Zmlyc3Q=&#x27;</span>,<span class="string">&#x27;NjI=&#x27;</span>,<span class="string">&#x27;dmFsdWVzLg==&#x27;</span>,<span class="string">&#x27;T3RoZXI=&#x27;</span>,<span class="string">&#x27;dmFyaWF0aW9ucw==&#x27;</span>,<span class="string">&#x27;c2hhcmU=&#x27;</span>,<span class="string">&#x27;dGhpcw==&#x27;</span>,<span class="string">&#x27;cHJvcGVydHk=&#x27;</span>,<span class="string">&#x27;YnV0&#x27;</span>,<span class="string">&#x27;ZGlmZmVy&#x27;</span>,<span class="string">&#x27;aW4=&#x27;</span>,<span class="string">&#x27;dGhl&#x27;</span>,<span class="string">&#x27;c3ltYm9scw==&#x27;</span>,<span class="string">&#x27;Y2hvc2Vu&#x27;</span>,<span class="string">&#x27;Zm9y&#x27;</span>,<span class="string">&#x27;dGhl&#x27;</span>,<span class="string">&#x27;bGFzdA==&#x27;</span>,<span class="string">&#x27;dHdv&#x27;</span>,<span class="string">&#x27;dmFsdWVzOw==&#x27;</span>,<span class="string">&#x27;YW4=&#x27;</span>,<span class="string">&#x27;ZXhhbXBsZQ==&#x27;</span>,<span class="string">&#x27;aXM=&#x27;</span>,<span class="string">&#x27;VVRGLTcu&#x27;</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> bases:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(base64.b64decode(i))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot; &quot;</span>)</span><br><span class="line"><span class="comment"># THIS FLAG IS HIDDEN. CAN YOU FIND IT OUT? DO YOU KNOW BASE64? YoungC THINK YOU ARE NOT THAT FAMILIAR WITH BASE64. Base64 is a group of similar binary-to-text encoding schemes that represent binary data in an ASCII string format by translating it into a radix-64 representation. The term Base64 originates from a specific MIME content transfer encoding. The particular set of 64 characters chosen to represent the 64 place-values for the base varies between implementations. The general strategy is to choose 64 characters that are both members of a subset common to most encodings, and also printable. This combination leaves the data unlikely to be modified in transit through information systems, such as E-mail, that were traditionally not 8-bit clean.[1] For example, MIME&#x27;s Base64 implementation uses A\xa8CZ, a\xa8Cz, and 0\xa8C9 for the first 62 values. Other variations share this property but differ in the symbols chosen for the last two values; an example is UTF-7. </span></span><br></pre></td></tr></table></figure>

<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220410210145314.png" class="" title="image-20220410210145314">

<p>以为通过共模攻击求解bases，再base64解码就可以了，没想到还有隐藏的flag，没辙了</p>
<p>–更新–</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41956187/article/details/105592471">https://blog.csdn.net/qq_41956187/article/details/105592471</a></p>
<p>没想到竟然有base64隐写，颠覆了我的认知，怪不得会有那么多的换行……</p>
<p>完整代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment">#扩展欧几里得算法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exgcd</span>(<span class="params">m, n, x, y</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        x = <span class="number">1</span></span><br><span class="line">        y = <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> (m, x, y)</span><br><span class="line">    a1 = b = <span class="number">1</span></span><br><span class="line">    a = b1 = <span class="number">0</span></span><br><span class="line">    c = m</span><br><span class="line">    d = n</span><br><span class="line">    q = <span class="built_in">int</span>(c / d)</span><br><span class="line">    r = c % d</span><br><span class="line">    <span class="keyword">while</span> r:</span><br><span class="line">        c = d</span><br><span class="line">        d = r</span><br><span class="line">        t = a1</span><br><span class="line">        a1 = a</span><br><span class="line">        a = t - q * a</span><br><span class="line">        t = b1</span><br><span class="line">        b1 = b</span><br><span class="line">        b = t - q * b</span><br><span class="line">        q = <span class="built_in">int</span>(c / d)</span><br><span class="line">        r = c % d</span><br><span class="line">    x = a</span><br><span class="line">    y = b</span><br><span class="line">    <span class="keyword">return</span> (d, x, y)</span><br><span class="line"></span><br><span class="line">n=<span class="number">785095419718268286866508214304816985447077293766819398728046411166917810820484759314291028976498223661229395009474063173705162627037610993539617751905443039278227583504604808251931083818909467613277587874545761074364427549966555519371913859875313577282243053150056274667798049694695703660313532933165449312949725581708965417273055582216295994587600975970124811496270080896977076946000102701030260990598181466447208054713391526313700681341093922240317428173599031624125155188216489476825606191521182034969120343287691181300399683515414809262700457525876691808180257730351707673660380698973884642306898810000633684878715402823143549139850732982897459698089649561190746850698130299458080255582312696873149210028240898137822888492559957665067936573356367589784593119016624072433872744537432005911668494455733330689385141214653091888017782049043434862620306783436169856564175929871100669913438980899219579329897753233450934770193915434791427728636586218049874617231705308003720066269312729135764175698611068808404054125581540114956463603240222497919384691718744014002554201602395969312999994159599536026359879060218056496345745457493919771337601177449899066579857630036350871090452649830775029695488575574985078428560054253180863725364147</span></span><br><span class="line">e1 = <span class="number">1697</span></span><br><span class="line">e2 = <span class="number">599</span></span><br><span class="line">c1_1 = <span class="number">412629526163150748619328091306742267675740578011800062477174189782151273970783531227579758540364970485350157944321579108232221072397135934034064481497887079641131808838242743811511451355024436983050572020925065644355566434625618133203024215941534926113892937988520918939061441606915556516246057349589921494351383160036280826024605351878408056180907759973804117263002554923041750587548819746346813966673034182913325507826219961923932100526305289894965216608254252188398580139545189681875824089456195044984585824938384521905334289906422454152976834867304693292466676355760173232407753256256317546190171995276258924613533179898467683358934751999655196790168438343198229183747091108262988777659858609744709324571850262293294975336628234767258858873839342596887193772615000676401522431518310648303975593582965021189182246986957349253156736526071639973844039068996404290548474640668851856078201093335425412842295604919065487301340901573809617549185106072798799159726375235125260509158832996701927878713084753334549129580912412168594170659605421750204835970231909591063407612779337478065175988365401590396247576709343727196106058477166945670117868989025903023998142850338956985816131805349549059377047477131270847579095628384569645636821650</span></span><br><span class="line">c1_2 = <span class="number">494644347943710545224678831941589086572700792465459558770782213550069709458568349686998660541810166872034041584767487150140111151788221460027897193248273461607411027815984883969396220626358625041781558277804930212654296704055890683796941327712758797770820006623289146990000114915293539639766846910274034245607746230740851938158390562286057002223177609606376329007676845450142537930798148258428701466415483232670659815791064681384406494388237742330786225557303988025468036820082959712050733095860546860468575857084616069132051094882919253745234762029759124776348047587755897123575123506976140900565238840752841856713613368250071926171873213897914794115466890719123299469964019450899291410760762179836946570945555295288184698184555018368687708432612286248476073758067175481771199066581572870175460016017100414479346437034291784837132240891321931601494414908927713208448927221095745802380014441841139882391378410438764884597938773868771896252329517440068673532468372840830510218585255432000690265226016573313570977945083879214961394087065558376158826938257664840570952233832852869328785568175434516247720356520242602299510374317488182738732700078879665745909603766482100138001417023680647717824323143388857817595766172152883484274718248</span></span><br><span class="line">c1_3 = <span class="number">152942283599728307168144137370127212672611894072038732126041098102628831053000986759260271210671922070555948023688596575415822984026159010574404359474670428678518262175033880513984372909748992727828381694416776740981021730545374002974037896534944567124543272737618380646771071804878796585983783360553761828325817820260204820004421979881871027255562690952334900616675606524933557440263648233514757200263521499508373975003431306847453046714027687108396945719803444444954079308404947126216395526551292104722047878178373207886033071857277857997932255251315982837892164421298202073945919187779856785892717251746704537315003771369737854896595170485152591013676942418134278534037654467840633528916812275267230155352077736583130992587670941654695382287023971261529987384520843829695778029311786431227409189019205818351911572757145556993606643464336196802350204616056286497246016800105003143046120608673496196758720552776772796609670537056331996894322779267635281472481559819839042424017171718303214059720568484939239370144038161541354254182769979771948759413102933987773401644506930205164891773826513161783736386604783484446345744957119469799231796368324927570694496679453313927562345656690240414624431304646248599226046524702364131095964335</span></span><br><span class="line">c1_4 = <span class="number">79717988936247951265489157583697956031893477858854186991051529161879478488281744062318600470906120960002282886511477294555606503083169449335174864424180701080203993329996226566203834693869525797695969610065991941396723959032680019082506816443041598300477625793433080664346470586416385854692124426348587211026568667694805849554780794033764714016521711467557284846737236374990121316809833819996821592832639024026411520407330206281265390130763948165694574512140518775603040182029818771866749548761938870605590174330887949847420877829240131490902432602005681085180807294176837646062568094875766945890382971790015490163385088144673549085079635083262975154206269679142412897438231719704933258660779310737302680265445437771977749959110744959368586293082016067927548564967400845992380076107522755566531760628823374519718763740378295585535591752887339222947397184116326706799921515431185636740825707782742373783475781052674257292910213843986132987466810027275052416774693363446184518901899202502828670309452622347532932678874990809930682575738653876289384151496807194146308614368821006660626870989784697045160231069428458961107751207771093777394616856305293335603892178327520756554333365975114235981173451368131680404850832773147333013716920</span></span><br><span class="line">c1_5 = <span class="number">123111353650401158556639983459870663057297871992927053886971224773529636525110628183715748795987525113177540092814119928708272290370336537110381023134637759740716140969662183269370676630325583385284994943164692397459103195434968057377474610500216801375394703781249039351368816958227409657934091741509357152328382960684515093945552479461382281913961956745154260686029997827565075768703774895750561575155143606297116391666385705899138085693913246313778033627210312268959737394553510894720099165193981333775907531107232556909478156441457899797515694348816961762796703443502856101079430585547997496001098926600499728389113862894833789669213630332988693669889340482430613291490613803204484751470676686041002772556117213612152322606737150858116122936539131795111263513114569794532805886643087299918196635113037777138666914296986040549274559835214505300618256105508764026461518876579387159881983544667258537064954616097750399839661065797883103731694314852301848272092388637114950059216922969842082648527035538090054093890365647676119748995243416337805666557501345234056968476142608491830438065401219751688687373709390057521910942736632126729711606256158399963682990881473178216060827021373776598901281958527655543318413664277921492723185984</span></span><br><span class="line">c1_6 = <span class="number">36869806815936046911848195817405817350259890871483063184373728397968909458432625046025376290214729914038387534731762237978339011724858818860181178811639468996206294711495853807311240013786226884265118119546377272154555615363105236192878292703331473547623021744317034819416624562896226194523639793573028006666236271812390759036235867495803255905843636447252225413871038762657801345647584493917576263471587347202664391908570140389126903204602391093990827188675090199750617303773574821926387194478875191828814971296674530519321530805302667925998711835019806761133078403281404889374663875077339168901297819436499920958268483684335998301056068380228873524800383911402490807139268964095165069610454677558808756444381542173782815227920906224931028457073652453777424387873533280455944646592996920617956675786286711447540353883400282402551158169958389450168079568459656526911857835375748015814860506707921852997096156275804955989964215077733621769938075413007804223217091604613132253046399456747595300404564172224333936405545921819654435437072133387523533568472443532200069133022979195685683508297337961701169394794966256415112246587706103819620428258245999539040721929317130088874161577093962579487428358736401687123174207198251449851429295</span></span><br><span class="line"></span><br><span class="line">c2_1 = <span class="number">592169079372093727306100216011395857825646323934289480976073629037543922902098120901138454462177159996376654176248238979132528728327590301098966139983157980612320563496546128644967731000716697705104079039156276714872147463350811303393260622707024952543509891692246246277965823414460326811240048060543656588688604452353899779068825120910282167004715339763187734797180326976132213325054697165320479166356562518029805927741656605174809726397565772271562066078076105491745903986597877400370206718954975288721072048333678609055008135809089304229015364348490924974097403734627265297637171818849461766523691595241613878709865506436588268999163342945070495338153600520537498539457396582804692959296612715752573140296135784933206146091436617979599749774330699946637591406356289409716084034451049094715202196203486088368791744107629271647320273259836915312794297246589501008666299165717722507702866033454215783240025504356157664454861755286285777763585177751796252655008206383024707883077513745863312079349790275094080707502392866946325796914450602264462588722052297430827681750827349094323968337670311272933785838850649376115667223821665435911506351891489985627506615492005617098615432522564204152887767244129985681083657783356557756654335186</span></span><br><span class="line">c2_2 = <span class="number">373940646416832740878733255707567753033716583448402000789202767511920210382830343955553654111486728333980557319799362514960627879016797491389812007768832730979916230647641872759001906846747977631675704310179448857128160385701185892914523053669366534408863734305635222625590986006420486092550427301086984563126480814987024980594613542978310129247678826691418335300577577527951623696426435497835228167084738007750914270251001921329521479047662848650808989996085600197309361410863238526802127877523767262921515150984998560136647154865791163316503073285223966216441025637452229043510097323724381056976302288136843260163922706692913035222445496716008888946581535004546355744211680390731257309941902587303353139951102244865270295414474488798335404630458489706639805186573874814586736746232358849677477533671968344154242963289415569487579895910660999043578737461300406937828924818002658292769882181668784501439254131996848948120781562158861495883827848139425862249576454689133681009549361314460818658995959098228995702202268649635363105549975932395335076521137604288520082040121286614922986554652700056148966514178935952363036963217619879899671383604638416567950421350546204434902113156720006282720889591288850271076074941927715678306057176</span></span><br><span class="line">c2_3 = <span class="number">527630926460622936571385649841758214453416849039412401087443444317101857090904711485538107058823056085840539073345920792871368232355475394571098380596835468509997340505604333730547799560998822989747473780307779717715522787724471724766494090783971030594671013168209717686720448579582618378459567979027822271918653169622428153856198907810040224340270362413432495029672123261375400927159831537760709974778708160583252613784358234858583174544777979242887938827573604837766801998381379999076416444683891078093889686055482709838668356120916040352123019019255084513769603803814947774554028717814638951416291274696771515474086351482107953150253616922787262398450376249126999644026382478413080973933173079111305142716133389111399235545279259017424722601848670061556859163943895466553927946412523750166582734005733378328468250568944945912238495877929717101722314678120172228493787964904072583905721074766711732215815561012960394537195757832959268603775112932862105945720853959285187521763557915356428113876893276879775603217718981852114599706699524551973934242045743122744146361596971245034059345915315495232135483464496114770357536576200511490922413208178149869347802988786513451486411409887164516065062084917556120712465074206435831498113605</span></span><br><span class="line">c2_4 = <span class="number">8786437178698940322877889807009957616777351844979869726962356553244050911283984280960665761649310895230455072977431415102053987735969326553978994853162483051544656873294555116009995592043183070208706258164840540599577072097104139505857517663273929851202628854185356185647194933800084230503413037858893307713037149307477830536758283681093517617820169181420796105338681582230788318108428132051793761014952837330456262272828627355701464740578197966332613127307037255647286823496355917642353327912440019621838870388091824748629637425759125214639885130163183752378908729773517053259212525494555880921052679512582051516604297098204363525081039382358483926727008679327719083138865969291911863630382097160230960738043575559330264018212774424527719153248563876760067931499029384228993253862501939337758514377472011933279273181144830381169849387893799390755052093069179605579485710343655570028592595882436632426527654452895431758715126580164902410286422637215098476316042367916779431052267545769495994723721129943616294879642305545894912914632980455031755879087401575310699765408473606166727137934224515998416625122213056208800095077933103150699272650116151674702438463062734472714004926103668378506804002740045547964716693536349447660850580</span></span><br><span class="line">c2_5 = <span class="number">205314962204511500352858372254132533167549960825498949618514841570703199264867431580754674275990554478140637041427842111391746883257447120035947621456863890934062044010795443059281736346976175772415034838334682726635263432655537852942177334888025283748611576171534251461847349566505628290587224150869640386437623371249743165260396675220683302142805646368906930575140628610003919131999295855501215111393294818218799982703289304596989070475000081175510085432290264502023736899104746316830742226946395027029820825791831870857382647221322734605026210073093918331247494307555600335550942340526536281372036612138713881098866303169425501998978400008829873080965592009371176208668290074288903681417933657472279670688597862835627506340169978450918788539270346340385928840299573889292189531738082166408734046381423516467694328971385421907314814283489322619386570046183556572383980777277173349209330683424343658179781015072259378576130442222984963071166207642585589822061597282467850868050737957726423713761694231879497037175627546427449730638216214828463003483408928375620315193290871300316930139260521382533279767663839278693750409419493280753368451508802658272220767624766390639285308433607255253282702383762149755935518922075584637512494819</span></span><br><span class="line">c2_6 = <span class="number">271453634732502613378948161256470991260052778799128789839624515809143527363206813219580098196957510291648493698144497567392065251244844074992734669490296293997386198359280316655904691639367482203210051809125904410431506925238374843856343243276508280641059690938930957474434518308646618959004216831130099873532714372402117796666560677624822509159287675432413016478948594640872091688482149004426363946048517480052906306290126242866034249478040406351940088231081456109195799442996799641647167552689564613346415247906852055588498305665928450828756152103096629274760601528737639415361467941349982213641454967962723875032638267311935042334584913897338553953961877439389588793074211502597238465542889335363559052368180212013206172712561221352833891640659020253527584706465205486408990762759230842192028381048563437724528409174790022752557512795782713125166158329880702730769957185428522011430144840232256419113631679343171680631630775266488738173707357123139368825087043785842169049943237537188129367275730984789479909103397937113837824575137021012333461552176687570010445744268373840742899299977372834041925102853718964831225250407279578465008537542659673685686242773379131904890865110699190451534445434533919127658976874721029586168106207</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c1=<span class="number">412629526163150748619328091306742267675740578011800062477174189782151273970783531227579758540364970485350157944321579108232221072397135934034064481497887079641131808838242743811511451355024436983050572020925065644355566434625618133203024215941534926113892937988520918939061441606915556516246057349589921494351383160036280826024605351878408056180907759973804117263002554923041750587548819746346813966673034182913325507826219961923932100526305289894965216608254252188398580139545189681875824089456195044984585824938384521905334289906422454152976834867304693292466676355760173232407753256256317546190171995276258924613533179898467683358934751999655196790168438343198229183747091108262988777659858609744709324571850262293294975336628234767258858873839342596887193772615000676401522431518310648303975593582965021189182246986957349253156736526071639973844039068996404290548474640668851856078201093335425412842295604919065487301340901573809617549185106072798799159726375235125260509158832996701927878713084753334549129580912412168594170659605421750204835970231909591063407612779337478065175988365401590396247576709343727196106058477166945670117868989025903023998142850338956985816131805349549059377047477131270847579095628384569645636821650</span></span><br><span class="line">c2=<span class="number">592169079372093727306100216011395857825646323934289480976073629037543922902098120901138454462177159996376654176248238979132528728327590301098966139983157980612320563496546128644967731000716697705104079039156276714872147463350811303393260622707024952543509891692246246277965823414460326811240048060543656588688604452353899779068825120910282167004715339763187734797180326976132213325054697165320479166356562518029805927741656605174809726397565772271562066078076105491745903986597877400370206718954975288721072048333678609055008135809089304229015364348490924974097403734627265297637171818849461766523691595241613878709865506436588268999163342945070495338153600520537498539457396582804692959296612715752573140296135784933206146091436617979599749774330699946637591406356289409716084034451049094715202196203486088368791744107629271647320273259836915312794297246589501008666299165717722507702866033454215783240025504356157664454861755286285777763585177751796252655008206383024707883077513745863312079349790275094080707502392866946325796914450602264462588722052297430827681750827349094323968337670311272933785838850649376115667223821665435911506351891489985627506615492005617098615432522564204152887767244129985681083657783356557756654335186</span></span><br><span class="line">e1=<span class="number">1697</span></span><br><span class="line">e2=<span class="number">599</span></span><br><span class="line"></span><br><span class="line">ans=exgcd(e1,e2,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">s1=ans[<span class="number">1</span>]</span><br><span class="line">s2=ans[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">c1 = [c1_1,c1_2,c1_3,c1_4,c1_5,c1_6]</span><br><span class="line">c2 = [c2_1,c2_2,c2_3,c2_4,c2_5,c2_6]</span><br><span class="line"></span><br><span class="line"><span class="comment">#powmod()函数,分数取模也可以直接算</span></span><br><span class="line">bases = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c1)):</span><br><span class="line">    m = (gmpy2.powmod(c1[i],s1,n)*gmpy2.powmod(c2[i],s2,n)) % n</span><br><span class="line">    bases += <span class="built_in">str</span>(long_to_bytes(m),<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(flag.replace(&quot;\n&quot;,&quot;&#x27;,&#x27;&quot;))</span></span><br><span class="line">basesList = [<span class="string">&#x27;VEhJUz==&#x27;</span>,<span class="string">&#x27;RkxBR3==&#x27;</span>,<span class="string">&#x27;SVN=&#x27;</span>,<span class="string">&#x27;SElEREVOLo==&#x27;</span>,<span class="string">&#x27;Q0FO&#x27;</span>,<span class="string">&#x27;WU9V&#x27;</span>,<span class="string">&#x27;RklORM==&#x27;</span>,<span class="string">&#x27;SVT=&#x27;</span>,<span class="string">&#x27;T1VUP4==&#x27;</span>,<span class="string">&#x27;RE8=&#x27;</span>,<span class="string">&#x27;WU9V&#x27;</span>,<span class="string">&#x27;S05PV9==&#x27;</span>,<span class="string">&#x27;QkFTRTY0P5==&#x27;</span>,<span class="string">&#x27;WW91bmdD&#x27;</span>,<span class="string">&#x27;VEhJTku=&#x27;</span>,<span class="string">&#x27;WU9V&#x27;</span>,<span class="string">&#x27;QVJF&#x27;</span>,<span class="string">&#x27;Tk9U&#x27;</span>,<span class="string">&#x27;VEhBVE==&#x27;</span>,<span class="string">&#x27;RkFNSUxJQVI=&#x27;</span>,<span class="string">&#x27;V0lUSO==&#x27;</span>,<span class="string">&#x27;QkFTRTY0Lh==&#x27;</span>,<span class="string">&#x27;QmFzZTY0&#x27;</span>,<span class="string">&#x27;aXO=&#x27;</span>,<span class="string">&#x27;YW==&#x27;</span>,<span class="string">&#x27;Z3JvdXA=&#x27;</span>,<span class="string">&#x27;b2b=&#x27;</span>,<span class="string">&#x27;c2ltaWxhcn==&#x27;</span>,<span class="string">&#x27;YmluYXJ5LXRvLXRleHR=&#x27;</span>,<span class="string">&#x27;ZW5jb2Rpbme=&#x27;</span>,<span class="string">&#x27;c2NoZW1lc0==&#x27;</span>,<span class="string">&#x27;dGhhdD==&#x27;</span>,<span class="string">&#x27;cmVwcmVzZW50&#x27;</span>,<span class="string">&#x27;YmluYXJ5&#x27;</span>,<span class="string">&#x27;ZGF0YW==&#x27;</span>,<span class="string">&#x27;aW5=&#x27;</span>,<span class="string">&#x27;YW6=&#x27;</span>,<span class="string">&#x27;QVNDSUl=&#x27;</span>,<span class="string">&#x27;c3RyaW5n&#x27;</span>,<span class="string">&#x27;Zm9ybWF0&#x27;</span>,<span class="string">&#x27;Ynk=&#x27;</span>,<span class="string">&#x27;dHJhbnNsYXRpbmd=&#x27;</span>,<span class="string">&#x27;aXS=&#x27;</span>,<span class="string">&#x27;aW50b1==&#x27;</span>,<span class="string">&#x27;YT==&#x27;</span>,<span class="string">&#x27;cmFkaXgtNjQ=&#x27;</span>,<span class="string">&#x27;cmVwcmVzZW50YXRpb24u&#x27;</span>,<span class="string">&#x27;VGhl&#x27;</span>,<span class="string">&#x27;dGVybc==&#x27;</span>,<span class="string">&#x27;QmFzZTY0&#x27;</span>,<span class="string">&#x27;b3JpZ2luYXRlc8==&#x27;</span>,<span class="string">&#x27;ZnJvbd==&#x27;</span>,<span class="string">&#x27;YY==&#x27;</span>,<span class="string">&#x27;c3BlY2lmaWN=&#x27;</span>,<span class="string">&#x27;TUlNRT==&#x27;</span>,<span class="string">&#x27;Y29udGVudI==&#x27;</span>,<span class="string">&#x27;dHJhbnNmZXI=&#x27;</span>,<span class="string">&#x27;ZW5jb2Rpbmcu&#x27;</span>,<span class="string">&#x27;VGhl&#x27;</span>,<span class="string">&#x27;cGFydGljdWxhct==&#x27;</span>,<span class="string">&#x27;c2V0&#x27;</span>,<span class="string">&#x27;b2b=&#x27;</span>,<span class="string">&#x27;NjR=&#x27;</span>,<span class="string">&#x27;Y2hhcmFjdGVyc5==&#x27;</span>,<span class="string">&#x27;Y2hvc2Vu&#x27;</span>,<span class="string">&#x27;dG+=&#x27;</span>,<span class="string">&#x27;cmVwcmVzZW50&#x27;</span>,<span class="string">&#x27;dGhl&#x27;</span>,<span class="string">&#x27;NjQ=&#x27;</span>,<span class="string">&#x27;cGxhY2UtdmFsdWVz&#x27;</span>,<span class="string">&#x27;Zm9y&#x27;</span>,<span class="string">&#x27;dGhl&#x27;</span>,<span class="string">&#x27;YmFzZd==&#x27;</span>,<span class="string">&#x27;dmFyaWVz&#x27;</span>,<span class="string">&#x27;YmV0d2Vlbt==&#x27;</span>,<span class="string">&#x27;aW1wbGVtZW50YXRpb25zLp==&#x27;</span>,<span class="string">&#x27;VGhl&#x27;</span>,<span class="string">&#x27;Z2VuZXJhbI==&#x27;</span>,<span class="string">&#x27;c3RyYXRlZ3n=&#x27;</span>,<span class="string">&#x27;aXO=&#x27;</span>,<span class="string">&#x27;dG9=&#x27;</span>,<span class="string">&#x27;Y2hvb3Nl&#x27;</span>,<span class="string">&#x27;NjR=&#x27;</span>,<span class="string">&#x27;Y2hhcmFjdGVyc5==&#x27;</span>,<span class="string">&#x27;dGhhdA==&#x27;</span>,<span class="string">&#x27;YXJl&#x27;</span>,<span class="string">&#x27;Ym90aN==&#x27;</span>,<span class="string">&#x27;bWVtYmVyc5==&#x27;</span>,<span class="string">&#x27;b2a=&#x27;</span>,<span class="string">&#x27;YS==&#x27;</span>,<span class="string">&#x27;c3Vic2V0&#x27;</span>,<span class="string">&#x27;Y29tbW9u&#x27;</span>,<span class="string">&#x27;dG8=&#x27;</span>,<span class="string">&#x27;bW9zdM==&#x27;</span>,<span class="string">&#x27;ZW5jb2RpbmdzLA==&#x27;</span>,<span class="string">&#x27;YW5k&#x27;</span>,<span class="string">&#x27;YWxzb8==&#x27;</span>,<span class="string">&#x27;cHJpbnRhYmxlLg==&#x27;</span>,<span class="string">&#x27;VGhpc9==&#x27;</span>,<span class="string">&#x27;Y29tYmluYXRpb25=&#x27;</span>,<span class="string">&#x27;bGVhdmVz&#x27;</span>,<span class="string">&#x27;dGhl&#x27;</span>,<span class="string">&#x27;ZGF0YW==&#x27;</span>,<span class="string">&#x27;dW5saWtlbHk=&#x27;</span>,<span class="string">&#x27;dG/=&#x27;</span>,<span class="string">&#x27;YmV=&#x27;</span>,<span class="string">&#x27;bW9kaWZpZWS=&#x27;</span>,<span class="string">&#x27;aW5=&#x27;</span>,<span class="string">&#x27;dHJhbnNpdE==&#x27;</span>,<span class="string">&#x27;dGhyb3VnaN==&#x27;</span>,<span class="string">&#x27;aW5mb3JtYXRpb26=&#x27;</span>,<span class="string">&#x27;c3lzdGVtcyw=&#x27;</span>,<span class="string">&#x27;c3VjaN==&#x27;</span>,<span class="string">&#x27;YXM=&#x27;</span>,<span class="string">&#x27;RS1tYWlsLD==&#x27;</span>,<span class="string">&#x27;dGhhdA==&#x27;</span>,<span class="string">&#x27;d2VyZQ==&#x27;</span>,<span class="string">&#x27;dHJhZGl0aW9uYWxseQ==&#x27;</span>,<span class="string">&#x27;bm90&#x27;</span>,<span class="string">&#x27;OC1iaXQ=&#x27;</span>,<span class="string">&#x27;Y2xlYW4uWzFd&#x27;</span>,<span class="string">&#x27;Rm9y&#x27;</span>,<span class="string">&#x27;ZXhhbXBsZSw=&#x27;</span>,<span class="string">&#x27;TUlNRSdz&#x27;</span>,<span class="string">&#x27;QmFzZTY0&#x27;</span>,<span class="string">&#x27;aW1wbGVtZW50YXRpb24=&#x27;</span>,<span class="string">&#x27;dXNlcw==&#x27;</span>,<span class="string">&#x27;QahDWiw=&#x27;</span>,<span class="string">&#x27;YahDeiw=&#x27;</span>,<span class="string">&#x27;YW5k&#x27;</span>,<span class="string">&#x27;MKhDOQ==&#x27;</span>,<span class="string">&#x27;Zm9y&#x27;</span>,<span class="string">&#x27;dGhl&#x27;</span>,<span class="string">&#x27;Zmlyc3Q=&#x27;</span>,<span class="string">&#x27;NjI=&#x27;</span>,<span class="string">&#x27;dmFsdWVzLg==&#x27;</span>,<span class="string">&#x27;T3RoZXI=&#x27;</span>,<span class="string">&#x27;dmFyaWF0aW9ucw==&#x27;</span>,<span class="string">&#x27;c2hhcmU=&#x27;</span>,<span class="string">&#x27;dGhpcw==&#x27;</span>,<span class="string">&#x27;cHJvcGVydHk=&#x27;</span>,<span class="string">&#x27;YnV0&#x27;</span>,<span class="string">&#x27;ZGlmZmVy&#x27;</span>,<span class="string">&#x27;aW4=&#x27;</span>,<span class="string">&#x27;dGhl&#x27;</span>,<span class="string">&#x27;c3ltYm9scw==&#x27;</span>,<span class="string">&#x27;Y2hvc2Vu&#x27;</span>,<span class="string">&#x27;Zm9y&#x27;</span>,<span class="string">&#x27;dGhl&#x27;</span>,<span class="string">&#x27;bGFzdA==&#x27;</span>,<span class="string">&#x27;dHdv&#x27;</span>,<span class="string">&#x27;dmFsdWVzOw==&#x27;</span>,<span class="string">&#x27;YW4=&#x27;</span>,<span class="string">&#x27;ZXhhbXBsZQ==&#x27;</span>,<span class="string">&#x27;aXM=&#x27;</span>,<span class="string">&#x27;VVRGLTcu&#x27;</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> basesList:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(base64.b64decode(i))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot; &quot;</span>)</span><br><span class="line"><span class="comment"># THIS FLAG IS HIDDEN. CAN YOU FIND IT OUT? DO YOU KNOW BASE64? YoungC THINK YOU ARE NOT THAT FAMILIAR WITH BASE64. Base64 is a group of similar binary-to-text encoding schemes that represent binary data in an ASCII string format by translating it into a radix-64 representation. The term Base64 originates from a specific MIME content transfer encoding. The particular set of 64 characters chosen to represent the 64 place-values for the base varies between implementations. The general strategy is to choose 64 characters that are both members of a subset common to most encodings, and also printable. This combination leaves the data unlikely to be modified in transit through information systems, such as E-mail, that were traditionally not 8-bit clean.[1] For example, MIME&#x27;s Base64 implementation uses A\xa8CZ, a\xa8Cz, and 0\xa8C9 for the first 62 values. Other variations share this property but differ in the symbols chosen for the last two values; an example is UTF-7. </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">bytes</span>(bases,encoding = <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_base64_diff_value</span>(<span class="params">s1, s2</span>):</span><br><span class="line">    base64chars = <span class="string">b&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s2)):</span><br><span class="line">        <span class="keyword">if</span> s1[i] != s2[i]:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">abs</span>(base64chars.index(s1[i]) - base64chars.index(s2[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_stego</span>():</span><br><span class="line">    line=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">    bin_str=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">        k=long_to_bytes(i)</span><br><span class="line">        <span class="keyword">if</span> k==<span class="string">b&#x27;\n&#x27;</span>:</span><br><span class="line">            steg_line = line</span><br><span class="line">            norm_line = base64.b64encode(base64.b64decode(line))</span><br><span class="line">            diff = get_base64_diff_value(steg_line, norm_line)</span><br><span class="line">            <span class="comment">#print(diff)</span></span><br><span class="line">            pads_num = steg_line.count(<span class="string">b&#x27;=&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> diff:</span><br><span class="line">                bin_str += <span class="built_in">bin</span>(diff)[<span class="number">2</span>:].zfill(pads_num * <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                bin_str += <span class="string">&#x27;0&#x27;</span> * pads_num * <span class="number">2</span></span><br><span class="line">            <span class="built_in">print</span>(goflag(bin_str))</span><br><span class="line">            line=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        line+=k</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">goflag</span>(<span class="params">bin_str</span>):</span><br><span class="line">    res_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bin_str), <span class="number">8</span>):</span><br><span class="line">        res_str += <span class="built_in">chr</span>(<span class="built_in">int</span>(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> res_str</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    solve_stego()</span><br><span class="line"><span class="comment"># flag&#123;7c86d8f7d6de33a87f7f9d6b005ce640&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="已知dp、dq"><a href="#已知dp、dq" class="headerlink" title="已知dp、dq"></a>已知dp、dq</h2><p>“一切以解题为目的的抄代码都是没有灵魂的，我们还是要从数学理论上去分析解决它，再去写代码。”</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">已知条件：</span><br><span class="line">c ≡ m  **  e mod n </span><br><span class="line">m ≡ c  **  d mod n</span><br><span class="line">φ(n) = (p-<span class="number">1</span>)(q-<span class="number">1</span>)</span><br><span class="line">d*e ≡ <span class="number">1</span> mod φ(n)</span><br><span class="line">dp ≡ d mod (p-<span class="number">1</span>)</span><br><span class="line">dq ≡ d mod (q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">中国剩余定理：</span><br><span class="line">m1 ≡ c  **  d mod P</span><br><span class="line">m2 ≡ c  **  d mod q</span><br></pre></td></tr></table></figure>

<p>经过各种推算:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">m1 ≡ c  **  dp mod p</span><br><span class="line">m2 ≡ c  **  dq mod q</span><br></pre></td></tr></table></figure>

<p>正常解法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">I = gmpy2.invert(q,p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c,dq,q)               <span class="comment">#求幂取模运算</span></span><br><span class="line"></span><br><span class="line">m = (((mp-mq)*I)%p)*q+mq       <span class="comment">#求明文公式</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(m))          <span class="comment">#转为十六进制</span></span><br></pre></td></tr></table></figure>

<h3 id="RSA1-（已知dp、dq）"><a href="#RSA1-（已知dp、dq）" class="headerlink" title="RSA1  （已知dp、dq）"></a>RSA1  （已知dp、dq）</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/MikeCoke/article/details/105959599">参考</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line">p = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> </span><br><span class="line">q = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> </span><br><span class="line">c = <span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br><span class="line">dp = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> </span><br><span class="line">dq = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> </span><br><span class="line"></span><br><span class="line">I = gmpy2.invert(q,p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c,dq,q)               <span class="comment">#求幂取模运算</span></span><br><span class="line"></span><br><span class="line">m = (((mp-mq)*I)%p)*q+mq       <span class="comment">#求明文公式</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(number.long_to_bytes(m))          <span class="comment">#long_to_bytes</span></span><br><span class="line"><span class="comment"># noxCTF&#123;W31c0m3_70_Ch1n470wn&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="低加密指数攻击"><a href="#低加密指数攻击" class="headerlink" title="低加密指数攻击"></a>低加密指数攻击</h2><h3 id="dangerous-RSA-（低加密指数攻击）"><a href="#dangerous-RSA-（低加密指数攻击）" class="headerlink" title="dangerous RSA （低加密指数攻击）"></a>dangerous RSA （低加密指数攻击）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#n:  0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793L</span></span><br><span class="line"><span class="comment">#e:  0x3</span></span><br><span class="line"><span class="comment">#c:0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365</span></span><br><span class="line">so,how to get the message? </span><br></pre></td></tr></table></figure>

<p>因为c &#x3D; m ** e%n，m &#x3D; c ** d%n</p>
<p>当指数e很小的时候（通常为3），可以分两种情况来讨论</p>
<ol>
<li><p>当m ** e&lt;n：</p>
<p>c &#x3D; m ** e</p>
<p>对c开e次根号</p>
</li>
<li><p>当m ** e&gt;n:</p>
<p>m ** e &#x3D; k * n+c</p>
<p>循环爆破k，使其满足条件</p>
</li>
</ol>
<p>这边推荐使用gmpy2.iroot函数来开根号，这个函数的返回值为一个(x,y)元组，其中x为结果值，y为一个bool型变量，如果x为整数，y&#x3D;True,否则y&#x3D;False</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365</span></span><br><span class="line">n = <span class="number">0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793</span></span><br><span class="line"></span><br><span class="line">m = gmpy2.iroot(c,e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(number.long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>当然这题，这道题的m很小，我只是对m开了三次根号。</p>
<p>而对于m值很大的情况，循环k，使k*n+c开e次根号，iroot返回的第二个值为True即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line">n = <span class="number">0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793</span></span><br><span class="line">c = <span class="number">0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365</span></span><br><span class="line">e = <span class="number">0x3</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    res=iroot(c+k*n,e)</span><br><span class="line">    <span class="keyword">if</span>(res[<span class="number">1</span>]==<span class="literal">True</span>):</span><br><span class="line">        <span class="built_in">print</span>(number.long_to_bytes(res[<span class="number">0</span>]))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    k=k+<span class="number">1</span></span><br></pre></td></tr></table></figure>



<h2 id="公因数分解n"><a href="#公因数分解n" class="headerlink" title="公因数分解n"></a>公因数分解n</h2><h3 id="BJDCTF2020-RSA（公因数分解n-爆破e）"><a href="#BJDCTF2020-RSA（公因数分解n-爆破e）" class="headerlink" title="[BJDCTF2020]RSA（公因数分解n+爆破e）"></a>[BJDCTF2020]RSA（公因数分解n+爆破e）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"></span><br><span class="line">flag=<span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">assert</span>(e&lt;<span class="number">100000</span>)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span> c,n</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(<span class="number">294</span>,e,n)</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(<span class="string">&quot;BJD&quot;</span>*<span class="number">32</span>)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span> c,n</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">output:</span></span><br><span class="line"><span class="string">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120  13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span></span><br><span class="line"><span class="string">381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span></span><br><span class="line"><span class="string">979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721  12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>关于e的爆破脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p2 = <span class="number">381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span></span><br><span class="line">n2 = <span class="number">13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span></span><br><span class="line">e = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">pow</span>(<span class="number">294</span>,e,n2) == p2:</span><br><span class="line">		<span class="built_in">print</span>(e)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="built_in">print</span>(e)</span><br><span class="line">	e += <span class="number">1</span></span><br><span class="line"><span class="comment"># e = 52361</span></span><br></pre></td></tr></table></figure>

<p>其余项打算用z3来解的，但是解不出来……</p>
<p>–更新–</p>
<p>忘了一个最重要的条件:当n1,n2很大的时候，q &#x3D; gcd(n1,n2)!!!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">q = gcd(n1,n2)</span><br><span class="line"><span class="comment"># q = 99855353761764939308265951492116976798674681282941462516956577712943717850048051273358745095906207085170915794187749954588685850452162165059831749303473106541930948723000882713453679904525655327168665295207423257922666721077747911860159181041422993030618385436504858943615630219459262419715816361781062898911</span></span><br></pre></td></tr></table></figure>

<p>求出q，那接下来就好办了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p2 = <span class="number">381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span></span><br><span class="line">c1 = <span class="number">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120</span>  </span><br><span class="line">n2 = <span class="number">12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span></span><br><span class="line">n1 = <span class="number">13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span></span><br><span class="line">q = <span class="number">99855353761764939308265951492116976798674681282941462516956577712943717850048051273358745095906207085170915794187749954588685850452162165059831749303473106541930948723000882713453679904525655327168665295207423257922666721077747911860159181041422993030618385436504858943615630219459262419715816361781062898911</span></span><br><span class="line">p1 = n1//q</span><br><span class="line">e = <span class="number">52361</span></span><br><span class="line">d = invert(e,(p1-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c1,d,n1)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># BJD&#123;p_is_common_divisor&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="RSA5（公因数求解）"><a href="#RSA5（公因数求解）" class="headerlink" title="RSA5（公因数求解）"></a>RSA5（公因数求解）</h3><p>本来想用CRT的，但是题目中给出的e很大，不适合用。</p>
<p>只能从给出的20个n中找规律了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 若n1,n2不互质</span></span><br><span class="line">p = gcd(n1，n2)</span><br></pre></td></tr></table></figure>

<p>从20个n中找出有公约数的一对，然后找出对应n的p和q，剩余的就顺水推舟了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">20474918894051778533305262345601880928088284471121823754049725354072477155873778848055073843345820697886641086842612486541250183965966001591342031562953561793332341641334302847996108417466360688139866505179689516589305636902137210185624650854906780037204412206309949199080005576922775773722438863762117750429327585792093447423980002401200613302943834212820909269713876683465817369158585822294675056978970612202885426436071950214538262921077409076160417436699836138801162621314845608796870206834704116707763169847387223307828908570944984416973019427529790029089766264949078038669523465243837675263858062854739083634207</span></span><br><span class="line">c1 = <span class="number">974463908243330865728978769213595400782053398596897741316275722596415018912929508637393850919224969271766388710025195039896961956062895570062146947736340342927974992616678893372744261954172873490878805483241196345881721164078651156067119957816422768524442025688079462656755605982104174001635345874022133045402344010045961111720151990412034477755851802769069309069018738541854130183692204758761427121279982002993939745343695671900015296790637464880337375511536424796890996526681200633086841036320395847725935744757993013352804650575068136129295591306569213300156333650910795946800820067494143364885842896291126137320</span></span><br><span class="line"></span><br><span class="line">n2 = <span class="number">20918819960648891349438263046954902210959146407860980742165930253781318759285692492511475263234242002509419079545644051755251311392635763412553499744506421566074721268822337321637265942226790343839856182100575539845358877493718334237585821263388181126545189723429262149630651289446553402190531135520836104217160268349688525168375213462570213612845898989694324269410202496871688649978370284661017399056903931840656757330859626183773396574056413017367606446540199973155630466239453637232936904063706551160650295031273385619470740593510267285957905801566362502262757750629162937373721291789527659531499435235261620309759</span></span><br><span class="line">c2 = <span class="number">15819636201971185538694880505120469332582151856714070824521803121848292387556864177196229718923770810072104155432038682511434979353089791861087415144087855679134383396897817458726543883093567600325204596156649305930352575274039425470836355002691145864435755333821133969266951545158052745938252574301327696822347115053614052423028835532509220641378760800693351542633860702225772638930501021571415907348128269681224178300248272689705308911282208685459668200507057183420662959113956077584781737983254788703048275698921427029884282557468334399677849962342196140864403989162117738206246183665814938783122909930082802031855</span></span><br><span class="line"></span><br><span class="line">n3 = <span class="number">25033254625906757272369609119214202033162128625171246436639570615263949157363273213121556825878737923265290579551873824374870957467163989542063489416636713654642486717219231225074115269684119428086352535471683359486248203644461465935500517901513233739152882943010177276545128308412934555830087776128355125932914846459470221102007666912211992310538890654396487111705385730502843589727289829692152177134753098649781412247065660637826282055169991824099110916576856188876975621376606634258927784025787142263367152947108720757222446686415627479703666031871635656314282727051189190889008763055811680040315277078928068816491</span></span><br><span class="line">c3 = <span class="number">4185308529416874005831230781014092407198451385955677399668501833902623478395669279404883990725184332709152443372583701076198786635291739356770857286702107156730020004358955622511061410661058982622055199736820808203841446796305284394651714430918690389486920560834672316158146453183789412140939029029324756035358081754426645160033262924330248675216108270980157049705488620263485129480952814764002865280019185127662449318324279383277766416258142275143923532168798413011028271543085249029048997452212503111742302302065401051458066585395360468447460658672952851643547193822775218387853623453638025492389122204507555908862</span></span><br><span class="line"></span><br><span class="line">n4 = <span class="number">21206968097314131007183427944486801953583151151443627943113736996776787181111063957960698092696800555044199156765677935373149598221184792286812213294617749834607696302116136745662816658117055427803315230042700695125718401646810484873064775005221089174056824724922160855810527236751389605017579545235876864998419873065217294820244730785120525126565815560229001887622837549118168081685183371092395128598125004730268910276024806808565802081366898904032509920453785997056150497645234925528883879419642189109649009132381586673390027614766605038951015853086721168018787523459264932165046816881682774229243688581614306480751</span></span><br><span class="line">c4 = <span class="number">4521038011044758441891128468467233088493885750850588985708519911154778090597136126150289041893454126674468141393472662337350361712212694867311622970440707727941113263832357173141775855227973742571088974593476302084111770625764222838366277559560887042948859892138551472680654517814916609279748365580610712259856677740518477086531592233107175470068291903607505799432931989663707477017904611426213770238397005743730386080031955694158466558475599751940245039167629126576784024482348452868313417471542956778285567779435940267140679906686531862467627238401003459101637191297209422470388121802536569761414457618258343550613</span></span><br><span class="line"></span><br><span class="line">n5 = <span class="number">22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067</span></span><br><span class="line">c5 = <span class="number">15406498580761780108625891878008526815145372096234083936681442225155097299264808624358826686906535594853622687379268969468433072388149786607395396424104318820879443743112358706546753935215756078345959375299650718555759698887852318017597503074317356745122514481807843745626429797861463012940172797612589031686718185390345389295851075279278516147076602270178540690147808314172798987497259330037810328523464851895621851859027823681655934104713689539848047163088666896473665500158179046196538210778897730209572708430067658411755959866033531700460551556380993982706171848970460224304996455600503982223448904878212849412357</span></span><br><span class="line"></span><br><span class="line">n6 = <span class="number">21574139855341432908474064784318462018475296809327285532337706940126942575349507668289214078026102682252713757703081553093108823214063791518482289846780197329821139507974763780260290309600884920811959842925540583967085670848765317877441480914852329276375776405689784571404635852204097622600656222714808541872252335877037561388406257181715278766652824786376262249274960467193961956690974853679795249158751078422296580367506219719738762159965958877806187461070689071290948181949561254144310776943334859775121650186245846031720507944987838489723127897223416802436021278671237227993686791944711422345000479751187704426369</span></span><br><span class="line">c6 = <span class="number">20366856150710305124583065375297661819795242238376485264951185336996083744604593418983336285185491197426018595031444652123288461491879021096028203694136683203441692987069563513026001861435722117985559909692670907347563594578265880806540396777223906955491026286843168637367593400342814725694366078337030937104035993569672959361347287894143027186846856772983058328919716702982222142848848117768499996617588305301483085428547267337070998767412540225911508196842253134355901263861121500650240296746702967594224401650220168780537141654489215019142122284308116284129004257364769474080721001708734051264841350424152506027932</span></span><br><span class="line"></span><br><span class="line">n7 = <span class="number">25360227412666612490102161131174584819240931803196448481224305250583841439581008528535930814167338381983764991296575637231916547647970573758269411168219302370541684789125112505021148506809643081950237623703181025696585998044695691322012183660424636496897073045557400768745943787342548267386564625462143150176113656264450210023925571945961405709276631990731602198104287528528055650050486159837612279600415259486306154947514005408907590083747758953115486124865486720633820559135063440942528031402951958557630833503775112010715604278114325528993771081233535247118481765852273252404963430792898948219539473312462979849137</span></span><br><span class="line">c7 = <span class="number">19892772524651452341027595619482734356243435671592398172680379981502759695784087900669089919987705675899945658648623800090272599154590123082189645021800958076861518397325439521139995652026377132368232502108620033400051346127757698623886142621793423225749240286511666556091787851683978017506983310073524398287279737680091787333547538239920607761080988243639547570818363788673249582783015475682109984715293163137324439862838574460108793714172603672477766831356411304446881998674779501188163600664488032943639694828698984739492200699684462748922883550002652913518229322945040819064133350314536378694523704793396169065179</span></span><br><span class="line"></span><br><span class="line">n8 = <span class="number">22726855244632356029159691753451822163331519237547639938779517751496498713174588935566576167329576494790219360727877166074136496129927296296996970048082870488804456564986667129388136556137013346228118981936899510687589585286517151323048293150257036847475424044378109168179412287889340596394755257704938006162677656581509375471102546261355748251869048003600520034656264521931808651038524134185732929570384705918563982065684145766427962502261522481994191989820110575981906998431553107525542001187655703534683231777988419268338249547641335718393312295800044734534761692799403469497954062897856299031257454735945867491191</span></span><br><span class="line">c8 = <span class="number">6040119795175856407541082360023532204614723858688636724822712717572759793960246341800308149739809871234313049629732934797569781053000686185666374833978403290525072598774001731350244744590772795701065129561898116576499984185920661271123665356132719193665474235596884239108030605882777868856122378222681140570519180321286976947154042272622411303981011302586225630859892731724640574658125478287115198406253847367979883768000812605395482952698689604477719478947595442185921480652637868335673233200662100621025061500895729605305665864693122952557361871523165300206070325660353095592778037767395360329231331322823610060006</span></span><br><span class="line"></span><br><span class="line">n9 = <span class="number">23297333791443053297363000786835336095252290818461950054542658327484507406594632785712767459958917943095522594228205423428207345128899745800927319147257669773812669542782839237744305180098276578841929496345963997512244219376701787616046235397139381894837435562662591060768476997333538748065294033141610502252325292801816812268934171361934399951548627267791401089703937389012586581080223313060159456238857080740699528666411303029934807011214953984169785844714159627792016926490955282697877141614638806397689306795328344778478692084754216753425842557818899467945102646776342655167655384224860504086083147841252232760941</span></span><br><span class="line">c9 = <span class="number">5418120301208378713115889465579964257871814114515046096090960159737859076829258516920361577853903925954198406843757303687557848302302200229295916902430205737843601806700738234756698575708612424928480440868739120075888681672062206529156566421276611107802917418993625029690627196813830326369874249777619239603300605876865967515719079797115910578653562787899019310139945904958024882417833736304894765433489476234575356755275147256577387022873348906900149634940747104513850154118106991137072643308620284663108283052245750945228995387803432128842152251549292698947407663643895853432650029352092018372834457054271102816934</span></span><br><span class="line"></span><br><span class="line">n10 = <span class="number">28873667904715682722987234293493200306976947898711255064125115933666968678742598858722431426218914462903521596341771131695619382266194233561677824357379805303885993804266436810606263022097900266975250431575654686915049693091467864820512767070713267708993899899011156106766178906700336111712803362113039613548672937053397875663144794018087017731949087794894903737682383916173267421403408140967713071026001874733487295007501068871044649170615709891451856792232315526696220161842742664778581287321318748202431466508948902745314372299799561625186955234673012098210919745879882268512656931714326782335211089576897310591491</span></span><br><span class="line">c10 = <span class="number">9919880463786836684987957979091527477471444996392375244075527841865509160181666543016317634963512437510324198702416322841377489417029572388474450075801462996825244657530286107428186354172836716502817609070590929769261932324275353289939302536440310628698349244872064005700644520223727670950787924296004296883032978941200883362653993351638545860207179022472492671256630427228461852668118035317021428675954874947015197745916918197725121122236369382741533983023462255913924692806249387449016629865823316402366017657844166919846683497851842388058283856219900535567427103603869955066193425501385255322097901531402103883869</span></span><br><span class="line"></span><br><span class="line">n11 = <span class="number">22324685947539653722499932469409607533065419157347813961958075689047690465266404384199483683908594787312445528159635527833904475801890381455653807265501217328757871352731293000303438205315816792663917579066674842307743845261771032363928568844669895768092515658328756229245837025261744260614860746997931503548788509983868038349720225305730985576293675269073709022350700836510054067641753713212999954307022524495885583361707378513742162566339010134354907863733205921845038918224463903789841881400814074587261720283879760122070901466517118265422863420376921536734845502100251460872499122236686832189549698020737176683019</span></span><br><span class="line">c11 = <span class="number">1491527050203294989882829248560395184804977277747126143103957219164624187528441047837351263580440686474767380464005540264627910126483129930668344095814547592115061057843470131498075060420395111008619027199037019925701236660166563068245683975787762804359520164701691690916482591026138582705558246869496162759780878437137960823000043988227303003876410503121370163303711603359430764539337597866862508451528158285103251810058741879687875218384160282506172706613359477657215420734816049393339593755489218588796607060261897905233453268671411610631047340459487937479511933450369462213795738933019001471803157607791738538467</span></span><br><span class="line"></span><br><span class="line">n12 = <span class="number">27646746423759020111007828653264027999257847645666129907789026054594393648800236117046769112762641778865620892443423100189619327585811384883515424918752749559627553637785037359639801125213256163008431942593727931931898199727552768626775618479833029101249692573716030706695702510982283555740851047022672485743432464647772882314215176114732257497240284164016914018689044557218920300262234652840632406067273375269301008409860193180822366735877288205783314326102263756503786736122321348320031950012144905869556204017430593656052867939493633163499580242224763404338807022510136217187779084917996171602737036564991036724299</span></span><br><span class="line">c12 = <span class="number">21991524128957260536043771284854920393105808126700128222125856775506885721971193109361315961129190814674647136464887087893990660894961612838205086401018885457667488911898654270235561980111174603323721280911197488286585269356849579263043456316319476495888696219344219866516861187654180509247881251251278919346267129904739277386289240394384575124331135655943513831009934023397457082184699737734388823763306805326430395849935770213817533387235486307008892410920611669932693018165569417445885810825749609388627231235840912644654685819620931663346297596334834498661789016450371769203650109994771872404185770230172934013971</span></span><br><span class="line"></span><br><span class="line">n13 = <span class="number">20545487405816928731738988374475012686827933709789784391855706835136270270933401203019329136937650878386117187776530639342572123237188053978622697282521473917978282830432161153221216194169879669541998840691383025487220850872075436064308499924958517979727954402965612196081404341651517326364041519250125036424822634354268773895465698920883439222996581226358595873993976604699830613932320720554130011671297944433515047180565484495191003887599891289037982010216357831078328159028953222056918189365840711588671093333013117454034313622855082795813122338562446223041211192277089225078324682108033843023903550172891959673551</span></span><br><span class="line">c13 = <span class="number">14227439188191029461250476692790539654619199888487319429114414557975376308688908028140817157205579804059783807641305577385724758530138514972962209062230576107406142402603484375626077345190883094097636019771377866339531511965136650567412363889183159616188449263752475328663245311059988337996047359263288837436305588848044572937759424466586870280512424336807064729894515840552404756879590698797046333336445465120445087587621743906624279621779634772378802959109714400516183718323267273824736540168545946444437586299214110424738159957388350785999348535171553569373088251552712391288365295267665691357719616011613628772175</span></span><br><span class="line"></span><br><span class="line">n14 = <span class="number">27359727711584277234897157724055852794019216845229798938655814269460046384353568138598567755392559653460949444557879120040796798142218939251844762461270251672399546774067275348291003962551964648742053215424620256999345448398805278592777049668281558312871773979931343097806878701114056030041506690476954254006592555275342579529625231194321357904668512121539514880704046969974898412095675082585315458267591016734924646294357666924293908418345508902112711075232047998775303603175363964055048589769318562104883659754974955561725694779754279606726358588862479198815999276839234952142017210593887371950645418417355912567987</span></span><br><span class="line">c14 = <span class="number">3788529784248255027081674540877016372807848222776887920453488878247137930578296797437647922494510483767651150492933356093288965943741570268943861987024276610712717409139946409513963043114463933146088430004237747163422802959250296602570649363016151581364006795894226599584708072582696996740518887606785460775851029814280359385763091078902301957226484620428513604630585131511167015763190591225884202772840456563643159507805711004113901417503751181050823638207803533111429510911616160851391754754434764819568054850823810901159821297849790005646102129354035735350124476838786661542089045509656910348676742844957008857457</span></span><br><span class="line"></span><br><span class="line">n15 = <span class="number">27545937603751737248785220891735796468973329738076209144079921449967292572349424539010502287564030116831261268197384650511043068738911429169730640135947800885987171539267214611907687570587001933829208655100828045651391618089603288456570334500533178695238407684702251252671579371018651675054368606282524673369983034682330578308769886456335818733827237294570476853673552685361689144261552895758266522393004116017849397346259119221063821663280935820440671825601452417487330105280889520007917979115568067161590058277418371493228631232457972494285014767469893647892888681433965857496916110704944758070268626897045014782837</span></span><br><span class="line">c15 = <span class="number">14069112970608895732417039977542732665796601893762401500878786871680645798754783315693511261740059725171342404186571066972546332813667711135661176659424619936101038903439144294886379322591635766682645179888058617577572409307484708171144488708410543462972008179994594087473935638026612679389759756811490524127195628741262871304427908481214992471182859308828778119005750928935764927967212343526503410515793717201360360437981322576798056276657140363332700714732224848346808963992302409037706094588964170239521193589470070839790404597252990818583717869140229811712295005710540476356743378906642267045723633874011649259842</span></span><br><span class="line"></span><br><span class="line">n16 = <span class="number">25746162075697911560263181791216433062574178572424600336856278176112733054431463253903433128232709054141607100891177804285813783247735063753406524678030561284491481221681954564804141454666928657549670266775659862814924386584148785453647316864935942772919140563506305666207816897601862713092809234429096584753263707828899780979223118181009293655563146526792388913462557306433664296966331469906428665127438829399703002867800269947855869262036714256550075520193125987011945192273531732276641728008406855871598678936585324782438668746810516660152018244253008092470066555687277138937298747951929576231036251316270602513451</span></span><br><span class="line">c16 = <span class="number">17344284860275489477491525819922855326792275128719709401292545608122859829827462088390044612234967551682879954301458425842831995513832410355328065562098763660326163262033200347338773439095709944202252494552172589503915965931524326523663289777583152664722241920800537867331030623906674081852296232306336271542832728410803631170229642717524942332390842467035143631504401140727083270732464237443915263865880580308776111219718961746378842924644142127243573824972533819479079381023103585862099063382129757560124074676150622288706094110075567706403442920696472627797607697962873026112240527498308535903232663939028587036724</span></span><br><span class="line"></span><br><span class="line">n17 = <span class="number">23288486934117120315036919418588136227028485494137930196323715336208849327833965693894670567217971727921243839129969128783853015760155446770590696037582684845937132790047363216362087277861336964760890214059732779383020349204803205725870225429985939570141508220041286857810048164696707018663758416807708910671477407366098883430811861933014973409390179948577712579749352299440310543689035651465399867908428885541237776143404376333442949397063249223702355051571790555151203866821867908531733788784978667478707672984539512431549558672467752712004519300318999208102076732501412589104904734983789895358753664077486894529499</span></span><br><span class="line">c17 = <span class="number">10738254418114076548071448844964046468141621740603214384986354189105236977071001429271560636428075970459890958274941762528116445171161040040833357876134689749846940052619392750394683504816081193432350669452446113285638982551762586656329109007214019944975816434827768882704630460001209452239162896576191876324662333153835533956600295255158377025198426950944040643235430211011063586032467724329735785947372051759042138171054165854842472990583800899984893232549092766400510300083585513014171220423103452292891496141806956300396540682381668367564569427813092064053993103537635994311143010708814851867239706492577203899024</span></span><br><span class="line"></span><br><span class="line">n18 = <span class="number">19591441383958529435598729113936346657001352578357909347657257239777540424811749817783061233235817916560689138344041497732749011519736303038986277394036718790971374656832741054547056417771501234494768509780369075443550907847298246275717420562375114406055733620258777905222169702036494045086017381084272496162770259955811174440490126514747876661317750649488774992348005044389081101686016446219264069971370646319546429782904810063020324704138495608761532563310699753322444871060383693044481932265801505819646998535192083036872551683405766123968487907648980900712118052346174533513978009131757167547595857552370586353973</span></span><br><span class="line">c18 = <span class="number">3834917098887202931981968704659119341624432294759361919553937551053499607440333234018189141970246302299385742548278589896033282894981200353270637127213483172182529890495903425649116755901631101665876301799865612717750360089085179142750664603454193642053016384714515855868368723508922271767190285521137785688075622832924829248362774476456232826885801046969384519549385428259591566716890844604696258783639390854153039329480726205147199247183621535172450825979047132495439603840806501254997167051142427157381799890725323765558803808030109468048682252028720241357478614704610089120810367192414352034177484688502364022887</span></span><br><span class="line"></span><br><span class="line">n19 = <span class="number">19254242571588430171308191757871261075358521158624745702744057556054652332495961196795369630484782930292003238730267396462491733557715379956969694238267908985251699834707734400775311452868924330866502429576951934279223234676654749272932769107390976321208605516299532560054081301829440688796904635446986081691156842271268059970762004259219036753174909942343204432795076377432107630203621754552804124408792358220071862369443201584155711893388877350138023238624566616551246804054720492816226651467017802504094070614892556444425915920269485861799532473383304622064493223627552558344088839860178294589481899206318863310603</span></span><br><span class="line">c19 = <span class="number">6790553533991297205804561991225493105312398825187682250780197510784765226429663284220400480563039341938599783346724051076211265663468643826430109013245014035811178295081939958687087477312867720289964506097819762095244479129359998867671811819738196687884696680463458661374310994610760009474264115750204920875527434486437536623589684519411519100170291423367424938566820315486507444202022408003879118465761273916755290898112991525546114191064022991329724370064632569903856189236177894007766690782630247443895358893983735822824243487181851098787271270256780891094405121947631088729917398317652320497765101790132679171889</span></span><br><span class="line"></span><br><span class="line">n20 = <span class="number">26809700251171279102974962949184411136459372267620535198421449833298448092580497485301953796619185339316064387798092220298630428207556482805739803420279056191194360049651767412572609187680508073074653291350998253938793269214230457117194434853888765303403385824786231859450351212449404870776320297419712486574804794325602760347306432927281716160368830187944940128907971027838510079519466846176106565164730963988892400240063089397720414921398936399927948235195085202171264728816184532651138221862240969655185596628285814057082448321749567943946273776184657698104465062749244327092588237927996419620170254423837876806659</span></span><br><span class="line">c20 = <span class="number">386213556608434013769864727123879412041991271528990528548507451210692618986652870424632219424601677524265011043146748309774067894985069288067952546139416819404039688454756044862784630882833496090822568580572859029800646671301748901528132153712913301179254879877441322285914544974519727307311002330350534857867516466612474769753577858660075830592891403551867246057397839688329172530177187042229028685862036140779065771061933528137423019407311473581832405899089709251747002788032002094495379614686544672969073249309703482556386024622814731015767810042969813752548617464974915714425595351940266077021672409858645427346</span></span><br><span class="line"></span><br><span class="line">cList = [c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17,c18,c19,c20]</span><br><span class="line">nList = [n1,n2,n3,n4,n5,n6,n7,n8,n9,n10,n11,n12,n13,n14,n15,n16,n17,n18,n19,n20]</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nList)):</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nList)):</span><br><span class="line">		<span class="keyword">if</span> i!= j:</span><br><span class="line">			<span class="keyword">if</span> gmpy2.gcd(nList[i],nList[j]) != <span class="number">1</span>:</span><br><span class="line">				<span class="built_in">print</span>(i,j)</span><br><span class="line">				<span class="built_in">print</span>(gmpy2.gcd(nList[i],nList[j]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4 17</span></span><br><span class="line"><span class="comment"># 132585806383798600305426957307612567604223562626764190211333136246643723811046149337852966828729052476725552361132437370521548707664977123165279305052971868012755509160408641100548744046621516877981864180076497524093201404558036301820216274968638825245150755772559259575544101918590311068466601618472464832499</span></span><br><span class="line">q = <span class="number">132585806383798600305426957307612567604223562626764190211333136246643723811046149337852966828729052476725552361132437370521548707664977123165279305052971868012755509160408641100548744046621516877981864180076497524093201404558036301820216274968638825245150755772559259575544101918590311068466601618472464832499</span></span><br><span class="line">p = nList[<span class="number">4</span>]//q</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(cList[<span class="number">4</span>],d,nList[<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># flag&#123;abdcbe5fd94e23b3de429223ab9c2fdf&#125;</span></span><br></pre></td></tr></table></figure>

<p>[脚本参考](<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44017838/article/details/104878645?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164958629416780261970846%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=164958629416780261970846&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-104878645.142">https://blog.csdn.net/weixin_44017838/article/details/104878645?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164958629416780261970846%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=164958629416780261970846&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-104878645.142</a> ** v7 ** pc_search_result_control_group,157 ** v4 ** control&amp;utm_term&#x3D;RSA5&amp;spm&#x3D;1018.2226.3001.4187)</p>
<h2 id="低加密指数广播攻击-中国剩余定理"><a href="#低加密指数广播攻击-中国剩余定理" class="headerlink" title="低加密指数广播攻击(中国剩余定理)"></a>低加密指数广播攻击(中国剩余定理)</h2><h3 id="RSA4-中国剩余定理-低加密指数攻击"><a href="#RSA4-中国剩余定理-低加密指数攻击" class="headerlink" title="RSA4 (中国剩余定理+低加密指数攻击)"></a>RSA4 (中国剩余定理+低加密指数攻击)</h3><p>来复习一下加密和解密的规则</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c = m  **  e % n</span><br><span class="line">m = c  **  d % n</span><br></pre></td></tr></table></figure>

<p>题目给了三个N和三个C，考虑用中国剩余定律（CRT）求出m ** e。</p>
<p>这题给出的数据仔细观察，可以知道是五进制数据，所以还需要转化，int(x,5)即可</p>
<p>题目中还没有给出e，这种题目中e通常都很小，低指数加密，只需要遍历求出的m ** e，开对应的根号即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#利用中国剩余定理求解同余方程，aList：余数，mList：模数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CRT</span>(<span class="params">aList, mList</span>):</span><br><span class="line">    M = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> mList:</span><br><span class="line">        M = M * i   <span class="comment">#计算M = ∏ mi</span></span><br><span class="line">    <span class="comment">#print(M)</span></span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mList)):</span><br><span class="line">        Mi = M // mList[i]   <span class="comment">#计算Mi</span></span><br><span class="line">        Mi_inverse = gmpy2.invert(Mi, mList[i]) <span class="comment">#计算Mi的逆元</span></span><br><span class="line">        x += aList[i] * Mi * Mi_inverse <span class="comment">#构造x各项</span></span><br><span class="line">    x = x % M</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment">#========== n c ==========</span></span><br><span class="line">    n1 = <span class="string">&quot;331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004&quot;</span></span><br><span class="line">    c1 = <span class="string">&quot;310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243&quot;</span></span><br><span class="line">    n2 = <span class="string">&quot;302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114&quot;</span></span><br><span class="line">    c2 = <span class="string">&quot;112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344&quot;</span></span><br><span class="line">    n3 = <span class="string">&quot;332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323&quot;</span></span><br><span class="line">    c3 = <span class="string">&quot;10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242&quot;</span></span><br><span class="line">    </span><br><span class="line">    cList = [<span class="built_in">int</span>(c1,<span class="number">5</span>), <span class="built_in">int</span>(c2,<span class="number">5</span>), <span class="built_in">int</span>(c3,<span class="number">5</span>)]</span><br><span class="line">    nList = [<span class="built_in">int</span>(n1,<span class="number">5</span>), <span class="built_in">int</span>(n2,<span class="number">5</span>), <span class="built_in">int</span>(n3,<span class="number">5</span>)]</span><br><span class="line">    m_e = CRT(cList, nList) <span class="comment">#计算m ** e</span></span><br><span class="line">    <span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):  <span class="comment">#遍历e求解</span></span><br><span class="line">        m, f = gmpy2.iroot(m_e, e) <span class="comment">#m_e开e次根</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;加密指数e = %d：&quot;</span>%e)</span><br><span class="line">        flag = long_to_bytes(m)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># noxCTF&#123;D4mn_y0u_h4s74d_wh47_4_b100dy_b4s74rd!&#125;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44017838/article/details/105058745">代码来源</a></p>
<h2 id="rsa-wiener-attack"><a href="#rsa-wiener-attack" class="headerlink" title="rsa-wiener-attack"></a>rsa-wiener-attack</h2><h3 id="rsa2"><a href="#rsa2" class="headerlink" title="rsa2"></a>rsa2</h3><h4 id="方法一：在线分解"><a href="#方法一：在线分解" class="headerlink" title="方法一：在线分解"></a>方法一：在线分解</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">N = <span class="number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span></span><br><span class="line">e = <span class="number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + hashlib.md5(<span class="built_in">hex</span>(d)).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p>在线网站分解出p和q</p>
<img src="/2022/03/22/BUU_crypto/rsa%E5%90%88%E9%9B%86/image-20220410191159209.png" class="" title="image-20220410191159209">

<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">9046853915223503351787031888977627106934564043204783593118678181991596316582877057556463152579621699010610569526573031954779520781448550677767565207407183</span></span><br><span class="line"></span><br><span class="line">q = <span class="number">11273732364123571293429600400343309403733952146912318879993851141423284675797325272321856863528776914709992821287788339848962916204774010644058033316303937</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + hashlib.md5(<span class="built_in">hex</span>(d)).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>注意该脚本需要在python2环境中跑出来，如果在python3中，则会提醒需要编码，而且结果不一致……</p>
<h4 id="方法二：rsa-wiener-attack"><a href="#方法二：rsa-wiener-attack" class="headerlink" title="方法二：rsa-wiener-attack"></a>方法二：rsa-wiener-attack</h4><p>当e非常大，和n差不多大的时候，就能考虑使用wiener-attack脚本来解题了。</p>
<p>使用的脚本<a target="_blank" rel="noopener" href="https://github.com/pablocelayes/rsa-wiener-attack">https://github.com/pablocelayes/rsa-wiener-attack</a></p>
<p>需要将脚本放在rsa-wiener-attack-master的目录下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> ContinuedFractions, Arithmetic</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wiener_hack</span>(<span class="params">e, n</span>):</span><br><span class="line">    frac = ContinuedFractions.rational_to_contfrac(e, n)</span><br><span class="line">    convergents = ContinuedFractions.convergents_from_contfrac(frac)</span><br><span class="line">    <span class="keyword">for</span> (k, d) <span class="keyword">in</span> convergents:</span><br><span class="line">        <span class="keyword">if</span> k != <span class="number">0</span> <span class="keyword">and</span> (e * d - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">            phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">            s = n - phi + <span class="number">1</span></span><br><span class="line">            discr = s * s - <span class="number">4</span> * n</span><br><span class="line">            <span class="keyword">if</span> (discr &gt;= <span class="number">0</span>):</span><br><span class="line">                t = Arithmetic.is_perfect_square(discr)</span><br><span class="line">                <span class="keyword">if</span> t != -<span class="number">1</span> <span class="keyword">and</span> (s + t) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Hacked!&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">d = wiener_hack(e, n)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(d))</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + hashlib.md5(<span class="built_in">hex</span>(d)).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>注意该脚本也需要在python2环境中跑</p>
<h2 id="数学推理"><a href="#数学推理" class="headerlink" title="数学推理"></a>数学推理</h2><h3 id="BJDCTF2020-easyrsa-（反三角函数求导）"><a href="#BJDCTF2020-easyrsa-（反三角函数求导）" class="headerlink" title="[BJDCTF2020]easyrsa （反三角函数求导）"></a>[BJDCTF2020]easyrsa （反三角函数求导）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Derivative</span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=p*q</span><br><span class="line">z=Fraction(<span class="number">1</span>,Derivative(arctan(p),p)) - Fraction(<span class="number">1</span>,Derivative(arth(q),q))</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(c,z,n)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">output:</span></span><br><span class="line"><span class="string">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span></span><br><span class="line"><span class="string">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span></span><br><span class="line"><span class="string">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>其中Fraction()是分数，Fraction(1,x)就是求倒数</p>
<p>Derivative(f(x),x)是求f(x)关于x的导数</p>
<p>反正切函数arctanx的求导公式：1 &#x2F;（ 1 + x^2 ）</p>
<p>反双曲正切 arthx的求导公式：1 &#x2F;（1 - x^2 )</p>
<p>所以 z &#x3D; p ^ 2 + q ^ 2</p>
<p>因为p*q &#x3D; n，所以我们通过z3来求解p和q</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">z = <span class="number">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span></span><br><span class="line">n = <span class="number">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span></span><br><span class="line"></span><br><span class="line">x = Solver()</span><br><span class="line">p,q = Ints(<span class="string">&quot;p q&quot;</span>)</span><br><span class="line">x.add(p*q == n)</span><br><span class="line">x.add(p**<span class="number">2</span> + q**<span class="number">2</span> == z)</span><br><span class="line">x.check()</span><br><span class="line"><span class="built_in">print</span>(x.model())</span><br><span class="line"><span class="comment"># p = 144564833334456076455156647979862690498796694770100520405218930055633597500009574663803955456004439398699669751249623406199542605271188909145969364476344963078599240058180033000440459281558347909876143313940657252737586803051935392596519226965519859474501391969755712097119163926672753588797180811711004203301</span></span><br><span class="line"><span class="comment"># q = 105909195259921349656664570904199242969110902804477734660927330311460997899731622163728968380757294196277263615386525795293086103142131020215128282050307177125962302515483190468569376643751587606016315185736245896434947691528567696271911398179288329609207435393579332931583829355558784305002360873458907029141</span></span><br></pre></td></tr></table></figure>

<p>然后就顺水推舟了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = <span class="number">144564833334456076455156647979862690498796694770100520405218930055633597500009574663803955456004439398699669751249623406199542605271188909145969364476344963078599240058180033000440459281558347909876143313940657252737586803051935392596519226965519859474501391969755712097119163926672753588797180811711004203301</span></span><br><span class="line">q = <span class="number">105909195259921349656664570904199242969110902804477734660927330311460997899731622163728968380757294196277263615386525795293086103142131020215128282050307177125962302515483190468569376643751587606016315185736245896434947691528567696271911398179288329609207435393579332931583829355558784305002360873458907029141</span></span><br><span class="line">c = <span class="number">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p * q</span><br><span class="line">d = gmpy2.invert(e, (q-<span class="number">1</span>)*(p-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># BJD&#123;Advanced_mathematics_is_too_hard!!!&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="RoarCTF2019-RSA-（推导-爆破e）"><a href="#RoarCTF2019-RSA-（推导-爆破e）" class="headerlink" title="[RoarCTF2019]RSA （推导+爆破e）"></a>[RoarCTF2019]RSA （推导+爆破e）</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">A=(((y%x)**<span class="number">5</span>)%(x%y))**<span class="number">2019</span>+y**<span class="number">316</span>+(y+<span class="number">1</span>)/x</span><br><span class="line">p=next_prime(z*x*y)</span><br><span class="line">q=next_prime(z)</span><br><span class="line">A =  <span class="number">2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724</span></span><br><span class="line">n =  <span class="number">117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127</span></span><br><span class="line">c =  <span class="number">41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这题首先是需要求出x和y的值，通过计算可以列出以下的等式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">y = gmpy2.iroot(A,<span class="number">316</span>)[<span class="number">0</span>]</span><br><span class="line">x = (y+<span class="number">1</span>) // (A - y**<span class="number">316</span> - <span class="number">1</span>)</span><br><span class="line"><span class="comment"># y = 83</span></span><br><span class="line"><span class="comment"># x = 2</span></span><br></pre></td></tr></table></figure>

<p>p和q是通过x,y,z生成的，可以确定的是，p约是q的166倍，这样我们大概可以求出z的范围，进而可以通过爆破，确定q的值，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">z = gmpy2.iroot(n//<span class="number">166</span>,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">100000</span>):</span><br><span class="line">    p = z+i</span><br><span class="line">	<span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">		<span class="built_in">print</span>(i,p)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line"><span class="comment"># i = 546 p = 842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458569</span></span><br></pre></td></tr></table></figure>

<p>题目中没有给出我们e值，我们选择爆破e</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">q = <span class="number">842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458569</span></span><br><span class="line"></span><br><span class="line">p = n//q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">100000</span>):</span><br><span class="line">	<span class="keyword">if</span> gmpy2.gcd(e,phi) != <span class="number">1</span>: <span class="comment">#e的值，需要与phi满足互质的关系</span></span><br><span class="line">		<span class="keyword">continue</span></span><br><span class="line">	d = gmpy2.invert(e,phi)</span><br><span class="line">	m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">	flag = <span class="built_in">str</span>(long_to_bytes(m))</span><br><span class="line">	<span class="keyword">if</span> <span class="string">&quot;CTF&quot;</span> <span class="keyword">in</span> flag <span class="keyword">or</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(flag):</span><br><span class="line">		<span class="built_in">print</span>(e,flag)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line"><span class="comment"># 65537 b&#x27;RoarCTF&#123;wm-l1l1ll1l1l1l111ll&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>这题看似简单，其实很头疼，如何通过给出的A，推断出x,y，再推断出z的范围，小范围爆破出q，最后还需要爆破e，花的时间挺久的……</p>
<p>当然，我尝试了一下在线分解，成功了。但是我认为，比赛中一般不会给出可以轻易分解的n，所以需要锻炼自己数学推理的能力。</p>
<p>过程中自己还编写了一个isPrime函数，和next_prime(n)函数来测试，贴在这边备用（当然使用sympy.nextprime()函数更佳）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">prime = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>, <span class="number">59</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">97</span>, <span class="number">101</span>, <span class="number">103</span>, <span class="number">107</span>, <span class="number">109</span>, <span class="number">113</span>, <span class="number">127</span>, <span class="number">131</span>, <span class="number">137</span>, <span class="number">139</span>, <span class="number">149</span>, <span class="number">151</span>, <span class="number">157</span>, <span class="number">163</span>, <span class="number">167</span>, <span class="number">173</span>, <span class="number">179</span>, <span class="number">181</span>, <span class="number">191</span>, <span class="number">193</span>, <span class="number">197</span>, <span class="number">199</span>, <span class="number">211</span>, <span class="number">223</span>, <span class="number">227</span>, <span class="number">229</span>, <span class="number">233</span>, <span class="number">239</span>, <span class="number">241</span>, <span class="number">251</span>, <span class="number">257</span>, <span class="number">263</span>, <span class="number">269</span>, <span class="number">271</span>, <span class="number">277</span>, <span class="number">281</span>, <span class="number">283</span>, <span class="number">293</span>, <span class="number">307</span>, <span class="number">311</span>, <span class="number">313</span>, <span class="number">317</span>, <span class="number">331</span>, <span class="number">337</span>, <span class="number">347</span>, <span class="number">349</span>, <span class="number">353</span>, <span class="number">359</span>, <span class="number">367</span>, <span class="number">373</span>, <span class="number">379</span>, <span class="number">383</span>, <span class="number">389</span>, <span class="number">397</span>, <span class="number">401</span>, <span class="number">409</span>, <span class="number">419</span>, <span class="number">421</span>, <span class="number">431</span>, <span class="number">433</span>, <span class="number">439</span>, <span class="number">443</span>, <span class="number">449</span>, <span class="number">457</span>, <span class="number">461</span>, <span class="number">463</span>, <span class="number">467</span>, <span class="number">479</span>, <span class="number">487</span>, <span class="number">491</span>, <span class="number">499</span>, <span class="number">503</span>, <span class="number">509</span>, <span class="number">521</span>, <span class="number">523</span>, <span class="number">541</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isPrime</span>(<span class="params">n</span>): </span><br><span class="line">	<span class="keyword">for</span> pri <span class="keyword">in</span> prime:</span><br><span class="line">		<span class="keyword">if</span> n == pri:</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		<span class="keyword">if</span> n % pri == <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_prime</span>(<span class="params">n</span>):</span><br><span class="line">	i = <span class="number">1</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		<span class="keyword">if</span> isPrime(n+i):</span><br><span class="line">			<span class="keyword">return</span> n+i</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		i += <span class="number">1</span></span><br></pre></td></tr></table></figure>



<h3 id="RoarCTF2019-babyRSA-威尔逊定理"><a href="#RoarCTF2019-babyRSA-威尔逊定理" class="headerlink" title="[RoarCTF2019]babyRSA (威尔逊定理)"></a>[RoarCTF2019]babyRSA (威尔逊定理)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myGetPrime</span>():</span><br><span class="line">    A= getPrime(<span class="number">513</span>)</span><br><span class="line">    <span class="built_in">print</span>(A)</span><br><span class="line">    B=A-random.randint(<span class="number">1e3</span>,<span class="number">1e5</span>)</span><br><span class="line">    <span class="built_in">print</span>(B)</span><br><span class="line">    <span class="keyword">return</span> sympy.nextPrime((B!)%A)</span><br><span class="line">p=myGetPrime()</span><br><span class="line"><span class="comment">#A1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span></span><br><span class="line"><span class="comment">#B1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span></span><br><span class="line"></span><br><span class="line">q=myGetPrime()</span><br><span class="line"><span class="comment">#A2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span></span><br><span class="line"><span class="comment">#B2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span></span><br><span class="line"></span><br><span class="line">r=myGetPrime()</span><br><span class="line"></span><br><span class="line">n=p*q*r</span><br><span class="line"><span class="comment">#n=85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span></span><br><span class="line">c=<span class="built_in">pow</span>(flag,e,n)</span><br><span class="line"><span class="comment">#e=0x1001</span></span><br><span class="line"><span class="comment">#c=75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span></span><br><span class="line"><span class="comment">#so,what is the flag?</span></span><br></pre></td></tr></table></figure>

<p>513位数字的阶乘？蒙了，看<a target="_blank" rel="noopener" href="https://www.cnblogs.com/vict0r/p/13563073.html">大佬的博客</a>才知道原来使用的是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%A8%81%E5%B0%94%E9%80%8A%E5%AE%9A%E7%90%86/1881444?fr=aladdin">威尔逊定律</a>，强到窒息……</p>
<p>简单阐述一下威尔逊定律，就是对于素数n来说，(n - 1)!%n  &#x3D; -1 (A - 1)</p>
<p>由题目可以得知：</p>
<p>p 约等于 (B1!)%A1</p>
<p>A1是质数，由威尔逊定律可以得出：(A1 - 1)!%A1 &#x3D; -1 % A</p>
<p>而B1 &#x3D; A1 - randint(1e3,1e5)</p>
<p>(A1 - 1) * (A1 - 2) * (A1- 3) …… (B1+1) * B1！% A1 &#x3D; -1 % A</p>
<p>推算一下：</p>
<p>(A1 - 2) * (A1- 3) …… (B1+1) * B1！% A1 &#x3D; 1 % A1</p>
<p>(A1 - 2) * (A1- 3) …… (B1+1)与 B1！% A1是关于A1的模逆，这样就能求出B1！% A1的值了</p>
<p>然后通过在通过sympy.nextprime()函数算出p</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">A1 = <span class="number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span></span><br><span class="line">B1 = <span class="number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span></span><br><span class="line">A2 = <span class="number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span></span><br><span class="line">B2 = <span class="number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span></span><br><span class="line">n = <span class="number">85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span></span><br><span class="line">c = <span class="number">75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_value</span>(<span class="params">A,B</span>):</span><br><span class="line">	s = <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(B+<span class="number">1</span>,A-<span class="number">1</span>):</span><br><span class="line">		s *= i</span><br><span class="line">		s %= A</span><br><span class="line">	value = gmpy2.invert(s,A)</span><br><span class="line">	<span class="keyword">return</span> sympy.nextprime(value)</span><br><span class="line">p = get_value(A1,B1)</span><br><span class="line">q = get_value(A2,B2)</span><br><span class="line"></span><br><span class="line">r = n//p//q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">0x1001</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># RoarCTF&#123;wm-CongrAtu1ation4-1t4-ju4t-A-bAby-R4A&#125;</span></span><br></pre></td></tr></table></figure>



</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/rsa/">rsa</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/03/27/CTF/2022DASCTF/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">2022DASCTF</div></div></a></div><div class="next-post pull-right"><a href="/2022/03/18/bugku/bugku-crypto/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">bugku-crypto</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/ke1os.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">ke1os</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">20</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">11</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E8%AE%BA%E7%9F%A5%E8%AF%86"><span class="toc-number">1.1.</span> <span class="toc-text">数论知识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">1.2.</span> <span class="toc-text">rsa加密算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yafu%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.3.</span> <span class="toc-text">yafu的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86"><span class="toc-number">1.4.</span> <span class="toc-text">中国剩余定理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98%EF%BC%9A%E8%93%9D%E6%A1%A5%E6%9D%AF2022%E5%B9%B4python-B%E7%BB%84%E8%AF%95%E9%A2%98B%EF%BC%9A%E5%AF%BB%E6%89%BE%E6%95%B4%E6%95%B0"><span class="toc-number">1.4.1.</span> <span class="toc-text">例题：蓝桥杯2022年python B组试题B：寻找整数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E9%A2%98%E5%9E%8B"><span class="toc-number">2.</span> <span class="toc-text">各种题型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E8%A7%A3%E6%B3%95"><span class="toc-number">2.1.</span> <span class="toc-text">基础解法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rsarsa-%EF%BC%88%E5%9F%BA%E7%A1%80%E8%A7%A3%E6%B3%95%EF%BC%89"><span class="toc-number">2.1.1.</span> <span class="toc-text">rsarsa （基础解法）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSAROOL-%E5%9C%A8%E7%BA%BF%E5%88%86%E8%A7%A3"><span class="toc-number">2.1.2.</span> <span class="toc-text">RSAROOL (在线分解)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA-%E5%9F%BA%E7%A1%80%E8%A7%A3%E6%B3%95"><span class="toc-number">2.1.3.</span> <span class="toc-text">RSA (基础解法)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-crypto-rsa0-zip%E4%BC%AA%E5%8A%A0%E5%AF%86"><span class="toc-number">2.1.4.</span> <span class="toc-text">[ACTF新生赛2020]crypto-rsa0 (zip伪加密)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#misc-zip%E4%BC%AA%E5%8A%A0%E5%AF%86"><span class="toc-number">2.1.4.1.</span> <span class="toc-text">misc zip伪加密</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GUET-CTF2019-BabyRSA-%EF%BC%88z3%EF%BC%89"><span class="toc-number">2.1.5.</span> <span class="toc-text">[GUET-CTF2019]BabyRSA （z3）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HDCTF2019-bbbbbbrsa-%E7%88%86%E7%A0%B4e"><span class="toc-number">2.1.6.</span> <span class="toc-text">[HDCTF2019]bbbbbbrsa (爆破e)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA-%E5%85%AC%E9%92%A5%E8%A7%A3%E6%9E%901"><span class="toc-number">2.1.7.</span> <span class="toc-text">RSA (公钥解析1)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AFCTF2018-%E5%8F%AF%E6%80%9C%E7%9A%84RSA-%E5%85%AC%E9%92%A5%E8%A7%A3%E6%9E%902-PKCS1-OAEP"><span class="toc-number">2.1.8.</span> <span class="toc-text">[AFCTF2018]可怜的RSA (公钥解析2 + PKCS1_OAEP)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dp%E6%B3%84%E9%9C%B2"><span class="toc-number">2.2.</span> <span class="toc-text">dp泄露</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA2-dp%E6%B3%84%E9%9C%B2"><span class="toc-number">2.2.1.</span> <span class="toc-text">RSA2  (dp泄露)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="toc-number">2.3.</span> <span class="toc-text">共模攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA3-%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="toc-number">2.3.1.</span> <span class="toc-text">RSA3 (共模攻击)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA-amp-what-%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB-base64%E9%9A%90%E5%86%99"><span class="toc-number">2.3.2.</span> <span class="toc-text">RSA &amp; what (共模攻击+base64隐写)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5dp%E3%80%81dq"><span class="toc-number">2.4.</span> <span class="toc-text">已知dp、dq</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA1-%EF%BC%88%E5%B7%B2%E7%9F%A5dp%E3%80%81dq%EF%BC%89"><span class="toc-number">2.4.1.</span> <span class="toc-text">RSA1  （已知dp、dq）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB"><span class="toc-number">2.5.</span> <span class="toc-text">低加密指数攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dangerous-RSA-%EF%BC%88%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB%EF%BC%89"><span class="toc-number">2.5.1.</span> <span class="toc-text">dangerous RSA （低加密指数攻击）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AC%E5%9B%A0%E6%95%B0%E5%88%86%E8%A7%A3n"><span class="toc-number">2.6.</span> <span class="toc-text">公因数分解n</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-RSA%EF%BC%88%E5%85%AC%E5%9B%A0%E6%95%B0%E5%88%86%E8%A7%A3n-%E7%88%86%E7%A0%B4e%EF%BC%89"><span class="toc-number">2.6.1.</span> <span class="toc-text">[BJDCTF2020]RSA（公因数分解n+爆破e）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA5%EF%BC%88%E5%85%AC%E5%9B%A0%E6%95%B0%E6%B1%82%E8%A7%A3%EF%BC%89"><span class="toc-number">2.6.2.</span> <span class="toc-text">RSA5（公因数求解）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB-%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86"><span class="toc-number">2.7.</span> <span class="toc-text">低加密指数广播攻击(中国剩余定理)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA4-%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86-%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB"><span class="toc-number">2.7.1.</span> <span class="toc-text">RSA4 (中国剩余定理+低加密指数攻击)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa-wiener-attack"><span class="toc-number">2.8.</span> <span class="toc-text">rsa-wiener-attack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa2"><span class="toc-number">2.8.1.</span> <span class="toc-text">rsa2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E5%9C%A8%E7%BA%BF%E5%88%86%E8%A7%A3"><span class="toc-number">2.8.1.1.</span> <span class="toc-text">方法一：在线分解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9Arsa-wiener-attack"><span class="toc-number">2.8.1.2.</span> <span class="toc-text">方法二：rsa-wiener-attack</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%A6%E6%8E%A8%E7%90%86"><span class="toc-number">2.9.</span> <span class="toc-text">数学推理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-easyrsa-%EF%BC%88%E5%8F%8D%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E6%B1%82%E5%AF%BC%EF%BC%89"><span class="toc-number">2.9.1.</span> <span class="toc-text">[BJDCTF2020]easyrsa （反三角函数求导）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RoarCTF2019-RSA-%EF%BC%88%E6%8E%A8%E5%AF%BC-%E7%88%86%E7%A0%B4e%EF%BC%89"><span class="toc-number">2.9.2.</span> <span class="toc-text">[RoarCTF2019]RSA （推导+爆破e）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RoarCTF2019-babyRSA-%E5%A8%81%E5%B0%94%E9%80%8A%E5%AE%9A%E7%90%86"><span class="toc-number">2.9.3.</span> <span class="toc-text">[RoarCTF2019]babyRSA (威尔逊定理)</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/04/25/CTF/2022%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%BD%91%E5%88%83%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" title="2022第二届网刃杯网络安全大赛"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022第二届网刃杯网络安全大赛"/></a><div class="content"><a class="title" href="/2022/04/25/CTF/2022%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%BD%91%E5%88%83%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" title="2022第二届网刃杯网络安全大赛">2022第二届网刃杯网络安全大赛</a><time datetime="2022-04-25T13:32:31.000Z" title="Created 2022-04-25 21:32:31">2022-04-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/20/CTF/2021CISCN/" title="2021CISCN"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021CISCN"/></a><div class="content"><a class="title" href="/2022/04/20/CTF/2021CISCN/" title="2021CISCN">2021CISCN</a><time datetime="2022-04-20T01:16:11.000Z" title="Created 2022-04-20 09:16:11">2022-04-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/18/CTF/2022TAMUctf/" title="2022TAMUctf"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022TAMUctf"/></a><div class="content"><a class="title" href="/2022/04/18/CTF/2022TAMUctf/" title="2022TAMUctf">2022TAMUctf</a><time datetime="2022-04-18T12:24:49.000Z" title="Created 2022-04-18 20:24:49">2022-04-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/18/CTF/2022CrewCTF/" title="2022CrewCTF"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022CrewCTF"/></a><div class="content"><a class="title" href="/2022/04/18/CTF/2022CrewCTF/" title="2022CrewCTF">2022CrewCTF</a><time datetime="2022-04-18T06:47:48.000Z" title="Created 2022-04-18 14:47:48">2022-04-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/18/CTF/2022DCTF/" title="2022DCTF"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022DCTF"/></a><div class="content"><a class="title" href="/2022/04/18/CTF/2022DCTF/" title="2022DCTF">2022DCTF</a><time datetime="2022-04-18T03:03:26.000Z" title="Created 2022-04-18 11:03:26">2022-04-18</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By ke1os</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>